{"version":3,"file":"adapt.min.js","sources":["../../../../../core/js/wait.js","../../../../../core/js/models/lockingModel.js","../../../../../core/js/adapt.js","../../../../../core/js/offlineStorage.js","../../../../../core/js/device.js","../../../../../core/js/location.js","../../../../../core/js/a11y/browserFocus.js","../../../../../core/js/a11y/focusOptions.js","../../../../../core/js/a11y/keyboardFocusOutline.js","../../../../../core/js/enums/logLevelEnum.js","../../../../../core/js/logging.js","../../../../../core/js/a11y/log.js","../../../../../core/js/a11y/scroll.js","../../../../../core/js/a11y/wrapFocus.js","../../../../../core/js/a11y/popup.js","../../../../../core/js/enums/defaultAriaLevels.js","../../../../../core/js/a11y/deprecated.js","../../../../../core/js/components.js","../../../../../core/js/collections/adaptCollection.js","../../../../../core/js/models/buildModel.js","../../../../../core/js/models/configModel.js","../../../../../core/js/data.js","../../../../../core/js/a11y.js","../../../../../core/js/views/drawerItemView.js","../../../../../core/js/views/drawerView.js","../../../../../core/js/drawer.js","../../../../../core/js/collections/adaptSubsetCollection.js","../../../../../core/js/modelEvent.js","../../../../../core/js/models/adaptModel.js","../../../../../core/js/models/contentObjectModel.js","../../../../../core/js/models/articleModel.js","../../../../../core/js/models/blockModel.js","../../../../../core/js/models/componentModel.js","../../../../../core/js/models/menuModel.js","../../../../../core/js/models/courseModel.js","../../../../../core/js/models/pageModel.js","../../../../../core/js/childEvent.js","../../../../../core/js/templateRenderEvent.js","../../../../../core/js/reactHelpers.js","../../../../../core/js/views/adaptView.js","../../../../../core/js/views/contentObjectView.js","../../../../../core/js/views/pageView.js","../../../../../core/js/views/articleView.js","../../../../../core/js/views/blockView.js","../../../../../core/js/mpabc.js","../../../../../core/js/views/notifyPushView.js","../../../../../core/js/models/notifyModel.js","../../../../../core/js/collections/notifyPushCollection.js","../../../../../core/js/views/notifyPopupView.js","../../../../../core/js/views/notifyView.js","../../../../../core/js/notify.js","../../../../../core/js/models/routerModel.js","../../../../../core/js/router.js","../../../../../core/js/scrolling.js","../../../../../core/js/startController.js","../../../../../core/js/enums/completionStateEnum.js","../../../../../core/js/tracking.js","../../../../../core/js/deprecated.js","../../../../../core/js/templates.js","../../../../../core/js/fixes/img.lazyload.js","../../../../../core/js/fixes/reactHelpers.html.js","../../../../../core/js/helpers.js","../../../../../core/js/views/headingView.js","../../../../../core/js/headings.js","../../../../../core/js/views/navigationView.js","../../../../../core/js/navigation.js","../../../../../core/js/views/componentView.js","../../../../../components/adapt-chartjs/js/chartjsView.js","../../../../../components/adapt-chartjs/js/chartjsModel.js","../../../../../components/adapt-chartjs/js/adapt-chartjs.js","../../../../../components/adapt-contrib-graphic/js/GraphicView.js","../../../../../components/adapt-contrib-graphic/js/GraphicModel.js","../../../../../components/adapt-contrib-graphic/js/adapt-contrib-graphic.js","../../../../../core/js/enums/buttonStateEnum.js","../../../../../core/js/views/buttonsView.js","../../../../../core/js/models/questionModel.js","../../../../../core/js/views/questionView.js","../../../../../components/adapt-contrib-matching/js/MatchingView.js","../../../../../core/js/models/itemModel.js","../../../../../components/adapt-contrib-matching/js/MatchingItemModel.js","../../../../../core/js/models/itemsComponentModel.js","../../../../../core/js/models/itemsQuestionModel.js","../../../../../components/adapt-contrib-matching/js/MatchingModel.js","../../../../../components/adapt-contrib-matching/js/adapt-contrib-matching.js","../../../../../components/adapt-contrib-mcq/js/McqView.js","../../../../../components/adapt-contrib-mcq/js/McqModel.js","../../../../../components/adapt-contrib-mcq/js/adapt-contrib-mcq.js","../../../../../components/adapt-contrib-text/js/TextView.js","../../../../../components/adapt-contrib-text/js/TextModel.js","../../../../../components/adapt-contrib-text/js/adapt-contrib-text.js","../../../../../components/odi-mit-moral-machine-gmcq/js/MoralMachineGmcqView.js","../../../../../components/odi-mit-moral-machine-gmcq/js/MoralMachineGmcqModel.js","../../../../../components/odi-mit-moral-machine-gmcq/js/odi-mit-moral-machine-gmcq.js","../../../../../components/odi-moralMachineResults/js/moralMachineResultsModel.js","../../../../../components/odi-moralMachineResults/js/moralMachineResultsView.js","../../../../../components/odi-moralMachineResults/js/odi-moralMachineResults.js","../../../../../extensions/adapt-articleBlockSlider/js/adapt-articleView.js","../../../../../extensions/adapt-articleBlockSlider/js/adapt-articleModel.js","../../../../../extensions/adapt-articleBlockSlider/js/adapt-articleExtension.js","../../../../../extensions/adapt-contrib-assessment/js/adapt-assessmentArticleView.js","../../../../../extensions/adapt-contrib-assessment/js/adapt-assessmentQuestionBank.js","../../../../../extensions/adapt-contrib-assessment/js/adapt-assessmentArticleModel.js","../../../../../extensions/adapt-contrib-assessment/js/assessment.js","../../../../../extensions/adapt-contrib-assessment/js/adapt-assessmentArticleExtension.js","../../../../../extensions/adapt-contrib-branching/js/correctness.js","../../../../../extensions/adapt-contrib-branching/js/BranchingSet.js","../../../../../extensions/adapt-contrib-branching/js/adapt-contrib-branching.js","../../../../../extensions/adapt-contrib-pageLevelProgress/js/completionCalculations.js","../../../../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressIndicatorView.js","../../../../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressItemView.js","../../../../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressView.js","../../../../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressNavigationView.js","../../../../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressCollection.js","../../../../../extensions/adapt-contrib-pageLevelProgress/js/adapt-contrib-pageLevelProgress.js","../../../../../extensions/adapt-contrib-trickle/js/models.js","../../../../../extensions/adapt-contrib-trickle/js/controller.js","../../../../../extensions/adapt-contrib-trickle/js/TrickleButtonView.js","../../../../../extensions/adapt-contrib-trickle/js/TrickleButtonModel.js","../../../../../extensions/adapt-contrib-trickle/js/trickleButton.js","../../../../../extensions/adapt-contrib-trickle/js/adapt-contrib-trickle.js","../../../../../extensions/adapt-contrib-tutor/js/TUTOR_TYPE.js","../../../../../extensions/adapt-contrib-tutor/js/TutorModel.js","../../../../../extensions/adapt-contrib-tutor/js/TutorNotify.js","../../../../../extensions/adapt-contrib-tutor/js/TutorView.js","../../../../../extensions/adapt-contrib-tutor/js/adapt-contrib-tutor.js","../../../../../extensions/adapt-contrib-xapi/js/adapt-contrib-xapi.js","../../../../../extensions/adapt-contrib-xapi/js/adapt-offlineStorage-xapi.js","../../../../../extensions/adapt-contrib-xapi/js/index.js","../../../../../extensions/adapt-devtools/js/devtools-model.js","../../../../../extensions/adapt-devtools/js/hinting.js","../../../../../extensions/adapt-devtools/js/is-question-supported.js","../../../../../extensions/adapt-devtools/js/auto-answer.js","../../../../../extensions/adapt-devtools/js/pass-half-fail.js","../../../../../extensions/adapt-devtools/js/toggle-banking.js","../../../../../extensions/adapt-devtools/js/map.js","../../../../../extensions/adapt-devtools/js/utils.js","../../../../../extensions/adapt-devtools/js/end-trickle.js","../../../../../extensions/adapt-devtools/js/toggle-feedback.js","../../../../../extensions/adapt-devtools/js/toggle-alt-text.js","../../../../../extensions/adapt-devtools/js/unlock.js","../../../../../extensions/adapt-devtools/js/enable.js","../../../../../extensions/adapt-devtools/js/toggle-trace-focus.js","../../../../../extensions/adapt-devtools/js/toggle-completion.js","../../../../../extensions/adapt-devtools/js/adapt-devtools.js","../../../../../core/js/views/menuItemView.js","../../../../../core/js/views/menuView.js","../../../../../menu/adapt-contrib-boxMenu/js/BoxMenuItemView.js","../../../../../menu/adapt-contrib-boxMenu/js/BoxMenuGroupView.js","../../../../../menu/adapt-contrib-boxMenu/js/BoxMenuView.js","../../../../../menu/adapt-contrib-boxMenu/js/adapt-contrib-boxMenu.js","../../../../../theme/5ee351b2d140fe35be130b76/js/themeView.js","../../../../../theme/5ee351b2d140fe35be130b76/js/themePageView.js","../../../../../theme/5ee351b2d140fe35be130b76/js/themeArticleView.js","../../../../../theme/5ee351b2d140fe35be130b76/js/themeBlockView.js","../../../../../theme/5ee351b2d140fe35be130b76/js/theme.js","../../../../../core/templates/header.jsx","../../../../../core/templates/image.jsx","../../../../../components/adapt-contrib-graphic/templates/graphic.jsx","../../../../../components/adapt-contrib-matching/templates/matching.jsx","../../../../../components/adapt-contrib-matching/templates/matchingDropDown.jsx","../../../../../components/adapt-contrib-mcq/templates/mcq.jsx","../../../../../components/adapt-contrib-text/templates/text.jsx","../../../../../components/odi-mit-moral-machine-gmcq/templates/gmcq.jsx","../../../../../core/js/app.js"],"sourcesContent":["class Wait extends Backbone.Controller {\n\n  initialize() {\n    this._waitCount = 0;\n    this._callbackHandle = null;\n    this.being = this.begin.bind(this);\n    this.end = this.end.bind(this);\n  }\n\n  /**\n   * Returns true if there are items in the waiting count.\n   *\n   * @return {Boolean}\n   */\n  isWaiting() {\n    return (this._waitCount !== 0);\n  }\n\n  /**\n   * Add one item to the waiting count.\n   *\n   * @return {Object}\n   */\n  begin() {\n    if (!this.isWaiting()) this.trigger('wait');\n\n    this._waitCount++;\n\n    if (this._callbackHandle) {\n      clearTimeout(this._callbackHandle);\n      this._callbackHandle = null;\n    }\n\n    return this;\n  }\n\n  /**\n   * Remove an item from the waiting count and trigger ready asynchronously if no more items are waiting.\n   *\n   * @return {Object}\n   */\n  end() {\n    if (!this.isWaiting()) return this;\n\n    this._waitCount--;\n\n    if (this.isWaiting() || this._callbackHandle) return this;\n\n    this._callbackHandle = setTimeout(function() {\n      this._callbackHandle = null;\n      this.trigger('ready');\n    }.bind(this), 0);\n\n    return this;\n  }\n\n  /**\n   * Queue this function until all open waits have been ended.\n   *\n   * @param  {Function} [callback]\n   * @return {Object|Promise}\n   */\n  queue(callback) {\n    if (!callback) {\n      this.begin();\n\n      return new Promise(resolve => {\n        this.once('ready', resolve);\n        this.end();\n      });\n    }\n\n    this.begin();\n    this.once('ready', callback);\n    this.end();\n\n    return this;\n  }\n\n  /**\n   * Wait for this asynchronous function to execute before triggering ready event.\n   *\n   * @param  {Function} callback   [ Function to execute whilst holding queued callback. Once complete run first argument, done(). ]\n   * @return {Object}\n   */\n  for(callback) {\n    this.begin();\n    _.defer(() => callback(_.once(this.end)));\n    return this;\n  }\n\n}\n\nconst wait = new Wait();\n\nexport default wait;\n","export default class LockingModel extends Backbone.Model {\n\n  set(attrName, attrVal, options = {}) {\n    const stopProcessing = (typeof attrName === 'object' || typeof attrVal !== 'boolean' || !this.isLocking(attrName));\n    if (stopProcessing) return super.set(...arguments);\n\n    const isSettingValueForSpecificPlugin = options?.pluginName;\n    if (!isSettingValueForSpecificPlugin) {\n      console.error('Must supply a pluginName to change a locked attribute');\n      options.pluginName = 'compatibility';\n    }\n\n    const pluginName = options.pluginName;\n    if (this.defaults[attrName] !== undefined) {\n      this._lockedAttributes[attrName] = !this.defaults[attrName];\n    }\n    const lockingValue = this._lockedAttributes[attrName];\n    const isAttemptingToLock = (lockingValue === attrVal);\n\n    if (isAttemptingToLock) {\n      this.setLockState(attrName, true, { pluginName: pluginName, skipcheck: true });\n      return super.set(attrName, lockingValue);\n    }\n\n    this.setLockState(attrName, false, { pluginName: pluginName, skipcheck: true });\n\n    const totalLockValue = this.getLockCount(attrName, { skipcheck: true });\n    if (totalLockValue === 0) {\n      return super.set(attrName, !lockingValue);\n    }\n\n    return this;\n\n  }\n\n  setLocking(attrName, defaultLockValue) {\n    if (this.isLocking(attrName)) return;\n    if (!this._lockedAttributes) this._lockedAttributes = {};\n    this._lockedAttributes[attrName] = defaultLockValue;\n  }\n\n  unsetLocking(attrName) {\n    if (!this.isLocking(attrName)) return;\n    if (!this._lockedAttributes) return;\n    delete this._lockedAttributes[attrName];\n    delete this._lockedAttributesValues[attrName];\n    if (Object.keys(this._lockedAttributes).length === 0) {\n      delete this._lockedAttributes;\n      delete this._lockedAttributesValues;\n    }\n  }\n\n  isLocking(attrName) {\n    const isCheckingGeneralLockingState = (attrName === undefined);\n    const isUsingLockedAttributes = Boolean(this.lockedAttributes || this._lockedAttributes);\n\n    if (isCheckingGeneralLockingState) {\n      return isUsingLockedAttributes;\n    }\n\n    if (!isUsingLockedAttributes) return false;\n\n    if (!this._lockedAttributes) {\n      this._lockedAttributes = _.result(this, 'lockedAttributes');\n    }\n\n    const isAttributeALockingAttribute = this._lockedAttributes.hasOwnProperty(attrName);\n    if (!isAttributeALockingAttribute) return false;\n\n    if (!this._lockedAttributesValues) {\n      this._lockedAttributesValues = {};\n    }\n\n    if (!this._lockedAttributesValues[attrName]) {\n      this._lockedAttributesValues[attrName] = {};\n    }\n\n    return true;\n  }\n\n  isLocked(attrName, options) {\n    const shouldSkipCheck = options?.skipcheck;\n    if (!shouldSkipCheck) {\n      const stopProcessing = !this.isLocking(attrName);\n      if (stopProcessing) return;\n    }\n\n    return this.getLockCount(attrName) > 0;\n  }\n\n  getLockCount(attrName, options) {\n    const shouldSkipCheck = options?.skipcheck;\n    if (!shouldSkipCheck) {\n      const stopProcessing = !this.isLocking(attrName);\n      if (stopProcessing) return;\n    }\n\n    const isGettingValueForSpecificPlugin = options?.pluginName;\n    if (isGettingValueForSpecificPlugin) {\n      return this._lockedAttributesValues[attrName][options.pluginName] ? 1 : 0;\n    }\n\n    const lockingAttributeValues = Object.values(this._lockedAttributesValues[attrName]);\n    const lockingAttributeValuesSum = lockingAttributeValues.reduce((sum, value) => sum + (value ? 1 : 0), 0);\n\n    return lockingAttributeValuesSum;\n  }\n\n  setLockState(attrName, value, options) {\n    const shouldSkipCheck = options?.skipcheck;\n    if (!shouldSkipCheck) {\n      const stopProcessing = !this.isLocking(attrName);\n      if (stopProcessing) return this;\n    }\n\n    const isSettingValueForSpecificPlugin = options?.pluginName;\n    if (!isSettingValueForSpecificPlugin) {\n      console.error('Must supply a pluginName to set a locked attribute lock value');\n      options.pluginName = 'compatibility';\n    }\n\n    if (value) {\n      this._lockedAttributesValues[attrName][options.pluginName] = value;\n    } else {\n      delete this._lockedAttributesValues[attrName][options.pluginName];\n    }\n\n    return this;\n\n  }\n\n}\n","import wait from 'core/js/wait';\nimport LockingModel from 'core/js/models/lockingModel';\n\nclass AdaptSingleton extends LockingModel {\n\n  initialize() {\n    this.loadScript = window.__loadScript;\n  }\n\n  defaults() {\n    return {\n      _canScroll: true, // to stop scrollTo behaviour,\n      _outstandingCompletionChecks: 0,\n      _pluginWaitCount: 0,\n      _isStarted: false,\n      _shouldDestroyContentObjects: true\n    };\n  }\n\n  lockedAttributes() {\n    return {\n      _canScroll: false\n    };\n  }\n\n  async init() {\n    this.addDirection();\n    this.disableAnimation();\n    this.trigger('adapt:preInitialize');\n    await wait.queue();\n\n    // wait until no more completion checking\n    this.deferUntilCompletionChecked(async () => {\n\n      // start adapt in a full restored state\n      this.trigger('adapt:start');\n      await wait.queue();\n\n      if (!Backbone.History.started) {\n        Backbone.history.start();\n      }\n\n      this.set('_isStarted', true);\n\n      this.trigger('adapt:initialize');\n      await wait.queue();\n\n    });\n  }\n\n  /**\n   * call when entering an asynchronous completion check\n   */\n  checkingCompletion() {\n    const outstandingChecks = this.get('_outstandingCompletionChecks');\n    this.set('_outstandingCompletionChecks', outstandingChecks + 1);\n  }\n\n  /**\n   * call when exiting an asynchronous completion check\n   */\n  checkedCompletion() {\n    const outstandingChecks = this.get('_outstandingCompletionChecks');\n    this.set('_outstandingCompletionChecks', outstandingChecks - 1);\n  }\n\n  /**\n   * wait until there are no outstanding completion checks\n   * @param {Function} [callback] Function to be called after all completion checks have been completed\n   */\n  async deferUntilCompletionChecked(callback = () => {}) {\n    if (this.get('_outstandingCompletionChecks') === 0) return callback();\n    return new Promise(resolve => {\n      const checkIfAnyChecksOutstanding = (model, outstandingChecks) => {\n        if (outstandingChecks !== 0) return;\n        this.off('change:_outstandingCompletionChecks', checkIfAnyChecksOutstanding);\n        callback();\n        resolve();\n      };\n      this.on('change:_outstandingCompletionChecks', checkIfAnyChecksOutstanding);\n    });\n  }\n\n  isWaitingForPlugins() {\n    this.log.deprecated('Use wait.isWaiting() as Adapt.isWaitingForPlugins() will be removed in the future');\n    return wait.isWaiting();\n  }\n\n  checkPluginsReady() {\n    this.log.deprecated('Use wait.isWaiting() as Adapt.checkPluginsReady() will be removed in the future');\n    if (this.isWaitingForPlugins()) {\n      return;\n    }\n    this.trigger('plugins:ready');\n  }\n\n  /**\n   * Relative strings describe the number and type of hops in the model hierarchy\n   * @param {string} relativeString\n   * Trickle uses this function to determine where it should scrollTo after it unlocks.\n   * Branching uses this function to determine where it should branch to.\n   * This function would return the following for a single offset directive:\n   * {\n   *     type: \"component\",\n   *     offset: 1,\n   *     inset: null\n   * }\n   * \"@component+1\" returns the next component outside this container, or undefined\n   * \"@component-1\" returns the previous component outside of this container, or undefined\n   * \"@block+0\" or \"@block\" returns this block, the first ancestor block, or undefined\n   * \"@type+0\" or \"@type\" returns this of type, the first ancestor of type, or undefined\n   * This function would return the following for a single inset directive:\n   * {\n   *     type: \"component\",\n   *     offset: null,\n   *     inset: 0\n   * }\n   * \"@article=0\" returns the first article inside this container, or undefined\n   * \"@article=-1\" returns the last article inside this container, or undefined\n   * \"@type=n\" returns the relatively positioned of type inside this container, or undefined\n   * This function would return the following for multiple inset and offset directives:\n   * [\n   *   {\n   *     type: \"block\",\n   *     offset: 2,\n   *     inset: null\n   *   },\n   *   {\n   *     type: \"component\",\n   *     offset: null,\n   *     inset: 0\n   *   }\n   * ]\n   * \"@block+2 @component=0\" move two blocks forward and return its first component\n   * \"@block-1 @component=-2\" move one block backward and return its second to last component\n   * \"@article+2 @block=1 @component=-1\" move two articles forward, find the second block and return its last component\n   * \"@article @component=-1\" find the first ancestor article and return its last component\n   */\n  parseRelativeString(relativeString) {\n    const parts = relativeString\n      .replace(/\\s*([+\\-=]+\\d+){1}/g, '$1') // Remove whitespace before symbol +/-/=\n      .split(/[@ ]/) // Find all sections\n      .filter(Boolean); // Remove empty sections\n    const parsed = parts.map(part => {\n      let splitIndex = part.search(/[+\\-=\\d]{1}/);\n      if (splitIndex === -1) splitIndex = part.length;\n      const symbol = part.slice(splitIndex, splitIndex + 1);\n      const type = part.slice(0, splitIndex).replace(/^@/, '');\n      let offset = null;\n      let inset = null;\n      switch (symbol) {\n        case '=':\n          inset = parseInt(part.slice(splitIndex + 1).trim() || 0);\n          break;\n        default:\n          offset = parseInt(part.slice(splitIndex).trim() || 0);\n          break;\n      }\n      return {\n        type,\n        offset,\n        inset\n      };\n    });\n    return parsed.length === 1\n      ? parsed[0]\n      : parsed;\n  }\n\n  addDirection() {\n    const defaultDirection = this.config.get('_defaultDirection');\n\n    $('html')\n      .addClass('dir-' + defaultDirection)\n      .attr('dir', defaultDirection);\n  }\n\n  disableAnimation() {\n    const disableAnimationArray = this.config.get('_disableAnimationFor');\n    const disableAnimation = this.config.get('_disableAnimation');\n\n    // Check if animations should be disabled\n    if (disableAnimationArray) {\n      for (let i = 0, l = disableAnimationArray.length; i < l; i++) {\n        if (!$('html').is(disableAnimationArray[i])) continue;\n        this.config.set('_disableAnimation', true);\n        $('html').addClass('disable-animation');\n        console.log('Animation disabled.');\n      }\n      return;\n    }\n\n    $('html').toggleClass('disable-animation', (disableAnimation === true));\n  }\n\n  async remove() {\n    const currentView = this.parentView;\n    if (currentView) {\n      currentView.model.setOnChildren({\n        _isReady: false,\n        _isRendered: false\n      });\n    }\n    this.trigger('preRemove', currentView);\n    await wait.queue();\n    // Facilitate contentObject transitions\n    if (currentView && this.get('_shouldDestroyContentObjects')) {\n      currentView.destroy();\n    }\n    this.trigger('remove', currentView);\n    _.defer(this.trigger.bind(this), 'postRemove', currentView);\n  }\n\n  /**\n   * @deprecated Please use core/js/a11y instead\n   */\n  get a11y() {}\n\n  /**\n   * @deprecated Please use core/js/components instead\n   */\n  get componentStore() {}\n\n  /**\n   * @deprecated Please use core/js/data instead\n   */\n  get data() {}\n\n  /**\n   * @deprecated Please use core/js/device instead\n   */\n  get device() {}\n\n  /**\n   * @deprecated Please use core/js/drawer instead\n   */\n  get drawer() {}\n\n  /**\n   * @deprecated Please use core/js/location instead\n   */\n  get location() {}\n\n  /**\n   * @deprecated Please use core/js/notify instead\n   */\n  get notify() {}\n\n  /**\n   * @deprecated Please use core/js/offlineStorage instead\n   */\n  get offlineStorage() {}\n\n  /**\n   * @deprecated Please use core/js/router instead\n   */\n  get router() {}\n\n  /**\n   * @deprecated Please use core/js/scrolling instead\n   */\n  get scrolling() {}\n\n  /**\n   * @deprecated Please use core/js/startController instead\n   */\n  get startController() {}\n\n  /**\n   * @deprecated Please use core/js/components instead\n   */\n  get store() {}\n\n  /**\n   * @deprecated Please use core/js/tracking instead\n   */\n  get tracking() {}\n\n  /**\n   * @deprecated Please use core/js/wait instead\n   */\n  get wait() {}\n\n  /**\n   * Allows a selector to be passed in and Adapt will navigate to this element. Resolves\n   * asynchronously when the element has been navigated to.  /**\n   * @deprecated Please use router.navigateToElement instead.\n   * @param {string} selector CSS selector of the Adapt element you want to navigate to e.g. `\".co-05\"`\n   * @param {Object} [settings] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\n   */\n  async navigateToElement() {}\n\n  /**\n   * Allows a selector to be passed in and Adapt will scroll to this element. Resolves\n   * asynchronously when the element has been navigated/scrolled to.\n   * @deprecated Please use router.navigateToElement instead.\n   * @param {string} selector CSS selector of the Adapt element you want to navigate to e.g. `\".co-05\"`\n   * @param {Object} [settings={}] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\n   */\n  async scrollTo() {}\n\n  /**\n   * Used to register models and views with `store`\n   * @deprecated Please use components.register instead.\n   * @param {string|Array} name The name(s) of the model/view to be registered\n   * @param {object} object Object containing properties `model` and `view` or (legacy) an object representing the view\n   */\n  register(name, object) {}\n\n  /**\n   * Parses a view class name.\n   * @deprecated Please use components.getViewName instead.\n   * @param {string|Backbone.Model|Backbone.View|object} nameModelViewOrData The name of the view class you want to fetch e.g. `\"hotgraphic\"` or its model or its json data\n   */\n  getViewName() {}\n\n  /**\n   * Fetches a view class from the store. For a usage example, see either HotGraphic or Narrative\n   * @deprecated Please use components.getViewClass instead.\n   * @param {string|Backbone.Model|Backbone.View|object} nameModelViewOrData The name of the view class you want to fetch e.g. `\"hotgraphic\"` or its model or its json data\n   * @returns {Backbone.View} Reference to the view class\n   */\n  getViewClass() {}\n\n  /**\n   * Parses a model class name.\n   * @deprecated Please use components.getModelName instead.\n   * @param {string|Backbone.Model|object} name The name of the model you want to fetch e.g. `\"hotgraphic\"`, the model to process or its json data\n   */\n  getModelName() {}\n\n  /**\n   * Fetches a model class from the store. For a usage example, see either HotGraphic or Narrative\n   * @deprecated Please use components.getModelClass instead.\n   * @param {string|Backbone.Model|object} name The name of the model you want to fetch e.g. `\"hotgraphic\"` or its json data\n   * @returns {Backbone.Model} Reference to the view class\n   */\n  getModelClass() {}\n\n  /**\n   * Looks up a model by its `_id` property\n   * @deprecated Please use data.findById instead.\n   * @param {string} id The id of the item e.g. \"co-05\"\n   * @return {Backbone.Model}\n   */\n  findById() {}\n\n  /**\n   * Looks up a view by its model `_id` property\n   * @deprecated Please use data.findViewByModelId instead.\n   * @param {string} id The id of the item e.g. \"co-05\"\n   * @return {Backbone.View}\n   */\n  findViewByModelId() {}\n\n  /**\n   * Returns the model represented by the trackingPosition.\n   * @deprecated Please use data.findByTrackingPosition instead.\n   * @param {Array<Number, Number>} trackingPosition Represents the relative location of a model to a _trackingId\n   * @returns {Backbone.Model}\n   */\n  findByTrackingPosition() {}\n\n}\n\nconst Adapt = new AdaptSingleton();\n\nexport default Adapt;\n","import Adapt from 'core/js/adapt';\n\n// Basic API for setting and getting name+value pairs\n// Allows registration of a single handler.\n\nclass OfflineStorage extends Backbone.Controller {\n\n  /**\n   * set .ready to false if an offlineStorage handler is being attached - we'll need to wait until the handler lets us know\n   * it's ready before we can safely use offlineStorage\n   */\n  initialize(handler) {\n    /**\n     * set to true initially so that if there are no offlineStorage handlers (i.e. if contrib-spoor is not installed)\n     * this can still be accessed OK\n     */\n    this.ready = true;\n    this._handler = undefined;\n\n    if (!handler) {\n      return;\n    }\n\n    this.ready = false;\n    this._handler = handler;\n  }\n\n  /**\n   * Flag to indicate if an offlineStorage handler has been defined.\n   * @returns {boolean} true if an offlineStorage handler has been defined, false otherwise\n   */\n  hasHandler() {\n    return this._handler !== undefined;\n  }\n\n  /**\n   * Causes state to be serialized and saved.\n   */\n  save() {\n    Adapt.trigger('tracking:save');\n    return this._handler?.save?.(...arguments);\n  }\n\n  /**\n   * Serializes nested arrays, booleans and numbers into an encoded string.\n   * @param {Array|boolean|number} value\n   * @returns {string}\n   */\n  serialize(value) {\n    if (this._handler?.serialize) {\n      return this._handler.serialize(...arguments);\n    }\n    return JSON.stringify(value);\n  }\n\n  /**\n   * Deserializes encoded strings back into nested arrays, booleans and numbers.\n   * @param {string} value\n   * @returns {Array|boolean|number}\n   */\n  deserialize(value) {\n    if (this._handler?.deserialize) {\n      return this._handler.deserialize(...arguments);\n    }\n    return JSON.parse(value);\n  }\n\n  set(name, value) {\n    if (this._handler?.set) {\n      return this._handler.set(...arguments);\n    }\n    // if no handler has been defined, just store the data locally\n    this[name] = value;\n  }\n\n  get(name) {\n    if (this._handler?.get) {\n      return this._handler.get(...arguments);\n    }\n    // if no handler has been defined, check local data store\n    return this[name];\n  }\n\n  clear() {\n    if (this._handler?.clear) {\n      return this._handler.clear(...arguments);\n    }\n    return false;\n  }\n\n  /**\n   * Some forms of offlineStorage could take time to initialise, this allows us to let plugins know when it's ready to be used\n   */\n  setReadyStatus() {\n    this.ready = true;\n    Adapt.trigger('offlineStorage:ready');\n  }\n\n}\n\nconst offlineStorage = new OfflineStorage();\nexport default offlineStorage;\n","import Adapt from 'core/js/adapt';\nimport Bowser from 'bowser';\nimport _ from 'underscore';\n\nclass Device extends Backbone.Controller {\n\n  initialize() {\n    _.bindAll(this, 'onWindowResize', 'calculateResize');\n    this.bowser = Bowser.parse(window.navigator.userAgent);\n    this.$html = $('html');\n    this.$window = $(window);\n    this.touch = Modernizr.touchevents;\n    this.screenWidth = this.getScreenWidth();\n    this.screenHeight = this.getScreenHeight();\n    this.setViewportHeight();\n    this.browser = (this.bowser.browser.name || '').toLowerCase();\n    this.version = (this.bowser.browser.version || '').toLowerCase();\n    this.OS = this.getOperatingSystem().toLowerCase();\n    this.osVersion = this.bowser.os.version || '';\n    this.renderingEngine = this.getRenderingEngine();\n    this.listenTo(Adapt, {\n      'configModel:dataLoaded': this.onConfigDataLoaded\n    });\n    const browser = this.browser.toLowerCase();\n    // Convert 'msie' and 'internet explorer' to 'ie'.\n    let browserString = browser.replace(/msie|internet explorer/, 'ie');\n    browserString += ` version-${this.version} OS-${this.OS} ${this.getAppleDeviceType()}`;\n    // Legacy bad code, missing space after getAppleDevice and string replace is not global\n    browserString += browserString.replace('.', '-').toLowerCase();\n    browserString += ` ${browserString.replace(/\\./g, '-').toLowerCase()}`;\n    browserString += ` pixel-density-${this.pixelDensity()}`;\n    this.$html.addClass(browserString);\n  }\n\n  get orientation() {\n    return (this.screenWidth >= this.screenHeight) ? 'landscape' : 'portrait';\n  }\n\n  get aspectRatio() {\n    return this.screenWidth / this.screenHeight;\n  }\n\n  onConfigDataLoaded() {\n    this.screenSize = this.checkScreenSize();\n    this.$html.addClass('size-' + this.screenSize);\n    if (this.orientation) {\n      this.$html.addClass('orientation-' + this.orientation);\n    }\n    // As Adapt.config is available it's ok to bind the 'resize'.\n    this.$window.on('resize orientationchange', this.onWindowResize);\n  }\n\n  /**\n   * Compares the calculated screen width to the breakpoints defined in config.json.\n   *\n   * @returns {string} 'large', 'medium' or 'small'\n   */\n  checkScreenSize() {\n    const screenSizeConfig = Adapt.config.get('screenSize');\n    let screenSize;\n\n    const screensizeEmThreshold = 300;\n    const baseFontSize = 16;\n\n    // Check to see if the screen size value is larger than the em threshold\n    // If value is larger than em threshold, convert value (assumed px) to ems\n    // Otherwise assume value is in ems\n    const mediumEmBreakpoint = screenSizeConfig.medium > screensizeEmThreshold\n      ? screenSizeConfig.medium / baseFontSize\n      : screenSizeConfig.medium;\n    const smallEmBreakpoint = screenSizeConfig.small > screensizeEmThreshold\n      ? screenSizeConfig.small / baseFontSize\n      : screenSizeConfig.small;\n\n    const fontSize = parseFloat($('html').css('font-size'));\n    const screenSizeEmWidth = (window.innerWidth / fontSize);\n\n    // Check to see if client screen width is larger than medium em breakpoint\n    // If so apply large, otherwise check to see if client screen width is\n    // larger than small em breakpoint. If so apply medium, otherwise apply small\n    if (screenSizeEmWidth >= mediumEmBreakpoint) {\n      screenSize = 'large';\n    } else if (screenSizeEmWidth >= smallEmBreakpoint) {\n      screenSize = 'medium';\n    } else {\n      screenSize = 'small';\n    }\n\n    return screenSize;\n  }\n\n  getScreenWidth() {\n    return this.isAppleDevice()\n      ? this.getAppleScreenWidth()\n      : window.innerWidth || this.$window.width();\n  }\n\n  getScreenHeight() {\n    return this.isAppleDevice()\n      ? this.getAppleScreenHeight()\n      : window.innerHeight || this.$window.height();\n  }\n\n  setViewportHeight() {\n    document.documentElement.style.setProperty('--adapt-viewport-height', `${window.innerHeight}px`);\n  }\n\n  getOperatingSystem() {\n    let os = this.bowser.os.name.toLowerCase() || '';\n\n    if (os === '') {\n      // Fall back to using navigator.platform in case Bowser can't detect the OS.\n      const platform = navigator.platform.toLowerCase();\n      const match = platform.match(/win|mac|linux/);\n      if (match) os = match[0];\n      // Set consistency with the Bowser flags.\n      if (os === 'win') os = 'windows';\n      if (!os) os = '';\n    }\n\n    if (!os) os = 'platformunknown';\n\n    return os;\n  }\n\n  getRenderingEngine() {\n    return this.bowser.engine.name || '';\n  }\n\n  onWindowResize() {\n    if (this.hasWindowResized) return;\n    requestAnimationFrame(this.calculateResize);\n    this.hasWindowResized = true;\n  }\n\n  calculateResize() {\n    this.hasWindowResized = false;\n    // Calculate the screen properties.\n    const previousWidth = this.screenWidth;\n    const previousHeight = this.screenHeight;\n    this.screenWidth = this.getScreenWidth();\n    this.screenHeight = this.getScreenHeight();\n    this.setViewportHeight();\n\n    if (previousWidth === this.screenWidth && previousHeight === this.screenHeight) {\n      // Do not trigger a change if the viewport hasn't actually changed.  Scrolling on iOS will trigger a resize.\n      return;\n    }\n\n    if (this.orientation) {\n      this.$html.toggleClass('orientation-landscape', this.orientation === 'landscape');\n      this.$html.toggleClass('orientation-portrait', this.orientation === 'portrait');\n    }\n\n    const newScreenSize = this.checkScreenSize();\n    if (newScreenSize !== this.screenSize) {\n      this.screenSize = newScreenSize;\n      this.$html.toggleClass('size-small', this.screenSize === 'small');\n      this.$html.toggleClass('size-medium', this.screenSize === 'medium');\n      this.$html.toggleClass('size-large', this.screenSize === 'large');\n      Adapt.trigger('device:changed', this.screenSize);\n    }\n\n    Adapt.trigger('device:preResize device:resize device:postResize', this.screenWidth);\n  }\n\n  isAppleDevice() {\n    return (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) || (navigator.userAgent.match(/Mac/) && navigator?.maxTouchPoints > 2);\n  }\n\n  get shouldReportInvertedAppleScreenSize() {\n    const windowRatio = (window.innerWidth / window.innerHeight);\n    const screenRatio = (window.screen.width / window.screen.height);\n    const isWindowPortrait = (windowRatio < 1);\n    const isScreenPortrait = (screenRatio < 1);\n    const isDeviceBadlyReportingScreenOrientation = (isWindowPortrait !== isScreenPortrait);\n    return isDeviceBadlyReportingScreenOrientation;\n  }\n\n  getAppleScreenWidth() {\n    return this.shouldReportInvertedAppleScreenSize ? window.screen.height : window.screen.width;\n  }\n\n  getAppleScreenHeight() {\n    return this.shouldReportInvertedAppleScreenSize ? window.screen.width : window.screen.height;\n  }\n\n  getAppleDeviceType() {\n    const platformType = this.bowser.platform.type?.toLowerCase() || '';\n    const browserName = this.bowser.browser.name?.toLowerCase() || '';\n    const isIPhone = (platformType === 'mobile' && browserName === 'safari');\n    const isIPad = (platformType === 'tablet' && browserName === 'safari');\n    if (isIPhone) return 'iphone';\n    if (isIPad) return 'ipad';\n    return '';\n  }\n\n  pixelDensity() {\n    const pixelDensity = (window.devicePixelRatio || 1);\n\n    if (pixelDensity >= 3) {\n      return 'ultra-high';\n    } else if (pixelDensity >= 2) {\n      return 'high';\n    } else if (pixelDensity >= 1.5) {\n      return 'medium';\n    } else {\n      return 'low';\n    }\n  }\n\n}\n\nconst device = new Device();\nexport default device;\n","import Backbone from 'backbone';\n\nclass Location extends Backbone.Controller {\n\n  initialize() {\n    /**\n     * _id of previous contentobject\n     * @type {string}\n     */\n    this._previousId = null;\n    /**\n     * _type of previous contentobject\n     * @type {string}\n     */\n    this._previousContentType = null;\n    /**\n     * Model of previous contentobject\n     * @type {Backbone.Model}\n     */\n    this._previousModel = null;\n    /**\n     * _htmlClasses of previous contentobject\n     * @type {string}\n     */\n    this._previousClasses = null;\n    /**\n     * Alias for _previousContentType\n     * @type {string}\n     */\n    this._lastVisitedType = null;\n    /**\n     * _id of last menu\n     * @type {string}\n     * */\n    this._lastVisitedMenu = null;\n    /**\n     * _id of last page\n     * @type {string}\n     * */\n    this._lastVisitedPage = null;\n    /**\n     * _id of current contentobject\n     * @type {string}\n     */\n    this._currentId = null;\n    /**\n     * Model of current contentobject\n     * @type {Backbone.Model}\n     */\n    this._currentModel = null;\n    /**\n     * Current url querystring\n     * @type {string}\n     */\n    this._currentLocation = null;\n    /**\n     * Current contentobject type\n     * @type {string}\n     */\n    this._contentType = null;\n  }\n\n}\n\nconst location = new Location();\nexport default location;\n","import Adapt from 'core/js/adapt';\n\n/**\n * Browser modifications to focus handling.\n * @class\n */\nexport default class BrowserFocus extends Backbone.Controller {\n\n  initialize({ a11y }) {\n    this.a11y = a11y;\n    this._onBlur = this._onBlur.bind(this);\n    this._onClick = this._onClick.bind(this);\n    this.$body = $('body');\n    this.listenTo(Adapt, {\n      'accessibility:ready': this._attachEventListeners\n    });\n  }\n\n  _attachEventListeners() {\n    this.$body\n      .on('blur', '*', this._onBlur)\n      .on('blur', this._onBlur);\n    // 'Capture' event attachment for click\n    this.$body[0].addEventListener('click', this._onClick, true);\n  }\n\n  /**\n   * When any element in the document receives a blur event,\n   * check to see if it needs the `data-a11y-force-focus` attribute removing\n   * and check to see if it was blurred because a disabled attribute was added.\n   * If a disabled attribute was added, the focus will be moved forward.\n   *\n   * @param {JQuery.Event} event\n   */\n  _onBlur(event) {\n    const config = this.a11y.config;\n    if (!config._isEnabled || !config._options._isFocusNextOnDisabled) {\n      return;\n    }\n    const $element = $(event.target);\n    if ($element.is('[data-a11y-force-focus]')) {\n      $element.removeAttr('tabindex data-a11y-force-focus');\n    }\n    // From here, only check source elements\n    if (event.target !== event.currentTarget) {\n      return;\n    }\n    // Check if element losing focus is losing focus\n    // due to the addition of a disabled class\n    if (!$element.is('[disabled]') && $element.css('display') !== 'none' && $element.css('visibility') !== 'hidden') {\n      return;\n    }\n    // Move focus to next readable element\n    this.a11y.focusNext($element);\n  }\n\n  /**\n   * Force focus when clicked on a tabbable element,\n   * making sure `document.activeElement` is updated.\n   * Stop event handling on aria-disabled elements.\n   *\n   * @param {JQuery.Event} event\n   */\n  _onClick(event) {\n    const $element = $(event.target);\n    // search element and parents for aria-disabled - see https://github.com/adaptlearning/adapt_framework/issues/3097\n    const isAriaDisabled = $element.closest('[aria-disabled=true]').length === 1;\n    if (isAriaDisabled) {\n      event.preventDefault();\n      event.stopImmediatePropagation();\n    }\n    const config = this.a11y.config;\n    if (!config._isEnabled || !config._options._isFocusOnClickEnabled) {\n      return;\n    }\n    const $stack = $([...$element.toArray(), ...$element.parents().toArray()]);\n    const $focusable = $stack.filter(config._options._tabbableElements);\n    if (!$focusable.length) {\n      return;\n    }\n    // Force focus for screen reader enter / space press\n    $focusable[0].focus();\n  }\n\n}\n","export default class FocusOptions {\n\n  /**\n   * Options parser for focus functions.\n   * @param {Object} options\n   * @param {boolean} [options.preventScroll=false] Stops the browser from scrolling to the focused point. https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus\n   * @param {boolean} [options.defer=false] Add a defer to the focus call, allowing for user interface settling.\n   */\n  constructor({\n    preventScroll = false,\n    defer = false\n  } = {}) {\n    /**\n    * Stops the browser from scrolling to the focused point.\n    * https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus\n    * @type {boolean}\n    */\n    this.preventScroll = preventScroll;\n    /**\n     * Add a defer to the focus call, allowing for user interface settling.\n     * @type {boolean}\n     */\n    this.defer = defer;\n  }\n\n}\n","import Adapt from 'core/js/adapt';\n\n/**\n * Manages whether or not the focus outline should be entirely removed\n * or removed until a key is pressed on a tabbable element.\n * @class\n */\nexport default class KeyboardFocusOutline extends Backbone.Controller {\n\n  initialize({ a11y }) {\n    this.a11y = a11y;\n    this._onKeyDown = this._onKeyDown.bind(this);\n    this.$html = $('html');\n    this.showOnKeys = {\n      9: true, // tab\n      13: true, // enter\n      32: true, // space\n      37: true, // arrow left\n      38: true, // arrow up\n      39: true, // arrow right\n      40: true // arrow down\n    };\n    this.listenTo(Adapt, {\n      'accessibility:ready': this._attachEventListeners\n    });\n  }\n\n  _attachEventListeners() {\n    document.addEventListener('keydown', this._onKeyDown);\n    this._start();\n  }\n\n  /**\n   * Add styling classes if required.\n   */\n  _start() {\n    const config = this.a11y.config;\n    if (config._options._isFocusOutlineDisabled) {\n      this.$html.addClass('a11y-disable-focusoutline');\n      return;\n    }\n    if (!config._isEnabled || !config._options._isFocusOutlineKeyboardOnlyEnabled) {\n      return;\n    }\n    this.$html.addClass('a11y-disable-focusoutline');\n  }\n\n  /**\n   * Handle key down events for on a tabbable element.\n   *\n   * @param {JQuery.Event} event\n   */\n  _onKeyDown(event) {\n    const config = this.a11y.config;\n    if (config._options._isFocusOutlineDisabled) {\n      this.$html.addClass('a11y-disable-focusoutline');\n      return;\n    }\n    if (!config._isEnabled || !config._options._isFocusOutlineKeyboardOnlyEnabled || !this.showOnKeys[event.keyCode]) {\n      return;\n    }\n    const $element = $(event.target);\n    if (!$element.is(config._options._tabbableElements) || $element.is(config._options._focusOutlineKeyboardOnlyIgnore)) {\n      return;\n    }\n    this.$html.removeClass('a11y-disable-focusoutline');\n  }\n\n}\n","// Used to determine if log call should be printed based on log level\nconst LOG_LEVEL = ENUM([\n  'DEBUG',\n  'INFO',\n  'WARN',\n  'ERROR',\n  'FATAL'\n]);\n\nexport default LOG_LEVEL;\n","import Adapt from 'core/js/adapt';\nimport LOG_LEVEL from 'core/js/enums/logLevelEnum';\n\nclass Logging extends Backbone.Controller {\n\n  initialize() {\n    this._config = {\n      _isEnabled: true,\n      _level: LOG_LEVEL.INFO.asLowerCase, // Default log level\n      _console: true, // Log to console\n      _warnFirstOnly: true // Show only first of identical removed and deprecated warnings\n    };\n    this._warned = {};\n    this.listenToOnce(Adapt, 'configModel:dataLoaded', this.onLoadConfigData);\n  }\n\n  onLoadConfigData() {\n\n    this.loadConfig();\n\n    this.debug('Logging config loaded');\n\n    this.trigger('log:ready');\n\n  }\n\n  loadConfig() {\n\n    if (Adapt.config.has('_logging')) {\n      this._config = Adapt.config.get('_logging');\n    }\n\n    this.checkQueryStringOverride();\n\n  }\n\n  checkQueryStringOverride() {\n\n    // Override default log level with level present in query string\n    const matches = window.location.search.match(/[?&]loglevel=([a-z]*)/i);\n    if (!matches || matches.length < 2) return;\n\n    const override = LOG_LEVEL(matches[1].toUpperCase());\n    if (!override) return;\n\n    this._config._level = override.asLowerCase;\n    this.debug('Loglevel override in query string:', this._config._level);\n\n  }\n\n  debug(...args) {\n    this._log(LOG_LEVEL.DEBUG, args);\n  }\n\n  info(...args) {\n    this._log(LOG_LEVEL.INFO, args);\n  }\n\n  warn(...args) {\n    this._log(LOG_LEVEL.WARN, args);\n  }\n\n  error(...args) {\n    this._log(LOG_LEVEL.ERROR, args);\n  }\n\n  fatal(...args) {\n    this._log(LOG_LEVEL.FATAL, args);\n  }\n\n  removed(...args) {\n    args = ['REMOVED'].concat(args);\n    this.warnOnce(...args);\n  }\n\n  deprecated(...args) {\n    args = ['DEPRECATED'].concat(args);\n    this.warnOnce(...args);\n  }\n\n  warnOnce(...args) {\n    if (this._hasWarned(args)) {\n      return;\n    }\n    this._log(LOG_LEVEL.WARN, args);\n  }\n\n  _log(level, data) {\n\n    const isEnabled = (this._config._isEnabled);\n    if (!isEnabled) return;\n\n    const configLevel = LOG_LEVEL(this._config._level.toUpperCase());\n\n    const isLogLevelAllowed = (level >= configLevel);\n    if (!isLogLevelAllowed) return;\n\n    this._logToConsole(level, data);\n\n    // Allow error reporting plugins to hook and report to logging systems\n    this.trigger('log', level, data);\n    this.trigger('log:' + level.asLowerCase, level, data);\n\n  }\n\n  _logToConsole(level, data) {\n\n    const shouldLogToConsole = (this._config._console);\n    if (!shouldLogToConsole) return;\n\n    const log = [level.asUpperCase + ':'];\n    data && log.push(...data);\n\n    // is there a matching console method we can use e.g. console.error()?\n    if (console[level.asLowerCase]) {\n      console[level.asLowerCase](...log);\n    } else {\n      console.log(...log);\n    }\n  }\n\n  _hasWarned(args) {\n    if (!this._config._warnFirstOnly) {\n      return false;\n    }\n    const hash = args.map(String).join(':');\n    if (this._warned[hash]) {\n      return true;\n    }\n    this._warned[hash] = true;\n    return false;\n  }\n\n}\n\nconst logging = new Logging();\nexport default logging;\n","import logging from 'core/js/logging';\n\n/**\n * Controller for managing accessibilty logging, specifically used for\n * controlling the display of removed or deprecated API warnings.\n */\nexport default class Log extends Backbone.Controller {\n\n  initialize({ a11y }) {\n    this.a11y = a11y;\n    this._warned = {};\n  }\n\n  _hasWarned(args) {\n    const config = this.a11y.config;\n    if (!config._options._warnFirstOnly) {\n      return false;\n    }\n    const hash = args.map(String).join(':');\n    if (this._warned[hash]) {\n      return true;\n    }\n    this._warned[hash] = true;\n    return false;\n  }\n\n  _canWarn() {\n    const config = this.a11y.config;\n    return Boolean(config._options._warn);\n  }\n\n  removed(...args) {\n    if (!this._canWarn) {\n      return;\n    }\n    args = ['A11Y'].concat(args);\n    if (this._hasWarned(args)) {\n      return;\n    }\n    logging.removed(...args);\n    return this;\n  }\n\n  deprecated(...args) {\n    if (!this._canWarn) {\n      return;\n    }\n    args = ['A11Y'].concat(args);\n    if (this._hasWarned(args)) {\n      return;\n    }\n    logging.deprecated(...args);\n    return this;\n  }\n\n}\n","/**\n * Controller for blocking scroll events on specified elements.\n * @class\n */\nexport default class Scroll extends Backbone.Controller {\n\n  initialize() {\n    this._onTouchStart = this._onTouchStart.bind(this);\n    this._onTouchEnd = this._onTouchEnd.bind(this);\n    this._onScrollEvent = this._onScrollEvent.bind(this);\n    this._onKeyDown = this._onKeyDown.bind(this);\n    this._scrollDisabledElements = $([]);\n    this.$window = $(window);\n    this.$body = $('body');\n    this._preventScrollOnKeys = {\n      37: true, // left\n      38: true, // up\n      39: true, // right\n      40: true // down\n    };\n    this._ignoreKeysOnElementsMatching = 'textarea, input, select';\n    this._isRunning = false;\n    this._touchStartEventObject = null;\n  }\n\n  /**\n   * Block scrolling on the given elements.\n   *\n   * @param {Object|string|Array} $elements\n   */\n  disable($elements) {\n    $elements = $($elements);\n    this._scrollDisabledElements = this._scrollDisabledElements.add($elements);\n    this._checkRunning();\n    return this;\n  }\n\n  /**\n   * Stop blocking scrolling on the given elements.\n   *\n   * @param {Object|string|Array} $items\n   */\n  enable($elements) {\n    $elements = $($elements);\n    if (!$elements.length) {\n      this.clear();\n      return this;\n    }\n    this._scrollDisabledElements = this._scrollDisabledElements.not($elements);\n    this._checkRunning();\n    return this;\n  }\n\n  /**\n   * Stop blocking all scrolling.\n   */\n  clear() {\n    this._scrollDisabledElements = $([]);\n    this._checkRunning();\n    return this;\n  }\n\n  /**\n   * Start or stop listening for events to block if and when needed.\n   */\n  _checkRunning() {\n    if (!this._scrollDisabledElements.length) {\n      this._stop();\n      return;\n    }\n    this._start();\n  }\n\n  /**\n   * Start listening for events to block.\n   */\n  _start() {\n    if (this._isRunning) {\n      return;\n    }\n    this._isRunning = true;\n    window.addEventListener('touchstart', this._onTouchStart); // mobile\n    window.addEventListener('touchend', this._onTouchEnd); // mobile\n    window.addEventListener('touchmove', this._onScrollEvent, { passive: false }); // mobile\n    window.addEventListener('wheel', this._onScrollEvent, { passive: false });\n    document.addEventListener('wheel', this._onScrollEvent, { passive: false });\n    document.addEventListener('keydown', this._onKeyDown);\n  }\n\n  /**\n   * Capture the touchstart event object for deltaY calculations.\n   *\n   * @param {JQuery.Event} event\n   */\n  _onTouchStart(event) {\n    event = $.event.fix(event);\n    this._touchStartEventObject = event;\n    return true;\n  }\n\n  /**\n   * Clear touchstart event object.\n   */\n  _onTouchEnd() {\n    this._touchStartEventObject = null;\n    return true;\n  }\n\n  /**\n   * Process a native scroll event.\n   *\n   * @param {JQuery.Event} event\n   */\n  _onScrollEvent(event) {\n    event = $.event.fix(event);\n    return this._preventScroll(event);\n  }\n\n  /**\n   * Process a native keydown event.\n   *\n   * @param {JQuery.Event} event\n   */\n  _onKeyDown(event) {\n    event = $.event.fix(event);\n    if (!this._preventScrollOnKeys[event.keyCode]) {\n      return;\n    }\n    const $target = $(event.target);\n    if ($target.is(this._ignoreKeysOnElementsMatching)) {\n      return;\n    }\n    return this._preventScroll(event);\n  }\n\n  /**\n   * Process jquery event object.\n   *\n   * @param {JQuery.Event} event\n   */\n  _preventScroll(event) {\n    const isGesture = (event.touches?.length > 1);\n    if (isGesture) {\n      // allow multiple finger gestures through\n      // this will unfortunately allow two finger background scrolling on mobile devices\n      // one finger background scrolling will still be disabled\n      return;\n    }\n    const $target = $(event.target);\n    if (this._scrollDisabledElements.length) {\n      const scrollingParent = this._getScrollingParent(event, $target);\n      if (scrollingParent.filter(this._scrollDisabledElements).length === 0) {\n        this.$window.scroll();\n        return;\n      }\n    }\n    event.preventDefault();\n    return false;\n  }\n\n  /**\n   * Return the parent which will be scrolling from the current scroll event.\n   *\n   * @param {JQuery.Event} event\n   * @param {Object} $target jQuery element object.\n   */\n  _getScrollingParent(event, $target) {\n    const isTouchEvent = event.type === 'touchmove';\n    const hasTouchStartEvent = this._touchStartEventObject?.originalEvent;\n    if (isTouchEvent && !hasTouchStartEvent) {\n      return $target;\n    }\n    const directionY = this._getScrollDirection(event);\n    if (directionY === 'none') {\n      return this.$body;\n    }\n    // Make sure to check the element on which the scroll event was triggered\n    const parents = [$target[0], ...$target.parents()];\n    for (let i = 0, l = parents.length; i < l; i++) {\n      const $parent = $(parents[i]);\n      if ($parent.is('body')) {\n        return this.$body;\n      }\n      if (!this._isScrollable($parent)) {\n        continue;\n      }\n      if (!this._isScrolling($parent, directionY)) {\n        continue;\n      }\n      return $parent;\n    }\n    return this.$body;\n  }\n\n  /**\n   * Returns true if the specified target is scrollable.\n   *\n   * @param {Object} $target jQuery element object.\n   * @returns {boolean}\n   */\n  _isScrollable($target) {\n    const scrollType = $target.css('overflow-y');\n    if (scrollType !== 'auto' && scrollType !== 'scroll') {\n      return false;\n    }\n    const pointerEvents = $target.css('pointer-events');\n    if (pointerEvents === 'none') {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Returns true if the specified target is the scrolling target.\n   *\n   * @param {Object} $target jQuery element object.\n   * @param {string} directionY 'none' | 'up' | 'down'\n   *\n   * @returns {boolean}\n   */\n  _isScrolling($target, directionY) {\n    const scrollTop = Math.ceil($target.scrollTop());\n    const innerHeight = $target.outerHeight();\n    const scrollHeight = $target[0].scrollHeight;\n    let hasScrollingSpace = false;\n    switch (directionY) {\n      case 'down':\n        hasScrollingSpace = scrollTop + innerHeight < scrollHeight;\n        if (hasScrollingSpace) {\n          return true;\n        }\n        break;\n      case 'up':\n        hasScrollingSpace = scrollTop > 0;\n        if (hasScrollingSpace) {\n          return true;\n        }\n        break;\n    }\n    return false;\n  }\n\n  /**\n   * Returns the vertical direction of scroll.\n   *\n   * @param {JQuery.Event} event\n   * @returns {string} 'none' | 'up' | 'down'\n   */\n  _getScrollDirection(event) {\n    const deltaY = this._getScrollDelta(event);\n    if (deltaY === 0) {\n      return 'none';\n    }\n    return deltaY > 0 ? 'up' : 'down';\n  }\n\n  /**\n   * Returns the number of pixels which is intended to be scrolled.\n   *\n   * @param {JQuery.Event} event\n   * @returns {number}\n   */\n  _getScrollDelta(event) {\n    let deltaY = 0;\n    const isTouchEvent = event.type === 'touchmove';\n    const originalEvent = event.originalEvent;\n    if (isTouchEvent) {\n      // Touch events\n      // iOS previous + current scroll pos\n      const startOriginalEvent = this._touchStartEventObject.originalEvent;\n      let currentY = originalEvent.pageY;\n      let previousY = startOriginalEvent.pageY;\n      if (currentY === 0 || currentY === previousY) {\n        // Android chrome current scroll pos\n        currentY = originalEvent.touches[0].pageY;\n        previousY = startOriginalEvent.touches[0].pageY;\n      }\n      // Touch: delta calculated from touchstart pos vs touchmove pos\n      deltaY = currentY - previousY;\n    } else {\n      // Mouse events\n      const hasDeltaY = (originalEvent.wheelDeltaY || originalEvent.deltaY !== undefined);\n      if (hasDeltaY) {\n        // Desktop: Firefox & IE delta inverted\n        deltaY = -originalEvent.deltaY;\n      } else {\n        // Desktop: Chrome & Safari wheel delta\n        deltaY = (originalEvent.wheelDelta || 0);\n      }\n    }\n    return deltaY;\n  }\n\n  /**\n   * Stop listening for events to block.\n   */\n  _stop() {\n    if (!this._isRunning) {\n      return;\n    }\n    this._isRunning = false;\n    window.removeEventListener('touchstart', this._onTouchStart); // mobile\n    window.removeEventListener('touchend', this._onTouchEnd); // mobile\n    // shouldn't need to supply 3rd arg when removing, but IE11 won't remove the event listener if you don't - see https://github.com/adaptlearning/adapt_framework/issues/2466\n    window.removeEventListener('touchmove', this._onScrollEvent, { passive: false }); // mobile\n    window.removeEventListener('wheel', this._onScrollEvent, { passive: false });\n    document.removeEventListener('wheel', this._onScrollEvent, { passive: false });\n    document.removeEventListener('keydown', this._onKeyDown);\n  }\n\n}\n","import Adapt from 'core/js/adapt';\n\n/**\n * Controller for managing tab wrapping for popups.\n * @class\n */\nexport default class WrapFocus extends Backbone.Controller {\n\n  initialize({ a11y }) {\n    this.a11y = a11y;\n    _.bindAll(this, '_onWrapAround');\n    this.listenTo(Adapt, {\n      'accessibility:ready': this._attachEventListeners\n    });\n  }\n\n  _attachEventListeners() {\n    const config = this.a11y.config;\n    $('body').on('click focus', config._options._focusguard, this._onWrapAround);\n  }\n\n  /**\n   * If click or focus is received on any element with the focusguard class,\n   * loop focus around to the top of the document.\n   *\n   * @param {JQuery.Event} event\n   */\n  _onWrapAround(event) {\n    const config = this.a11y.config;\n    if (!config._isEnabled || !config._options._isPopupWrapFocusEnabled) {\n      return;\n    }\n    event.preventDefault();\n    event.stopPropagation();\n    this.a11y.focusFirst('body', { defer: false });\n  }\n\n}\n","import Adapt from 'core/js/adapt';\n\n/**\n * Tabindex and aria-hidden manager for popups.\n * @class\n */\nexport default class Popup extends Backbone.Controller {\n\n  initialize({ a11y }) {\n    this.a11y = a11y;\n    /**\n     * List of elements which form the base at which elements are generally tabbale\n     * and aria-hidden='false'.\n     *\n     * @type {Array<Object>}\n     */\n    this._floorStack = [$('body')];\n    /**\n     * List of elements to return the focus to once leaving each stack.\n     *\n     * @type {Array<Object>}\n     */\n    this._focusStack = [];\n    /**\n     * Hash of tabindex states for each tabbable element in the popup stack.\n     *\n     * @type {Object}\n     */\n    this._tabIndexes = {};\n    /**\n     * Hash of aria-hidden states for each tabbable element in the popup stack.\n     *\n     * @type {Object}\n     */\n    this._ariaHiddens = {};\n    /**\n     * Incremented unique ids for elements belonging to a popup stack with saved\n     * states,\n     */\n    this._elementUIDIndex = 0;\n    this.listenTo(Adapt, {\n      'popup:opened'($element, ignoreInternalTrigger) {\n        if (ignoreInternalTrigger) {\n          return;\n        }\n        this.a11y.log.deprecated('Adapt.trigger(\"popup:opened\", $element) is replaced with a11y.popupOpened($element);');\n        this.opened($element, true);\n      },\n      'popup:closed'($target, ignoreInternalTrigger) {\n        if (ignoreInternalTrigger) {\n          return;\n        }\n        this.a11y.log.deprecated('Adapt.trigger(\"popup:closed\", $target) is replaced with a11y.popupClosed($target);');\n        this.closed($target, true);\n      }\n    });\n  }\n\n  /**\n   * Reorganise the tabindex and aria-hidden attributes in the document to\n   * restrict user interaction to the element specified.\n   *\n   * @param {Object} [$popupElement] Element encapulating the popup.\n   * @returns {Object} Returns `a11y._popup`.\n   */\n  opened($popupElement, silent) {\n    // Capture currently active element or element specified\n    $popupElement = $popupElement || $(document.activeElement);\n    this._addPopupLayer($popupElement);\n    if (!silent) {\n      Adapt.trigger('popup:opened', $popupElement, true);\n    }\n    return this;\n  }\n\n  /**\n   * Restrict tabbing and screen reader access to selected element only.\n   *\n   * @param {Object} $popupElement Element encapulating the popup.\n   */\n  _addPopupLayer($popupElement) {\n    $popupElement = $($popupElement);\n    const config = this.a11y.config;\n    if (!config._isEnabled || !config._options._isPopupManagementEnabled || $popupElement.length === 0) {\n      return $popupElement;\n    }\n    this._floorStack.push($popupElement);\n    this._focusStack.push($(document.activeElement));\n    let $elements = $(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);\n    const $branch = $popupElement.add($popupElement.parents());\n    const $siblings = $branch.siblings().filter(config._options._tabbableElementsExcludes);\n    $elements = $elements.add($siblings);\n    $elements.each((index, item) => {\n      const $item = $(item);\n      if (typeof item.a11y_uid === 'undefined') {\n        item.a11y_uid = 'UID' + ++this._elementUIDIndex;\n      }\n      const elementUID = item.a11y_uid;\n      if (this._tabIndexes[elementUID] === undefined) {\n        this._tabIndexes[elementUID] = [];\n      }\n      if (this._ariaHiddens[elementUID] === undefined) {\n        this._ariaHiddens[elementUID] = [];\n      }\n      const tabindex = $item.attr('tabindex');\n      const ariaHidden = $item.attr('aria-hidden');\n      this._tabIndexes[elementUID].push(tabindex === undefined ? '' : tabindex);\n      this._ariaHiddens[elementUID].push(ariaHidden === undefined ? '' : ariaHidden);\n      if (config._options._isPopupTabIndexManagementEnabled) {\n        $item.attr('tabindex', -1);\n      }\n      if (config._options._isPopupAriaHiddenManagementEnabled) {\n        $item.attr('aria-hidden', true);\n      }\n    });\n    const $items = $popupElement.find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);\n    if (config._options._isPopupTabIndexManagementEnabled) {\n      $items.attr('tabindex', 0);\n    }\n    if (config._options._isPopupAriaHiddenManagementEnabled) {\n      $items\n        .removeAttr('aria-hidden')\n        .removeClass('aria-hidden')\n        .parents(config._options._ariaHiddenExcludes)\n        .removeAttr('aria-hidden')\n        .removeClass('aria-hidden');\n    }\n  }\n\n  /**\n   * Close the last popup on the stack, restoring tabindex and aria-hidden\n   * attributes.\n   *\n   * @param {Object} [$focusElement] Element at which to move focus.\n   * @returns {Object} Returns `a11y._popup`.\n   */\n  closed($focusElement, silent) {\n    const $previousFocusElement = this._removeLastPopupLayer();\n    $focusElement = $focusElement || $previousFocusElement || $('body');\n    if (!silent) {\n      Adapt.trigger('popup:closed', $focusElement, true);\n    }\n    this.a11y.focusFirst($($focusElement), { preventScroll: true });\n    return this;\n  }\n\n  /**\n   * Restores tabbing and screen reader access to the state before the last\n   * `_addPopupLayer` call.\n   *\n   * @returns {Object} Returns previously active element.\n   */\n  _removeLastPopupLayer() {\n    const config = this.a11y.config;\n    if (!config._isEnabled || !config._options._isPopupManagementEnabled) {\n      return $(document.activeElement);\n    }\n    // the body layer is the first element and must always exist\n    if (this._floorStack.length <= 1) {\n      return;\n    }\n    this._floorStack.pop();\n    $(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes).each((index, item) => {\n      const $item = $(item);\n      let previousTabIndex = '';\n      let previousAriaHidden = '';\n      if (typeof item.a11y_uid === 'undefined') {\n        // assign element a unique id\n        item.a11y_uid = 'UID' + ++this._elementUIDIndex;\n      }\n      const elementUID = item.a11y_uid;\n      if (this._tabIndexes[elementUID]?.length) {\n        // get previous tabindex if saved\n        previousTabIndex = this._tabIndexes[elementUID].pop();\n        previousAriaHidden = this._ariaHiddens[elementUID].pop();\n      }\n      if (this._tabIndexes[elementUID]?.length) {\n        // delete element tabindex store if empty\n        delete this._tabIndexes[elementUID];\n        delete this._ariaHiddens[elementUID];\n      }\n      if (config._options._isPopupTabIndexManagementEnabled) {\n        if (previousTabIndex === '') {\n          $item.removeAttr('tabindex');\n        } else {\n          $item.attr({\n            tabindex: previousTabIndex\n          });\n        }\n      }\n      if (config._options._isPopupAriaHiddenManagementEnabled) {\n        if (previousAriaHidden === '') {\n          $item.removeAttr('aria-hidden');\n        } else {\n          $item.attr({\n            'aria-hidden': previousAriaHidden\n          });\n        }\n      }\n    });\n    return this._focusStack.pop();\n  }\n\n  /**\n   * When a popup is open, this function makes it possible to swap the element\n   * that should receive focus on popup close.\n   *\n   * @param {Object} $focusElement Set a new element to focus on.\n   * @returns {Object} Returns previously set focus element.\n   */\n  setCloseTo($focusElement) {\n    const $original = this._focusStack.pop();\n    this._focusStack.push($focusElement);\n    return $original;\n  }\n\n}\n","export default {\n  _menu: 1,\n  _menuGroup: 2,\n  _menuItem: 2,\n  _page: 1,\n  _article: 2,\n  _block: 3,\n  _component: 4,\n  _componentItem: 5,\n  _notify: 1\n};\n","export default function(a11y) {\n\n  /**\n   * The old API is rerouted to the new API with warnings.\n   */\n\n  Object.assign($.fn, {\n\n    isFixedPostion() {\n      a11y.log.removed('$(\"..\").isFixedPostion was unneeded and has been removed, let us know if you need it back.');\n      return false;\n    },\n\n    a11y_aria_label() {\n      a11y.log.removed('$(\"..\").a11y_aria_label was incorrect behaviour.');\n      return this;\n    },\n\n    limitedScrollTo() {\n      a11y.log.removed('$.limitedScrollTo had no impact on the screen reader cursor.');\n      return this;\n    },\n\n    a11y_text() {\n      a11y.log.removed('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\n      return this;\n    },\n\n    a11y_selected() {\n      a11y.log.removed('$(\"..\").a11y_selected is removed. Please use aria-live instead.');\n      return this;\n    },\n\n    a11y_on(isOn) {\n      a11y.log.deprecated('$(\"..\").a11y_on, use a11y.findTabbable($element); and a11y.toggleAccessible($elements, isAccessible); instead.');\n      const $tabbable = a11y.findTabbable(this);\n      a11y.toggleAccessible($tabbable, isOn);\n      return this;\n    },\n\n    a11y_only() {\n      a11y.log.removed('$(\"..\").a11y_only, use a11y.popupOpened($popupElement); instead.');\n      return this;\n    },\n\n    scrollDisable() {\n      if (a11y.config._options._isScrollDisableEnabled === false) {\n        return this;\n      }\n      a11y.log.deprecated('$(\"..\").scrollDisable, use a11y.scrollDisable($elements); instead.');\n      a11y.scrollDisable(this);\n      return this;\n    },\n\n    scrollEnable() {\n      if (a11y.config._options._isScrollDisableEnabled === false) {\n        return this;\n      }\n      a11y.log.deprecated('$(\"..\").scrollEnable, use a11y.scrollEnable($elements); instead.');\n      a11y.scrollEnable(this);\n      return this;\n    },\n\n    a11y_popup() {\n      a11y.log.deprecated('$(\"..\").a11y_popup, use a11y.popupOpened($popupElement); instead.');\n      return a11y.popupOpened(this);\n    },\n\n    a11y_cntrl(isOn, withDisabled) {\n      a11y.log.deprecated('$(\"..\").a11y_cntrl, use a11y.toggleAccessible($elements, isAccessible); and if needed a11y.toggleEnabled($elements, isEnabled); instead.');\n      a11y.toggleAccessible(this, isOn);\n      if (withDisabled) a11y.toggleEnabled(this, isOn);\n      return this;\n    },\n\n    a11y_cntrl_enabled(isOn) {\n      a11y.log.deprecated('$(\"..\").a11y_cntrl_enabled, use a11y.toggleAccessibleEnabled($elements, isAccessibleEnabled); instead.');\n      a11y.toggleAccessibleEnabled(this, isOn);\n      return this;\n    },\n\n    isReadable() {\n      a11y.log.deprecated('$(\"..\").isReadable, use a11y.isReadable($element); instead.');\n      return a11y.isReadable(this);\n    },\n\n    findForward(selector) {\n      a11y.log.removed('$(\"..\").findForward has been removed as the use cases are very small, let us know if you need it back.');\n      return a11y._findFirstForward(this, selector);\n    },\n\n    findWalk(selector) {\n      a11y.log.removed('$(\"..\").findWalk has been removed as the use cases are very small, let us know if you need it back.');\n      return a11y._findFindForwardDescendant(this, selector);\n    },\n\n    focusNoScroll() {\n      a11y.log.deprecated('$(\"..\").focusNoScroll, use a11y.focus($element); instead.');\n      return a11y.focus(this);\n    },\n\n    focusNext(returnOnly) {\n      a11y.log.deprecated('$(\"..\").focusNext, use a11y.focusNext($element); or if needed a11y.findFirstReadable($element); instead.');\n      if (returnOnly) {\n        return a11y.findFirstReadable(this);\n      }\n      return a11y.focusNext(this);\n    },\n\n    focusOrNext(returnOnly) {\n      a11y.log.deprecated('$(\"..\").focusOrNext, use a11y.focusFirst($element); or if needed a11y.findFirstReadable($element); or a11y.isReadable($element); instead.');\n      if (returnOnly) {\n        if (a11y.isReadable(this)) return this;\n        return a11y.findFirstReadable(this);\n      }\n      return a11y.focusFirst(this);\n    },\n\n    a11y_focus(dontDefer) {\n      a11y.log.deprecated('$(\"..\").a11y_focus, use a11y.focusFirst($element, { defer: true }); instead.');\n      a11y.focusFirst(this, { defer: !dontDefer });\n      return this;\n    }\n\n  });\n\n  Object.assign($, {\n\n    a11y_alert() {\n      a11y.log.removed('$.a11y_alert is removed. Please use aria-live instead.');\n      return this;\n    },\n\n    a11y_update() {\n      a11y.log.removed('a11y_update is no longer required.');\n      return this;\n    },\n\n    a11y_text(text) {\n      a11y.log.removed('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\n      return text;\n    },\n\n    a11y_on(isOn, selector) {\n      a11y.log.deprecated('$(\"..\").a11y_on, use a11y.toggleHidden($elements, isHidden); instead.');\n      return a11y.toggleHidden(selector, !isOn);\n    },\n\n    a11y_popdown($focusTarget) {\n      a11y.log.removed('$.a11y_popdown, use a11y.popupClosed($focusTarget); instead.');\n      return a11y.popupClosed($focusTarget);\n    },\n\n    a11y_focus(dontDefer) {\n      a11y.log.deprecated('$.a11y_focus, use a11y.focusFirst(\"body\", { defer: true }); instead.');\n      a11y.focusFirst('body', { defer: !dontDefer });\n      return this;\n    },\n\n    a11y_normalize(html) {\n      a11y.log.deprecated('$.a11y_normalize, use a11y.normalize(\"html\"); instead.');\n      return a11y.normalize(html);\n    },\n\n    a11y_remove_breaks(html) {\n      a11y.log.deprecated('$.a11y_remove_breaks, use a11y.removeBreaks(\"html\"); instead.');\n      return a11y.removeBreaks(html);\n    }\n\n  });\n}\n","import Backbone from 'backbone';\nimport logging from 'core/js/logging';\n\nclass Components extends Backbone.Controller {\n\n  initialize() {\n    this._register = {};\n    this.register = this.register.bind(this);\n    this.getViewName = this.getViewName.bind(this);\n    this.getViewClass = this.getViewClass.bind(this);\n    this.getModelName = this.getModelName.bind(this);\n    this.getModelClass = this.getModelClass.bind(this);\n  }\n\n  /**\n   * Used to register models and views\n   * @param {string|Array} name The name(s) of the model/view to be registered\n   * @param {object} object Object containing properties `model` and `view` or (legacy) an object representing the view\n   */\n  register(name, object) {\n    if (Array.isArray(name)) {\n      // if an array is passed, iterate by recursive call\n      name.forEach(name => this.register(name, object));\n      return object;\n    }\n\n    if (name.split(' ').length > 1) {\n      // if name with spaces is passed, split and pass as array\n      this.register(name.split(' '), object);\n      return object;\n    }\n\n    if ((!object.view && !object.model) || object instanceof Backbone.View) {\n      logging.deprecated('View-only registrations are no longer supported');\n      object = { view: object };\n    }\n\n    if (object.view && !object.view.template) {\n      object.view.template = name;\n    }\n\n    const isModelSetAndInvalid = (object.model &&\n      !(object.model.prototype instanceof Backbone.Model) &&\n      !(object.model instanceof Function));\n    if (isModelSetAndInvalid) {\n      throw new Error('The registered model is not a Backbone.Model or Function');\n    }\n\n    const isViewSetAndInvalid = (object.view &&\n      !(object.view.prototype instanceof Backbone.View) &&\n      !(object.view instanceof Function));\n    if (isViewSetAndInvalid) {\n      throw new Error('The registered view is not a Backbone.View or Function');\n    }\n\n    this._register[name] = Object.assign({}, this._register[name], object);\n\n    return object;\n  }\n\n  /**\n   * Parses a view class name.\n   * @param {string|Backbone.Model|Backbone.View|object} nameModelViewOrData The name of the view class you want to fetch e.g. `\"hotgraphic\"` or its model or its json data\n   */\n  getViewName(nameModelViewOrData) {\n    if (typeof nameModelViewOrData === 'string') {\n      return nameModelViewOrData;\n    }\n    if (nameModelViewOrData instanceof Backbone.Model) {\n      nameModelViewOrData = nameModelViewOrData.toJSON();\n    }\n    if (nameModelViewOrData instanceof Backbone.View) {\n      let foundName;\n      Object.entries(this._register).forEach(([key, entry]) => {\n        if (!entry?.view) return;\n        if (!(nameModelViewOrData instanceof entry.view)) return;\n        foundName = key;\n        return true;\n      });\n      return foundName;\n    }\n    if (nameModelViewOrData instanceof Object) {\n      const names = [\n        typeof nameModelViewOrData._view === 'string' && nameModelViewOrData._view,\n        typeof nameModelViewOrData._component === 'string' && nameModelViewOrData._component,\n        typeof nameModelViewOrData._type === 'string' && nameModelViewOrData._type\n      ].filter(Boolean);\n      if (names.length) {\n        // find first fitting view name\n        const name = names.find(name => this._register[name]?.view);\n        return name || names.pop(); // return last available if none found\n      }\n    }\n    throw new Error('Cannot derive view class name from input');\n  }\n\n  /**\n   * Fetches a view class from the components. For a usage example, see either HotGraphic or Narrative\n   * @param {string|Backbone.Model|Backbone.View|object} nameModelViewOrData The name of the view class you want to fetch e.g. `\"hotgraphic\"` or its model or its json data\n   * @returns {Backbone.View} Reference to the view class\n   */\n  getViewClass(nameModelViewOrData) {\n    const name = this.getViewName(nameModelViewOrData);\n    const object = this._register[name];\n    if (!object) {\n      logging.error(`A view for '${name}' isn't registered in your project`);\n      return;\n    }\n    const isBackboneView = (object.view?.prototype instanceof Backbone.View);\n    if (!isBackboneView && object.view instanceof Function) {\n      return object.view();\n    }\n    return object.view;\n  }\n\n  /**\n   * Parses a model class name.\n   * @param {string|Backbone.Model|object} name The name of the model you want to fetch e.g. `\"hotgraphic\"`, the model to process or its json data\n   */\n  getModelName(nameModelOrData) {\n    if (typeof nameModelOrData === 'string') {\n      return nameModelOrData;\n    }\n    if (nameModelOrData instanceof Backbone.Model) {\n      nameModelOrData = nameModelOrData.toJSON();\n    }\n    if (nameModelOrData instanceof Object) {\n      const name = nameModelOrData._component;\n      const entry = this._register[name];\n      const isViewOnlyQuestion = entry && !entry.model && entry.view?._isQuestionType;\n      if (isViewOnlyQuestion) {\n        // Use question model by default\n        logging.deprecated(`Assuming a question model for a view-only question: ${name}`);\n        return 'question';\n      }\n      const names = [\n        typeof nameModelOrData._model === 'string' && nameModelOrData._model,\n        typeof nameModelOrData._component === 'string' && nameModelOrData._component,\n        typeof nameModelOrData._type === 'string' && nameModelOrData._type\n      ].filter(Boolean);\n      if (names.length) {\n        // find first fitting model name\n        const name = names.find(name => this._register[name]?.model);\n        return name || names.pop(); // return last available if none found\n      }\n    }\n    throw new Error('Cannot derive model class name from input');\n  }\n\n  /**\n   * Fetches a model class from the components. For a usage example, see either HotGraphic or Narrative\n   * @param {string|Backbone.Model|object} name The name of the model you want to fetch e.g. `\"hotgraphic\"` or its json data\n   * @returns {Backbone.Model} Reference to the view class\n   */\n  getModelClass(nameModelOrData) {\n    const name = this.getModelName(nameModelOrData);\n    const object = this._register[name];\n    if (!object) {\n      logging.error(`A model for '${name}' isn't registered in your project`);\n      return;\n    }\n    const isBackboneModel = (object.model?.prototype instanceof Backbone.Model);\n    if (!isBackboneModel && object.model instanceof Function) {\n      return object.model();\n    }\n    return object.model;\n  }\n\n}\n\nconst components = new Components();\nexport default components;\n","import Adapt from 'core/js/adapt';\n\nexport default class AdaptCollection extends Backbone.Collection {\n\n  initialize(models, options) {\n    this.once('reset', this.loadedData, this);\n  }\n\n  loadedData() {\n    Adapt.trigger('adaptCollection:dataLoaded');\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport LockingModel from 'core/js/models/lockingModel';\nimport 'core/js/logging';\nimport semver from 'semver';\n\nexport default class BuildModel extends LockingModel {\n\n  defaults() {\n    return {\n      jsonext: 'json'\n    };\n  }\n\n  initialize(attrs, options) {\n    this.url = options.url;\n    // Fetch data & if successful trigger event to enable plugins to stop course files loading\n    // Then check if course files can load\n    // 'configModel:loadCourseData' event starts the core content collections and models being fetched\n    this.fetch({\n      success: () => {\n        this.isLoaded = true;\n        Adapt.trigger('buildModel:dataLoaded');\n      },\n      error: () => {\n        console.log('Unable to load adapt/js/build.js');\n        Adapt.trigger('buildModel:dataLoaded');\n      }\n    });\n  }\n\n  isFrameworkVersion(version) {\n    return semver.satisfies(this.get('package').version, version, { includePrerelease: true });\n  }\n\n  isPluginInstalled(name, version = '*') {\n    const plugin = this.get('plugins').find(plugin => {\n      if (plugin.name !== name) return false;\n      return semver.satisfies(plugin.version, version, { includePrerelease: true });\n    });\n    return Boolean(plugin);\n  }\n\n  whenReady() {\n    if (this.isLoaded) return Promise.resolve();\n    return new Promise(resolve => {\n      Adapt.once('buildModel:dataLoaded', resolve);\n    });\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport wait from 'core/js/wait';\nimport LockingModel from 'core/js/models/lockingModel';\nimport logging from 'core/js/logging';\n\nexport default class ConfigModel extends LockingModel {\n\n  defaults() {\n    return {\n      screenSize: {\n        large: 900,\n        medium: 760,\n        small: 520\n      },\n      _forceRouteLocking: false,\n      _canLoadData: true,\n      _disableAnimation: false\n    };\n  }\n\n  /**\n   * Parse the incoming search queries for certain parameter values to use as defaults\n   */\n  setValuesFromURLParams() {\n    const paramMappings = {\n      dir: '_defaultDirection',\n      lang: '_defaultLanguage'\n    };\n\n    const params = new URLSearchParams(window.location.search);\n\n    Object.entries(paramMappings).forEach(([key, value]) => {\n      const passedVal = params.get(key);\n      if (!passedVal) return;\n      if (key === 'lang' && Adapt.build.get('availableLanguageNames')?.includes(passedVal) === false) return;\n      this.set(value, passedVal);\n    });\n  }\n\n  initialize(attrs, options) {\n    this.url = options.url;\n    // Fetch data & if successful trigger event to enable plugins to stop course files loading\n    // Then check if course files can load\n    // 'configModel:loadCourseData' event starts the core content collections and models being fetched\n    this.fetch({\n      success: () => {\n        this.setValuesFromURLParams();\n\n        Adapt.trigger('offlineStorage:prepare');\n        wait.queue(() => {\n          Adapt.trigger('configModel:dataLoaded');\n          if (!this.get('_canLoadData')) return;\n          Adapt.trigger('configModel:loadCourseData');\n        });\n      },\n      error: () => logging.error('Unable to load course/config.json')\n    });\n  }\n\n  loadData() {}\n\n}\n","import Adapt from 'core/js/adapt';\nimport offlineStorage from 'core/js/offlineStorage';\nimport wait from 'core/js/wait';\nimport components from 'core/js/components';\nimport AdaptCollection from 'core/js/collections/adaptCollection';\nimport BuildModel from 'core/js/models/buildModel';\nimport ConfigModel from 'core/js/models/configModel';\nimport LockingModel from 'core/js/models/lockingModel';\nimport logging from 'core/js/logging';\nimport location from 'core/js/location';\nimport _ from 'underscore';\n\nclass Data extends AdaptCollection {\n\n  model(json) {\n    const ModelClass = components.getModelClass(json);\n    if (!ModelClass) {\n      return new LockingModel(json);\n    }\n    return new ModelClass(json, { parse: true });\n  }\n\n  initialize() {\n    super.initialize();\n    this.findById = this.findById.bind(this);\n    this.findViewByModelId = this.findViewByModelId.bind(this);\n    this.findByTrackingPosition = this.findByTrackingPosition.bind(this);\n    this.on({\n      add: this.onAdded,\n      remove: this.onRemoved\n    });\n  }\n\n  async init () {\n    this.reset();\n    this._byAdaptID = {};\n    Adapt.build = new BuildModel(null, { url: 'adapt/js/build.min.js', reset: true });\n    await Adapt.build.whenReady();\n    $('html').attr('data-adapt-framework-version', Adapt.build.get('package').version);\n    this.loadConfigData();\n  }\n\n  onAdded(model) {\n    this._byAdaptID[model.get('_id')] = model;\n  }\n\n  onRemoved(model) {\n    delete this._byAdaptID[model.get('_id')];\n  }\n\n  loadConfigData() {\n    Adapt.config = new ConfigModel(null, { url: Adapt.build.get('coursedir') + '/config.' + Adapt.build.get('jsonext'), reset: true });\n    this.listenToOnce(Adapt, 'configModel:loadCourseData', this.onLoadCourseData);\n    this.listenTo(Adapt.config, {\n      'change:_activeLanguage': this.onLanguageChange,\n      'change:_defaultDirection': this.onDirectionChange\n    });\n  }\n\n  onDirectionChange(model, direction) {\n    if (direction === 'rtl') {\n      $('html').removeClass('dir-ltr').addClass('dir-rtl').attr('dir', 'rtl');\n    } else {\n      $('html').removeClass('dir-rtl').addClass('dir-ltr').attr('dir', 'ltr');\n    }\n  }\n\n  /**\n   * Before we actually go to load the course data, we first need to check to see if a language has been set\n   * If it has we can go ahead and start loading; if it hasn't, apply the defaultLanguage from config.json\n   */\n  onLoadCourseData() {\n    if (!Adapt.config.get('_activeLanguage')) {\n      Adapt.config.set('_activeLanguage', Adapt.config.get('_defaultLanguage'));\n      return;\n    }\n    this.loadCourseData();\n  }\n\n  async onLanguageChange(model, language) {\n    await wait.queue();\n    offlineStorage.set('lang', language);\n    // set `_isStarted` back to `false` when changing language so that the learner's answers\n    // to questions get restored in the new language when `_restoreStateOnLanguageChange: true`\n    // see https://github.com/adaptlearning/adapt_framework/issues/2977\n    if (Adapt.get('_isStarted')) {\n      Adapt.set('_isStarted', false);\n    }\n    this.loadCourseData(language);\n  }\n\n  async loadCourseData(newLanguage) {\n\n    // All code that needs to run before adapt starts should go here\n    const language = Adapt.config.get('_activeLanguage');\n\n    const courseFolder = Adapt.build.get('coursedir') + '/' + language + '/';\n\n    $('html').attr('lang', language);\n\n    await this.loadManifestFiles(courseFolder);\n    await this.triggerDataLoaded();\n    await this.triggerDataReady(newLanguage);\n    this.triggerInit();\n\n  }\n\n  getJSON(path) {\n    return new Promise((resolve, reject) => {\n      $.getJSON(path, data => {\n        // Add path to data in case it's necessary later\n        data.__path__ = path;\n        resolve(data);\n      }).fail(() => {\n        reject(new Error(`Unable to load ${path}`));\n      });\n    });\n  }\n\n  async loadManifestFiles(languagePath) {\n    this.trigger('loading');\n    this.reset();\n    const manifestPath = languagePath + 'language_data_manifest.js';\n    let manifest;\n    try {\n      manifest = await this.getJSON(manifestPath);\n    } catch (err) {\n      manifest = ['course.json', 'contentObjects.json', 'articles.json', 'blocks.json', 'components.json'];\n      logging.error(`Manifest path '${manifestPath} not found. Using traditional files: ${manifest.join(', ')}`);\n    }\n    let allFileData;\n    try {\n      allFileData = await Promise.all(manifest.map(filePath => {\n        return this.getJSON(`${languagePath}${filePath}`);\n      }));\n    } catch (error) {\n      logging.error(error);\n      return;\n    }\n    // Flatten all file data into a single array of model data\n    const allModelData = allFileData.reduce((result, fileData) => {\n      if (Array.isArray(fileData)) {\n        fileData.forEach((datum, index) => {\n          datum.__path__ = fileData.__path__;\n          datum.__index__ = index;\n      });\n        result.push(...fileData);\n      } else if (fileData instanceof Object) {\n        result.push(fileData);\n      } else {\n        logging.warnOnce(`File data isn't an array or object: ${fileData.__path__}`);\n      }\n      return result;\n    }, []);\n    // Add course model first to allow other model/views to utilize its settings\n    const course = allModelData.find(modelData => modelData._type === 'course');\n    if (!course) {\n      throw new Error('Expected a model data with \"_type\": \"course\", none found.');\n    }\n    Adapt.trigger('courseModel:dataLoading');\n    Adapt.course = this.push(course);\n    Adapt.trigger('courseModel:dataLoaded');\n    // Add other models\n    allModelData.forEach(modelData => {\n      if (modelData._type === 'course') {\n        return;\n      }\n      try {\n        components.getModelName(modelData);\n      } catch (error) {\n        logging.error(`Failed to load object ${modelData.__path__}${Object.prototype.hasOwnProperty.call(modelData, '__index__') ? `[${modelData.__index__}]` : ''}`)\n        logging.error(error);\n        return;\n      }\n      this.push(modelData);\n    });\n    this.checkData();\n    this.trigger('reset');\n    this.trigger('loaded');\n    await wait.queue();\n  }\n\n  async triggerDataLoaded() {\n    logging.debug('Firing app:dataLoaded');\n    try {\n      // Setup the newly added models\n      this.forEach(model => model.setupModel?.());\n      Adapt.trigger('app:dataLoaded');\n    } catch (e) {\n      logging.error('Error during app:dataLoading trigger', e);\n    }\n    await wait.queue();\n  }\n\n  async triggerDataReady(newLanguage) {\n    if (newLanguage) {\n      Adapt.trigger('app:languageChanged', newLanguage);\n      await wait.queue();\n    }\n    logging.debug('Firing app:dataReady');\n    try {\n      Adapt.trigger('app:dataReady');\n    } catch (e) {\n      logging.error('Error during app:dataReady trigger', e);\n    }\n    await wait.queue();\n  }\n\n  triggerInit() {\n    this.isReady = true;\n    this.trigger('ready');\n  }\n\n  whenReady() {\n    if (this.isReady) return Promise.resolve();\n    return new Promise(resolve => {\n      this.once('ready', resolve);\n    });\n  }\n\n  /**\n   * Checks if a model _id exists\n   * @param {string} id The id of the item e.g. \"co-05\"\n   * @returns {boolean}\n   */\n  hasId(id) {\n    return Boolean(this._byAdaptID[id]);\n  }\n\n  /**\n   * Looks up a model by its `_id` property\n   * @param {string} id The id of the item e.g. \"co-05\"\n   * @return {Backbone.Model}\n   */\n  findById(id) {\n    const model = this._byAdaptID[id];\n    if (!model) {\n      console.warn(`data.findById() unable to find id: ${id}`);\n      return;\n    }\n    return model;\n  }\n\n  /**\n   * Looks up a view by its model `_id` property\n   * @param {string} id The id of the item e.g. \"co-05\"\n   * @return {Backbone.View}\n   */\n  findViewByModelId(id) {\n    const model = this.findById(id);\n    if (!model) return;\n\n    if (model === Adapt.parentView.model) return Adapt.parentView;\n\n    const idPathToView = [id];\n    const currentLocationId = location._currentId;\n    const currentLocationModel = model.getAncestorModels().find(model => {\n      const modelId = model.get('_id');\n      if (modelId === currentLocationId) return true;\n      idPathToView.unshift(modelId);\n      return false;\n    });\n\n    if (!currentLocationModel) {\n      return console.warn(`data.findViewByModelId() unable to find view for model id: ${id}`);\n    }\n\n    const foundView = idPathToView.reduce((view, currentId) => {\n      if (!view) return null;\n      const childViews = view.getChildViews();\n      return childViews?.find(view => view.model.get('_id') === currentId);\n    }, Adapt.parentView);\n\n    return foundView;\n  }\n\n  /**\n   * Returns the model represented by the trackingPosition.\n   * @param {Array<Number, Number>} trackingPosition Represents the relative location of a model to a _trackingId\n   * @returns {Backbone.Model}\n   */\n  findByTrackingPosition(trackingPosition) {\n    const [ trackingId, indexInTrackingIdDescendants ] = trackingPosition;\n    const trackingIdModel = this.find(model => model.get('_trackingId') === trackingId);\n    if (!trackingIdModel) {\n      console.warn(`data.findByTrackingPosition() unable to find trackingPosition: ${trackingPosition}`);\n      return;\n    }\n    if (indexInTrackingIdDescendants >= 0) {\n      // Model is either the trackingId model or a descendant\n      let trackingIdDescendants = [trackingIdModel].concat(trackingIdModel.getAllDescendantModels(true));\n      trackingIdDescendants = trackingIdDescendants.filter(model => !(model.isTypeGroup('component') && model.get('_isTrackable') === false));\n      return trackingIdDescendants[indexInTrackingIdDescendants];\n    }\n    // Model is an ancestor of the trackingId model\n    const trackingIdAncestors = trackingIdModel.getAncestorModels();\n    const ancestorDistance = Math.abs(indexInTrackingIdDescendants) - 1;\n    return trackingIdAncestors[ancestorDistance];\n  }\n\n  logReadyError(view) {\n    const notReadyDescendants = view.model.getAllDescendantModels(true).filter(model => !model.get('_isReady'));\n    logging.error(`View ${notReadyDescendants.map(model => `${model.get('_id')} (${model.get('_component') ?? model.get('_type')})`).join(', ')} failed to become ready, forcing ready status.`);\n    notReadyDescendants.reverse().forEach(model => model.set('_isReady', true));\n  }\n\n  checkData() {\n    this.checkIds();\n    this.checkTrackingIds();\n  }\n\n  checkIds() {\n    const items = this.toJSON();\n    // Index and group\n    const idIndex = _.indexBy(items, '_id');\n    const idGroups = _.groupBy(items, '_id');\n    const parentIdGroups = _.groupBy(items, '_parentId');\n    // Setup error collection arrays\n    let orphanedIds = {};\n    let emptyIds = {};\n    let duplicateIds = {};\n    let missingIds = {};\n    items.forEach((o) => {\n      const isCourseType = (o._type === 'course');\n      const isComponentType = (o._type === 'component');\n      if (idGroups[o._id].length > 1) {\n        duplicateIds[o._id] = true; // Id has more than one item\n      }\n      if (!isComponentType && !parentIdGroups[o._id]) {\n        emptyIds[o._id] = true; // Course has no children\n      }\n      if (!isCourseType && (!o._parentId || !idIndex[o._parentId])) {\n        orphanedIds[o._id] = true; // Item has no defined parent id or the parent id doesn't exist\n      }\n      if (!isCourseType && o._parentId && !idIndex[o._parentId]) {\n        missingIds[o._parentId] = true; // Referenced parent item does not exist\n      }\n    });\n    orphanedIds = Object.keys(orphanedIds);\n    emptyIds = Object.keys(emptyIds);\n    duplicateIds = Object.keys(duplicateIds);\n    missingIds = Object.keys(missingIds);\n    // Output for each type of error\n    const hasErrored = orphanedIds.length || emptyIds.length || duplicateIds.length || missingIds.length;\n    if (orphanedIds.length) {\n      logging.error(`Orphaned _ids: ${orphanedIds.join(', ')}`);\n    }\n    if (missingIds.length) {\n      logging.error(`Missing _ids: ${missingIds.join(', ')}`);\n    }\n    if (emptyIds.length) {\n      logging.error(`Empty _ids: ${emptyIds.join(', ')}`);\n    }\n    if (duplicateIds.length) {\n      logging.error(`Duplicate _ids: ${duplicateIds.join(', ')}`);\n    }\n    // If any error has occured, stop processing.\n    if (hasErrored) {\n      const err = new Error('Oops, looks like you have some json errors.');\n      err.number = 10011;\n      throw err;\n    }\n  }\n\n  checkTrackingIds() {\n    const items = this.toJSON();\n    const trackingIdType = Adapt.build.get('trackingIdType') || 'block';\n    const trackingIdCounts = _.groupBy(items.filter(item => item._type === trackingIdType), '_trackingId');\n    const missingTrackingIds = items.filter(item => item._type === trackingIdType && item._trackingId === undefined).map(item => item._id);\n    if (missingTrackingIds.length) {\n      logging.error(`Missing _trackingIds: ${missingTrackingIds.join(', ')}`);\n    }\n    const duplicateTrackingIds = Object.entries(trackingIdCounts)\n      .filter(([id, group]) => group.length > 1)\n      .map(([id, group]) => `${id}:[${group.map(item => item._id).join(', ')}]`);\n    if (duplicateTrackingIds.length) {\n      logging.error(`Duplicate _trackingIds: ${duplicateTrackingIds.join(', ')}`);\n    }\n    const hasErrored = missingTrackingIds.length || duplicateTrackingIds.length;\n    // If any error has occured, stop processing.\n    if (hasErrored) {\n      const err = new Error('Oops, looks like you have some json errors with trackingIds.');\n      err.number = 10011;\n      throw err;\n    }\n  }\n\n}\n\nconst data = new Data();\nexport default data;\n","import Adapt from 'core/js/adapt';\nimport offlineStorage from 'core/js/offlineStorage';\nimport device from 'core/js/device';\nimport location from 'core/js/location';\nimport BrowserFocus from 'core/js/a11y/browserFocus';\nimport FocusOptions from 'core/js/a11y/focusOptions';\nimport KeyboardFocusOutline from 'core/js/a11y/keyboardFocusOutline';\nimport Log from 'core/js/a11y/log';\nimport Scroll from 'core/js/a11y/scroll';\nimport WrapFocus from 'core/js/a11y/wrapFocus';\nimport Popup from 'core/js/a11y/popup';\nimport defaultAriaLevels from 'core/js/enums/defaultAriaLevels';\nimport deprecated from 'core/js/a11y/deprecated';\nimport logging from 'core/js/logging';\nimport data from './data';\n\nclass A11y extends Backbone.Controller {\n\n  defaults() {\n    return {\n      _isFocusOutlineKeyboardOnlyEnabled: true,\n      /**\n       * `_isFocusOutlineDisabled` ignores `_isEnabled` and can be used when all other\n       * accessibility features have been disabled.\n       */\n      _isFocusOutlineDisabled: false,\n      _isFocusAssignmentEnabled: true,\n      _isFocusOnClickEnabled: true,\n      _isFocusNextOnDisabled: true,\n      _isScrollDisableEnabled: true,\n      _isAriaHiddenManagementEnabled: true,\n      _isPopupManagementEnabled: true,\n      _isPopupWrapFocusEnabled: true,\n      _isPopupAriaHiddenManagementEnabled: true,\n      _isPopupTabIndexManagementEnabled: true,\n      /**\n       * Do not change aria-hidden on these elements.\n       */\n      _ariaHiddenExcludes: ':not(#wrapper):not(body)',\n      _tabbableElements: 'a,button,input,select,textarea,[tabindex]:not([data-a11y-force-focus])',\n      _focusOutlineKeyboardOnlyIgnore: 'input,textarea',\n      /**\n       * Designate these elements as not tabbable.\n       */\n      _tabbableElementsExcludes: ':not(.a11y-ignore):not([data-a11y-force-focus])',\n      _focusableElements: 'a,button,input,select,textarea,[tabindex],label',\n      _readableElements: '[role=heading],[aria-label],[aria-labelledby],[alt]',\n      /**\n       * Prevent adapt from focusing forward onto these elements.\n       */\n      _focusForwardElementsExcludes: ':not([aria-labelledby][role=dialog],[aria-labelledby][role=main],[aria-labelledby][role=region],[aria-labelledby][role=radiogroup],[aria-labelledby][role=group],[aria-labelledby][role=tablist],[aria-labelledby][role=list],[aria-labelledby][role=tree],[aria-labelledby][role=treegrid],[aria-labelledby][role=table],[aria-labelledby][role=grid][aria-labelledby],[role=menu],[aria-labelledby][role=rowgroup])',\n      /**\n       * Selector for elements which cause tab wrapping.\n       */\n      _focusguard: '.a11y-focusguard',\n      /**\n       * Specifies all stylistic elements.\n       */\n      _wrapStyleElements: 'b,i,abbr,strong,em,small,sub,sup,ins,del,mark,zw,nb',\n\n      /**\n       * Logging settings\n       */\n      _warnFirstOnly: true,\n      _warn: true\n    };\n  }\n\n  initialize() {\n    this.isFocusable = this.isFocusable.bind(this);\n    this.isReadable = this.isReadable.bind(this);\n    this.isTabbable = this.isTabbable.bind(this);\n    this.$html = $('html');\n    this._htmlCharRegex = /&.*;/g;\n    /** @type {Object} */\n    this.config = null;\n    this._browserFocus = new BrowserFocus({ a11y: this });\n    this._keyboardFocusOutline = new KeyboardFocusOutline({ a11y: this });\n    this._wrapFocus = new WrapFocus({ a11y: this });\n    this._popup = new Popup({ a11y: this });\n    this._scroll = new Scroll({ a11y: this });\n    this.log = new Log({ a11y: this });\n    deprecated(this);\n\n    this._removeLegacyElements();\n    this.listenToOnce(Adapt, {\n      'configModel:dataLoaded': this._onConfigDataLoaded,\n      'navigationView:postRender': this._removeLegacyElements\n    }, this);\n    Adapt.on('device:changed', this._setupNoSelect);\n    this.listenTo(Adapt, {\n      'router:location': this._onNavigationStart,\n      'contentObjectView:ready router:plugin': this._onNavigationEnd\n    });\n  }\n\n  _onConfigDataLoaded() {\n    this.config = Adapt.config.get('_accessibility');\n    this.config._isActive = false;\n    this.config._options = _.defaults(this.config._options || {}, this.defaults());\n    offlineStorage.set('a11y', false);\n    this.$html.toggleClass('has-accessibility', this.isEnabled());\n    this._setupNoSelect();\n    this._addFocuserDiv();\n    if (this._isReady) {\n      return;\n    }\n    this._isReady = true;\n    Adapt.trigger('accessibility:ready');\n  }\n\n  _setupNoSelect() {\n    if (!this.config?._disableTextSelectOnClasses) {\n      return;\n    }\n    const classes = this.config._disableTextSelectOnClasses.split(' ');\n    const isMatch = classes.some(className => this.$html.is(className));\n    this.$html.toggleClass('u-no-select', isMatch);\n  }\n\n  _addFocuserDiv() {\n    if ($('#a11y-focuser').length) {\n      return;\n    }\n    $('body').append($('<div id=\"a11y-focuser\" class=\"a11y-ignore\" tabindex=\"-1\">&nbsp;</div>'));\n  }\n\n  _removeLegacyElements() {\n    const $legacyElements = $('body').children('#accessibility-toggle, #accessibility-instructions');\n    const $navigationElements = $('.nav').find('#accessibility-toggle, #accessibility-instructions');\n    if (!$legacyElements.length && !$navigationElements.length) {\n      return;\n    }\n    logging.warn('REMOVED: #accessibility-toggle and #accessibility-instructions have been removed. Please remove them from all of your .html files.');\n    $legacyElements.remove();\n    $navigationElements.remove();\n  }\n\n  _onNavigationStart() {\n    if (!this.isEnabled()) {\n      return;\n    }\n    // Stop document reading\n    _.defer(() => this.toggleHidden('.contentobject', true));\n  }\n\n  _onNavigationEnd(view) {\n    // Prevent sub-menu items provoking behaviour\n    if ((view?.model?.get('_id') !== location._currentId) || !this.isEnabled()) {\n      return;\n    }\n    // Allow document to be read\n    this.toggleHidden('.contentobject', false);\n  }\n\n  isActive() {\n    this.log.removed('Accessibility is now always active when enabled. Please unify your user experiences.');\n    return false;\n  }\n\n  isEnabled() {\n    return this.config?._isEnabled;\n  }\n\n  /**\n   * Calculate the aria level for a heading\n   * @param {object} [options]\n   * @param {string|number} [options.id] Used to automate the heading level when relative increments are used\n   * @param {string|number} [options.level] Specify a default level, \"component\" / \"menu\" / \"componentItem\" etc\n   * @param {string|number} [options.override] Override with a default level, an absolute value or a relative increment\n   * @returns {number}\n   * @notes\n   * Default levels come from config.json:_accessibility._ariaLevels attribute names, they are:\n   *  \"menu\", \"menuGroup\", \"menuItem\", \"page\", \"article\", \"block\", \"component\", \"componentItem\" and \"notify\"\n   * An absolute value would be \"1\" or \"2\" etc.\n   * A relative increment would be \"@page+1\" or \"@block+1\". They are calculated from ancestor values,\n   * respecting both _ariaLevel overrides and not incrementing for missing displayTitle values.\n   */\n  ariaLevel({\n    id = null,\n    level = \"1\",\n    override = null\n  } = {}) {\n    if (arguments.length === 2) {\n      // backward compatibility\n      level = arguments[0];\n      override =  arguments[1];\n      id = null;\n    }\n    // get the global configuration from config.json\n    const ariaLevels = Adapt.config.get('_accessibility')?._ariaLevels ?? defaultAriaLevels;\n    /**\n     * Recursive function to calculate aria-level\n     * @param {string} id Model id\n     * @param {string} level Default name, relative increment or absolute level\n     * @param {number} [offset=0] Total offset count from first absolute value\n     * @returns\n     */\n    function calculateLevel(id = null, level, offset = 0) {\n      const isNumber =  !isNaN(level);\n      const isTypeName = /[a-zA-z]/.test(level);\n      if (!isTypeName && isNumber) {\n        // if an absolute value is found, use it, adding the accumulated offset\n        return parseInt(level) + offset;\n      }\n      // parse the level value as a relative string\n      const relativeDescriptor = Adapt.parseRelativeString(level);\n      // lookup the default value from `config.json:_accessibility._ariaLevels`\n      const nextLevel = ariaLevels?.['_' + relativeDescriptor.type];\n      const hasModelId = Boolean(id);\n      if (!hasModelId) {\n        logging.warnOnce('Cannot calculate appropriate heading level, no model id was specified');\n        return calculateLevel(id, nextLevel, offset + relativeDescriptor.offset);\n      }\n      // try to find the next relevant ancestor, or use the specified model\n      const nextModel =  data.findById(id)?.findAncestor(relativeDescriptor.type?.toLowerCase()) ?? data.findById(id);\n      const nextModelId = nextModel?.get('_id') ?? id;\n      // check overrides, check title existence, adjust offset accordingly\n      const hasNextTitle = Boolean(nextModel.get('displayTitle'));\n      const nextModelOverride = nextModel.get('_ariaLevel');\n      const accumulatedOffset = offset + (hasNextTitle ? relativeDescriptor.offset : 0);\n      const resolvedLevel = nextModelOverride ?? nextLevel;\n      // move towards the parents until an absolute value is found\n      return calculateLevel(nextModelId, resolvedLevel, accumulatedOffset);\n    }\n    return calculateLevel(id, override ?? level)\n  }\n\n  /**\n   * Adds or removes `aria-hidden` attribute to elements.\n   *\n   * @param {Object|string|Array} $elements\n   * @param {boolean} [isHidden=true]\n   * @returns {Object} Chainable\n   */\n  toggleHidden($elements, isHidden = true) {\n    $elements = $($elements);\n    const config = this.config;\n    if (!config._isEnabled || !config._options._isAriaHiddenManagementEnabled) {\n      return this;\n    }\n    if (isHidden === true) {\n      $elements.attr('aria-hidden', true);\n    } else {\n      $elements.removeAttr('aria-hidden');\n    }\n    return this;\n  }\n\n  /**\n   * Adds or removes `aria-hidden` and `disabled` attributes and `disabled`\n   * classes to elements.\n   *\n   * @param {Object|string|Array} $elements\n   * @param {boolean} [isHidden=true]\n   * @returns {Object} Chainable\n   */\n  toggleAccessibleEnabled($elements, isAccessibleEnabled) {\n    this.toggleAccessible($elements, isAccessibleEnabled);\n    this.toggleEnabled($elements, isAccessibleEnabled);\n    return this;\n  }\n\n  /**\n   * Adds or removes `aria-hidden` attribute and disables `tabindex` on elements.\n   *\n   * @param {Object|string|Array} $elements\n   * @param {boolean} [isReadable=true]\n   * @returns {Object} Chainable\n   */\n  toggleAccessible($elements, isReadable = true) {\n    $elements = $($elements);\n    const config = this.config;\n    if (!config._isEnabled || !config._options._isAriaHiddenManagementEnabled || $elements.length === 0) {\n      return this;\n    }\n    if (!isReadable) {\n      $elements.attr({\n        tabindex: '-1',\n        'aria-hidden': 'true'\n      }).addClass('aria-hidden');\n    } else {\n      $elements.removeAttr('aria-hidden tabindex').removeClass('aria-hidden');\n      $elements.parents(config._options._ariaHiddenExcludes).removeAttr('aria-hidden').removeClass('aria-hidden');\n    }\n    return this;\n  }\n\n  /**\n   * Adds or removes `disabled` attribute and `disabled` class.\n   *\n   * @param {Object|string|Array} $elements\n   * @param {boolean} [isEnabled=true]\n   * @returns {Object} Chainable\n   */\n  toggleEnabled($elements, isEnabled = true) {\n    $elements = $($elements);\n    if ($elements.length === 0) {\n      return this;\n    }\n    if (!isEnabled) {\n      $elements.attr({\n        'aria-disabled': 'true'\n      }).addClass('is-disabled');\n    } else {\n      $elements.removeAttr('aria-disabled').removeClass('is-disabled');\n    }\n    return this;\n  }\n\n  /**\n   * Toggles tabindexes off and on all tabbable descendants.\n   * @param {Object|string|Array} $element\n   * @param {boolean} isTabbable\n   * @returns {Object} Chainable\n   */\n  toggleTabbableDescendants($element, isTabbable = true) {\n    const $tabbable = this.findTabbable($element);\n    if (!isTabbable) {\n      $tabbable.each((index, element) => {\n        if (element.isAdaptTabHidden) return;\n        const $element = $(element);\n        element.isAdaptTabHidden = true;\n        element.adaptPreviousTabIndex = $element.attr('tabindex') ?? null;\n        $element.attr('tabindex', -1);\n      });\n      return this;\n    }\n    $tabbable.each((index, element) => {\n      if (!element.isAdaptTabHidden) return;\n      const $element = $(element);\n      if (element.adaptPreviousTabIndex === null) $element.removeAttr('tabindex');\n      else $element.attr('tabindex', element.adaptPreviousTabIndex);\n      delete element.isAdaptTabHidden;\n      delete element.adaptPreviousTabIndex;\n    });\n    return this;\n  }\n\n  /**\n   * Find the first tabbable element after the specified element.\n   *\n   * @param {Object|string|Array} $element\n   * @returns {Object}\n   */\n  findFirstTabbable($element) {\n    $element = $($element).first();\n    return this._findFirstForward($element, this.isTabbable);\n  }\n\n  /**\n   * Find the first readable element after the specified element.\n   *\n   * @param {Object|string|Array} $element\n   * @returns {Object}\n   */\n  findFirstReadable($element) {\n    $element = $($element).first();\n    return this._findFirstForward($element, this.isReadable);\n  }\n\n  /**\n   * Find the first focusable element after the specified element.\n   *\n   * @param {Object|string|Array} $element\n   * @returns {Object}\n   */\n  findFirstFocusable($element) {\n    $element = $($element).first();\n    return this._findFirstForward($element, this.isFocusable);\n  }\n\n  /**\n   * Find all tabbable elements in the specified element.\n   *\n   * @param {Object|string|Array} $element\n   * @returns {Object}\n   */\n  findTabbable($element) {\n    const config = this.config;\n    return $($element).find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);\n  }\n\n  /**\n   * Find all readable elements in the specified element.\n   *\n   * @param {Object|string|Array} $element\n   */\n  findReadable($element) {\n    return $($element).find('*').filter((index, element) => this.isReadable(element));\n  }\n\n  /**\n   * Find all focusable elements in the specified element.\n   *\n   * @param {Object|string|Array} $element\n   */\n  findFocusable($element) {\n    return $($element).find('*').filter((index, element) => this.isFocusable(element));\n  }\n\n  /**\n   * Check if the element is natively or explicitly tabbable.\n   *\n   * @param {Object|string|Array} $element\n   * @returns {boolean|undefined}\n   */\n  isTabbable($element) {\n    const config = this.config;\n    const value = $($element).is(config._options._tabbableElements).is(config._options._tabbableElementsExcludes);\n    if (!value) {\n      return null; // Allow _findForward to descend\n    }\n    return value;\n  }\n\n  /**\n   * Check if the first item is readable by a screen reader.\n   *\n   * @param {Object|string|Array} $element\n   * @param {boolean} [checkParents=true] Check if parents are inaccessible.\n   * @returns {boolean}\n   */\n  isReadable($element, checkParents = true) {\n    const config = this.config;\n    $element = $($element).first();\n\n    const $branch = checkParents\n      ? $element.add($element.parents())\n      : $element;\n\n    const isNotVisible = $branch.toArray().some(item => {\n      const $item = $(item);\n      // make sure item is not explicitly invisible\n      return $item.css('display') === 'none' ||\n        $item.css('visibility') === 'hidden' ||\n        $item.attr('aria-hidden') === 'true';\n    });\n    if (isNotVisible) {\n      return false;\n    }\n\n    // check that the component is natively tabbable or\n    // will be knowingly read by a screen reader\n    const hasReadableContent = (!/^\\s*$/.test($element.text()) ||\n      !/^\\s*$/.test($element.attr('aria-label') ?? '') ||\n      !/^\\s*$/.test($element.attr('aria-labelledby') ?? ''));\n    const hasNativeFocusOrIsScreenReadable = ($element.is(config._options._focusableElements) ||\n      $element.is(config._options._readableElements)) && hasReadableContent;\n    if (hasNativeFocusOrIsScreenReadable) {\n      return true;\n    }\n    const childNodes = $element[0].childNodes;\n    for (let c = 0, cl = childNodes.length; c < cl; c++) {\n      const childNode = childNodes[c];\n      const isTextNode = (childNode.nodeType === 3);\n      if (!isTextNode) {\n        continue;\n      }\n      const isOnlyWhiteSpace = /^\\s*$/.test(childNode.nodeValue);\n      if (isOnlyWhiteSpace) {\n        continue;\n      }\n      return true;\n    }\n    return null; // Allows _findForward to decend.\n  }\n\n  /**\n   * Check if the first item is readable by a screen reader.\n   *\n   * @param {Object|string|Array} $element\n   * @param {boolean} [checkParents=true] Check if parents are inaccessible.\n   * @returns {boolean}\n   */\n  isFocusable($element, checkParents = true) {\n    const config = this.config;\n    $element = $($element).first();\n    if (!$element.is(config._options._focusForwardElementsExcludes)) return null;\n    return this.isReadable($element, checkParents);\n  }\n\n  /**\n   * Find forward in the DOM, descending and ascending to move forward\n   * as appropriate.\n   *\n   * If the selector is a function it should returns true, false or undefined.\n   * Returning true matches the item and returns it. Returning false means do\n   * not match or descend into this item, returning undefined means do not match,\n   * but descend into this item.\n   *\n   * @param {Object|string|Array} $element\n   * @param {string|function|undefined} selector\n   * @returns {Object} Returns found descendant.\n   */\n  _findFirstForward($element, selector) {\n    $element = $($element).first();\n\n    // make sure iterator is correct, use boolean or selector comparison\n    // appropriately\n    let iterator;\n    switch (typeof selector) {\n      case 'string':\n        // make selector iterator\n        iterator = function($tag) {\n          return $tag.is(selector) || undefined;\n        };\n        break;\n      case 'function':\n        iterator = selector;\n        break;\n      case 'undefined':\n        // find first next element\n        iterator = Boolean;\n    }\n\n    if ($element.length === 0) {\n      return $element.not('*');\n    }\n\n    // check children by walking the tree\n    let $found = this._findFirstForwardDescendant($element, iterator);\n    if ($found.length) {\n      return $found;\n    }\n\n    // check subsequent siblings\n    $element.nextAll().toArray().some(sibling => {\n      const $sibling = $(sibling);\n      const value = iterator($sibling);\n\n      // skip this sibling if explicitly instructed\n      if (value === false) {\n        return false;\n      }\n\n      if (value) {\n        // sibling matched\n        $found = $sibling;\n        return true;\n      }\n\n      // check parent sibling children by walking the tree\n      $found = this._findFirstForwardDescendant($sibling, iterator);\n      return Boolean($found.length);\n    });\n    if ($found.length) {\n      return $found;\n    }\n\n    // move through parents towards the body element\n    $element.add($element.parents()).toArray().reverse().some(parent => {\n      const $parent = $(parent);\n      if (iterator($parent) === false) {\n        // skip this parent if explicitly instructed\n        return false;\n      }\n\n      // move through parents nextAll siblings\n      return $parent.nextAll().toArray().some(sibling => {\n        const $sibling = $(sibling);\n        const value = iterator($sibling);\n\n        // skip this sibling if explicitly instructed\n        if (value === false) {\n          return false;\n        }\n\n        if (value) {\n          // sibling matched\n          $found = $sibling;\n          return true;\n        }\n\n        // check parent sibling children by walking the tree\n        $found = this._findFirstForwardDescendant($sibling, iterator);\n        return Boolean($found.length);\n      });\n    });\n\n    if (!$found.length) {\n      return $element.not('*');\n    }\n    return $found;\n  }\n\n  /**\n   * Find descendant in a DOM tree, work from selected to branch-end, through allowed\n   * branch structures in hierarchy order\n   *\n   * If the selector is a function it should returns true, false or undefined.\n   * Returning true matches the item and returns it. Returning false means do\n   * not match or descend into this item, returning undefined means do not match,\n   * but descend into this item.\n   *\n   * @param {Object|string|Array} $element jQuery element to start from.\n   * @param {string|function|undefined} selector\n   * @returns {Object} Returns found descendant.\n   */\n  _findFirstForwardDescendant($element, selector) {\n    $element = $($element).first();\n\n    // make sure iterator is correct, use boolean or selector comparison\n    // appropriately\n    let iterator;\n    switch (typeof selector) {\n      case 'string':\n        // make selector iterator\n        iterator = function($tag) {\n          return $tag.is(selector) || undefined;\n        };\n        break;\n      case 'function':\n        iterator = selector;\n        break;\n      case 'undefined':\n        // find first next element\n        iterator = Boolean;\n    }\n\n    const $notFound = $element.not('*');\n    if ($element.length === 0) {\n      return $notFound;\n    }\n\n    // keep walked+passed children in a stack\n    const stack = [{\n      item: $element[0],\n      value: undefined\n    }];\n    let stackIndexPosition = 0;\n    let childIndexPosition = stackIndexPosition + 1;\n    do {\n\n      const stackEntry = stack[stackIndexPosition];\n      const $stackItem = $(stackEntry.item);\n\n      // check current item\n      switch (stackEntry.value) {\n        case true:\n          return $stackItem;\n        case false:\n          return $notFound;\n      }\n\n      // get i stack children\n      $stackItem.children().toArray().forEach(item => {\n        const $item = $(item);\n        const value = iterator($item);\n\n        // item explicitly not allowed, don't add to stack,\n        // skip children\n        if (value === false) {\n          return;\n        }\n\n        // item passed or readable, add to stack before any parent\n        // siblings\n        stack.splice(childIndexPosition++, 0, {\n          item: item,\n          value: value\n        });\n      });\n\n      // move to next stack item\n      stackIndexPosition++;\n      // keep place to inject children\n      childIndexPosition = stackIndexPosition + 1;\n    } while (stackIndexPosition < stack.length);\n\n    return $notFound;\n  }\n\n  /**\n   * Assign focus to the next readable element.\n   *\n   * @param {Object|string|Array} $element\n   * @param {FocusOptions} options\n   * @returns {Object} Chainable\n   */\n  focusNext($element, options) {\n    options = new FocusOptions(options);\n    $element = $($element).first();\n    $element = this.findFirstFocusable($element);\n    this.focus($element, options);\n    return this;\n  }\n\n  /**\n   * Assign focus to either the specified element if it is readable or the\n   * next readable element.\n   *\n   * @param {Object|string|Array} $element\n   * @param {FocusOptions} options\n   * @returns {Object}\n   */\n  focusFirst($element, options) {\n    options = new FocusOptions(options);\n    $element = $($element).first();\n    if (this.isReadable($element)) {\n      this.focus($element, options);\n      return $element;\n    }\n    $element = this.findFirstFocusable($element);\n    this.focus($element, options);\n    return $element;\n  }\n\n  /**\n   * Force focus to the specified element with/without a defer or scroll.\n   *\n   * @param {Object|string|Array} $element\n   * @param {FocusOptions} options\n   * @returns {Object} Chainable\n   */\n  focus($element, options) {\n    options = new FocusOptions(options);\n    $element = $($element).first();\n    const config = this.config;\n    if (!config._isEnabled || !config._options._isFocusAssignmentEnabled || $element.length === 0) {\n      return this;\n    }\n    function perform() {\n      if ($element.attr('tabindex') === undefined) {\n        $element.attr({\n          // JAWS reads better with 0, do not use -1\n          tabindex: '0',\n          'data-a11y-force-focus': 'true'\n        });\n      }\n      if (options.preventScroll) {\n        const y = $(window).scrollTop();\n        try {\n          $element[0].focus({\n            preventScroll: true\n          });\n        } catch (e) {\n          // Drop focus errors as only happens when the element\n          // isn't attached to the DOM.\n        }\n        switch (device.browser) {\n          case 'internet explorer':\n          case 'microsoft edge':\n          case 'safari':\n            // return to previous scroll position due to no support for preventScroll\n            window.scrollTo(null, y);\n        }\n      } else {\n        $element[0].focus();\n      }\n    }\n    if (options.defer) {\n      _.defer(perform);\n    } else {\n      perform();\n    }\n    return this;\n  }\n\n  /**\n   * Used to convert html to text aria-labels.\n   *\n   * @param {string} htmls Any html strings.\n   * @returns {string} Returns text without markup or html encoded characters.\n   */\n  normalize(htmls) {\n    htmls = [...arguments].filter(Boolean).filter(_.isString).join(' ');\n    const text = $('<div>' + htmls + '</div>').text();\n    // Remove all html encoded characters, such as &apos;\n    return text.replace(this._htmlCharRegex, '');\n  }\n\n  /**\n   * Removes all html tags except stylistic elements.\n   * Useful for producing uninterrupted text for screen readers from\n   * any html.\n   *\n   * @param  {string} htmls Any html strings.\n   * @return {string} Returns html string without markup which would cause screen reader to pause.\n   */\n  removeBreaks(htmls) {\n    htmls = [...arguments].filter(Boolean).filter(_.isString).join(' ');\n    const $div = $('<div>' + htmls + '</div>');\n    const stack = [ $div[0] ];\n    let stackIndex = 0;\n    const outputs = [];\n    do {\n      if (stack[stackIndex].childNodes.length) {\n        const nodes = stack[stackIndex].childNodes;\n        const usable = nodes.filter(node => {\n          const isTextNode = (node.nodeType === 3);\n          if (isTextNode) {\n            return true;\n          }\n          const isStyleElement = $(node).is(this.config._options._wrapStyleElements);\n          if (isStyleElement) {\n            return true;\n          }\n          return false;\n        });\n        outputs.push.apply(outputs, usable);\n        stack.push.apply(stack, nodes);\n      }\n      stackIndex++;\n    } while (stackIndex < stack.length);\n    let rtnText = '';\n    outputs.forEach(function(item) {\n      rtnText += item.outerHTML || item.textContent;\n    });\n    return rtnText;\n  }\n\n  /**\n   * @param {Object|string|Array} $elements\n   * @returns {Object} Chainable\n   */\n  scrollEnable($elements) {\n    this._scroll.enable($elements);\n    return this;\n  }\n\n  /**\n   * @param {Object|string|Array} $elements\n   * @returns {Object} Chainable\n   */\n  scrollDisable($elements) {\n    this._scroll.disable($elements);\n    return this;\n  }\n\n  /**\n   * To apply accessibilty handling to a tag, isolating the user.\n   *\n   * @param {Object} $popupElement Element encapsulating the popup.\n   * @returns {Object} Chainable\n   */\n  popupOpened($popupElement) {\n    this._popup.opened($popupElement);\n    return this;\n  }\n\n  /**\n   * Remove the isolation applied with a call to `popupOpened`.\n   *\n   * @param {Object} [$focusElement] Element to move focus to.\n   * @returns {Object} Chainable\n   */\n  popupClosed($focusElement) {\n    this._popup.closed($focusElement);\n    return this;\n  }\n\n  /**\n   * When a popup is open, this function makes it possible to swap the element\n   * that should receive focus on popup close.\n   *\n   * @param {Object} $focusElement Set a new element to focus on.\n   * @returns {Object} Returns previously set focus element.\n   */\n  setPopupCloseTo($focusElement) {\n    return this._popup.setCloseTo($focusElement);\n  }\n\n}\n\nconst a11y = new A11y();\nexport default a11y;\n","import Adapt from 'core/js/adapt';\n\nclass DrawerItemView extends Backbone.View {\n\n  className() {\n    return 'drawer__menu drawer__item';\n  }\n\n  attributes() {\n    return {\n      role: 'listitem'\n    };\n  }\n\n  initialize() {\n    this.listenTo(Adapt, 'drawer:empty', this.remove);\n    this.render();\n  }\n\n  events() {\n    return {\n      'click .drawer__item-btn': 'onDrawerItemClicked'\n    };\n  }\n\n  render() {\n    const data = this.model.toJSON();\n    const template = Handlebars.templates['drawerItem'];\n    $(this.el).html(template(data)).appendTo('.drawer__holder');\n    return this;\n  }\n\n  onDrawerItemClicked(event) {\n    event.preventDefault();\n    const eventCallback = this.model.get('eventCallback');\n    Adapt.trigger(eventCallback);\n  }\n\n}\n\nDrawerItemView.type = 'drawerItem';\n\nexport default DrawerItemView;\n","import Adapt from 'core/js/adapt';\nimport a11y from 'core/js/a11y';\nimport DrawerItemView from 'core/js/views/drawerItemView';\n\nclass DrawerView extends Backbone.View {\n\n  className() {\n    return 'drawer u-display-none';\n  }\n\n  attributes() {\n    return {\n      role: 'dialog',\n      'aria-modal': 'true',\n      'aria-labelledby': 'drawer-heading',\n      'aria-hidden': 'true'\n    };\n  }\n\n  initialize() {\n    this._isVisible = false;\n    this.disableAnimation = Adapt.config.has('_disableAnimation') ? Adapt.config.get('_disableAnimation') : false;\n    this.drawerDir = Adapt.config.get('_defaultDirection') === 'rtl' ? 'left' : 'right';\n    this.drawerDuration = Adapt.config.get('_drawer')?._duration ?? 400;\n    this.setupEventListeners();\n    this.render();\n  }\n\n  setupEventListeners() {\n    this.listenTo(Adapt, {\n      'navigation:toggleDrawer': this.toggleDrawer,\n      'drawer:triggerCustomView': this.openCustomView,\n      'drawer:closeDrawer': this.onCloseDrawer,\n      remove: this.onRemove,\n      'drawer:remove': this.remove\n    });\n\n    this.onKeyUp = this.onKeyUp.bind(this);\n    this.setupEscapeKey();\n  }\n\n  setupEscapeKey() {\n    $(window).on('keyup', this.onKeyUp);\n  }\n\n  onKeyUp(event) {\n    if (event.which !== 27) return;\n    event.preventDefault();\n\n    this.onCloseDrawer();\n  }\n\n  events() {\n    return {\n      'click .drawer__back': 'onBackButtonClicked',\n      'click .drawer__close': 'onCloseClicked'\n    };\n  }\n\n  render() {\n    const template = Handlebars.templates.drawer;\n    $(this.el).html(template({ _globals: Adapt.course.get('_globals') })).prependTo('body');\n    const shadowTemplate = Handlebars.templates.shadow;\n    $(shadowTemplate()).prependTo('body');\n    _.defer(this.postRender.bind(this));\n    return this;\n  }\n\n  postRender() {\n    this.$('a, button, input, select, textarea').attr('tabindex', -1);\n\n    this.checkIfDrawerIsAvailable();\n  }\n\n  openCustomView(view, hasBackButton) {\n    this.$('.js-drawer-holder').removeAttr('role');\n    this._hasBackButton = hasBackButton;\n    this._isCustomViewVisible = true;\n    Adapt.trigger('drawer:empty');\n    this.showDrawer();\n    this.$('.drawer__holder').html(view);\n  }\n\n  checkIfDrawerIsAvailable() {\n    const isEmptyDrawer = (this.collection.length === 0);\n    $('.js-nav-drawer-btn').toggleClass('u-display-none', isEmptyDrawer);\n    if (isEmptyDrawer) {\n      Adapt.trigger('drawer:noItems');\n    }\n  }\n\n  onBackButtonClicked(event) {\n    event.preventDefault();\n    this.showDrawer(true);\n  }\n\n  onCloseClicked(event) {\n    event.preventDefault();\n    this.hideDrawer();\n  }\n\n  onCloseDrawer($toElement) {\n    this.hideDrawer($toElement);\n  }\n\n  onRemove() {\n    this.hideDrawer();\n  }\n\n  toggleDrawer() {\n    if (this._isVisible && this._isCustomViewVisible === false) {\n      this.hideDrawer();\n      return;\n    }\n    this.showDrawer(true);\n  }\n\n  showDrawer(emptyDrawer) {\n    this.$el.removeClass('u-display-none').removeAttr('aria-hidden');\n    // Only trigger popup:opened if drawer is visible, pass popup manager drawer element\n    if (!this._isVisible) {\n      a11y.popupOpened(this.$el);\n      a11y.scrollDisable('body');\n      this._isVisible = true;\n    }\n\n    // Sets tab index to 0 for all tabbable elements in Drawer\n    this.$('a, button, input, select, textarea').attr('tabindex', 0);\n\n    if (emptyDrawer) {\n      this.$('.drawer__back').addClass('u-display-none');\n      this._isCustomViewVisible = false;\n      this.emptyDrawer();\n      if (this.collection.models.length === 1) {\n        // This callback triggers openCustomView() and sets\n        // _isCustomViewVisible to true, causing toggleDrawer()\n        // to re-render the drawer on every toggle button press\n        Adapt.trigger(this.collection.models[0].get('eventCallback'));\n        // Set _isCustomViewVisible to false to prevent re-rendering\n        // the drawer and fix the toggle functionality on toggle button press\n        this._isCustomViewVisible = false;\n      } else {\n        this.renderItems();\n        Adapt.trigger('drawer:openedItemView');\n      }\n    } else {\n      const hideDrawerBackButton = (!this._hasBackButton || this.collection.models.length <= 1);\n      this.$('.drawer__back').toggleClass('u-display-none', hideDrawerBackButton);\n      Adapt.trigger('drawer:openedCustomView');\n    }\n\n    const complete = () => {\n      this.addShadowEvent();\n      Adapt.trigger('drawer:opened');\n\n      // focus on first tabbable element in drawer\n      a11y.focusFirst(this.$el, { defer: true });\n    };\n\n    // delay drawer animation until after background fadeout animation is complete\n    const direction = {};\n    if (this.disableAnimation) {\n      $('.js-shadow').removeClass('u-display-none');\n      $('.js-drawer-holder').scrollTop(0);\n\n      direction[this.drawerDir] = 0;\n      this.$el.css(direction);\n      complete();\n    } else {\n      $('.js-shadow').velocity({ opacity: 1 }, {\n        duration: this.drawerDuration,\n        begin: () => {\n          $('.js-shadow').removeClass('u-display-none');\n          $('.js-drawer-holder').scrollTop(0);\n          complete();\n        }\n      });\n\n      const easing = Adapt.config.get('_drawer')?._showEasing || 'easeOutQuart';\n      direction[this.drawerDir] = 0;\n      this.$el.velocity(direction, this.drawerDuration, easing);\n    }\n\n  }\n\n  emptyDrawer() {\n    this.$('.drawer__holder').empty();\n  }\n\n  renderItems() {\n    Adapt.trigger('drawer:empty');\n    this.emptyDrawer();\n    const isList = (this.collection.length > 1);\n    if (isList) this.$('.js-drawer-holder').attr('role', 'list');\n    else this.$('.js-drawer-holder').removeAttr('role');\n    this.collection.forEach(model => new DrawerItemView({ model }));\n  }\n\n  hideDrawer($toElement) {\n    if (!this._isVisible) return;\n\n    const direction = {};\n    a11y.popupClosed($toElement);\n    this._isVisible = false;\n    a11y.scrollEnable('body');\n\n    if (this.disableAnimation) {\n\n      direction[this.drawerDir] = -this.$el.width();\n      this.$el\n        .css(direction)\n        .addClass('u-display-none')\n        .attr('aria-hidden', 'true');\n\n      $('.js-shadow').addClass('u-display-none');\n      this.$('.js-drawer-holder').removeAttr('role');\n      Adapt.trigger('drawer:closed');\n\n    } else {\n      const easing = Adapt.config.get('_drawer')?._hideEasing || 'easeInQuart';\n\n      direction[this.drawerDir] = -this.$el.width();\n      this.$el.velocity(direction, this.drawerDuration, easing, () => {\n        this.$el\n          .addClass('u-display-none')\n          .attr('aria-hidden', 'true');\n        this.$('.js-drawer-holder').removeAttr('role');\n        Adapt.trigger('drawer:closed');\n      });\n\n      $('.js-shadow').velocity({ opacity: 0 }, {\n        duration: this.drawerDuration,\n        complete() {\n          $('.js-shadow').addClass('u-display-none');\n        }\n      });\n\n    }\n\n    this._isCustomViewVisible = false;\n    this.removeShadowEvent();\n\n  }\n\n  addShadowEvent() {\n    $('.js-shadow').one('click touchstart', () => this.onCloseDrawer());\n  }\n\n  removeShadowEvent() {\n    $('.js-shadow').off('click touchstart');\n  }\n\n  remove() {\n    super.remove();\n    $(window).off('keyup', this.onKeyUp);\n\n    Adapt.trigger('drawer:empty');\n    this.collection.reset();\n    $('.js-shadow').remove();\n  }\n\n}\n\nObject.assign(DrawerView, {\n  childContainer: '.js-drawer-holder',\n  childView: DrawerItemView\n});\n\nexport default DrawerView;\n","import Adapt from 'core/js/adapt';\nimport DrawerView from 'core/js/views/drawerView';\n\nconst DrawerCollection = new Backbone.Collection(null, { comparator: 'drawerOrder' });\nconst Drawer = {};\n\nDrawer.addItem = function(drawerObject, eventCallback) {\n  drawerObject.eventCallback = eventCallback;\n  DrawerCollection.add(drawerObject);\n};\n\nDrawer.triggerCustomView = function(view, hasBackButton) {\n  if (hasBackButton !== false) {\n    hasBackButton = true;\n  }\n  Adapt.trigger('drawer:triggerCustomView', view, hasBackButton);\n};\n\nAdapt.on({\n  'adapt:start'() {\n    new DrawerView({ collection: DrawerCollection });\n  },\n  'app:languageChanged'() {\n    Adapt.trigger('drawer:remove');\n  }\n});\n\nexport default Drawer;\n","import AdaptCollection from 'core/js/collections/adaptCollection';\n\nexport default class AdaptSubsetCollection extends AdaptCollection {\n\n  initialize(models, options) {\n    super.initialize(models, options);\n    this.parent = options.parent;\n    this.listenTo(this.parent, 'reset', this.loadSubset);\n  }\n\n  loadSubset() {\n    this.set(this.parent.filter(model => model instanceof this.model));\n    this._byAdaptID = this.groupBy('_id');\n  }\n\n}\n","export default class ModelEvent extends Backbone.Controller {\n\n  /**\n   * @param {string} type Event name / type\n   * @param {Backbone.Model} target Origin model\n   * @param {*} [value] Any value that should be carried through on the event\n   */\n  initialize(type, target, value) {\n    this.type = type;\n    this.target = target;\n    this.value = value;\n    this.canBubble = true;\n    this.deepPath = [target];\n    this.timeStamp = null;\n  }\n\n  stopPropagation() {\n    this.canBubble = false;\n  }\n\n  addPath(target) {\n    this.deepPath.unshift(target);\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport data from 'core/js/data';\nimport ModelEvent from 'core/js/modelEvent';\nimport LockingModel from 'core/js/models/lockingModel';\nimport logging from 'core/js/logging';\n\nexport default class AdaptModel extends LockingModel {\n\n  toJSON() {\n    // Perform shallow clone\n    const json = { ...this.attributes };\n    // Remove deprecated values as they are not true json\n    delete json._children;\n    delete json._parent;\n    // Perform deep clone\n    return $.extend(true, {}, json);\n  }\n\n  get(name) {\n    switch (name) {\n      case '_parent':\n      case '_children':\n        logging.deprecated('Use model.getChildren() or model.getParent() instead of model.get(\\'_children\\') or model.get(\\'_parent\\')');\n    }\n    return super.get(name);\n  }\n\n  defaults() {\n    return {\n      _canShowFeedback: true,\n      _classes: '',\n      _canReset: true,\n      _canRequestChild: false,\n      _isComplete: false,\n      _isInteractionComplete: false,\n      _isA11yRegionEnabled: false,\n      _isA11yCompletionDescriptionEnabled: true,\n      _requireCompletionOf: -1,\n      _isEnabled: true,\n      _isResetOnRevisit: false,\n      _isAvailable: true,\n      _isOptional: false,\n      _isRendered: false,\n      _isReady: false,\n      _isVisible: true,\n      _isVisited: false,\n      _isLocked: false,\n      _isHidden: false\n    };\n  }\n\n  /**\n   * Fetch an array representing the relative location of the model to the nearest _trackingId\n   * @returns {Array<Number, Number>}\n   */\n  get trackingPosition() {\n    const firstDescendant = this.getAllDescendantModels(false).concat([this])[0];\n    const nearestTrackingIdModel = [firstDescendant].concat(firstDescendant.getAncestorModels()).find(model => model.has('_trackingId'));\n    if (!nearestTrackingIdModel) return;\n    const trackingId = nearestTrackingIdModel.get('_trackingId');\n    let trackingIdDescendants = [nearestTrackingIdModel].concat(nearestTrackingIdModel.getAllDescendantModels(true));\n    trackingIdDescendants = trackingIdDescendants.filter(model => !(model.isTypeGroup('component') && model.get('_isTrackable') === false));\n    const indexInTrackingIdDescendants = trackingIdDescendants.findIndex(descendant => descendant === this);\n    if (indexInTrackingIdDescendants >= 0) {\n      // Is either the nearestTrackingIdModel (0) or one of its flattened descendants (>0)\n      return [ trackingId, indexInTrackingIdDescendants ];\n    }\n    // Is an ancestor of the nearestTrackingIdModel\n    const trackingIdAncestors = nearestTrackingIdModel.getAncestorModels();\n    const ancestorDistance = trackingIdAncestors.findIndex(ancestor => ancestor === this);\n    return [ trackingId, -(ancestorDistance + 1) ];\n  }\n\n  /**\n   * The AAT always sets the value of `_isResetOnRevisit` to a String\n   * which is fine for the 'soft' and 'hard' values - but 'false' needs\n   * converting to Boolean - see #2825\n   */\n  parse(data) {\n    if (data._isResetOnRevisit === 'false') {\n      data._isResetOnRevisit = false;\n    }\n    return data;\n  }\n\n  trackable() {\n    return [\n      '_id',\n      '_isComplete',\n      '_isInteractionComplete',\n      '_isVisited'\n    ];\n  }\n\n  trackableType() {\n    return [\n      String,\n      Boolean,\n      Boolean,\n      Boolean\n    ];\n  }\n\n  bubblingEvents() {\n    return [\n      'change:_isComplete',\n      'change:_isInteractionComplete',\n      'change:_isActive',\n      'change:_isVisited'\n    ];\n  }\n\n  setupModel() {\n    if (this.hasManagedChildren) {\n      this.setupChildListeners();\n    }\n    this.init();\n    _.defer(() => {\n      if (this.hasManagedChildren) {\n        this.checkCompletionStatus();\n        this.checkInteractionCompletionStatus();\n        this.checkLocking();\n        this.checkVisitedStatus();\n      }\n      this.setupTrackables();\n    });\n  }\n\n  setupTrackables() {\n\n    // Limit state trigger calls and make state change callbacks batched-asynchronous\n    const originalTrackableStateFunction = this.triggerTrackableState;\n    this.triggerTrackableState = _.compose(\n      () => {\n\n        // Flag that the function is awaiting trigger\n        this.triggerTrackableState.isQueued = true;\n\n      },\n      _.debounce(() => {\n\n        // Trigger original function\n        originalTrackableStateFunction.apply(this);\n\n        // Unset waiting flag\n        this.triggerTrackableState.isQueued = false;\n\n      }, 17)\n    );\n\n    // Listen to model changes, trigger trackable state change when appropriate\n    this.listenTo(this, 'change', ({ changed }) => {\n\n      // Skip if trigger queued or adapt hasn't started yet\n      if (this.triggerTrackableState.isQueued || !Adapt.attributes._isStarted) {\n        return;\n      }\n\n      // Check that property is trackable\n      const trackablePropertyNames = _.result(this, 'trackable', []);\n      const changedPropertyNames = Object.keys(changed);\n      const isTrackable = changedPropertyNames.find(item => {\n        return trackablePropertyNames.includes(item);\n      });\n\n      if (isTrackable) {\n        // Trigger trackable state change\n        this.triggerTrackableState();\n      }\n    });\n  }\n\n  setupChildListeners() {\n    const children = this.getChildren();\n    if (!children.length) {\n      return;\n    }\n\n    this.listenTo(children, {\n      all: this.onAll,\n      bubble: this.bubble,\n      'change:_isVisited': this.checkVisitedStatus,\n      'change:_isReady': this.checkReadyStatus,\n      'change:_isComplete': this.onIsComplete,\n      'change:_isInteractionComplete': this.checkInteractionCompletionStatus\n    });\n  }\n\n  init() {}\n\n  getTrackableState() {\n\n    const trackable = this.resultExtend('trackable', []);\n    const json = this.toJSON();\n\n    const args = trackable;\n    args.unshift(json);\n\n    return _.pick(...args);\n\n  }\n\n  setTrackableState(state) {\n\n    const trackable = this.resultExtend('trackable', []);\n\n    const args = trackable;\n    args.unshift(state);\n\n    state = _.pick(...args);\n\n    this.set(state);\n\n    return this;\n\n  }\n\n  triggerTrackableState() {\n\n    Adapt.trigger('state:change', this, this.getTrackableState());\n\n  }\n\n  /**\n   * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\n   * @param {boolean} [canReset] Defaults to this.get('_canReset')\n   * @returns {boolean}\n   */\n  reset(type = 'hard', canReset = this.get('_canReset')) {\n    if (!canReset) return false;\n    switch (type) {\n      case 'hard':\n      case true:\n        this.set({\n          _isEnabled: true,\n          _isComplete: false,\n          _isInteractionComplete: false\n        });\n        return true;\n      case 'soft':\n        this.set({\n          _isEnabled: true,\n          _isInteractionComplete: false\n        });\n        return true;\n    }\n    return false;\n  }\n\n  /**\n   * Checks if any child models which have been _isRendered are not _isReady.\n   * If all rendered child models are marked ready then this model will be\n   * marked _isReady: true as well.\n   * @param {AdaptModel} [model]\n   * @param {boolean} [value]\n   * @returns {boolean}\n   */\n  checkReadyStatus(model, value) {\n    if (value === false) {\n      // Do not respond to _isReady: false as _isReady is unset throughout\n      // the rendering process\n      return false;\n    }\n    // Filter children based upon whether they are available\n    // Check if any _isRendered: true children return _isReady: false\n    // If not - set this model to _isReady: true\n    const children = this.getAvailableChildModels();\n    if (children.find(child => child.get('_isReady') === false && child.get('_isRendered'))) {\n      return false;\n    }\n\n    this.set('_isReady', true);\n    return true;\n  }\n\n  setReadyStatus() {\n    this.set('_isReady', true);\n  }\n\n  checkVisitedStatus() {\n    const children = this.getAvailableChildModels();\n    const isVisited = children.some(child => child.get('_isVisited') || child.get('_isComplete') || child.get('_isInteractionComplete'));\n    if (isVisited) this.set('_isVisited', true);\n    return isVisited;\n  }\n\n  setVisitedStatus() {\n    if (!this.get('_isReady') || !this.get('_isRendered')) return;\n    this.set('_isVisited', true);\n  }\n\n  setCompletionStatus() {\n    if (!this.get('_isVisible')) return;\n\n    this.set({\n      _isComplete: true,\n      _isInteractionComplete: true,\n      _isVisited: true\n    });\n  }\n\n  checkCompletionStatus() {\n    // defer to allow other change:_isComplete handlers to fire before cascading to parent\n    Adapt.checkingCompletion();\n    _.defer(this.checkCompletionStatusFor.bind(this), '_isComplete');\n  }\n\n  checkInteractionCompletionStatus() {\n    // defer to allow other change:_isInteractionComplete handlers to fire before cascading to parent\n    Adapt.checkingCompletion();\n    _.defer(this.checkCompletionStatusFor.bind(this), '_isInteractionComplete');\n  }\n\n  /**\n   * Function for checking whether the supplied completion attribute should be set to true or false.\n   * It iterates over our immediate children, checking the same completion attribute on any mandatory child\n   * to see if enough/all of them them have been completed. If enough/all have, we set our attribute to true;\n   * if not, we set it to false.\n   * @param {string} [completionAttribute] Either '_isComplete' or '_isInteractionComplete'. Defaults to '_isComplete' if not supplied.\n   */\n\n  checkCompletionStatusFor(completionAttribute = '_isComplete') {\n    let completed = false;\n    const children = this.getAvailableChildModels();\n    const requireCompletionOf = this.get('_requireCompletionOf');\n\n    if (requireCompletionOf === -1) { // a value of -1 indicates that ALL mandatory children must be completed\n      completed = children.every(child => {\n        return child.get(completionAttribute) || child.get('_isOptional');\n      });\n    } else {\n      completed = (children.filter(child => {\n        return child.get(completionAttribute) && !child.get('_isOptional');\n      }).length >= requireCompletionOf);\n    }\n\n    this.set(completionAttribute, completed);\n\n    Adapt.checkedCompletion();\n  }\n\n  /**\n   * Returns a string describing the type group of this model.\n   * Strings should be lowercase and not plurlaized.\n   * i.e. 'page', 'menu', 'contentobject', 'component', 'article', 'block'\n   * Override in inheritance chain.\n   * @returns {string}\n   */\n  getTypeGroup() {}\n\n  /**\n   * Returns true if this model is of the type group described.\n   * Automatically manages pluralization typeGroup and matches lowercase only.\n   * Pluralized typeGroups and uppercase characters in typeGroups are discouraged.\n   * @param {string} type Type group name i.e. course, contentobject, article, block, component\n   * @returns {boolean}\n   */\n  isTypeGroup(typeGroup) {\n    const hasUpperCase = /[A-Z]+/.test(typeGroup);\n    const isPluralized = typeGroup.slice(-1) === 's';\n    const lowerCased = typeGroup.toLowerCase();\n    const singular = isPluralized && lowerCased.slice(0, -1); // remove pluralization if ending in s\n    const singularLowerCased = (singular || lowerCased).toLowerCase();\n    if (isPluralized || hasUpperCase) {\n      logging.deprecated(`'${typeGroup}' appears pluralized or contains uppercase characters, suggest using the singular, lowercase type group '${singularLowerCased}'.`);\n    }\n    const pluralizedLowerCaseTypes = [\n      singularLowerCased,\n      !isPluralized && `${lowerCased}s` // pluralize if not ending in s\n    ].filter(Boolean);\n    const typeGroups = this.getTypeGroups();\n    if (_.intersection(pluralizedLowerCaseTypes, typeGroups).length) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns an array of strings describing the model type groups.\n   * All strings are lowercase and should not be pluralized.\n   * i.e. ['course', 'menu', 'contentobject'], ['page', 'contentobject'], ['component']\n   * @returns {[string]}\n   */\n  getTypeGroups() {\n    if (this._typeGroups) return this._typeGroups;\n    const typeGroups = [ this.get('_type') ];\n    let parentClass = this;\n    while ((parentClass = Object.getPrototypeOf(parentClass))) {\n      if (!Object.prototype.hasOwnProperty.call(parentClass, 'getTypeGroup')) continue;\n      typeGroups.push(parentClass.getTypeGroup.call(this));\n    }\n    return (this._typeGroups = _.uniq(typeGroups.filter(Boolean).map(s => s.toLowerCase())));\n  }\n\n  /**\n   * Searches the model's ancestors to find the first instance of the specified ancestor type\n   * @param {string} [ancestorType] Valid values are 'course', 'pages', 'contentObjects', 'articles' or 'blocks'.\n   * If left blank, the immediate ancestor (if there is one) is returned\n   * @return {object} Reference to the model of the first ancestor of the specified type that's found - or `undefined` if none found\n   */\n  findAncestor(ancestorType) {\n    const parent = this.getParent();\n    if (!parent) return;\n    if (!ancestorType || parent.isTypeGroup(ancestorType)) {\n      return parent;\n    }\n    return parent.findAncestor(ancestorType);\n  }\n\n  /**\n   * Returns all the descendant models of a specific type\n   * @param {string} descendants Valid values are 'contentobject', 'page', 'menu', 'article', 'block', 'component', 'question'\n   * @param {object} options an object that defines the search type and the properties/values to search on. Currently only the `where` search type (equivalent to `Backbone.Collection.where()`) is supported.\n   * @param {object} options.where\n   * @return {array}\n   * @example\n   * //find all available, non-optional components\n   * this.findDescendantModels('component', { where: { _isAvailable: true, _isOptional: false }});\n   */\n  findDescendantModels(descendants, options) {\n    const allDescendantsModels = this.getAllDescendantModels();\n    const returnedDescendants = allDescendantsModels.filter(model => {\n      return model.isTypeGroup(descendants);\n    });\n\n    if (!options) {\n      return returnedDescendants;\n    }\n\n    if (options.where) {\n      return returnedDescendants.filter(descendant => {\n        for (const property in options.where) {\n          const value = options.where[property];\n          if (descendant.get(property) !== value) {\n            return false;\n          }\n        }\n        return true;\n      });\n    }\n  }\n\n  /**\n   * Fetches the sub structure of a model as a flattened array\n   *\n   * Such that the tree:\n   *  { a1: { b1: [ c1, c2 ], b2: [ c3, c4 ] }, a2: { b3: [ c5, c6 ] } }\n   *\n   * will become the array (parent first = false):\n   *  [ c1, c2, b1, c3, c4, b2, a1, c5, c6, b3, a2 ]\n   *\n   * or (parent first = true):\n   *  [ a1, b1, c1, c2, b2, c3, c4, a2, b3, c5, c6 ]\n   *\n   * This is useful when sequential operations are performed on the menu/page/article/block/component hierarchy.\n   * @param {boolean} [isParentFirst]\n   * @return {array}\n   */\n  getAllDescendantModels(isParentFirst) {\n\n    const descendants = [];\n\n    if (!this.hasManagedChildren) {\n      return descendants;\n    }\n\n    const children = this.getChildren();\n\n    children.models.forEach(child => {\n\n      if (!child.hasManagedChildren) {\n        descendants.push(child);\n        return;\n      }\n\n      const subDescendants = child.getAllDescendantModels(isParentFirst);\n      if (isParentFirst === true) {\n        descendants.push(child);\n      }\n\n      descendants.push(...subDescendants);\n\n      if (isParentFirst !== true) {\n        descendants.push(child);\n      }\n    });\n\n    return descendants;\n\n  }\n\n  /**\n   * Returns a relative model from the Adapt hierarchy\n   *\n   * Such that in the tree:\n   *  { a1: { b1: [ c1, c2 ], b2: [ c3, c4 ] }, a2: { b3: [ c5, c6 ] } }\n   *\n   *  c1.findRelativeModel('@block+1') = b2;\n   *  c1.findRelativeModel('@component+4') = c5;\n   *  c1.findRelativeModel('@article+1 @component=-1') = c6;\n   *\n   * @see Adapt.parseRelativeString for a description of relativeStrings\n   * @param {string} relativeString\n   * @param {object} options Search configuration settings\n   * @param {boolean} options.limitParentId Constrain to a parent\n   * @param {function} options.filter Model filter\n   * @param {boolean} options.loop Allow offsets and insets to loop around to the beginning\n   * @return {array}\n   */\n  findRelativeModel(relativeString, options = {}) {\n    if (!relativeString) return this;\n\n    let relativeDescriptorObjects = Adapt.parseRelativeString(relativeString);\n    if (!Array.isArray(relativeDescriptorObjects)) relativeDescriptorObjects = [relativeDescriptorObjects];\n\n    const find = ({ type, offset, inset }) => {\n      const isInset = (inset !== null);\n      const isOffset = (offset !== null);\n      const rootModel = options.limitParentId\n        ? data.findById(options.limitParentId)\n        : isInset\n          ? this // For insets, the default parent constraint is this model\n          : Adapt.course; // For offsets, the default parent constraint is the course\n\n      const increment = isOffset\n        ? offset\n        : inset;\n\n      const searchBackwards = (increment < 0);\n      let moveBy = Math.abs(increment);\n      let movementCount = 0;\n\n      const hasDescendantsOfType = Boolean(this.findDescendantModels(type).length);\n      if (isInset && !hasDescendantsOfType) return undefined;\n      if (isOffset && hasDescendantsOfType) {\n        // Move by one less as first found is considered next.\n        // Should find descendants on either side but not inside.\n        moveBy--;\n      }\n      if (isInset && searchBackwards) {\n        // Move by one less as -1 should act like the last, -2 second from last\n        moveBy--;\n      }\n\n      const searchDescendants = searchBackwards\n        // Parents first [p1,a1,b1,c1,c2,a2,b2,c3,c4,p2,a3,b3,c6,c7,a4,b4,c8,c9]\n        // Reverse so that we don't need a forward and a backward iterating loop\n        // Reversed [c9,c8,b4,a4,c7,c6,b3,a3,p2,c4,c3,b2,a2,c2,c1,b1,a1,p1]\n        ? [rootModel, ...rootModel.getAllDescendantModels(true)].reverse()\n        // Children first [c1,c2,b1,a1,c3,c4,b2,a2,p1,c6,c7,b3,a3,c8,c9,b4,a4,p2]\n        : [...rootModel.getAllDescendantModels(false), rootModel];\n\n      const modelId = this.get('_id');\n      // Find the index of this model in the searchDescendants array\n      const searchFromIndex = isInset\n        ? 0 // On inset, this model will always be the first model in searchDescendants\n        : searchDescendants.findIndex(searchDescendant => (searchDescendant.get('_id') === modelId));\n\n      const hasFilterFunction = (typeof options.filter === 'function');\n\n      // Normalize the moveBy position to allow for overflow looping\n      if (options.loop) {\n        const totalOfType = searchDescendants.reduce((count, model) => {\n          if (!model.isTypeGroup(type)) return count;\n          return ++count;\n        }, 0);\n        // Take the remainder of moveBy after removing whole units of the type count\n        moveBy = moveBy % totalOfType;\n        // Double up the searchDescendant entries to allow for overflow looping\n        searchDescendants.push(...searchDescendants.slice(0));\n      }\n\n      for (let i = searchFromIndex, l = searchDescendants.length; i < l; i++) {\n        const descendant = searchDescendants[i];\n        if (!descendant.isTypeGroup(type)) continue;\n        const isSelf = (i === searchFromIndex);\n        // https://github.com/adaptlearning/adapt_framework/issues/3031\n        if (!isSelf && hasFilterFunction && !options.filter(descendant)) continue;\n        if (movementCount > moveBy) {\n          // There is no descendant which matches this relativeString\n          // Probably looking for a descendant +/-0\n          break;\n        }\n        if (movementCount === moveBy) {\n          return descendant;\n        }\n        movementCount++;\n      }\n    };\n\n    // Join the remaining descriptors together to pass to the next model\n    const nextDescriptor = relativeDescriptorObjects\n      .slice(1)\n      .reduce((output, { type, offset, inset }) => {\n        const isInset = (inset !== null);\n        const isOffset = (offset !== null);\n        if (isOffset) return `${output}@${type}${offset < 0 ? offset : `+${offset}`}`;\n        if (isInset) return `${output}@${type}=${inset}`;\n        return `${output}@${type}`;\n      }, '');\n\n    const foundModel = find(relativeDescriptorObjects[0]);\n    if (nextDescriptor) {\n      // Perform the lookup of the next descriptor on the found model\n      // Defer to that model as it may have overridden the findRelativeModel function\n      return foundModel?.findRelativeModel(nextDescriptor);\n    }\n    return foundModel;\n  }\n\n  get hasManagedChildren() {\n    return true;\n  }\n\n  getChildren() {\n    if (this._childrenCollection) {\n      return this._childrenCollection;\n    }\n\n    let childrenCollection;\n\n    if (!this.hasManagedChildren) {\n      childrenCollection = new Backbone.Collection();\n    } else {\n      const id = this.get('_id');\n      // Look up child by _parentId from data\n      const children = data.filter(model => model.get('_parentId') === id);\n      childrenCollection = new Backbone.Collection(children);\n    }\n\n    if (this.get('_type') === 'block' &&\n      childrenCollection.length === 2 &&\n      childrenCollection.models[0].get('_layout') !== 'left') {\n      // Components may have a 'left' or 'right' _layout,\n      // so ensure they appear in the correct order\n      // Re-order component models to correct it\n      childrenCollection.comparator = '_layout';\n      childrenCollection.sort();\n    }\n\n    this.setChildren(childrenCollection);\n    return this._childrenCollection;\n  }\n\n  setChildren(children) {\n    this._childrenCollection = children;\n    // Setup deprecated reference\n    this.set('_children', children);\n  }\n\n  getAvailableChildModels() {\n    return this.getChildren().where({\n      _isAvailable: true\n    });\n  }\n\n  getParent() {\n    if (this._parentModel) {\n      return this._parentModel;\n    }\n    const parentId = this.get('_parentId');\n    if (!parentId) return;\n    // Look up parent by id from data\n    this.setParent(data.findById(parentId));\n    return this._parentModel;\n  }\n\n  setParent(parent) {\n    this._parentModel = parent;\n    this.set('_parentId', this._parentModel.get('_id'));\n    // Set up deprecated reference\n    this.set('_parent', this._parentModel);\n  }\n\n  getAncestorModels(shouldIncludeChild) {\n    const parents = [];\n    let context = this;\n\n    if (shouldIncludeChild) parents.push(context);\n\n    while (context.has('_parentId')) {\n      context = context.getParent();\n      parents.push(context);\n    }\n\n    return parents.length ? parents : null;\n  }\n\n  getSiblings(passSiblingsAndIncludeSelf) {\n    const id = this.get('_id');\n    const parentId = this.get('_parentId');\n    let siblings;\n    if (!passSiblingsAndIncludeSelf) {\n      // returns a collection of siblings excluding self\n      if (this._hasSiblingsAndSelf === false) {\n        return this.get('_siblings');\n      }\n      siblings = data.filter(model => {\n        return model.get('_parentId') === parentId &&\n          model.get('_id') !== id;\n      });\n\n      this._hasSiblingsAndSelf = false;\n\n    } else {\n      // returns a collection of siblings including self\n      if (this._hasSiblingsAndSelf) {\n        return this.get('_siblings');\n      }\n\n      siblings = data.filter(model => {\n        return model.get('_parentId') === parentId;\n      });\n      this._hasSiblingsAndSelf = true;\n    }\n\n    const siblingsCollection = new Backbone.Collection(siblings);\n    this.set('_siblings', siblingsCollection);\n    return siblingsCollection;\n  }\n\n  /**\n   * @param  {string} key\n   * @param  {any} value\n   * @param  {Object} options\n   */\n  setOnChildren(...args) {\n\n    this.set(...args);\n\n    if (!this.hasManagedChildren) return;\n\n    const children = this.getChildren();\n    children.models.forEach(child => child.setOnChildren(...args));\n\n  }\n\n  /**\n   * @deprecated since v3.2.3 - please use `model.set('_isOptional', value)` instead\n   */\n  setOptional(value) {\n    logging.deprecated('Use model.set(\\'_isOptional\\', value) as setOptional() may be removed in the future');\n    this.set({ _isOptional: value });\n  }\n\n  checkLocking() {\n    const lockType = this.get('_lockType');\n\n    if (!lockType) return;\n\n    switch (lockType) {\n      case 'sequential':\n        this.setSequentialLocking();\n        break;\n      case 'unlockFirst':\n        this.setUnlockFirstLocking();\n        break;\n      case 'lockLast':\n        this.setLockLastLocking();\n        break;\n      case 'custom':\n        this.setCustomLocking();\n        break;\n      default:\n        console.warn(`AdaptModel.checkLocking: unknown _lockType '${lockType}' found on ${this.get('_id')}`);\n    }\n  }\n\n  setSequentialLocking() {\n    const children = this.getAvailableChildModels();\n    // Start from second child\n    children.slice(1).forEach((child, index) => {\n      const previousChild = children[index];\n      // If previous was locked, all subsequent will be locked.\n      const isLockedByPreviousChild = previousChild.get('_isLocked') ||\n        (\n          !previousChild.get('_isComplete') &&\n          !previousChild.get('_isOptional')\n        );\n      child.set('_isLocked', isLockedByPreviousChild);\n    }, false);\n  }\n\n  setUnlockFirstLocking() {\n    const children = this.getAvailableChildModels();\n    const firstChild = children.shift();\n    const isLockedByFirstChild = (!firstChild.get('_isComplete') && !firstChild.get('_isOptional'));\n    children.forEach(child => child.set('_isLocked', isLockedByFirstChild));\n  }\n\n  setLockLastLocking() {\n    const children = this.getAvailableChildModels();\n    const lastChild = children.pop();\n    const isLockedByChildren = children.some(child => (!child.get('_isComplete') && !child.get('_isOptional')));\n    lastChild.set('_isLocked', isLockedByChildren);\n  }\n\n  setCustomLocking() {\n    const children = this.getAvailableChildModels();\n    children.forEach(child => child.set('_isLocked', this.shouldLock(child)));\n  }\n\n  shouldLock(child) {\n    const lockedBy = child.get('_lockedBy');\n    if (!lockedBy) return false;\n    return lockedBy.some(id => {\n      try {\n        const anotherModel = data.findById(id);\n        return anotherModel.get('_isAvailable') &&\n          (\n            anotherModel.get('_isLocked') ||\n            (\n              !anotherModel.get('_isComplete') &&\n              !anotherModel.get('_isOptional')\n            )\n          );\n      } catch (e) {\n        console.warn(`AdaptModel.shouldLock: unknown _lockedBy ID '${id}' found on ${child.get('_id')}`);\n        return false;\n      }\n    });\n  }\n\n  onIsComplete() {\n    this.checkCompletionStatus();\n\n    this.checkLocking();\n  }\n\n  /**\n   * Used before a model is rendered to determine if it should be reset to its\n   * default values.\n   */\n  checkIfResetOnRevisit() {\n    const isResetOnRevisit = this.get('_isResetOnRevisit');\n    this.reset(isResetOnRevisit);\n  }\n\n  /**\n   * Clones this model and all managed children returning a new branch.\n   * Assign new unique ids to each cloned model.\n   * @param {Function} [modifier] A callback function for each child to allow for custom modifications\n   * @returns {AdaptModel}\n   */\n  deepClone(modifier = null) {\n    // Fetch the class\n    const ModelClass = this.constructor;\n    // Clone the model\n    const clonedModel = new ModelClass(this.toJSON());\n    // Run the custom modifier on the clone\n    if (modifier) {\n      modifier(clonedModel, this);\n    }\n    let clonedId = clonedModel.get('_id');\n    const hasId = Boolean(clonedId);\n    const shouldAssignUniqueId = (this.get('_id') === clonedId);\n    if (hasId && shouldAssignUniqueId) {\n      // Create a unique id if none was set by the modifier\n      const cid = _.uniqueId(ModelClass.prototype.cidPrefix || 'c');\n      clonedId = `${clonedId}_${cid}`;\n      clonedModel.set('_id', clonedId);\n    }\n    // Add the cloned model to data for data.findById resolution\n    if (hasId) {\n      data.add(clonedModel);\n    }\n    // Clone any children\n    if (this.hasManagedChildren) {\n      this.getChildren().each(child => {\n        if (!child.deepClone) {\n          throw new Error('Cannot deepClone child.');\n        }\n        child.deepClone((clone, child) => {\n          if (hasId) {\n            // Set the cloned child parent id\n            clone.set('_parentId', clonedId);\n          }\n          if (modifier) {\n            // Run the custom modifier function on the cloned child\n            modifier(clone, child);\n          }\n        });\n      });\n    }\n    // Add the cloned model to its parent for model.findDescendants resolution\n    clonedModel.getParent().getChildren().add(clonedModel);\n    // Setup the cloned model after setting the id, the parent and adding any children\n    clonedModel.setupModel();\n    return clonedModel;\n  }\n\n  /**\n   * Internal event handler for all module events. Triggers event bubbling\n   * through the module hierarchy when the event is included in\n   * `this.bubblingEvents`.\n   * @param {string} type Event name / type\n   * @param {Backbone.Model} model Origin backbone model\n   * @param {*} value New property value\n   */\n  onAll(type, model, value) {\n    if (!_.result(this, 'bubblingEvents').includes(type)) return;\n    const event = new ModelEvent(type, model, value);\n    this.bubble(event);\n  }\n\n  /**\n   * Internal event handler for bubbling events.\n   * @param {ModelEvent} event\n   */\n  bubble(event) {\n    if (!event.canBubble) return;\n    event.addPath(this);\n    this.trigger(`bubble:${event.type} bubble`, event);\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport logging from 'core/js/logging';\nimport AdaptModel from 'core/js/models/adaptModel';\n\nexport default class ContentObjectModel extends AdaptModel {\n\n  get _parent() {\n    logging.deprecated('contentObjectModel._parent, use contentObjectModel.getParent() instead, parent models are defined by the JSON');\n    const isParentCourse = (this.get('_parentId') === Adapt.course.get('_id'));\n    if (isParentCourse) {\n      return 'course';\n    }\n    return 'contentObjects';\n  }\n\n  get _siblings() {\n    logging.deprecated('contentObjectModel._siblings, use contentObjectModel.getSiblings() instead, sibling models are defined by the JSON');\n    return 'contentObjects';\n  }\n\n  get _children() {\n    logging.deprecated('contentObjectModel._children, use contentObjectModel.hasManagedChildren instead, child models are defined by the JSON');\n    return null;\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'contentobject';\n  }\n\n}\n","import components from 'core/js/components';\nimport logging from 'core/js/logging';\nimport AdaptModel from 'core/js/models/adaptModel';\n\nclass ArticleModel extends AdaptModel {\n\n  get _parent() {\n    logging.deprecated('articleModel._parent, use articleModel.getParent() instead, parent models are defined by the JSON');\n    return 'contentObjects';\n  }\n\n  get _siblings() {\n    logging.deprecated('articleModel._siblings, use articleModel.getSiblings() instead, sibling models are defined by the JSON');\n    return 'articles';\n  }\n\n  get _children() {\n    logging.deprecated('articleModel._children, use articleModel.hasManagedChildren instead, child models are defined by the JSON');\n    return 'blocks';\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'article';\n  }\n\n}\n\ncomponents.register('article', { model: ArticleModel });\n\nexport default ArticleModel;\n","import components from 'core/js/components';\nimport logging from 'core/js/logging';\nimport AdaptModel from 'core/js/models/adaptModel';\n\nclass BlockModel extends AdaptModel {\n\n  get _parent() {\n    logging.deprecated('blockModel._parent, use blockModel.getParent() instead, parent models are defined by the JSON');\n    return 'articles';\n  }\n\n  get _siblings() {\n    logging.deprecated('blockModel._siblings, use blockModel.getSiblings() instead, sibling models are defined by the JSON');\n    return 'blocks';\n  }\n\n  get _children() {\n    logging.deprecated('blockModel._children, use blockModel.hasManagedChildren instead, child models are defined by the JSON');\n    return 'components';\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'block';\n  }\n\n}\n\ncomponents.register('block', { model: BlockModel });\n\nexport default BlockModel;\n","import components from 'core/js/components';\nimport Adapt from 'core/js/adapt';\nimport logging from 'core/js/logging';\nimport AdaptModel from 'core/js/models/adaptModel';\n\nclass ComponentModel extends AdaptModel {\n\n  get _parent() {\n    logging.deprecated('componentModel._parent, use componentModel.getParent() instead, parent models are defined by the JSON');\n    return 'blocks';\n  }\n\n  get _siblings() {\n    logging.deprecated('componentModel._siblings, use componentModel.getSiblings() instead, sibling models are defined by the JSON');\n    return 'components';\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'component';\n  }\n\n  defaults() {\n    return AdaptModel.resultExtend('defaults', {\n      _isA11yComponentDescriptionEnabled: true,\n      _shouldStoreAttempts: true,\n      _userAnswer: null,\n      _attemptStates: null\n    });\n  }\n\n  trackable() {\n    return AdaptModel.resultExtend('trackable', [\n      '_userAnswer',\n      '_attemptStates'\n    ]);\n  }\n\n  trackableType() {\n    return AdaptModel.resultExtend('trackableType', [\n      Array,\n      Array\n    ]);\n  }\n\n  get hasManagedChildren() {\n    return false;\n  }\n\n  init() {\n    if (Adapt.get('_isStarted')) {\n      this.onAdaptInitialize();\n      return;\n    }\n    this.listenToOnce(Adapt, 'adapt:initialize', this.onAdaptInitialize);\n  }\n\n  onAdaptInitialize() {\n    this.restoreUserAnswers();\n  }\n\n  /**\n   * Restore the user's answer from the _userAnswer property.\n   * The _userAnswer value must be in the form of arrays containing\n   * numbers, booleans or arrays only.\n   */\n  restoreUserAnswers() {}\n\n  /**\n   * Store the user's answer in the _userAnswer property.\n   * The _userAnswer value must be in the form of arrays containing\n   * numbers, booleans or arrays only.\n   */\n  storeUserAnswer() {}\n\n  resetUserAnswer() {\n    this.set('_userAnswer', null);\n  }\n\n  /**\n   * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\n   * @param {boolean} [canReset] Defaults to this.get('_canReset')\n   * @returns {boolean}\n   */\n  reset(type = 'hard', canReset = this.get('_canReset')) {\n    const wasReset = super.reset(type, canReset);\n    if (!wasReset) return false;\n    this.resetUserAnswer();\n    return true;\n  }\n\n  /**\n   * Returns the current attempt state raw data or the raw data from the supplied attempt state object.\n   * @param {Object} [object] JSON object representing the component state. Defaults to current JSON.\n   * @returns {Array}\n   */\n  getAttemptState(object = this.toJSON()) {\n    const trackables = this.trackable();\n    const types = this.trackableType();\n    trackables.find((name, index) => {\n      // Exclude _attemptStates as it's trackable but isn't needed here\n      if (name !== '_attemptStates') return false;\n      trackables.splice(index, 1);\n      types.splice(index, 1);\n      return true;\n    });\n    const values = trackables.map(n => object[n]);\n    const booleans = values.filter((v, i) => types[i] === Boolean).map(Boolean);\n    const numbers = values.filter((v, i) => types[i] === Number).map(v => Number(v) || 0);\n    const arrays = values.filter((v, i) => types[i] === Array);\n    return [\n      numbers,\n      booleans,\n      arrays\n    ];\n  }\n\n  /**\n   * Returns an attempt object representing the current state or a formatted version of the raw state object supplied.\n   * @param {Array} [state] JSON object representing the component state, defaults to current state returned from getAttemptState().\n   * @returns {Object}\n   */\n  getAttemptObject(state = this.getAttemptState()) {\n    const trackables = this.trackable();\n    const types = this.trackableType();\n    trackables.find((name, index) => {\n      // Exclude _attemptStates as it's trackable but isn't needed here\n      if (name !== '_attemptStates') return false;\n      trackables.splice(index, 1);\n      types.splice(index, 1);\n      return true;\n    });\n    const numbers = (state[0] || []).slice(0);\n    const booleans = (state[1] || []).slice(0);\n    const arrays = (state[2] || []).slice(0);\n    const object = {};\n    trackables.forEach((n, i) => {\n      if (n === '_id') return;\n      switch (types[i]) {\n        case Number:\n          object[n] = numbers.shift();\n          break;\n        case Boolean:\n          object[n] = booleans.shift();\n          break;\n        case Array:\n          object[n] = arrays.shift();\n          break;\n      }\n    });\n    return object;\n  }\n\n  /**\n   * Sets the current attempt state from the supplied attempt state object.\n   * @param {Object} object JSON object representing the component state.\n   * @param {boolean} silent Stops change events from triggering\n   */\n  setAttemptObject(object, silent = true) {\n    this.set(object, { silent });\n  }\n\n  /**\n   * Adds the current attempt state object or the supplied state object to the attempts store.\n   * @param {Object} [object] JSON object representing the component state. Defaults to current JSON.\n   */\n  addAttemptObject(object = this.getAttemptObject()) {\n    const attemptStates = this.get('_attemptStates') || [];\n    const state = this.getAttemptState(object);\n    attemptStates.push(state);\n    this.set('_attemptStates', attemptStates);\n  }\n\n  /**\n   * Returns an array of the previous state objects. The most recent state is last in the list.\n   * @returns {Array}\n   */\n  getAttemptObjects() {\n    const states = this.get('_attemptStates') || [];\n    return states.map(state => this.getAttemptObject(state));\n  }\n\n}\n\n// This abstract model needs to registered to support deprecated view-only components\ncomponents.register('component', { model: ComponentModel });\n\nexport default ComponentModel;\n","import components from 'core/js/components';\nimport logging from 'core/js/logging';\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\n\nclass MenuModel extends ContentObjectModel {\n\n  get _children() {\n    logging.deprecated('menuModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON');\n    return 'contentObjects';\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'menu';\n  }\n\n  setCustomLocking() {\n    const children = this.getAvailableChildModels();\n    children.forEach(child => {\n      child.set('_isLocked', this.shouldLock(child));\n      if (!(child instanceof MenuModel)) return;\n      child.checkLocking();\n    });\n  }\n\n}\n\ncomponents.register('menu', { model: MenuModel });\n\nexport default MenuModel;\n","import components from 'core/js/components';\nimport logging from 'core/js/logging';\nimport MenuModel from 'core/js/models/menuModel';\n\nclass CourseModel extends MenuModel {\n\n  get _parent() {\n    logging.deprecated('courseModel._parent, use courseModel.getParent() instead, parent models are defined by the JSON');\n    return null;\n  }\n\n  get _siblings() {\n    logging.deprecated('courseModel._siblings, use courseModel.getSiblings() instead, sibling models are defined by the JSON');\n    return null;\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'course';\n  }\n\n}\n\ncomponents.register('course', { model: CourseModel });\n\nexport default CourseModel;\n","import components from 'core/js/components';\nimport logging from 'core/js/logging';\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\n\nclass PageModel extends ContentObjectModel {\n\n  get _children() {\n    logging.deprecated('pageModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON');\n    return 'articles';\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'page';\n  }\n\n}\n\ncomponents.register('page', { model: PageModel });\n\nexport default PageModel;\n","import logging from 'core/js/logging';\n\n/**\n * Event object triggered for controlling child view rendering.\n * Sent with 'view:addChild' and 'view:requestChild' events.\n * All plugins receive the same object reference in their event handler and\n * as such, this object becomes a place of consensus for plugins to decide how\n * to handle rendering for this child.\n */\nexport default class ChildEvent extends Backbone.Controller {\n\n  /**\n   * @param {string} type Event type\n   * @param {AdaptView} target Parent view\n   * @param {AdaptModel} model Child model\n   */\n  initialize(type, target, model) {\n    /** @type {string} */\n    this.type = type;\n    /** @type {AdaptView} */\n    this.target = target;\n    /** @type {boolean} Force the child model to render */\n    this.isForced = false;\n    /** @type {boolean} Stop rendering before the child model */\n    this.isStoppedImmediate = false;\n    /** @type {boolean} Stop rendering after the child model */\n    this.isStoppedNext = false;\n    /** @type {boolean} Contains a model to render in response to a requestChild event */\n    this.hasRequestChild = false;\n    this._model = model;\n  }\n\n  /**\n   * Get the model to be rendered.\n   * @returns {AdaptModel}\n   */\n  get model() {\n    return this._model;\n  }\n\n  /**\n   * Set the model to render in response to a 'view:requestChild' event.\n   * @param {AdaptModel}\n   */\n  set model(model) {\n    if (this.type !== 'requestChild') {\n      logging.warn(`Cannot change model in ${this.type} event.`);\n      return;\n    }\n    if (this._model) {\n      logging.warn(`Cannot inject two models in one sitting. ${model.get('_id')} attempts to overwrite ${this._model.get('_id')}`);\n      return;\n    }\n    this._model = model;\n    this.hasRequestChild = true;\n  }\n\n  /**\n   * Reset all render stops.\n   */\n  reset() {\n    this.isStoppedImmediate = false;\n    this.isStoppedNext = false;\n  }\n\n  /**\n   * Force model to render.\n   */\n  force() {\n    this.isForced = true;\n  }\n\n  /**\n   * General stop. Stop immediately or stop next with flag to false.\n   * @param {boolean} [immediate=true] Flag to stop immediate or next.\n   */\n  stop(immediate = true) {\n    if (!immediate) {\n      return this.stopNext();\n    }\n    this.isStoppedImmediate = true;\n  }\n\n  /**\n   * Shortcut to stop(false). Stop the render after the contained model is rendered.\n   */\n  stopNext() {\n    this.isStoppedNext = true;\n  }\n\n  /**\n   * Trigger an event to signify that a final decision has been reached.\n   */\n  close() {\n    this.trigger('closed');\n  }\n\n}\n","export default class TemplateRenderEvent extends Backbone.Controller {\n\n  /**\n   * Template render event\n   * @param {string} type Event type\n   * @param {string} name Template name\n   * @param {string} mode \"template\" / \"partial\"\n   * @param {string} value Rendered template string\n   * @param {[*]} args Arguments passed to template for render\n   */\n  initialize(type, name, mode, value, args) {\n    /** @type {string} Event type */\n    this.type = type;\n    /** @type {string} Template name */\n    this.name = name;\n    /** @type {string} \"template\" / \"partial\" */\n    this.mode = mode;\n    /** @type {string} Rendered template string */\n    this.value = value;\n    /** @type {[*]} Arguments passed to template for render */\n    this.args = args;\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport TemplateRenderEvent from 'core/js/templateRenderEvent';\nimport React from 'react';\nimport logging from 'core/js/logging';\n\n/**\n * Used by babel plugin babel-plugin-transform-react-templates to inject react templates\n */\nexport default function register(name, component) {\n  templates[name] = (...args) => {\n    // Trap render calls to emit preRender and postRender events\n    const mode = 'reactTemplate';\n    // Send preRender event to allow modification of args\n    const preRenderEvent = new TemplateRenderEvent(`${mode}:preRender`, name, mode, null, args);\n    Adapt.trigger(preRenderEvent.type, preRenderEvent);\n    // Execute template\n    const value = component(...preRenderEvent.args);\n    // Send postRender event to allow modification of rendered template\n    const postRenderEvent = new TemplateRenderEvent(`${mode}:postRender`, name, mode, value, preRenderEvent.args);\n    Adapt.trigger(postRenderEvent.type, postRenderEvent);\n    // Return rendered, modified template\n    return postRenderEvent.value;\n  };\n};\n\n/**\n * Override React.createElement to allow trapping and modification of react\n * template elements.\n */\n(function () {\n  const original = React.createElement;\n  React.createElement = (...args) => {\n    const name = args[0];\n    // Trap render calls to emit preRender and postRender events\n    const mode = 'reactElement';\n    // Send preRender event to allow modification of args\n    const preRenderEvent = new TemplateRenderEvent(`${mode}:preRender`, name, mode, null, args);\n    Adapt.trigger(preRenderEvent.type, preRenderEvent);\n    // Execute element creation\n    const value = original(...preRenderEvent.args);\n    // Send postRender event to allow modification of rendered element\n    const postRenderEvent = new TemplateRenderEvent(`${mode}:postRender`, name, mode, value, preRenderEvent.args);\n    Adapt.trigger(postRenderEvent.type, postRenderEvent);\n    // Return rendered, modified element\n    return postRenderEvent.value;\n  };\n})();\n\n/**\n * Storage for react templates\n */\nexport const templates = {};\n\n/**\n * Convert html strings to react dom, equivalent to handlebars {{{html}}}\n * @param {string} html\n * @deprecated since v6.0.4, please use react dangerouslySetInnerHTML instead: https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml\n */\nexport function html(html) {\n  if (!html) return;\n  logging.deprecated('reactHelpers.html please use react dangerouslySetInnerHTML instead: https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml');\n  return { __html: html };\n}\n\n/**\n * Handlebars compile integration\n * @param {string} name Handlebars template\n * @param {...any} args Template arguments\n */\nexport function compile(template, ...args) {\n  const output = Handlebars.compile(template)(...args);\n  return output;\n};\n\n/**\n * Handlebars partials integration\n * @param {string} name Partial name\n * @param {...any} args Partial arguments\n */\nexport function partial(name, ...args) {\n  const output = Handlebars.partials[name](...args);\n  return output;\n};\n\n/**\n * Handlebars helpers integration\n * @param {string} name Helper name\n * @param {...any} args Helper arguments\n */\nexport function helper(name, ...args) {\n  const output = Handlebars.helpers[name].call(args[0]);\n  return (output && output.string) || output;\n};\n\n/**\n * Helper for a list of classes, filtering out falsies and duplicates, and joining with spaces\n * @param  {...any} args List or arrays of classes\n */\nexport function classes(...args) {\n  return _.uniq(_.flatten(args).filter(Boolean).join(' ').split(' ')).join(' ');\n};\n\n/**\n * Helper for prefixing a list of classes, filtering out falsies and duplicates and joining with spaces\n * @param  {[...string]} prefixes Array of class prefixes\n * @param  {...any} args List or arrays of classes\n */\nexport function prefixClasses(prefixes, ...args) {\n  const classes = _.flatten(args).filter(Boolean);\n  const prefixed = _.flatten(prefixes.map(prefix => classes.map(className => `${prefix}${className}`)));\n  return _.uniq(prefixed.join(' ').split(' ')).join(' ');\n};\n","import Adapt from 'core/js/adapt';\nimport wait from 'core/js/wait';\nimport components from 'core/js/components';\nimport ChildEvent from 'core/js/childEvent';\nimport { templates } from 'core/js/reactHelpers';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport location from 'core/js/location';\nimport logging from 'core/js/logging';\n\nclass AdaptView extends Backbone.View {\n\n  attributes() {\n    return {\n      'data-adapt-id': this.model.get('_id')\n    };\n  }\n\n  initialize() {\n    this.listenTo(this.model, {\n      'change:_isVisible': this.toggleVisibility,\n      'change:_isHidden': this.toggleHidden,\n      'change:_isComplete': this.onIsCompleteChange\n    });\n    this.isJSX = (this.constructor.template || '').includes('.jsx');\n    if (this.isJSX) {\n      this._classSet = new Set(_.result(this, 'className').trim().split(/\\s+/));\n      this.listenTo(this.model, 'all', this.changed);\n      const children = this.model?.getChildren?.();\n      children && this.listenTo(children, 'all', this.changed);\n      // Facilitate adaptive react views\n      this.listenTo(Adapt, 'device:changed', this.changed);\n    }\n    this.model.set({\n      _globals: Adapt.course.get('_globals'),\n      _isReady: false\n    });\n    this._isRemoved = false;\n\n    if (location._currentId === this.model.get('_id')) {\n      Adapt.parentView = this;\n    }\n\n    this.preRender();\n    this.render();\n    this.setupOnScreenHandler();\n  }\n\n  preRender() {}\n\n  async postRender() {\n    await this.addChildren();\n  }\n\n  render() {\n    const type = this.constructor.type;\n    Adapt.trigger(`${type}View:preRender view:preRender`, this);\n\n    if (this.isJSX) {\n      this.changed();\n    } else {\n      const data = this.model.toJSON();\n      data.view = this;\n      const template = Handlebars.templates[this.constructor.template];\n      this.$el.html(template(data));\n    }\n\n    Adapt.trigger(`${type}View:render view:render`, this);\n\n    _.defer(async () => {\n      // don't call postRender after remove\n      if (this._isRemoved) return;\n\n      await this.postRender();\n      Adapt.trigger(`${type}View:postRender view:postRender`, this);\n    });\n\n    return this;\n  }\n\n  /**\n   * Re-render a react template\n   * @param {string} eventName=null Backbone change event name\n   */\n  changed(eventName = null) {\n    if (!this.isJSX) {\n      throw new Error('Cannot call changed on a non-react view');\n    }\n    if (typeof eventName === 'string' && eventName.startsWith('bubble')) {\n      // Ignore bubbling events as they are outside of this view's scope\n      return;\n    }\n    const props = {\n      // Add view own properties, bound functions etc\n      ...this,\n      // Add model json data\n      ...this.model.toJSON(),\n      // Add globals\n      _globals: Adapt.course.get('_globals')\n    };\n    const Template = templates[this.constructor.template.replace('.jsx', '')];\n    this.updateViewProperties();\n    ReactDOM.render(<Template {...props} />, this.el);\n  }\n\n  updateViewProperties() {\n    const classesToAdd = _.result(this, 'className').trim().split(/\\s+/);\n    classesToAdd.forEach(i => this._classSet.add(i));\n    const classesToRemove = [ ...this._classSet ].filter(i => !classesToAdd.includes(i));\n    classesToRemove.forEach(i => this._classSet.delete(i));\n    this._setAttributes({ ..._.result(this, 'attributes'), id: _.result(this, 'id') });\n    this.$el.removeClass(classesToRemove).addClass(classesToAdd);\n  }\n\n  setupOnScreenHandler() {\n    const onscreen = this.model.get('_onScreen');\n\n    if (!onscreen?._isEnabled) return;\n\n    this.$el.addClass(`has-animation ${onscreen._classes}-before`);\n    this.$el.on('onscreen.adaptView', (e, m) => {\n      if (!m.onscreen) return;\n      const minVerticalInview = onscreen._percentInviewVertical || 33;\n      if (m.percentInviewVertical < minVerticalInview) return;\n      this.$el.addClass(`${onscreen._classes}-after`).off('onscreen.adaptView');\n    });\n  }\n\n  /**\n   * Add children and descendant views, first-child-first. Wait until all possible\n   * views are added before resolving asynchronously.\n   * Will trigger 'view:addChild'(ChildEvent), 'view:requestChild'(ChildEvent)\n   * and 'view:childAdded'(ParentView, ChildView) accordingly.\n   * @returns {number} Count of views added\n   */\n  async addChildren() {\n    this.nthChild = this.nthChild || 0;\n    // Check descendants first\n    let addedCount = await this.addDescendants(false);\n    // Iterate through existing available children and/or request new children\n    // if required and allowed\n    while (true) {\n      const models = this.model.getAvailableChildModels();\n      const event = this._getAddChildEvent(models[this.nthChild]);\n      if (!event) {\n        break;\n      }\n      if (event.isForced) {\n        event.reset();\n      }\n      if (event.isStoppedImmediate || !event.model) {\n        // If addChild has been stopped before it is added then\n        // set all subsequent models and their children as not rendered\n        const subsequentModels = models.slice(this.nthChild);\n        subsequentModels.forEach(model => model.setOnChildren('_isRendered', false));\n        break;\n      }\n      // Set model state\n      const model = event.model;\n      model.set({\n        _isRendered: true,\n        _nthChild: ++this.nthChild\n      });\n      // Create child view\n      const ChildView = this.constructor.childView || components.getViewClass(model);\n      if (!ChildView) {\n        throw new Error(`The component '${model.attributes._id}' ('${model.attributes._component}') has not been installed, and so is not available in your project.`);\n      }\n      const childView = new ChildView({ model });\n      this.addChildView(childView);\n      addedCount++;\n      if (event.isStoppedNext) {\n        break;\n      }\n    }\n\n    if (!addedCount) {\n      return addedCount;\n    }\n\n    // Children were added, unset _isReady\n    this.model.set('_isReady', false);\n    return addedCount;\n  }\n\n  /**\n   * Child views can be added with '_renderPosition': 'outer-append' or\n   * 'inner-append' (default). Each child view will trigger a\n   * 'view:childAdded'(ParentView, ChildView) event and be added to the\n   * this.getChildViews() array on this parent.\n   * @param {AdaptView} childView\n   * @returns {AdaptView} Returns this childView\n   */\n  addChildView(childView) {\n    const childViews = this.getChildViews() || [];\n    childViews.push(childView);\n    this.setChildViews(childViews);\n    const $parentContainer = this.$(this.constructor.childContainer);\n    switch (childView.model.get('_renderPosition')) {\n      case 'outer-append':\n        // Useful for trickle buttons, inline feedback etc\n        this.$el.append(childView.$el);\n        break;\n      case 'inner-append':\n      default:\n        $parentContainer.append(childView.$el);\n        break;\n    }\n    // Signify that a child has been added to the view to enable updates to status bars\n    Adapt.trigger('view:childAdded', this, childView);\n    return childView;\n  }\n\n  /**\n   * Iterates through existing childViews and runs addChildren on them, resolving\n   * the total count of views added asynchronously.\n   * @returns {number} Count of views added\n   */\n  async addDescendants() {\n    let addedDescendantCount = 0;\n    const childViews = this.getChildViews();\n    if (!childViews) {\n      return addedDescendantCount;\n    }\n    for (let i = 0, l = childViews.length; i < l; i++) {\n      const view = childViews[i];\n      addedDescendantCount = view.addChildren ? await view.addChildren() : 0;\n      if (addedDescendantCount) {\n        break;\n      }\n    }\n    if (!addedDescendantCount) {\n      this.model.checkReadyStatus();\n      return addedDescendantCount;\n    }\n    // Descendants were added, unset _isReady\n    this.model.set('_isReady', false);\n    return addedDescendantCount;\n  }\n\n  /**\n   * Resolves after outstanding asynchronous view additions are finished\n   * and ready.\n   */\n  async whenReady() {\n    if (this.model.get('_isReady')) return;\n    return new Promise(resolve => {\n      const onReadyChange = (model, value) => {\n        if (!value) return;\n        this.stopListening(this.model, 'change:_isReady', onReadyChange);\n        resolve();\n      };\n      this.listenTo(this.model, 'change:_isReady', onReadyChange);\n      this.model.checkReadyStatus();\n    });\n  }\n\n  /**\n   * Triggers and returns a new ChildEvent object for render control.\n   * This function is used by addChildren to manage event triggering.\n   * @param {AdaptModel} model\n   * @returns {ChildEvent}\n   */\n  _getAddChildEvent(model) {\n    const isRequestChild = (!model);\n    const event = new ChildEvent(null, this, model);\n    if (isRequestChild) {\n      // No model has been supplied, we are at the end of the available child list\n      const canRequestChild = this.model.get('_canRequestChild');\n      if (!canRequestChild) {\n        // This model cannot request children\n        return;\n      }\n      event.type = 'requestChild';\n      // Send a request asking for a new model\n      Adapt.trigger('view:requestChild', event);\n      if (!event.hasRequestChild) {\n        // No new model was supplied\n        // Close the event so that the final state can be scrutinized\n        event.close();\n        return;\n      }\n      // A new model has been supplied for the end of the list.\n    }\n    // Trigger an event to signify that a new model is to be added\n    event.type = 'addChild';\n    Adapt.trigger('view:addChild', event);\n    // Close the event so that the final state can be scrutinized\n    event.close();\n    return event;\n  }\n\n  /**\n   * Return an array of all child and descendant views.\n   * @param {boolean} [isParentFirst=false] Array returns with parents before children\n   * @returns {[AdaptView]}\n   */\n  findDescendantViews(isParentFirst) {\n    const descendants = [];\n    const childViews = this.getChildViews();\n    childViews?.forEach(view => {\n      if (isParentFirst) descendants.push(view);\n      const children = view.findDescendantViews?.(isParentFirst);\n      if (children) descendants.push(...children);\n      if (!isParentFirst) descendants.push(view);\n    });\n    return descendants;\n  }\n\n  setReadyStatus() {\n    this.model.setReadyStatus();\n  }\n\n  setCompletionStatus() {\n    this.model.setCompletionStatus();\n  }\n\n  resetCompletionStatus(type) {\n    if (!this.model.get('_canReset')) return;\n\n    const descendantComponents = this.model.findDescendantModels('component');\n    if (descendantComponents.length === 0) {\n      this.model.reset(type);\n    } else {\n      descendantComponents.forEach(model => model.reset(type));\n    }\n  }\n\n  preRemove() {\n    const type = this.constructor.type;\n    Adapt.trigger(`${type}View:preRemove view:preRemove`, this);\n  }\n\n  remove() {\n    const type = this.constructor.type;\n    this.preRemove();\n    Adapt.trigger(`${type}View:remove view:remove`, this);\n    this._isRemoved = true;\n    this.stopListening();\n\n    wait.for(end => {\n      if (this.isJSX) {\n        ReactDOM.unmountComponentAtNode(this.el);\n      }\n      this.$el.off('onscreen.adaptView');\n      super.remove();\n      _.defer(() => {\n        Adapt.trigger(`${type}View:postRemove view:postRemove`, this);\n      });\n      end();\n    });\n\n    return this;\n  }\n\n  setVisibility() {\n    return this.model.get('_isVisible') ? '' : 'u-visibility-hidden';\n  }\n\n  toggleVisibility() {\n    this.$el.toggleClass('u-visibility-hidden', !this.model.get('_isVisible'));\n  }\n\n  setHidden() {\n    return this.model.get('_isHidden') ? 'u-display-none' : '';\n  }\n\n  toggleHidden() {\n    this.$el.toggleClass('u-display-none', this.model.get('_isHidden'));\n  }\n\n  onIsCompleteChange(model, isComplete) {\n    this.$el.toggleClass('is-complete', isComplete);\n  }\n\n  /**\n   * @returns {[AdaptView]}\n   */\n  getChildViews() {\n    if (!this._childViews) return this._childViews;\n    // Allow both a deprecated id/view map or a new array of child views\n    return Object.entries(this._childViews).map(([key, value]) => value);\n  }\n\n  /**\n   * @param {[AdaptView]} value\n   */\n  setChildViews(value) {\n    this._childViews = value;\n  }\n\n  /**\n   * Returns an indexed by id list of child views.\n   * @deprecated since 5.7.0\n   * @returns {{<string, AdaptView}}\n   */\n  get childViews() {\n    logging.deprecated('view.childViews use view.getChildViews() and view.setChildViews([])');\n    if (Array.isArray(this._childViews)) {\n      return _.indexBy(this._childViews, view => view.model.get('_id'));\n    }\n    return this._childViews;\n  }\n\n  /**\n   * Sets an indexed by id list of child views.\n   * @deprecated since 5.7.0\n   */\n  set childViews(value) {\n    logging.deprecated('view.childViews use view.getChildViews() and view.setChildViews([])');\n    this.setChildViews(value);\n  }\n\n}\n\nAdaptView.className = '';\n\nexport default AdaptView;\n","import Adapt from 'core/js/adapt';\nimport wait from 'core/js/wait';\nimport AdaptView from 'core/js/views/adaptView';\nimport ReactDOM from 'react-dom';\nimport data from 'core/js/data';\n\nexport default class ContentObjectView extends AdaptView {\n\n  attributes() {\n    return AdaptView.resultExtend('attributes', {\n      role: 'main'\n    }, this);\n  }\n\n  className() {\n    return [\n      this.constructor.type,\n      'contentobject',\n      this.constructor.className,\n      this.model.get('_id'),\n      this.model.get('_classes'),\n      this.setVisibility(),\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\n      (this.model.get('_isOptional') ? 'is-optional' : '')\n    ].filter(Boolean).join(' ');\n  }\n\n  preRender() {\n    $.inview.lock(this.constructor.type + 'View');\n    this.disableAnimation = Adapt.config.has('_disableAnimation') ? Adapt.config.get('_disableAnimation') : false;\n    this.$el.css('opacity', 0);\n    this.listenTo(this.model, 'change:_isReady', this.isReady);\n    this._loadingErrorTimeout = setTimeout(() => data.logReadyError(this), 10000);\n  }\n\n  render() {\n    const type = this.constructor.type;\n    Adapt.trigger(`${type}View:preRender contentObjectView:preRender view:preRender`, this);\n\n    if (this.isReact) {\n      this.changed();\n    } else {\n      const data = this.model.toJSON();\n      data.view = this;\n      const template = Handlebars.templates[this.constructor.template];\n      this.$el.html(template(data));\n    }\n\n    Adapt.trigger(`${type}View:render contentObjectView:render view:render`, this);\n\n    _.defer(() => {\n      // don't call postRender after remove\n      if (this._isRemoved) return;\n\n      this.postRender();\n      Adapt.trigger(`${type}View:postRender contentObjectView:postRender view:postRender`, this);\n    });\n\n    return this;\n  }\n\n  async isReady() {\n    if (!this.model.get('_isReady') || this._isTriggeredReady) return;\n    this._isTriggeredReady = true;\n    clearTimeout(this._loadingErrorTimeout);\n    delete this._loadingErrorTimeout;\n    const type = this.constructor.type;\n    const performIsReady = async () => {\n      Adapt.trigger(`${type}View:preReady contentObjectView:preReady view:preReady`, this);\n      await wait.queue();\n      $('.js-loading').hide();\n      if (Adapt.get('_shouldContentObjectScrollTop') !== false) {\n        $(window).scrollTop(0);\n      }\n      Adapt.trigger(`${type}View:ready contentObjectView:ready view:ready`, this);\n      $.inview.unlock(`${type}View`);\n      const styleOptions = { opacity: 1 };\n      if (this.disableAnimation) {\n        this.$el.css(styleOptions);\n        $.inview();\n        _.defer(() => {\n          Adapt.trigger(`${type}View:postReady contentObjectView:postReady view:postReady`, this);\n        });\n      } else {\n        this.$el.velocity(styleOptions, {\n          duration: 'fast',\n          complete: () => {\n            $.inview();\n            Adapt.trigger(`${type}View:postReady contentObjectView:postReady view:postReady`, this);\n          }\n        });\n      }\n      $(window).scroll();\n    };\n\n    _.defer(performIsReady);\n  }\n\n  /**\n   * Force render up to specified id. Resolves when views are ready.\n   * @param {string} id\n   */\n  async renderTo(id) {\n    const isRenderToSelf = (id === this.model.get('_id'));\n    if (isRenderToSelf) return;\n    let models = this.model.getAllDescendantModels(true).filter(model => model.get('_isAvailable'));\n    const index = models.findIndex(model => model.get('_id') === id);\n    if (index === -1) {\n      throw new Error(`Cannot renderTo \"${id}\" as it isn't a descendant.`);\n    }\n    // Return early if the model is already rendered and ready\n    const model = models[index];\n    if (model.get('_isRendered') && model.get('_isReady')) {\n      return;\n    }\n    // Force all models up until the id to render\n    models = models.slice(0, index + 1);\n    const isLocked = models.some(model => model.get('_isLocked'));\n    if (isLocked) throw new Error(`Cannot renderTo ${id} as it is preceded by locked content`);\n    const ids = _.indexBy(models, (model) => model.get('_id'));\n    const forceUntilId = (event) => {\n      const addingId = event.model.get('_id');\n      if (!ids[addingId]) return;\n      event.force();\n      if (addingId !== id) return;\n      Adapt.off('view:addChild', forceUntilId);\n    };\n    Adapt.on('view:addChild', forceUntilId);\n    // Trigger addChildren cascade\n    await this.addChildren();\n    await this.whenReady();\n    // Error if model isn't rendered and ready\n    if (!model.get('_isRendered') || !model.get('_isReady')) {\n      throw new Error(`Cannot renderTo \"${id}\".`);\n    }\n  }\n\n  preRemove() {\n    const type = this.constructor.type;\n    Adapt.trigger(`${type}View:preRemove contentObjectView:preRemove view:preRemove`, this);\n  }\n\n  remove() {\n    const type = this.constructor.type;\n    this.preRemove();\n    Adapt.trigger(`${type}View:remove contentObjectView:remove view:remove`, this);\n    this._isRemoved = true;\n\n    wait.for(end => {\n      if (this.isReact) {\n        ReactDOM.unmountComponentAtNode(this.el);\n      }\n      this.$el.off('onscreen.adaptView');\n      this.findDescendantViews().reverse().forEach(view => {\n        view.remove();\n      });\n      this.setChildViews(null);\n      super.remove();\n      _.defer(() => {\n        Adapt.trigger(`${type}View:postRemove contentObjectView:postRemove view:postRemove`, this);\n        this.trigger('postRemove');\n      });\n      end();\n    });\n\n    return this;\n  }\n\n  destroy() {\n    this.remove();\n    if (Adapt.parentView === this) {\n      Adapt.parentView = null;\n    }\n  }\n\n}\n","import components from 'core/js/components';\nimport ContentObjectView from 'core/js/views/contentObjectView';\n\nclass PageView extends ContentObjectView {\n\n  remove() {\n    if (this.$pageLabel) {\n      this.$pageLabel.remove();\n    }\n    super.remove();\n  }\n\n}\n\nObject.assign(PageView, {\n  childContainer: '.article__container',\n  type: 'page',\n  template: 'page'\n});\n\ncomponents.register('page', { view: PageView });\n\nexport default PageView;\n","import components from 'core/js/components';\nimport AdaptView from 'core/js/views/adaptView';\n\nclass ArticleView extends AdaptView {\n\n  className() {\n    return [\n      'article',\n      this.model.get('_id'),\n      this.model.get('_classes'),\n      this.setVisibility(),\n      this.setHidden(),\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\n      (this.model.get('_isOptional') ? 'is-optional' : '')\n    ].join(' ');\n  }\n\n}\n\nObject.assign(ArticleView, {\n  childContainer: '.block__container',\n  type: 'article',\n  template: 'article'\n});\n\ncomponents.register('article', { view: ArticleView });\n\nexport default ArticleView;\n","import components from 'core/js/components';\nimport AdaptView from 'core/js/views/adaptView';\n\nclass BlockView extends AdaptView {\n\n  className() {\n    return [\n      'block',\n      this.model.get('_id'),\n      this.model.get('_classes'),\n      this.setVisibility(),\n      this.setHidden(),\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\n      (this.model.get('_isOptional') ? 'is-optional' : '')\n    ].join(' ');\n  }\n\n}\n\nObject.assign(BlockView, {\n  childContainer: '.component__container',\n  type: 'block',\n  template: 'block'\n});\n\ncomponents.register('block', { view: BlockView });\n\nexport default BlockView;\n","import Adapt from 'core/js/adapt';\nimport wait from 'core/js/wait';\nimport Data from 'core/js/data';\nimport AdaptSubsetCollection from 'core/js/collections/adaptSubsetCollection';\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\nimport ArticleModel from 'core/js/models/articleModel';\nimport BlockModel from 'core/js/models/blockModel';\nimport ComponentModel from 'core/js/models/componentModel';\n\nimport 'core/js/models/courseModel';\nimport 'core/js/models/menuModel';\nimport 'core/js/models/pageModel';\nimport 'core/js/views/pageView';\nimport 'core/js/views/articleView';\nimport 'core/js/views/blockView';\n\nclass MPABC extends Backbone.Controller {\n\n  initialize() {\n    // Example of how to cause the data loader to wait for another module to setup\n    this.listenTo(Data, {\n      loading: this.waitForDataLoaded,\n      loaded: this.onDataLoaded\n    });\n    this.setupSubsetCollections();\n  }\n\n  waitForDataLoaded() {\n    // Tell the data loader to wait\n    wait.begin();\n  }\n\n  onDataLoaded() {\n    // Tell the data loader that we have finished\n    wait.end();\n  }\n\n  setupSubsetCollections() {\n    Adapt.contentObjects = new AdaptSubsetCollection(null, { parent: Data, model: ContentObjectModel });\n    Adapt.articles = new AdaptSubsetCollection(null, { parent: Data, model: ArticleModel });\n    Adapt.blocks = new AdaptSubsetCollection(null, { parent: Data, model: BlockModel });\n    Adapt.components = new AdaptSubsetCollection(null, { parent: Data, model: ComponentModel });\n  }\n\n}\n\nconst mpabc = new MPABC();\nexport default mpabc;\n","import Adapt from 'core/js/adapt';\n\nexport default class NotifyPushView extends Backbone.View {\n\n  className() {\n    let classes = 'notify-push ';\n    classes += (this.model.get('_classes') || '');\n    return classes;\n  }\n\n  attributes() {\n    return {\n      role: 'dialog',\n      'aria-labelledby': 'notify-push-heading',\n      'aria-modal': 'false'\n    };\n  }\n\n  initialize() {\n    this.listenTo(Adapt, {\n      'notify:pushShown notify:pushRemoved': this.updateIndexPosition,\n      remove: this.remove\n    });\n\n    this.listenTo(this.model.collection, {\n      remove: this.updateIndexPosition,\n      'change:_index': this.updatePushPosition\n    });\n\n    this.preRender();\n    this.render();\n  }\n\n  events() {\n    return {\n      'click .js-notify-push-close-btn': 'closePush',\n      'click .js-notify-push-inner': 'triggerEvent'\n    };\n  }\n\n  preRender() {\n    this.hasBeenRemoved = false;\n  }\n\n  render() {\n    const data = this.model.toJSON();\n    const template = Handlebars.templates.notifyPush;\n    this.$el.html(template(data)).appendTo('.notify__push-container');\n\n    _.defer(this.postRender.bind(this));\n\n    return this;\n  }\n\n  postRender() {\n    this.$el.addClass('is-active');\n\n    _.delay(this.closePush.bind(this), this.model.get('_timeout'));\n\n    Adapt.trigger('notify:pushShown');\n  }\n\n  closePush(event) {\n    if (event) {\n      event.preventDefault();\n    }\n\n    // Check whether this view has been removed as the delay can cause it to be fired twice\n    if (this.hasBeenRemoved === false) {\n\n      this.hasBeenRemoved = true;\n\n      this.$el.removeClass('is-active');\n\n      _.delay(() => {\n        this.model.collection.remove(this.model);\n        Adapt.trigger('notify:pushRemoved', this);\n        this.remove();\n      }, 600);\n    }\n  }\n\n  triggerEvent(event) {\n    Adapt.trigger(this.model.get('_callbackEvent'));\n    this.closePush();\n  }\n\n  updateIndexPosition() {\n    if (this.hasBeenRemoved) return;\n    const models = this.model.collection.models;\n    models.forEach((model, index) => {\n      if (!model.get('_isActive')) return;\n      model.set('_index', index);\n      this.updatePushPosition();\n    });\n  }\n\n  updatePushPosition() {\n    if (this.hasBeenRemoved) {\n      return;\n    }\n\n    if (typeof this.model.get('_index') !== 'undefined') {\n      const elementHeight = this.$el.height();\n      const offset = 20;\n      const navigationHeight = $('.nav').height();\n      const currentIndex = this.model.get('_index');\n      let flippedIndex = (currentIndex === 0) ? 1 : 0;\n\n      if (this.model.collection.where({ _isActive: true }).length === 1) {\n        flippedIndex = 0;\n      }\n\n      const positionLowerPush = (elementHeight + offset) * flippedIndex + navigationHeight + offset;\n      this.$el.css('top', positionLowerPush);\n    }\n  }\n}\n","import LockingModel from 'core/js/models/lockingModel';\n\nexport default class NotifyModel extends LockingModel {\n\n  defaults() {\n    return {\n      _isActive: false,\n      _showIcon: false,\n      _timeout: 3000\n    };\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport NotifyPushView from 'core/js/views/notifyPushView';\nimport NotifyModel from 'core/js/models/notifyModel';\n\n// Build a collection to store push notifications\nexport default class NotifyPushCollection extends Backbone.Collection {\n\n  initialize() {\n    this.model = NotifyModel;\n    this.listenTo(this, 'add', this.onPushAdded);\n    this.listenTo(Adapt, 'notify:pushRemoved', this.onRemovePush);\n  }\n\n  onPushAdded(model) {\n    this.checkPushCanShow(model);\n  }\n\n  checkPushCanShow(model) {\n    if (!this.canShowPush()) return;\n    model.set('_isActive', true);\n    this.showPush(model);\n  }\n\n  canShowPush() {\n    const availablePushNotifications = this.where({ _isActive: true });\n    return (availablePushNotifications.length < 2);\n  }\n\n  showPush(model) {\n    new NotifyPushView({\n      model: model\n    });\n  }\n\n  onRemovePush(view) {\n    const inactivePushNotifications = this.where({ _isActive: false });\n    if (inactivePushNotifications.length > 0) {\n      this.checkPushCanShow(inactivePushNotifications[0]);\n    }\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport components from 'core/js/components';\nimport data from 'core/js/data';\nimport a11y from 'core/js/a11y';\nimport AdaptView from 'core/js/views/adaptView';\nimport Backbone from 'backbone';\n\nexport default class NotifyPopupView extends Backbone.View {\n\n  className() {\n    return `notify ${this.model.get('_classes') || ''}`;\n  }\n\n  attributes() {\n    return Object.assign({\n      role: 'dialog',\n      'aria-labelledby': 'notify-heading',\n      'aria-modal': 'true'\n    }, this.model.get('_attributes'));\n  }\n\n  events() {\n    return {\n      'click .js-notify-btn-alert': 'onAlertButtonClicked',\n      'click .js-notify-btn-prompt': 'onPromptButtonClicked',\n      'click .js-notify-close-btn': 'onCloseButtonClicked',\n      'click .js-notify-shadow-click': 'onShadowClicked'\n    };\n  }\n\n  initialize({ notify }) {\n    this.notify = notify;\n    _.bindAll(this, 'resetNotifySize', 'onKeyUp');\n    this.disableAnimation = Adapt.config.get('_disableAnimation') || false;\n    this.isOpen = false;\n    this.hasOpened = false;\n    this.setupEventListeners();\n    this.render();\n  }\n\n  setupEventListeners() {\n    this.listenTo(Adapt, {\n      remove: this.closeNotify,\n      'notify:resize': this.resetNotifySize,\n      'notify:cancel': this.cancelNotify,\n      'notify:close': this.closeNotify,\n      'device:resize': this.resetNotifySize\n    });\n    this.setupEscapeKey();\n  }\n\n  setupEscapeKey() {\n    $(window).on('keyup', this.onKeyUp);\n  }\n\n  onKeyUp(event) {\n    if (event.which !== 27) return;\n    event.preventDefault();\n    this.cancelNotify();\n  }\n\n  render() {\n    const data = this.model.toJSON();\n    const template = Handlebars.templates.notifyPopup;\n    // hide notify container\n    this.$el.css('visibility', 'hidden');\n    // attach popup + shadow\n    this.$el.html(template(data)).appendTo('.notify__popup-container');\n    // hide popup\n    this.$('.notify__popup').css('visibility', 'hidden');\n    // show notify container\n    this.$el.css('visibility', 'visible');\n    this.showNotify();\n    return this;\n  }\n\n  onAlertButtonClicked(event) {\n    event.preventDefault();\n    // tab index preservation, notify must close before subsequent callback is triggered\n    this.closeNotify();\n    Adapt.trigger(this.model.get('_callbackEvent'), this);\n  }\n\n  onPromptButtonClicked(event) {\n    event.preventDefault();\n    // tab index preservation, notify must close before subsequent callback is triggered\n    this.closeNotify();\n    Adapt.trigger($(event.currentTarget).attr('data-event'), this);\n  }\n\n  onCloseButtonClicked(event) {\n    event.preventDefault();\n    // tab index preservation, notify must close before subsequent callback is triggered\n    this.cancelNotify();\n  }\n\n  onShadowClicked(event) {\n    event.preventDefault();\n    if (this.model.get('_closeOnShadowClick') === false) return;\n    this.cancelNotify();\n  }\n\n  cancelNotify() {\n    if (this.model.get('_isCancellable') === false) return;\n    // tab index preservation, notify must close before subsequent callback is triggered\n    this.closeNotify();\n    Adapt.trigger('notify:cancelled', this);\n  }\n\n  resetNotifySize() {\n    if (!this.hasOpened) return;\n    this.resizeNotify();\n  }\n\n  resizeNotify() {\n    const windowHeight = $(window).height();\n    const notifyHeight = this.$('.notify__popup-inner').outerHeight();\n    const isFullWindow = (notifyHeight >= windowHeight);\n    this.$('.notify__popup').css({\n      height: isFullWindow ? '100%' : 'auto',\n      top: isFullWindow ? 0 : '',\n      'margin-top': isFullWindow ? '' : -(notifyHeight / 2),\n      'overflow-y': isFullWindow ? 'scroll' : '',\n      '-webkit-overflow-scrolling': isFullWindow ? 'touch' : ''\n    });\n  }\n\n  async showNotify() {\n    this.isOpen = true;\n    await this.addSubView();\n    // Add to the list of open popups\n    this.notify.stack.push(this);\n    // Keep focus from previous action\n    this.$previousActiveElement = $(document.activeElement);\n    Adapt.trigger('notify:opened', this);\n    this.$el.imageready(this.onLoaded.bind(this));\n  }\n\n  onLoaded() {\n    if (this.disableAnimation) {\n      this.$('.notify__shadow').css('display', 'block');\n    } else {\n      this.$('.notify__shadow').velocity({ opacity: 0 }, { duration: 0 }).velocity({ opacity: 1 }, {\n        duration: 400,\n        begin: () => {\n          this.$('.notify__shadow').css('display', 'block');\n        }\n      });\n    }\n    this.resizeNotify();\n    if (this.disableAnimation) {\n      this.$('.notify__popup').css('visibility', 'visible');\n      this.onOpened();\n    } else {\n      this.$('.notify__popup').velocity({ opacity: 0 }, { duration: 0 }).velocity({ opacity: 1 }, {\n        duration: 400,\n        begin: () => {\n          // Make sure to make the notify visible and then set\n          // focus, disabled scroll and manage tabs\n          this.$('.notify__popup').css('visibility', 'visible');\n          this.onOpened();\n        }\n      });\n    }\n  }\n\n  onOpened() {\n    $.inview();\n    this.hasOpened = true;\n    // Allows popup manager to control focus\n    a11y.popupOpened(this.$el);\n    a11y.scrollDisable('body');\n    $('html').addClass('notify');\n    // Set focus to first accessible element\n    a11y.focusFirst(this.$('.notify__popup'), { defer: false });\n  }\n\n  async addSubView() {\n    this.subView = this.model.get('_view');\n    if (this.model.get('_shouldRenderId') && this.model.get('_id')) {\n      // Automatically render the specified id\n      const model = data.findById(this.model.get('_id'));\n      const View = components.getViewClass(model);\n      this.subView = new View({ model });\n    }\n    if (!this.subView) return;\n    this.subView.$el.on('resize', this.resetNotifySize);\n    this.$('.notify__content-inner').append(this.subView.$el);\n    if (!(this.subView instanceof AdaptView) || this.subView.model.get('_isReady')) return;\n    // Wait for the AdaptView subview to be ready\n    return new Promise(resolve => {\n      const check = (model, value) => {\n        if (!value) return;\n        this.subView.model.off('change:_isReady', check);\n        resolve();\n      };\n      this.subView.model.on('change:_isReady', check);\n    });\n  }\n\n  closeNotify() {\n    // Make sure that only the top most notify is closed\n    const stackItem = this.notify.stack[this.notify.stack.length - 1];\n    if (this !== stackItem) return;\n    this.notify.stack.pop();\n    // Prevent from being invoked multiple times - see https://github.com/adaptlearning/adapt_framework/issues/1659\n    if (!this.isOpen) return;\n    this.isOpen = false;\n    // If closeNotify is called before showNotify has finished then wait\n    // until it's open.\n    if (this.hasOpened) {\n      this.onCloseReady();\n      return;\n    }\n    this.listenToOnce(Adapt, 'popup:opened', () => {\n      // Wait for popup:opened to finish processing\n      _.defer(this.onCloseReady.bind(this));\n    });\n  }\n\n  onCloseReady() {\n    if (this.disableAnimation) {\n      this.$('.notify__popup').css('visibility', 'hidden');\n      this.$el.css('visibility', 'hidden');\n      this.remove();\n    } else {\n      this.$('.notify__popup').velocity({ opacity: 0 }, {\n        duration: 400,\n        complete: () => {\n          this.$('.notify__popup').css('visibility', 'hidden');\n        }\n      });\n      this.$('.notify__shadow').velocity({ opacity: 0 }, {\n        duration: 400,\n        complete: () => {\n          this.$el.css('visibility', 'hidden');\n          this.remove();\n        }\n      });\n    }\n    a11y.scrollEnable('body');\n    $('html').removeClass('notify');\n    // Return focus to previous active element\n    a11y.popupClosed(this.$previousActiveElement);\n    // Return reference to the notify view\n    Adapt.trigger('notify:closed', this);\n  }\n\n  remove(...args) {\n    this.removeSubView();\n    $(window).off('keyup', this.onKeyUp);\n    super.remove(...args);\n  }\n\n  removeSubView() {\n    if (!this.subView) return;\n    this.subView.$el.off('resize', this.resetNotifySize);\n    if (this.subView instanceof AdaptView) {\n      // Clear up nested views and models\n      const views = [...this.subView.findDescendantViews(), this.subView];\n      views.forEach(view => {\n        view.model.set('_isReady', false);\n        view.remove();\n      });\n    } else {\n      this.subView.remove();\n    }\n    this.subView = null;\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport logging from 'core/js/logging';\nimport NotifyPushCollection from 'core/js/collections/notifyPushCollection';\nimport NotifyPopupView from 'core/js/views/notifyPopupView';\nimport NotifyModel from 'core/js/models/notifyModel';\n\nexport default class NotifyView extends Backbone.View {\n\n  className() {\n    return 'notify__container';\n  }\n\n  initialize() {\n    this._stack = [];\n    this.notifyPushes = new NotifyPushCollection();\n    this.listenTo(Adapt, {\n      'notify:popup': this._deprecated.bind(this, 'popup'),\n      'notify:alert': this._deprecated.bind(this, 'alert'),\n      'notify:prompt': this._deprecated.bind(this, 'prompt'),\n      'notify:push': this._deprecated.bind(this, 'push')\n    });\n    this.render();\n  }\n\n  get stack() {\n    return this._stack;\n  }\n\n  get isOpen() {\n    return (this.stack.length > 0);\n  }\n\n  _deprecated(type, notifyObject) {\n    logging.deprecated(`NOTIFY DEPRECATED: Adapt.trigger('notify:${type}', notifyObject); is no longer supported, please use notify.${type}(notifyObject);`);\n    return this.create(notifyObject, { _type: type });\n  }\n\n  render() {\n    const notifyTemplate = Handlebars.templates.notify;\n    this.$el.html(notifyTemplate());\n    this.$el.appendTo('body');\n  }\n\n  create(notifyObject, defaults) {\n    notifyObject = _.defaults({}, notifyObject, defaults, {\n      _type: 'popup',\n      _shouldRenderId: false,\n      _isCancellable: true,\n      _showCloseButton: true,\n      _closeOnShadowClick: true\n    });\n\n    if (notifyObject._type === 'push') {\n      this.notifyPushes.push(notifyObject);\n      return;\n    }\n\n    return new NotifyPopupView({\n      model: new NotifyModel(notifyObject),\n      notify: this\n    });\n  }\n\n  /**\n   * Creates a 'popup' notify\n   * @param {Object} notifyObject An object containing all the settings for the popup\n   * @param {string} notifyObject.title Title of the popup\n   * @param {string} notifyObject.body Body of the popup\n   * @param {Boolean} [notifyObject._showCloseButton=true] If set to `false` the popup will not have a close button. The learner will still be able to dismiss the popup by clicking outside of it or by pressing the Esc key. This setting is typically used mainly for popups that have a subview (where the subview contains the close button)\n   * @param {Boolean} [notifyObject._isCancellable=true] If set to `false` the learner will not be able to close the popup - use with caution!\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\n   * @param {Backbone.View} [notifyObject._view] Subview to display in the popup instead of the standard view\n   */\n  popup(notifyObject) {\n    return this.create(notifyObject, { _type: 'popup' });\n  }\n\n  /**\n   * Creates an 'alert' notify popup\n   * @param {Object} notifyObject An object containing all the settings for the alert popup\n   * @param {string} notifyObject.title Title of the alert popup\n   * @param {string} notifyObject.body Body of the alert popup\n   * @param {string} notifyObject.confirmText Label for the popup confirm button\n   * @param {Boolean} [notifyObject._isCancellable=true] If set to `false` only the confirm button can be used to dismiss/close the popup\n   * @param {Boolean} [notifyObject._showIcon=false] If set to `true` an 'alert' icon will be displayed in the popup\n   * @param {string} [notifyObject._callbackEvent] Event to trigger when the confirm button is clicked\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\n   * @param {Backbone.View} [notifyObject._view] Subview to display in the popup instead of the standard view\n   */\n  alert(notifyObject) {\n    return this.create(notifyObject, { _type: 'alert' });\n  }\n\n  /**\n   * Creates a 'prompt dialog' notify popup\n   * @param {Object} notifyObject An object containing all the settings for the prompt dialog\n   * @param {string} notifyObject.title Title of the prompt\n   * @param {string} notifyObject.body Body of the prompt\n   * @param {Object[]} notifyObject._prompts Array of objects that each define a button (and associated callback event) that you want shown in the prompt\n   * @param {string} notifyObject._prompts[].promptText Label for this button\n   * @param {string} notifyObject._prompts[]._callbackEvent Event to be triggered when this button is clicked\n   * @param {Boolean} [notifyObject._isCancellable=true] If set to `false` only the confirm button can be used to dismiss/close the prompt\n   * @param {Boolean} [notifyObject._showIcon=true] If set to `true` a 'query' icon will be displayed in the popup\n   * @param {string} [notifyObject._callbackEvent] Event to trigger when the confirm button is clicked\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\n   * @param {Backbone.View} [notifyObject._view] Subview to display in the popup instead of the standard view\n   */\n  prompt(notifyObject) {\n    return this.create(notifyObject, { _type: 'prompt' });\n  }\n\n  /**\n   * Creates a 'push notification'\n   * @param {Object} notifyObject An object containing all the settings for the push notification\n   * @param {string} notifyObject.title Title of the push notification\n   * @param {string} notifyObject.body Body of the push notification\n   * @param {Number} [notifyObject._timeout=3000] Length of time (in milliseconds) the notification should left on-screen before automatically fading away\n   * @param {string} notifyObject._callbackEvent Event to be triggered if the learner clicks on the push notification (not triggered if they use the close button)\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\n   */\n  push(notifyObject) {\n    return this.create(notifyObject, { _type: 'push' });\n  }\n\n}\n","import NotifyView from 'core/js/views/notifyView';\n\nconst notify = new NotifyView();\nexport default notify;\n","import LockingModel from 'core/js/models/lockingModel';\n\nexport default class RouterModel extends LockingModel {\n\n  defaults() {\n    return {\n      _canNavigate: true,\n      _shouldNavigateFocus: true\n    };\n  }\n\n  lockedAttributes() {\n    return {\n      _canNavigate: false,\n      _shouldNavigateFocus: false\n    };\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport wait from 'core/js/wait';\nimport components from 'core/js/components';\nimport data from 'core/js/data';\nimport a11y from 'core/js/a11y';\nimport RouterModel from 'core/js/models/routerModel';\nimport logging from 'core/js/logging';\nimport location from 'core/js/location';\n\nclass Router extends Backbone.Router {\n\n  routes() {\n    return {\n      '': 'handleRoute',\n      'id/:id': 'handleRoute',\n      ':pluginName(/*location)(/*action)': 'handleRoute'\n    };\n  }\n\n  initialize({ model }) {\n    this.navigateToElement = this.navigateToElement.bind(this);\n    this._isBackward = false;\n    this.model = model;\n    this._navigationRoot = null;\n    // Flag to indicate if the router has tried to redirect to the current location.\n    this._isCircularNavigationInProgress = false;\n    this.showLoading();\n    // Store #wrapper element and html to cache for later use.\n    this.$wrapper = $('#wrapper');\n    this.$html = $('html');\n    this.listenToOnce(Adapt, 'app:dataReady', this.setDocumentTitle);\n    this.listenTo(Adapt, 'router:navigateTo', this.navigateToArguments);\n  }\n\n  get rootModel() {\n    return this._navigationRoot || Adapt.course;\n  }\n\n  set rootModel(model) {\n    this._navigationRoot = model;\n  }\n\n  showLoading() {\n    $('.js-loading').show();\n  }\n\n  hideLoading() {\n    $('.js-loading').hide();\n  }\n\n  setDocumentTitle() {\n    const currentModel = location._currentModel;\n    const hasSubTitle = (currentModel && currentModel !== router.rootModel && currentModel.get('title'));\n    const title = [\n      this.rootModel.get('title'),\n      hasSubTitle && currentModel.get('title')\n    ].filter(Boolean).join(' | ');\n    this.listenToOnce(Adapt, 'contentObjectView:preRender', () => {\n      const escapedTitle = $(`<div>${title}</div>`).text();\n      document.title = escapedTitle;\n    });\n  }\n\n  navigateToArguments(args) {\n    args = args.filter(v => v !== null);\n    const options = { trigger: false, replace: false };\n    if (args.length === 1 && data.findById(args[0])) {\n      this.navigate('#/id/' + args[0], options);\n      return;\n    }\n    if (args.length <= 3) {\n      this.navigate('#/' + args.join('/'), options);\n      return;\n    }\n    logging.deprecated('Use Backbone.history.navigate or window.location.href instead of Adapt.trigger(\\'router:navigateTo\\')');\n    this.handleRoute(...args);\n  }\n\n  handleRoute(...args) {\n    args = args.filter(v => v !== null);\n\n    if (this.model.get('_canNavigate')) {\n      // Reset _isCircularNavigationInProgress protection as code is allowed to navigate away.\n      this._isCircularNavigationInProgress = false;\n    }\n\n    // Check if the current page is in the process of navigating to itself.\n    // It will redirect to itself if the URL was changed and _canNavigate is false.\n    if (this._isCircularNavigationInProgress === false) {\n      // Trigger an event pre 'router:location' to allow extensions to stop routing.\n      Adapt.trigger('router:navigate', args);\n    }\n\n    // Re-check as _canNavigate can be set to false on 'router:navigate' event.\n    if (this.model.get('_canNavigate')) {\n      // Disable navigation whilst rendering.\n      this.model.set('_canNavigate', false, { pluginName: 'adapt' });\n      this._isBackward = false;\n      if (args.length <= 1) {\n        return this.handleId(...args);\n      }\n      return this.handlePluginRouter(...args);\n    }\n\n    if (this._isCircularNavigationInProgress) {\n      // Navigation correction finished.\n      // Router has successfully re-navigated to the current _id as the URL was changed\n      // while _canNavigate: false\n      this._isCircularNavigationInProgress = false;\n      return;\n    }\n\n    // Cancel navigation to stay at the current location.\n    this._isCircularNavigationInProgress = true;\n    Adapt.trigger('router:navigationCancelled', args);\n\n    // Reset URL to the current one.\n    // https://github.com/adaptlearning/adapt_framework/issues/3061\n    Backbone.history.history[this._isBackward ? 'forward' : 'back']();\n    this._isBackward = false;\n  }\n\n  async handlePluginRouter(pluginName, location, action) {\n    const pluginLocation = [\n      pluginName,\n      location && `-${location}`,\n      action && `-${action}`\n    ].filter(Boolean).join('');\n    await this.updateLocation(pluginLocation, null, null, null);\n\n    Adapt.trigger('router:plugin:' + pluginName, pluginName, location, action);\n    Adapt.trigger('router:plugin', pluginName, location, action);\n    this.model.set('_canNavigate', true, { pluginName: 'adapt' });\n  }\n\n  async handleId(id) {\n    const rootModel = router.rootModel;\n    let model = (!id) ? rootModel : data.findById(id);\n\n    if (!model) {\n      // Bad id\n      this.model.set('_canNavigate', true, { pluginName: 'adapt' });\n      return;\n    }\n\n    // Keep the routed id incase it needs to be scrolled to later\n    const isContentObject = model.isTypeGroup?.('contentobject');\n    const navigateToId = model.get('_id');\n\n    // Ensure that the router is rendering a contentobject\n    model = isContentObject ? model : model.findAncestor('contentobject');\n    id = model.get('_id');\n\n    const isRoot = (model === rootModel);\n    if (isRoot && Adapt.course.has('_start')) {\n      // Do not allow access to the menu when the start controller is enabled.\n      const startController = Adapt.course.get('_start');\n      if (startController._isEnabled === true && startController._isMenuDisabled === true) {\n        return;\n      }\n    }\n\n    if (model.get('_isLocked') && Adapt.config.get('_forceRouteLocking')) {\n      // Locked id\n      logging.warn('Unable to navigate to locked id: ' + id);\n      this.model.set('_canNavigate', true, { pluginName: 'adapt' });\n      if (location._previousId === undefined) {\n        return this.navigate('#/', { trigger: true, replace: true });\n      }\n      return this.navigateBack();\n    }\n\n    // Move to a content object\n    this.showLoading();\n    await Adapt.remove();\n\n    /**\n     * TODO:\n     * As the course object has separate location and type rules,\n     * it makes it more difficult to update the location object\n     * should stop doing this.\n     */\n    const isCourse = model.isTypeGroup?.('course');\n    const type = isCourse ? 'menu' : model.get('_type');\n    const newLocation = isCourse ? 'course' : `${type}-${id}`;\n\n    model.set('_isVisited', true);\n    await this.updateLocation(newLocation, type, id, model);\n\n    Adapt.once('contentObjectView:ready', () => {\n      // Allow navigation.\n      this.model.set('_canNavigate', true, { pluginName: 'adapt' });\n      this.handleNavigationFocus();\n    });\n    Adapt.trigger(`router:${type} router:contentObject`, model);\n\n    const ViewClass = components.getViewClass(model);\n    const isMenu = model.isTypeGroup?.('menu');\n    if (!ViewClass && isMenu) {\n      logging.deprecated(`Using event based menu view instantiation for '${components.getViewName(model)}'`);\n      return;\n    }\n\n    if (!isMenu) {\n      // checkIfResetOnRevisit where exists on descendant models before render\n      _.invoke(model.getAllDescendantModels(), 'checkIfResetOnRevisit');\n      // wait for completion to settle\n      await Adapt.deferUntilCompletionChecked();\n    }\n\n    this.$wrapper.append(new ViewClass({ model }).$el);\n\n    if (!isContentObject && !this.isScrolling) {\n      // Scroll to element if not a content object or not already trying to\n      await this.navigateToElement('.' + navigateToId, { replace: true, duration: 400 });\n    }\n\n  }\n\n  async updateLocation(currentLocation, type, id, currentModel) {\n    // Handles updating the location.\n    location._previousModel = location._currentModel;\n    location._previousId = location._currentId;\n    location._previousContentType = location._contentType;\n\n    location._currentModel = currentModel;\n    location._currentId = id;\n    location._contentType = type;\n    location._currentLocation = currentLocation;\n\n    /**\n     * TODO:\n     * this if block should be removed,\n     * these properties are unused in the framework\n     */\n    if (type === 'menu') {\n      location._lastVisitedType = 'menu';\n      location._lastVisitedMenu = id;\n    } else if (type === 'page') {\n      location._lastVisitedType = 'page';\n      location._lastVisitedPage = id;\n    }\n\n    this.setDocumentTitle();\n    this.setGlobalClasses();\n\n    // Trigger event when location changes.\n    Adapt.trigger('router:location', location);\n\n    await wait.queue();\n  }\n\n  setGlobalClasses() {\n    const currentModel = location._currentModel;\n\n    const htmlClasses = currentModel?.get('_htmlClasses') || '';\n    const classes = (location._currentId) ?\n      `location-${location._contentType} location-id-${location._currentId}` :\n      `location-${location._currentLocation}`;\n    const currentClasses = `${classes} ${htmlClasses}`;\n\n    this.$html\n      .removeClass(location._previousClasses)\n      .addClass(currentClasses)\n      .attr('data-location', location._currentLocation);\n\n    this.$wrapper\n      .removeClass()\n      .addClass(classes)\n      .attr('data-location', location._currentLocation);\n\n    location._previousClasses = currentClasses;\n  }\n\n  handleNavigationFocus() {\n    if (!this.model.get('_shouldNavigateFocus')) return;\n    // Body will be forced to accept focus to start the\n    // screen reader reading the page.\n    a11y.focus('body');\n  }\n\n  navigateBack() {\n    this._isBackward = true;\n    Backbone.history.history.back();\n  }\n\n  navigateToCurrentRoute(force) {\n    if (!this.model.get('_canNavigate') && !force) {\n      return;\n    }\n    if (!location._currentId) {\n      return;\n    }\n    const currentId = location._currentModel.get('_id');\n    const isRoot = (location._currentModel === this.rootModel);\n    const route = isRoot ? '#/' : '#/id/' + currentId;\n    this.navigate(route, { trigger: true, replace: true });\n  }\n\n  navigateToPreviousRoute(force) {\n    // Sometimes a plugin might want to stop the default navigation.\n    // Check whether default navigation has changed.\n    if (!this.model.get('_canNavigate') && !force) {\n      return;\n    }\n    const currentModel = location._currentModel;\n    const previousModel = location._previousModel;\n    if (!currentModel) {\n      return this.navigateBack();\n    }\n    if (location._currentModel?.isTypeGroup('menu')) {\n      return this.navigateToParent();\n    }\n    if (previousModel) {\n      return this.navigateBack();\n    }\n    this.navigateToParent();\n  }\n\n  navigateToParent(force) {\n    if (!this.model.get('_canNavigate') && !force) {\n      return;\n    }\n    const parentId = location._currentModel.get('_parentId');\n    const parentModel = data.findById(parentId);\n    const isRoot = (parentModel === this.rootModel);\n    const route = isRoot ? '#/' : '#/id/' + parentId;\n    this.navigate(route, { trigger: true });\n  }\n\n  navigateToHomeRoute(force) {\n    if (!this.model.get('_canNavigate') && !force) {\n      return;\n    }\n    this.navigate('#/', { trigger: true });\n  }\n\n  /**\n   * Allows a selector or id to be passed in and Adapt will navigate to this element. Resolves\n   * asynchronously when the element has been navigated to.\n   * @param {JQuery|string} selector CSS selector or id of the Adapt element you want to navigate to e.g. `\".co-05\"` or `\"co-05\"`\n   * @param {Object} [settings] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\n   */\n  async navigateToElement(selector, settings = {}) {\n    const currentModelId = typeof selector === 'string' && selector.replace(/\\./g, '').split(' ')[0];\n    const isSelectorAnId = data.hasId(currentModelId);\n\n    if (isSelectorAnId) {\n      const currentModel = data.findById(currentModelId);\n      const contentObject = currentModel.isTypeGroup?.('contentobject') ? currentModel : currentModel.findAncestor('contentobject');\n      const contentObjectId = contentObject.get('_id');\n      const isNotInCurrentContentObject = (contentObjectId !== location._currentId);\n\n      if (currentModel && (!currentModel.get('_isRendered') || !currentModel.get('_isReady') || isNotInCurrentContentObject)) {\n        const shouldReplace = settings.replace || false;\n        if (isNotInCurrentContentObject) {\n          this.isScrolling = true;\n          this.navigate(`#/id/${currentModelId}`, { trigger: true, replace: shouldReplace });\n          this.model.set('_shouldNavigateFocus', false, { pluginName: 'adapt' });\n          await new Promise(resolve => Adapt.once('contentObjectView:ready', _.debounce(() => {\n            this.model.set('_shouldNavigateFocus', true, { pluginName: 'adapt' });\n            resolve();\n          }, 1)));\n          this.isScrolling = false;\n        }\n        await Adapt.parentView.renderTo(currentModelId);\n      }\n\n      // Correct selector when passed a pure id\n      if (currentModel && selector === currentModel.get('_id')) {\n        selector = `.${selector}`;\n      }\n    }\n\n    const isElementUnavailable = !$(selector).length;\n    if (isElementUnavailable) {\n      logging.warn(`router.navigateToElement, selector not found in document: ${selector}`);\n      return;\n    }\n\n    // Get the current location - this is set in the router\n    const newLocation = (location._contentType)\n      ? location._contentType\n      : location._currentLocation;\n    // Trigger initial scrollTo event\n    Adapt.trigger(`${newLocation}:scrollTo`, selector);\n    // Setup duration variable\n    const disableScrollToAnimation = Adapt.config.has('_disableAnimation') ? Adapt.config.get('_disableAnimation') : false;\n    if (disableScrollToAnimation) {\n      settings.duration = 0;\n    } else if (!settings.duration) {\n      settings.duration = $.scrollTo.defaults.duration;\n    }\n\n    const $wrapper = $('#wrapper');\n    // Work out offset from the top of the wrapper rather than the height of the navigation bar\n    let offsetTop = -parseInt($wrapper.css('padding-top'));\n    // Prevent scroll issue when component description aria-label coincident with top of component\n    if ($(selector).hasClass('component')) {\n      offsetTop -= $(selector).find('.aria-label').height() || 0;\n    }\n\n    if (!settings.offset) settings.offset = { top: offsetTop, left: 0 };\n    if (settings.offset.top === undefined) settings.offset.top = offsetTop;\n    if (settings.offset.left === undefined) settings.offset.left = 0;\n\n    if (settings.offset.left === 0) settings.axis = 'y';\n\n    if (Adapt.get('_canScroll') !== false) {\n      // Trigger scrollTo plugin\n      $.scrollTo(selector, settings);\n    }\n\n    // Trigger an event after animation\n    // 300 milliseconds added to make sure queue has finished\n    await new Promise(resolve => {\n      _.delay(() => {\n        a11y.focusNext(selector);\n        Adapt.trigger(`${location}:scrolledTo`, selector);\n        resolve();\n      }, settings.duration + 300);\n    });\n  }\n\n  get(...args) {\n    logging.deprecated('router.get, please use router.model.get');\n    return this.model.get(...args);\n  }\n\n  set(...args) {\n    logging.deprecated('router.set, please use router.model.set');\n    return this.model.set(...args);\n  }\n\n}\n\nconst router = new Router({\n  model: new RouterModel(null, { reset: true })\n});\nexport default router;\n","import Adapt from 'core/js/adapt';\nimport logging from 'core/js/logging';\nimport router from 'core/js/router';\n\n/**\n * This allows Adapt to:\n * - Be embedded in iframes on ios\n *   ios iframes assume the content height and no scrolling\n *   https://blog.codepen.io/2017/12/01/stupid-iframes-stupid-ios/\n *   https://stackoverflow.com/questions/23083462/how-to-get-an-iframe-to-be-responsive-in-ios-safari\n * - Prevent the 44px click region occluding trickle at the bottom of\n *   ios safari by keeping the controls always visible\n *   https://github.com/adaptlearning/adapt-contrib-trickle/issues/132\n *   https://www.eventbrite.com/engineering/mobile-safari-why/\n */\nclass Scrolling extends Backbone.Controller {\n\n  initialize() {\n    this.scrollTo = this.scrollTo.bind(this);\n    this.$html = $('html');\n    this.isLegacyScrolling = true;\n    Adapt.once('configModel:dataLoaded', this._loadConfig.bind(this));\n  }\n\n  _loadConfig() {\n    const config = Adapt.config.get('_scrollingContainer');\n    if (!config?._isEnabled) return;\n    const limitTo = config._limitToSelector;\n    const isIncluded = !limitTo || (this.$html.is(limitTo) || this.$html.hasClass(limitTo));\n    if (!isIncluded) return;\n    this.isLegacyScrolling = false;\n    this._windowScrollFix();\n    this._addStyling();\n    this._updateScrollbarWidth();\n    // Update the scrollbar width on zooming/resize as it changes in chrome and firefox\n    this.listenTo(Adapt, 'device:resize', this._updateScrollbarWidth);\n  }\n\n  _addStyling() {\n    this.$html.addClass('adapt-scrolling');\n  }\n\n  /**\n   * Set the --adapt-scrollbar-width css variable to be used to offset the navigation bar\n   * width against the body scrollbar\n   * The body scrollbar does not constrain the navigation width in the same way the viewport\n   * scrollbar does\n   * IE11 always defaults to 18px\n   * Chrome and firefox change based on zooming\n   * Safari has floating scrollbars, so 0px\n   */\n  _updateScrollbarWidth() {\n    const $tester = $('<div class=\"outer\" style=\"overflow:scroll; visibility: hidden; position:fixed; top: 0; left: 0;\"><div class=\"inner\"> </div></div>\"');\n    $('body').append($tester);\n    const scrollBarWidth = $tester.outerWidth() - $tester.find('.inner').outerWidth();\n    $tester.remove();\n    const documentStyle = document.documentElement.style;\n    documentStyle.setProperty('--adapt-scrollbar-width', `${scrollBarWidth}px`);\n  }\n\n  /**\n   * Correct scrolling to use the body element rather than the html element or viewport\n   */\n  _windowScrollFix() {\n    /** @type {HTMLDivElement} */\n    const body = document.body;\n    const html = Adapt.scrolling.$html[0];\n    const scrollY = {\n      get: () => body.scrollTop,\n      set: value => (body.scrollTop = value)\n    };\n    const scrollX = {\n      get: () => body.scrollLeft,\n      set: value => (body.scrollLeft = value)\n    };\n    const scrollHeight = {\n      get: () => body.scrollHeight,\n      set: value => (body.scrollHeight = value)\n    };\n    const scrollWidth = {\n      get: () => body.scrollWidth,\n      set: value => (body.scrollWidth = value)\n    };\n    // Fix window.scrollY, window.scrollX, window.pageYOffset and window.pageXOffset\n    Object.defineProperties(window, {\n      scrollY,\n      scrollX,\n      // Note: jQuery uses pageYOffset and pageXOffset instead of scrollY and scrollX\n      pageYOffset: scrollY,\n      pageXOffset: scrollX\n    });\n    // Fix html.scrollHeight and html.scrollWidth\n    Object.defineProperties(html, {\n      // Note: jQuery animate as used in scrollTo library, uses scrollHeight to determine animation maxiumum\n      scrollHeight,\n      scrollWidth\n    });\n    // Fix window.scrollTo\n    window.scrollTo = (...args) => {\n      const isObject = (args.length === 1 && typeof args[0] === 'object' && args[0] !== null);\n      const left = (isObject ? args[0].left : args[0]) ?? null;\n      const top = (isObject ? args[0].top : args[1]) ?? null;\n      left !== null && (body.scrollLeft = left);\n      top !== null && (body.scrollTop = top);\n    };\n    // Fix MouseEvent.prototype.pageX and MouseEvent.prototype.pageY\n    const MouseEvent = window.MouseEvent;\n    Object.defineProperties(MouseEvent.prototype, {\n      pageX: {\n        get: function() { return this.clientX + scrollX.get(); }\n      },\n      pageY: {\n        // Note: MediaElementJS uses event.pageY to work out the mouse position for the volume controls\n        get: function() { return this.clientY + scrollY.get(); }\n      }\n    });\n    // Trigger scroll events on window when scrolling\n    const $window = $(window);\n    $(document.body).on('scroll', () => $window.scroll());\n  }\n\n  /**\n   * Allows a selector to be passed in and Adapt will scroll to this element. Resolves\n   * asynchronously when the element has been navigated/scrolled to.\n   * @param {string} selector CSS selector of the Adapt element you want to navigate to e.g. `\".co-05\"`\n   * @param {Object} [settings={}] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\n   */\n  async scrollTo(selector, settings = {}) {\n    logging.deprecated('Adapt.scrollTo and Adapt.scrolling.scrollTo, use router.navigateToElement instead.');\n    return router.navigateToElement(selector, settings);\n  }\n\n}\n\nconst scrolling = new Scrolling();\nexport default scrolling;\n","import Adapt from 'core/js/adapt';\nimport wait from 'core/js/wait';\nimport LockingModel from 'core/js/models/lockingModel';\nimport router from 'core/js/router';\nimport data from 'core/js/data';\n\nclass StartController extends Backbone.Controller {\n\n  initialize(...args) {\n    super.initialize(...args);\n    this.model = null;\n  }\n\n  loadCourseData() {\n    this.model = new LockingModel(Adapt.course.get('_start'));\n  }\n\n  setStartLocation() {\n    if (!this.isEnabled()) return;\n    window.history.replaceState('', '', this.getStartHash());\n  }\n\n  returnToStartLocation() {\n    const startIds = this.model.get('_startIds');\n    if (startIds) {\n      // ensure we can return to the start page even if it is completed\n      startIds.forEach(startId => (startId._skipIfComplete = false));\n    }\n    window.location.hash = this.getStartHash(true);\n  }\n\n  /**\n   * Returns a string in URL.hash format representing the route that the course should be sent to\n   * @param {boolean} [alwaysForce] Ignore any route specified in location.hash and force use of the start page instead\n   * @return {string}\n   */\n  getStartHash(alwaysForce) {\n    const startId = this.getStartId();\n    const isRouteSpecified = window.location.href.indexOf('#') > -1;\n    const shouldForceStartId = alwaysForce || this.model.get('_force');\n    const shouldNavigateToStartId = startId && (!isRouteSpecified || shouldForceStartId);\n\n    if (shouldNavigateToStartId && startId !== Adapt.course.get('_id')) {\n      return '#/id/' + startId;\n    }\n\n    // If there's a route specified in location.hash, use that - otherwise go to main menu\n    return window.location.hash || '#/';\n  }\n\n  isEnabled() {\n    return Boolean(this.model?.get('_isEnabled'));\n  }\n\n  getStartId() {\n    let startId = this.model.get('_id');\n    const startIds = this.model.get('_startIds');\n\n    if (!startIds?.length) return startId;\n\n    const $html = $('html');\n    for (let i = 0, l = startIds.length; i < l; i++) {\n      const item = startIds[i];\n      const className = item._className;\n      const skipIfComplete = item._skipIfComplete;\n\n      const model = data.findById(item._id);\n\n      if (!model) {\n        console.log('startController: cannot find id', item._id);\n        continue;\n      }\n\n      if (skipIfComplete) {\n        if (model.get('_isComplete')) continue;\n      }\n\n      if (!className || $html.is(className) || $html.hasClass(className)) {\n        // See https://github.com/adaptlearning/adapt_framework/issues/1843\n        startId = item._id;\n        break;\n      }\n    }\n\n    return startId;\n  }\n\n}\n\nAdapt.once('adapt:start', () => {\n  startController.loadCourseData();\n  startController.setStartLocation();\n});\n\n/*\n* allows you to call returnToStartLocation either by calling `Adapt.trigger('navigation:returnToStart')`\n* or by including in the top navigation bar a button that has the attribute `data-event=\"returnToStart\"`\n*/\nAdapt.on('navigation:returnToStart', () => {\n  startController.returnToStartLocation();\n});\n\nAdapt.on('app:languageChanged', () => {\n  wait.for(done => {\n    startController.loadCourseData();\n    const hash = startController.isEnabled() ? startController.getStartHash(false) : '#/';\n    router.navigate(hash, { trigger: true, replace: true });\n    done();\n  });\n});\n\nconst startController = new StartController();\nexport default startController;\n","const COMPLETION_STATE = ENUM([\n  'INCOMPLETE',\n  'COMPLETED',\n  'PASSED',\n  'FAILED'\n]);\n\nexport default COMPLETION_STATE;\n","import Adapt from 'core/js/adapt';\nimport offlineStorage from 'core/js/offlineStorage';\nimport logging from 'core/js/logging';\nimport COMPLETION_STATE from 'core/js/enums/completionStateEnum';\n\nclass Tracking extends Backbone.Controller {\n\n  initialize() {\n    this._config = {\n      _requireContentCompleted: true,\n      _requireAssessmentCompleted: false,\n      _shouldSubmitScore: false\n    };\n    this._assessmentState = null;\n\n    Adapt.once('configModel:dataLoaded', this.loadConfig.bind(this));\n    Adapt.on('app:dataReady', this.setupEventListeners.bind(this));\n  }\n\n  setupEventListeners() {\n    this.listenTo(Adapt, {\n      'assessment:complete': this.onAssessmentComplete,\n      'assessment:restored': this.onAssessmentRestored\n    });\n\n    // Check if completion requires completing all content.\n    if (this._config._requireContentCompleted) {\n      this.listenTo(Adapt.course, 'change:_isComplete', this.checkCompletion);\n    }\n  }\n\n  /**\n   * Store the assessment state.\n   * @param {object} assessmentState - The object returned by Adapt.assessment.getState()\n   */\n  onAssessmentComplete(assessmentState) {\n    this._assessmentState = assessmentState;\n\n    this.submitScore();\n    // Check if completion requires passing an assessment.\n    if (this._config._requireAssessmentCompleted) {\n      this.checkCompletion();\n    }\n  }\n\n  submitScore() {\n    if (!this._config._shouldSubmitScore) return;\n\n    if (this._assessmentState.isPercentageBased) {\n      offlineStorage.set('score', this._assessmentState.scoreAsPercent, 0, 100);\n      return;\n    }\n\n    offlineStorage.set('score', this._assessmentState.score, this._assessmentState.minScore, this._assessmentState.maxScore);\n  }\n\n  /**\n   * Restores the _assessmentState object when an assessment is registered.\n   * @param {object} assessmentState - An object representing the overall assessment state\n   */\n  onAssessmentRestored(assessmentState) {\n    this._assessmentState = assessmentState;\n  }\n\n  /**\n   * Evaluate the course and assessment completion.\n   */\n  checkCompletion() {\n    const completionData = this.getCompletionData();\n\n    if (completionData.status === COMPLETION_STATE.INCOMPLETE) {\n      return;\n    }\n    \n    const canRetry = (completionData.assessment?.canRetry === true);\n    if (completionData.status === COMPLETION_STATE.FAILED && canRetry) {\n      return;\n    }\n\n    Adapt.trigger('tracking:complete', completionData);\n    logging.debug('tracking:complete', completionData);\n  }\n\n  /**\n   * The return value of this function should be passed to the trigger of 'tracking:complete'.\n   * @returns An object representing the user's course completion.\n   */\n  getCompletionData() {\n    const completionData = {\n      status: COMPLETION_STATE.INCOMPLETE,\n      assessment: null\n    };\n\n    // Course complete is required.\n    if (this._config._requireContentCompleted && !Adapt.course.get('_isComplete')) {\n      // INCOMPLETE: course not complete.\n      return completionData;\n    }\n\n    // Assessment completed required.\n    if (this._config._requireAssessmentCompleted) {\n      if (!this._assessmentState) {\n        // INCOMPLETE: assessment is not complete.\n        return completionData;\n      }\n\n      // PASSED/FAILED: assessment completed.\n      completionData.status = this._assessmentState.isPass ? COMPLETION_STATE.PASSED : COMPLETION_STATE.FAILED;\n      completionData.assessment = this._assessmentState;\n\n      return completionData;\n    }\n\n    // COMPLETED: criteria met, no assessment requirements.\n    completionData.status = COMPLETION_STATE.COMPLETED;\n\n    return completionData;\n  }\n\n  /**\n   * Set the _config object to the values retrieved from config.json.\n   */\n  loadConfig() {\n    this._config = Adapt.config.get('_completionCriteria') ?? this._config;\n    const newShouldSubmitScore = this._config._shouldSubmitScore;\n    const legacyShouldSubmitScore = Adapt.config.get('_spoor')?._tracking?._shouldSubmitScore;\n    // If the legacy property exists, use it for backward compatibility but warn in the console\n    if (legacyShouldSubmitScore !== undefined) logging.deprecated('config.json:_spoor._tracking._shouldSubmitScore, please use only config.json:_completionCriteria._shouldSubmitScore');\n    this._config._shouldSubmitScore = legacyShouldSubmitScore ?? newShouldSubmitScore ?? true;\n  }\n\n}\n\nconst tracking = new Tracking();\nexport default tracking;\n","import Adapt from 'core/js/adapt';\nimport a11y from 'core/js/a11y';\nimport components from 'core/js/components';\nimport data from 'core/js/data';\nimport device from 'core/js/device';\nimport drawer from 'core/js/drawer';\nimport location from 'core/js/location';\nimport logging from 'core/js/logging';\nimport mpabc from 'core/js/mpabc';\nimport notify from 'core/js/notify';\nimport offlineStorage from 'core/js/offlineStorage';\nimport router from 'core/js/router';\nimport scrolling from 'core/js/scrolling';\nimport startController from 'core/js/startController';\nimport tracking from 'core/js/tracking';\nimport wait from 'core/js/wait';\n\n/** START REDUNDANT ADAPT WAIT BEHAVIOUR */\nconst beginWait = () => {\n  logging.deprecated('Use wait.begin() as Adapt.trigger(\\'plugin:beginWait\\') will be removed in the future');\n  wait.begin();\n};\n\nconst endWait = () => {\n  logging.deprecated('Use wait.end() as Adapt.trigger(\\'plugin:endWait\\') will be removed in the future');\n  wait.end();\n};\n\nconst ready = () => {\n  if (wait.isWaiting()) {\n    return;\n  }\n  const isEventListening = (Adapt._events['plugins:ready']);\n  if (!isEventListening) {\n    return;\n  }\n  logging.deprecated(\"Use wait.queue(callback) as Adapt.on('plugins:ready', callback) will be removed in the future\");\n  Adapt.trigger('plugins:ready');\n};\n\nAdapt.listenTo(wait, 'ready', ready);\nAdapt.on({\n  'plugin:beginWait': beginWait,\n  'plugin:endWait': endWait\n});\n/** END REDUNDANT ADAPT WAIT BEHAVIOUR */\n\nObject.defineProperties(Adapt, {\n  accessibility: {\n    get() {\n      a11y.log.deprecated('Adapt.accessibility has moved to a11y');\n      return a11y;\n    }\n  },\n  a11y: {\n    get() {\n      logging.deprecated('Adapt.a11y, please use core/js/a11y directly');\n      return a11y;\n    }\n  },\n  componentStore: {\n    get() {\n      logging.deprecated('Adapt.componentStore, please use core/js/components directly');\n      return components._register;\n    }\n  },\n  data: {\n    get() {\n      logging.deprecated('Adapt.data, please use core/js/data directly');\n      return data;\n    }\n  },\n  device: {\n    get() {\n      logging.deprecated('device, please use core/js/device directly');\n      return device;\n    }\n  },\n  drawer: {\n    get() {\n      logging.deprecated('Adapt.drawer, please use core/js/drawer directly');\n      return drawer;\n    }\n  },\n  findById: {\n    get() {\n      logging.deprecated('Adapt.findById, please use data.findById directly');\n      return data.findById;\n    }\n  },\n  findViewByModelId: {\n    get() {\n      logging.deprecated('Adapt.findViewByModelId, please use data.findViewByModelId directly');\n      return data.findViewByModelId;\n    }\n  },\n  findByTrackingPosition: {\n    get() {\n      logging.deprecated('Adapt.findByTrackingPosition, please use data.findByTrackingPosition directly');\n      return data.findByTrackingPosition;\n    }\n  },\n  getViewName: {\n    get() {\n      logging.deprecated('Adapt.getViewName, please use components.getViewName instead');\n      return components.getViewName;\n    }\n\n  },\n  getViewClass: {\n    get() {\n      logging.deprecated('Adapt.getViewClass, please use components.getViewClass instead');\n      return components.getViewClass;\n    }\n\n  },\n  getModelName: {\n    get() {\n      logging.deprecated('Adapt.getModelName, please use components.getModelName instead');\n      return components.getModelName;\n    }\n  },\n  getModelClass: {\n    get() {\n      logging.deprecated('Adapt.getModelClass, please use components.getModelClass instead');\n      return components.getModelClass;\n    }\n  },\n  location: {\n    get() {\n      logging.deprecated('Adapt.location, please use core/js/location directly');\n      return location;\n    }\n  },\n  log: {\n    get() {\n      logging.deprecated('Adapt.log, please use core/js/logging directly');\n      return logging;\n    }\n  },\n  mpabc: {\n    get() {\n      logging.deprecated('Adapt.mpabc, please use core/js/mpabc directly');\n      return mpabc;\n    }\n  },\n  notify: {\n    get() {\n      logging.deprecated('Adapt.notify, please use core/js/notify directly');\n      return notify;\n    }\n  },\n  offlineStorage: {\n    get() {\n      logging.deprecated('offlineStorage, please use src/core/offlineStorage instead');\n      return offlineStorage;\n    }\n  },\n  navigateToElement: {\n    get() {\n      logging.deprecated('Adapt.navigateToElement, please use router.navigateToElement');\n      return router.navigateToElement;\n    }\n  },\n  register: {\n    get() {\n      logging.deprecated('Adapt.register, please use components.register instead');\n      return components.register;\n    }\n  },\n  router: {\n    get() {\n      logging.deprecated('Adapt.router, please use core/js/router directly');\n      return router;\n    }\n  },\n  scrolling: {\n    get() {\n      logging.deprecated('Adapt.scrolling, please use core/js/scrolling directly');\n      return scrolling;\n    }\n  },\n  scrollTo: {\n    get() {\n      logging.deprecated('Adapt.scrollTo, please use router.navigateToElement');\n      return scrolling.scrollTo;\n    }\n  },\n  startController: {\n    get() {\n      logging.deprecated('Adapt.startController, please use core/js/startController directly');\n      return startController;\n    }\n  },\n  store: {\n    get() {\n      logging.deprecated('Adapt.store, please use core/js/components directly');\n      return components._register;\n    }\n  },\n  tracking: {\n    get() {\n      logging.deprecated('Adapt.tracking, please use core/js/tracking directly');\n      return tracking;\n    }\n  },\n  wait: {\n    get() {\n      logging.deprecated('Adapt.wait, please use src/core/wait instead');\n      return wait;\n    }\n  }\n});\n","import Adapt from 'core/js/adapt';\nimport TemplateRenderEvent from 'core/js/templateRenderEvent';\n\n/**\n * Adds template and partial, preRender and postRender events to Adapt\n */\n\nfunction onRender(cb) {\n  const intercept = (object, name, mode, cb) => {\n    return (object[name] = cb.bind(object, object[name], name, mode));\n  };\n  Object.keys(Handlebars.templates).forEach(name => {\n    intercept(Handlebars.templates, name, 'template', cb);\n  });\n  Object.keys(Handlebars.partials).forEach(name => {\n    intercept(Handlebars.partials, name, 'partial', cb);\n  });\n}\n\nonRender((template, name, mode, ...args) => {\n  // Send preRender event to allow modification of args\n  const preRenderEvent = new TemplateRenderEvent(`${mode}:preRender`, name, mode, null, args);\n  Adapt.trigger(preRenderEvent.type, preRenderEvent);\n\n  // Execute template\n  const value = template(...preRenderEvent.args);\n\n  // Send postRender event to allow modification of rendered template\n  const postRenderEvent = new TemplateRenderEvent(`${mode}:postRender`, name, mode, value, preRenderEvent.args);\n  Adapt.trigger(postRenderEvent.type, postRenderEvent);\n\n  // Return rendered, modified template\n  return postRenderEvent.value;\n});\n","import Adapt from 'core/js/adapt';\nimport 'core/js/templates';\n\n/**\n * 27 April 2020 https://github.com/adaptlearning/adapt_framework/issues/2734\n * Chrome on Android defers load events on images when lite mode is enabled\n * and as part of a data saving technique.\n *\n * Add a loading=\"eager\" attribute to all template and partial img tags where\n * the loading attribute is missing.\n */\nAdapt.on('app:dataReady', () => {\n  const config = Adapt.config.get('_fixes');\n  if (config?._imgLazyLoad === false) return;\n  applyImgLoadingFix();\n});\n\nfunction applyImgLoadingFix() {\n  const findImgTag = /<img([^>]*)>/gi;\n  const hasLoadingAttr = / loading=/gi;\n  Adapt.on('template:postRender partial:postRender', event => {\n    const imgTagsFound = event.value.match(findImgTag);\n    if (!imgTagsFound) {\n      return;\n    }\n    event.value = imgTagsFound.reduce((value, img) => {\n      if (hasLoadingAttr.test(img)) {\n        return value;\n      }\n      // Add loading=\"eager\" by default\n      return value.replace(img, img.replace(findImgTag, '<img loading=\"eager\"$1>'));\n    }, event.value);\n  });\n  Adapt.on('reactElement:preRender', event => {\n    if (event.name !== 'img') return;\n    const options = event.args[1] = event.args[1] || {};\n    if (options && options.hasOwnProperty('loading')) return;\n    options.loading = 'eager';\n  });\n}\n","import Adapt from 'core/js/adapt';\nimport HTMLReactParser from 'html-react-parser';\nimport 'core/js/templates';\nimport logging from 'core/js/logging';\n\n/**\n * 27 October 2021 https://github.com/adaptlearning/adapt_authoring/issues/2570\n * The function reactHelpers.html was stopping javascript generated in the AAT editor\n * from presenting correctly in the DOM.\n *\n * This file helps deprecate the function reactHelpers.html and instead recommends\n * replacing it with dangerouslySetInnerHTML, a native react property.\n * https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml\n */\nAdapt.on('app:dataReady', () => {\n  const config = Adapt.config.get('_fixes');\n  if (config?._jsxReactHelpersHTML === false) return;\n  applyReactHelpersHTML();\n});\n\nfunction applyReactHelpersHTML() {\n  Adapt.on('reactElement:preRender', event => {\n    let [tagName, props, ...children] = event.args;\n    if (!children) return;\n    if (!Array.isArray(children)) children = [children];\n    children = children.filter(Boolean);\n    const hasSomeUnsafeConversions = children.some(c => c?.__html);\n    if (!hasSomeUnsafeConversions) return;\n    const hasManyChildren = (children.length > 1);\n    if (hasManyChildren) {\n      // Process reactHelpers.html() children amongst other nodes as a conversion from HTML strings to React nodes\n      // Warn as this is an unexpected use-case\n      event.args = event.args.map(child => {\n        if (!child || !child.__html) return child;\n        const attributes = Object.entries(props).map(([name, value]) => `${name}=\"${value}\"`).join(' ');\n        logging.warnOnce(`html() call should be the only child in its parent <${tagName} ${attributes}>`);\n        return child.__html ? HTMLReactParser(child.__html) : undefined;\n      });\n      return;\n    }\n    // Process one reactHelpers.html() child as dangerouslySetInnerHTML on the parent\n    // Allows html generated from the json to appear in the DOM in raw format\n    props = (event.args[1] = event.args[1] || {});\n    props.dangerouslySetInnerHTML = children[0];\n    event.args.length = 2;\n  });\n}\n","import Adapt from 'core/js/adapt';\nimport a11y from 'core/js/a11y';\nimport logging from './logging';\n\nconst helpers = {\n\n  lowercase(text) {\n    return text.toLowerCase();\n  },\n\n  capitalise(text) {\n    return text.charAt(0).toUpperCase() + text.slice(1);\n  },\n\n  inc(index) {\n    return index + 1;\n  },\n\n  dec(index) {\n    return index - 1;\n  },\n\n  odd (index) {\n    return (index + 1) % 2 === 0 ? 'even' : 'odd';\n  },\n\n  equals(value, text, block) {\n    return helpers.compare.call(this, value, '==', text, block);\n  },\n\n  compare(value, operator, text, block) {\n    // Comparison operators\n    switch (operator) {\n      case '===':\n        if (value === text) return block.fn(this);\n        break;\n      case '=': case '==':\n        // eslint-disable-next-line eqeqeq\n        if (value == text) return block.fn(this);\n        break;\n      case '>=':\n        if (value >= text) return block.fn(this);\n        break;\n      case '<=':\n        if (value <= text) return block.fn(this);\n        break;\n      case '>':\n        if (value > text) return block.fn(this);\n        break;\n      case '<':\n        if (value < text) return block.fn(this);\n        break;\n    }\n    return block.inverse(this);\n  },\n\n  math(lvalue, operator, rvalue, options) {\n    // Mathematical operators\n    lvalue = parseFloat(lvalue);\n    rvalue = parseFloat(rvalue);\n    switch (operator) {\n      case '+': return lvalue + rvalue;\n      case '-': return lvalue - rvalue;\n      case '*': return lvalue * rvalue;\n      case '/': return lvalue / rvalue;\n      case '%': return lvalue % rvalue;\n    }\n  },\n\n  /**\n   * Equivalent to:\n   *  if (conditionA || conditionB)\n   * @example\n   * {{#any displayTitle body instruction}}\n   * <div class='component__header {{_component}}__header'></div>\n   * {{/any}}\n   */\n  any(...args) {\n    const specified = args.slice(0, -1);\n    const block = args.slice(-1)[0];\n    return specified.some(Boolean) ? (block.fn ? block.fn(this) : true) : (block.inverse ? block.inverse(this) : false);\n  },\n\n  /**\n   * Equivalent to:\n   *  if (conditionA && conditionB)\n   * @example\n   * {{#all displayTitle body instruction}}\n   * <div class='component__header {{_component}}__header'></div>\n   * {{/all}}\n   */\n  all(...args) {\n    const specified = args.slice(0, -1);\n    const block = args.slice(-1)[0];\n    return specified.every(Boolean) ? (block.fn ? block.fn(this) : true) : (block.inverse ? block.inverse(this) : false);\n  },\n\n  /**\n   * Equivalent to:\n   *  if (!conditionA && !conditionB)\n   * @example\n   * {{#none displayTitle body instruction}}\n   * <div class='component__header {{_component}}__header'></div>\n   * {{/none}}\n   */\n  none(...args) {\n    const specified = args.slice(0, -1);\n    const block = args.slice(-1)[0];\n    return !specified.some(Boolean) ? (block.fn ? block.fn(this) : true) : (block.inverse ? block.inverse(this) : false);\n  },\n\n  /**\n   * Allow JSON to be a template i.e. you can use handlebars {{expressions}} within your JSON\n   */\n  compile(template, context) {\n    if (!template) return '';\n    if (template instanceof Object) template = template.toString();\n    const data = (context?.data?.root ? this : context);\n    return Handlebars.compile(template)(data);\n  },\n\n  /**\n   * Allow JSON to be a template and accessible text\n   */\n  compile_a11y_text(template, context) {\n    logging.deprecated('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\n    return helpers.compile.call(this, template, context);\n  },\n\n  /**\n   * Allow JSON to be a template and normalized text\n   */\n  compile_a11y_normalize(template, context) {\n    if (!template) {\n      return '';\n    }\n    if (template instanceof Object) template = template.toString();\n    return Handlebars.helpers.a11y_normalize.call(this, helpers.compile.call(this, template, context));\n  },\n\n  /**\n   * Remove all html tags except styling tags\n   */\n  compile_a11y_remove_breaks(template, context) {\n    if (!template) {\n      return '';\n    }\n    return Handlebars.helpers.a11y_remove_breaks.call(this, helpers.compile.call(this, template, context));\n  },\n\n  /**\n   * makes the _globals object in course.json available to a template\n   */\n  import_globals(context) {\n    if (context.data.root._globals) {\n      return '';\n    }\n    context.data.root._globals = Adapt.course.get('_globals');\n    return '';\n  },\n\n  /**\n   * makes the Adapt module data available to a template\n   */\n  import_adapt(context) {\n\n    if (context.data.root.Adapt) {\n      return;\n    }\n    const adapt = context.data.root.Adapt = {};\n\n    let i, l, name;\n\n    const directImport = ['config', 'course'];\n    for (i = 0, l = directImport.length; i < l; i++) {\n      name = directImport[i];\n      // convert the model to a json object and add to the current context\n      adapt[name] = Adapt[name].toJSON();\n    }\n\n    const indexedImport = ['contentObjects', 'articles', 'blocks', 'components'];\n    for (i = 0, l = indexedImport.length; i < l; i++) {\n      name = indexedImport[i];\n      // convert the collection of models to an array of json objects\n      const importArray = Adapt[name].toJSON();\n      // convert the array of json models to an object indexed by id\n      const importIndex = {};\n      for (let i1 = 0, l1 = importArray.length; i1 < l1; i1++) {\n        const item = importArray[i1];\n        importIndex[item._id] = item;\n      }\n      // add the indexed object to the current context\n      adapt[name] = importIndex;\n    }\n\n    return '';\n\n  },\n\n  /**\n   * Allow components to fetch their component description.\n   *\n   * Creates an aria label using the `a11y_aria_label` helper containing\n   * the component description specified in the\n   * `_globals._component[componentName].ariaRegion`. This value is defined\n   * in the `properties.schema:globals.ariaRegion`.\n   *\n   * @param {string} [override]\n   * @returns {string}\n   */\n  component_description(override, context) {\n    if (!this._isA11yComponentDescriptionEnabled) {\n      return;\n    }\n    const isNotDefined = !this._globals._components?.['_' + this._component];\n    if (isNotDefined) {\n      return;\n    }\n    const hasOverride = (arguments.length > 1);\n    let description;\n    if (hasOverride) {\n      description = override;\n      description = helpers.compile(description, context);\n    } else {\n      description = this._globals._components['_' + this._component].ariaRegion;\n      description = helpers.compile(description, override);\n    }\n    if (!description) {\n      return;\n    }\n    return new Handlebars.SafeString('<div class=\"aria-label\">' + description + '</div>');\n  },\n\n  a11y_text(text) {\n    logging.deprecated('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\n    return text;\n  },\n\n  /**\n   * Handlebars helper for `a11y.normalize(htmls)`.\n   *\n   * @param {string} htmls Any htmls.\n   * @returns {string}\n   */\n  a11y_normalize(htmls) {\n    return a11y.normalize.apply(a11y, arguments);\n  },\n\n  /**\n   * Handlebars helper for `a11y.removeBreaks(htmls)`.\n   *\n   * @param {string} htmls Any htmls.\n   * @returns {string}\n   */\n  a11y_remove_breaks(htmls) {\n    return a11y.removeBreaks.apply(a11y, arguments);\n  },\n\n  /**\n   * Creates a div styled with tiny, transparent text.\n   * It it absolutely positioned.\n   * The text is not visibly readable but is read by screen readers.\n   *\n   * @param {string} htmls\n   * @returns {string}\n   */\n  a11y_aria_label(htmls) {\n    let values = Array.prototype.slice.call(arguments, 0, -1);\n    values = values.filter(Boolean);\n    return new Handlebars.SafeString('<div class=\"aria-label\">' + values.join(' ') + '</div>');\n  },\n\n  /**\n   * Creates a div styled with tiny, transparent text.\n   * It it relatively positioned.\n   * The text is not visibly readable but is read by screen readers.\n   *\n   * @param {string} htmls Aria label texts.\n   * @returns {string}\n   */\n  a11y_aria_label_relative(htmls) {\n    let values = Array.prototype.slice.call(arguments, 0, -1);\n    values = values.filter(Boolean);\n    return new Handlebars.SafeString('<div class=\"aria-label relative\">' + values.join(' ') + '</div>');\n  },\n\n  /**\n   * Creates a div styled with tiny, transparent text and `role\"=img\"`.\n   * It is used for representing an image to a screen reader user in an\n   * order which cannot be represented in the DOM in a way that achieves the\n   * styling objectives.\n   * It it absolutely positioned.\n   * The text is not visibly readable but is read by screen readers.\n   *\n   * @param {string} texts Aria label texts.\n   * @returns {string}\n   */\n  a11y_aria_image(texts) {\n    let values = Array.prototype.slice.call(arguments, 0, -1);\n    values = values.filter(Boolean);\n    return new Handlebars.SafeString('<div class=\"aria-label\" role=\"img\" aria-label=\"' + values.join(' ') + '\"></div>');\n  },\n\n  /**\n   * Returns an `a` tag which when receiving focus causes the focus to wrap\n   * to the top of the readable document.\n   *\n   * @returns {string}\n   */\n  a11y_wrap_focus() {\n    const cfg = Adapt.config.get('_accessibility');\n    if (cfg._isPopupWrapFocusEnabled === false) return '';\n    return new Handlebars.SafeString('<a class=\"a11y-focusguard a11y-ignore a11y-ignore-focus\" tabindex=\"0\" role=\"presentation\">&nbsp;</a>');\n  },\n\n  /**\n   * Creates the attributes for a subject heading text. `role=\"heading\"` and\n   * `aria-level=\"#\"`. It will use the `_ariaLevel` attribute from the current\n   * context if specified, a number if given as the `levelOrType` parameter,\n   * or a name from the configured aria levels hash.\n   *\n   * @param {number|string} level\n   * @returns {string}\n   * @deprecated Please use a11y_aria_level or a11y.ariaLevel accordingly\n   */\n  a11y_attrs_heading(level) {\n    logging.deprecated('a11y_attrs_heading, please use a11y_aria_level or a11y.ariaLevel');\n    const resolvedLevel = a11y.ariaLevel({\n      id: this._id ?? Array.from(arguments).lastItem?.data?.root?._id,\n      level,\n      override: this._ariaLevel\n    });\n    return new Handlebars.SafeString(' role=\"heading\" aria-level=\"${resolvedLevel}\" ');\n  },\n\n  /**\n   * Creates the value of the aria-level attribute for a subject heading text.\n   *\n   * @param {number|string} id The originating model id\n   * @param {number|string} level An explicit level number (\"1\"), a relative increment (\"@block+1\") or a default type name (\"menu\").\n   * @param {number|string} [override=null] An explicit level number (\"1\"), a relative increment (\"@block+1\") or a default type name (\"menu\"), usually passed through from the config to override the default.\n   * @returns {string}\n   */\n  a11y_aria_level(id, level, override = null) {\n    const resolvedLevel = a11y.ariaLevel({ id, level, override });\n    return resolvedLevel;\n  },\n\n  a11y_attrs_tabbable() {\n    logging.deprecated('a11y_attrs_tabbable should not be used. tabbable elements should be natively tabbable.');\n    return new Handlebars.SafeString(' role=\"region\" tabindex=\"0\" ');\n  },\n\n  /**\n   * Produce display text with alternative screen reader version.\n   * @param {string} visible Text that will be displayed on screen\n   * @param {string} alternatives Text that will be read by the screen reader (instead of what's displayed on screen)\n   * @example {{a11y_alt_text '$5bn' 'five billion dollars'}} or {{a11y_alt_text 'Here are some bits to read' 'There are' _items.length 'items to read'}}\n   */\n  a11y_alt_text(visible, alternatives) {\n    let values = Array.prototype.slice.call(arguments, 1, -1);\n    values = values.filter(Boolean);\n    return new Handlebars.SafeString('<span aria-hidden=\"true\">' + visible + '</span><span class=\"aria-label\">' + values.join(' ') + '</span>');\n  }\n\n};\n\n// Compatibility references\nObject.assign(helpers, {\n\n  if_value_equals() {\n    logging.deprecated('if_value_equals, use equals instead.');\n    return helpers.equals.apply(this, arguments);\n  },\n\n  numbers() {\n    logging.deprecated('numbers, use inc instead.');\n    return helpers.inc.apply(this, arguments);\n  },\n\n  lowerCase() {\n    logging.deprecated('lowerCase, use lowercase instead.');\n    return helpers.lowercase.apply(this, arguments);\n  }\n\n});\n\nfor (const name in helpers) {\n  Handlebars.registerHelper(name, helpers[name]);\n}\n\nexport default helpers;\n","import Adapt from 'core/js/adapt';\n\nclass HeadingView extends Backbone.View {\n\n  initialize() {\n    this.listenTo(Adapt.parentView, 'postRemove', this.remove);\n    this.listenTo(this.model, 'change:_isComplete', this.updateAria);\n    this.render();\n  }\n\n  render() {\n    const template = Handlebars.templates[this.constructor.template];\n    const data = this.model.toJSON();\n    const customHeadingType = this.$el.attr('data-a11y-heading-type');\n    if (customHeadingType) data._type = customHeadingType;\n    if (data._type === 'course') data._type = 'menu';\n    this.$el.html(template(data));\n    this.checkCompletion();\n  }\n\n  updateAria() {\n    const template = Handlebars.templates[this.constructor.template];\n    const data = this.model.toJSON();\n    const $rendered = $(`<div>${template(data)}</div>`);\n    this.$('.aria-label').html($rendered.find('.aria-label').html());\n    this.checkCompletion();\n  }\n\n  checkCompletion() {\n    const isComplete = this.model.get('_isComplete');\n    this.$el\n      .toggleClass('is-complete', isComplete)\n      .toggleClass('is-incomplete', !isComplete);\n  }\n\n}\n\nHeadingView.template = 'heading';\n\nexport default HeadingView;\n","import Adapt from 'core/js/adapt';\nimport HeadingView from 'core/js/views/headingView';\n\nclass Headings extends Backbone.Controller {\n\n  initialize() {\n    this.listenTo(Adapt, 'view:render', this.onViewRender);\n  }\n\n  onViewRender(view) {\n    const $headingSeats = view.$('.js-heading');\n    $headingSeats.each((index, el) => new HeadingView({ el, model: view.model }));\n  }\n\n}\n\nexport default new Headings();\n","import Adapt from 'core/js/adapt';\nimport a11y from 'core/js/a11y';\nimport location from 'core/js/location';\nimport router from 'core/js/router';\nimport startController from 'core/js/startController';\n\nclass NavigationView extends Backbone.View {\n\n  className() {\n    return 'nav';\n  }\n\n  events() {\n    return {\n      'click [data-event]': 'triggerEvent'\n    };\n  }\n\n  attributes() {\n    return {\n      role: 'navigation'\n    };\n  }\n\n  initialize() {\n    this.sortNavigationButtons = _.debounce(this.sortNavigationButtons.bind(this), 1);\n    this.listenToOnce(Adapt, {\n      'courseModel:dataLoading': this.remove\n    });\n    this.listenTo(Adapt, 'router:menu router:page', this.onNavigate);\n    this.preRender();\n  }\n\n  preRender() {\n    Adapt.trigger('navigationView:preRender', this);\n    this.render();\n  }\n\n  render() {\n    const template = Handlebars.templates[this.constructor.template];\n    this.$el.html(template({\n      _globals: Adapt.course.get('_globals'),\n      _accessibility: Adapt.config.get('_accessibility')\n    })).insertBefore('#app');\n\n    _.defer(() => {\n      Adapt.trigger('navigationView:postRender', this);\n    });\n\n    return this;\n  }\n\n  triggerEvent(event) {\n    event.preventDefault();\n    const currentEvent = $(event.currentTarget).attr('data-event');\n    Adapt.trigger('navigation:' + currentEvent);\n    switch (currentEvent) {\n      case 'backButton':\n        router.navigateToPreviousRoute();\n        break;\n      case 'homeButton':\n        router.navigateToHomeRoute();\n        break;\n      case 'parentButton':\n        router.navigateToParent();\n        break;\n      case 'skipNavigation':\n        this.skipNavigation();\n        break;\n      case 'returnToStart':\n        startController.returnToStartLocation();\n        break;\n    }\n  }\n\n  skipNavigation() {\n    a11y.focusFirst('.' + location._contentType);\n  }\n\n  onNavigate(model) {\n    this.hideNavigationButton(model);\n    this.sortNavigationButtons();\n  }\n\n  hideNavigationButton(model) {\n    const shouldHide = (model.get('_type') === 'course');\n    this.$('.nav__back-btn, .nav__home-btn').toggleClass('u-display-none', shouldHide);\n  }\n\n  sortNavigationButtons() {\n    const container = this.$('.nav__inner')[0];\n    const items = [...container.children];\n    items\n      .sort((a, b) => parseFloat($(a).attr('data-order') || 0) - parseFloat($(b).attr('data-order') || 0))\n      .forEach(item => container.appendChild(item));\n  }\n\n  showNavigationButton() {\n    this.$('.nav__back-btn, .nav__home-btn').removeClass('u-display-none');\n  }\n\n}\n\nNavigationView.template = 'nav';\n\nexport default NavigationView;\n","import Adapt from 'core/js/adapt';\nimport NavigationView from 'core/js/views/navigationView';\n\nclass NavigationController extends Backbone.Controller {\n\n  initialize() {\n    this.listenTo(Adapt, 'adapt:preInitialize', this.addNavigationBar);\n  }\n\n  addNavigationBar() {\n    const adaptConfig = Adapt.course.get('_navigation');\n\n    if (adaptConfig?._isDefaultNavigationDisabled) {\n      Adapt.trigger('navigation:initialize');\n      return;\n    }\n\n    Adapt.navigation = new NavigationView();// This should be triggered after 'app:dataReady' as plugins might want to manipulate the navigation\n  }\n\n}\n\nexport default new NavigationController();\n","import logging from 'core/js/logging';\nimport AdaptView from 'core/js/views/adaptView';\n\nclass ComponentView extends AdaptView {\n\n  attributes() {\n    if (!this.model.get('_isA11yRegionEnabled')) {\n      return AdaptView.resultExtend('attributes', {}, this);\n    }\n    return AdaptView.resultExtend('attributes', {\n      'aria-labelledby': this.model.get('_id') + '-heading',\n      role: 'region'\n    }, this);\n  }\n\n  className() {\n    return [\n      'component',\n      this.model.get('_component').toLowerCase(),\n      this.model.get('_id'),\n      this.model.get('_classes'),\n      this.setVisibility(),\n      this.setHidden(),\n      'is-' + this.model.get('_layout'),\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\n      (this.model.get('_isOptional') ? 'is-optional' : '')\n    ].join(' ');\n  }\n\n  renderState() {\n    logging.removed('renderState is removed and moved to item title');\n  }\n\n  /**\n   * Allows components that want to use inview for completion to set that up\n   * @param {string} [inviewElementSelector] Allows to you to specify (via a selector) which DOM element to use for inview.\n   * Defaults to `'.component__inner'` if not supplied.\n   * @param {function} [callback] Allows you to specify what function is called when the component has been viewed, should\n   * you want to perform additional checks before setting the component to completed - see adapt-contrib-assessmentResults\n   * for an example. Defaults to `view.setCompletionStatus` if not specified.\n   */\n  setupInviewCompletion(inviewElementSelector = '.component__inner', callback = this.setCompletionStatus) {\n    this.$inviewElement = this.$(inviewElementSelector);\n    this.inviewCallback = callback;\n\n    this.$inviewElement.on('inview.componentView', this.onInview.bind(this));\n  }\n\n  removeInviewListener() {\n    if (!this.$inviewElement) return;\n    this.$inviewElement.off('inview.componentView');\n    this.$inviewElement = null;\n  }\n\n  onInview(event, visible, visiblePartX, visiblePartY) {\n    if (!visible) return;\n\n    switch (visiblePartY) {\n      case 'top':\n        this.hasSeenTop = true;\n        break;\n      case 'bottom':\n        this.hasSeenBottom = true;\n        break;\n      case 'both':\n        this.hasSeenTop = this.hasSeenBottom = true;\n    }\n\n    if (!this.hasSeenTop || !this.hasSeenBottom) return;\n\n    this.inviewCallback();\n\n    if (this.model.get('_isComplete')) {\n      this.removeInviewListener();\n    }\n  }\n\n  postRender() {}\n\n  remove() {\n    this.removeInviewListener();\n    super.remove();\n  }\n\n}\n\nComponentView.type = 'component';\n\nexport default ComponentView;\n","\n    import Adapt from 'core/js/adapt';\n    import ComponentView from 'core/js/views/componentView';\n    import Chart from 'libraries/chart.min'\n    \n    export default class ChartJSView extends ComponentView {\n  \n        preRender() {\n            this.listenTo(this.model, 'change:data', this.onDataChanged);\n        }\n\n        postRender() {\n            this.setupChart();\n            this.setupInview();\n        }\n\n        setupInview() {\n            const selector = this.getInviewElementSelector();\n            if (!selector) return this.setCompletionStatus();\n            this.setupInviewCompletion(selector);\n        }\n\n        getInviewElementSelector() {\n            if (this.model.get('body')) return '.component__body';\n            if (this.model.get('instruction')) return '.component__instruction';\n            if (this.model.get('displayTitle')) return '.component__title';\n            return null;\n        }\n\n        async dynamicInsert (dataURL) {\n                const fetchJson = async () => {\n                    const response = await fetch(dataURL)\n                    const json = await response.json()\n                    return json\n                }\n                return await fetchJson();\n        }\n\n        async setupChart () {\n            var ctx = $(\"#myChart\" + this.model.get('_id'));\n\n            await Promise.all(this.model.get('data').datasets.map(async (dataset) => {\n                if (dataset.dataURL) {\n                    dataset.data = await this.dynamicInsert(dataset.dataURL);\n                }\n            }));\n\n            var chart = new Chart(ctx, {\n                type: this.model.get('_chartType'),\n                data: await this.model.get('data'),\n                options: this.model.get('_options')\n            });\n\n            this.setReadyStatus();\n\n            this.model.set(\"_chart\", chart);\n        }\n        \n        onDataChanged() {\n            var chart = this.model.get(\"_chart\");\n            console.log(chart)\n\n            if (chart) {\n                chart.update();\n            }\n        }\n\n    }","import Adapt from 'core/js/adapt';\nimport ComponentModel from 'core/js/models/componentModel';\n\n  export default class ChartJSModel extends ComponentModel {\n    /**\n     * Updates an existing dataset for a chart.\n     *\n     * @param  {array} datasetData  An array of the new data points.\n     * @param  {int} datasetIndex The index of the dataset to update (defaults to 0.)\n     */\n    updateDataset(datasetData, datasetIndex) {\n      datasetIndex = datasetIndex || 0;\n\n      var data = this.get(\"data\");\n      if (!data) {\n        throw new Error(\"This chart instance has no data; it may be improperly configured\");\n      }\n\n      if (!data.datasets || datasetIndex >= data.datasets.length) {\n        throw new RangeError(\"Cannot update a nonexistent dataset\");\n      }\n\n      data.datasets[datasetIndex].data = datasetData;\n\n      this.trigger(\"change:data\");\n    }\n  }\n","\nimport Adapt from 'core/js/adapt';\nimport ChartJSView from './chartjsView';\nimport ChartJSModel from './chartjsModel';\n\nexport default Adapt.register(\"chartjs\", {\n    view: ChartJSView,\n    model: ChartJSModel\n});\n\n","import ComponentView from 'core/js/views/componentView';\n\nclass GraphicView extends ComponentView {\n\n  className() {\n    return [\n      super.className(),\n      this.model.get('_isScrollable') && 'is-scrollable'\n    ].filter(Boolean).join(' ');\n  }\n\n  events() {\n    return {\n      'click .js-graphic-link': 'onClick',\n      'keydown .js-graphic-scrollbar': 'onKeyDown'\n    };\n  }\n\n  postRender() {\n    this.$('.graphic__widget').imageready(() => {\n      this.setReadyStatus();\n      this.setupInviewCompletion('.graphic__widget');\n      this.setupScrollable();\n    });\n  }\n\n  setupScrollable() {\n    if (!this.model.get('_isScrollable')) return;\n    this.onScroll = _.debounce(this.onScroll.bind(this), 17);\n    const $scrollbar = this.$('.js-graphic-scrollbar');\n    const $scrollContainer = this.$(`#${$scrollbar.attr('aria-controls')}`);\n    $scrollContainer.on('scroll', this.onScroll);\n    this.onKeyDown();\n  }\n\n  onScroll(event) {\n    if (!this.model.get('_isScrollable')) return;\n    const $scrollbar = this.$('.js-graphic-scrollbar');\n    const $scrollContainer = this.$(`#${$scrollbar.attr('aria-controls')}`);\n    const { clientWidth, scrollWidth } = $scrollContainer[0];\n    const scrollableWidth = (scrollWidth - clientWidth);\n    const left = $scrollContainer.scrollLeft();\n    const calculatedScrollPercent = parseInt(left / scrollableWidth * 100);\n    this.model.set('_scrollPercent', calculatedScrollPercent);\n  }\n\n  onKeyDown(event) {\n    if (!this.model.get('_isScrollable')) return;\n    const $scrollbar = this.$('.js-graphic-scrollbar');\n    const $scrollContainer = this.$(`#${$scrollbar.attr('aria-controls')}`);\n    const { clientWidth, scrollWidth } = $scrollContainer[0];\n    const scrollableWidth = (scrollWidth - clientWidth);\n    const step = (clientWidth * 0.1);\n    let left = $scrollContainer.scrollLeft();\n    const calculatedScrollPercent = parseInt(left / scrollableWidth * 100);\n    const definedScrollPercent = this.model.get('_scrollPercent') ?? 0;\n    if (definedScrollPercent !== calculatedScrollPercent) {\n      // set inital position\n      left = definedScrollPercent / 100 * scrollableWidth;\n    }\n    switch (event?.which) {\n      case 37: // left\n        left -= step;\n        break;\n      case 39: // right\n        left += step;\n        break;\n    }\n    left = _.max([0, _.min([scrollableWidth, left])]);\n    $scrollContainer.scrollLeft(left);\n  }\n\n  onClick(event) {\n    if (event) event.preventDefault();\n\n    const item = this.model.get('_graphic');\n    const { _url: url, _target: target = '_blank' } = item;\n\n    const isNewWindow = (target !== '_self');\n    if (isNewWindow) return window.open(url, target);\n    const isRouterNavigation = (url.substr(0, 1) === '#');\n    if (isRouterNavigation) return Backbone.history.navigate(url, { trigger: true });\n    window.location.href = url;\n  }\n\n  preRemove() {\n    if (!this.model.get('_isScrollable')) return;\n    const $scrollbar = this.$('.js-graphic-scrollbar');\n    const $scrollContainer = this.$(`#${$scrollbar.attr('aria-controls')}`);\n    $scrollContainer.off('scroll', this.onScroll);\n  }\n\n}\n\nGraphicView.template = 'graphic.jsx';\n\nexport default GraphicView;\n","import ComponentModel from 'core/js/models/componentModel';\n\nexport default class GraphicModel extends ComponentModel {\n\n  init() {\n    this.set('_scrollPercent', this.get('_defaultScrollPercent'));\n  }\n\n}\n","import components from 'core/js/components';\nimport GraphicView from './GraphicView';\nimport GraphicModel from './GraphicModel';\n\nexport default components.register('graphic', {\n  model: GraphicModel,\n  view: GraphicView\n});\n","const BUTTON_STATE = ENUM([\n  'SUBMIT',\n  'CORRECT',\n  'INCORRECT',\n  'SHOW_CORRECT_ANSWER',\n  'HIDE_CORRECT_ANSWER',\n  'SHOW_FEEDBACK',\n  'RESET'\n]);\n\nexport default BUTTON_STATE;\n","import Adapt from 'core/js/adapt';\nimport a11y from 'core/js/a11y';\nimport BUTTON_STATE from 'core/js/enums/buttonStateEnum';\n\n// convert BUTTON_STATE to property name\nconst textPropertyName = {\n  SUBMIT: 'submit',\n  CORRECT: 'correct',\n  INCORRECT: 'incorrect',\n  SHOW_CORRECT_ANSWER: 'showCorrectAnswer',\n  HIDE_CORRECT_ANSWER: 'hideCorrectAnswer',\n  SHOW_FEEDBACK: 'showFeedback',\n  RESET: 'reset'\n};\n\nexport default class ButtonsView extends Backbone.View {\n\n  initialize(options) {\n    this.parent = options.parent;\n    this.listenTo(Adapt.parentView, 'postRemove', this.remove);\n    this.listenTo(this.model, {\n      'change:_buttonState': this.onButtonStateChanged,\n      'change:feedbackMessage': this.onFeedbackMessageChanged,\n      'change:_attemptsLeft': this.onAttemptsChanged,\n      'change:_canSubmit': this.onCanSubmitChange\n    });\n    this.render();\n  }\n\n  events() {\n    return {\n      'click .js-btn-action': 'onActionClicked',\n      'click .js-btn-feedback': 'onFeedbackClicked'\n    };\n  }\n\n  render() {\n    const data = this.model.toJSON();\n    const template = Handlebars.templates.buttons;\n    _.defer(() => {\n      this.postRender();\n      Adapt.trigger('buttonsView:postRender', this);\n    });\n    this.$el.html(template(data));\n  }\n\n  postRender() {\n    this.refresh();\n  }\n\n  checkResetSubmittedState() {\n    const isSubmitted = this.model.get('_isSubmitted');\n    if (isSubmitted) {\n      this.$el.addClass('is-submitted');\n      return;\n    }\n\n    this.$('.js-btn-marking, .js-btn-marking-label').removeClass('is-incorrect is-correct').addClass('u-display-none');\n    this.$el.removeClass('is-submitted');\n    this.model.set('feedbackMessage', undefined);\n    a11y.toggleEnabled(this.$('.js-btn-feedback'), false);\n  }\n\n  onActionClicked() {\n    const buttonState = BUTTON_STATE(this.model.get('_buttonState'));\n    this.trigger('buttons:stateUpdate', buttonState);\n    this.checkResetSubmittedState();\n\n    if (buttonState === BUTTON_STATE.SHOW_CORRECT_ANSWER) {\n      const correctAnswer = this.model.getCorrectAnswerAsText?.();\n      this.updateAnswerLiveRegion(correctAnswer);\n    }\n\n    if (buttonState === BUTTON_STATE.HIDE_CORRECT_ANSWER) {\n      const userAnswer = this.model.getUserAnswerAsText?.();\n      this.updateAnswerLiveRegion(userAnswer);\n    }\n  }\n\n  onFeedbackClicked() {\n    this.trigger('buttons:stateUpdate', BUTTON_STATE.SHOW_FEEDBACK);\n  }\n\n  onFeedbackMessageChanged(model, changedAttribute) {\n    if (changedAttribute && this.model.get('_canShowFeedback')) {\n      // enable feedback button\n      a11y.toggleEnabled(this.$('.js-btn-feedback'), true);\n      return;\n    }\n    // disable feedback button\n    a11y.toggleEnabled(this.$('.js-btn-feedback'), false);\n  }\n\n  onCanSubmitChange() {\n    this.onButtonStateChanged(this.model, this.model.get('_buttonState'));\n  }\n\n  onButtonStateChanged(model, changedAttribute) {\n\n    this.updateAttemptsCount();\n\n    // Use 'correct' instead of 'complete' to signify button state\n    const $buttonsAction = this.$('.js-btn-action');\n    const buttonState = BUTTON_STATE(changedAttribute);\n    if (changedAttribute === BUTTON_STATE.CORRECT || changedAttribute === BUTTON_STATE.INCORRECT) {\n      // Both 'correct' and 'incorrect' states have no model answer, so disable the submit button\n      a11y.toggleEnabled($buttonsAction, false);\n      return;\n    }\n\n    const propertyName = textPropertyName[buttonState.asString];\n    const ariaLabel = this.model.get('_buttons')['_' + propertyName].ariaLabel;\n    const buttonText = this.model.get('_buttons')['_' + propertyName].buttonText;\n\n    // Enable the button, make accessible and update aria labels and text\n    a11y.toggleEnabled($buttonsAction, this.model.get('_canSubmit'));\n    $buttonsAction.html(buttonText).attr('aria-label', ariaLabel);\n  }\n\n  checkFeedbackState() {\n    const canShowFeedback = this.model.get('_canShowFeedback');\n\n    this.$('.js-btn-action').toggleClass('is-full-width', !canShowFeedback);\n    this.$('.js-btn-feedback').toggleClass('u-display-none', !canShowFeedback);\n    this.$('.js-btn-marking, .js-btn-marking-label').toggleClass('is-full-width u-display-none', !canShowFeedback);\n  }\n\n  updateAttemptsCount() {\n    const isInteractionComplete = this.model.get('_isInteractionComplete');\n    const attemptsLeft = (this.model.get('_attemptsLeft')) ? this.model.get('_attemptsLeft') : this.model.get('_attempts');\n    const shouldDisplayAttempts = this.model.get('_shouldDisplayAttempts');\n    let attemptsString;\n\n    this.checkResetSubmittedState();\n\n    if (!isInteractionComplete && attemptsLeft >= 0) {\n      attemptsString = attemptsLeft + ' ';\n      attemptsString += attemptsLeft === 1 ?\n        this.model.get('_buttons').remainingAttemptText :\n        this.model.get('_buttons').remainingAttemptsText;\n    } else {\n      this.$('.js-display-attempts').addClass('u-visibility-hidden');\n      this.showMarking();\n    }\n\n    if (shouldDisplayAttempts) {\n      this.$('.js-insert-attempts-string').html(attemptsString);\n    }\n\n  }\n\n  /**\n   * Updates the ARIA 'live region' with the correct/user answer when that button\n   * is selected by the learner.\n   * @param {string} answer Textual representation of the correct/user answer\n   */\n  updateAnswerLiveRegion(answer) {\n    if (!answer) return;\n    this.$('.js-answer-live-region').html(answer);\n  }\n\n  showMarking() {\n    if (!this.model.shouldShowMarking) return;\n\n    const isCorrect = this.model.get('_isCorrect');\n    const ariaLabels = Adapt.course.get('_globals')._accessibility._ariaLabels;\n\n    const $marking = this.$('.js-btn-marking, .js-btn-marking-label')\n      .removeClass('u-display-none')\n      .addClass(isCorrect ? 'is-correct' : 'is-incorrect');\n\n    const $ariaLabel = this.$('.js-btn-marking-label');\n    const hasSpanAriaLabel = Boolean($ariaLabel.length);\n    if (!hasSpanAriaLabel) {\n      // Backward compability\n      $marking.attr('aria-label', isCorrect ? ariaLabels.answeredCorrectly : ariaLabels.answeredIncorrectly);\n      return;\n    }\n\n    $ariaLabel.html(isCorrect ? ariaLabels.answeredCorrectly : ariaLabels.answeredIncorrectly);\n  }\n\n  refresh() {\n    this.updateAttemptsCount();\n    this.checkResetSubmittedState();\n    this.checkFeedbackState();\n    this.onButtonStateChanged(null, this.model.get('_buttonState'));\n    this.onFeedbackMessageChanged(null, this.model.get('feedbackMessage'));\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport components from 'core/js/components';\nimport ComponentModel from 'core/js/models/componentModel';\nimport BUTTON_STATE from 'core/js/enums/buttonStateEnum';\n\nclass QuestionModel extends ComponentModel {\n\n  /// ///\n  // Setup question types\n  /// /\n\n  // Used to set model defaults\n  defaults() {\n    // Extend from the ComponentModel defaults\n    return ComponentModel.resultExtend('defaults', {\n      _isQuestionType: true,\n      _shouldDisplayAttempts: false,\n      _shouldShowMarking: false,\n      _canShowModelAnswer: true,\n      _canShowFeedback: true,\n      _canShowMarking: true,\n      _canSubmit: true,\n      _isSubmitted: false,\n      _isCorrectAnswerShown: false,\n      _questionWeight: Adapt.config.get('_questionWeight'),\n      _hasItemScoring: false,\n      _items: []\n    });\n  }\n\n  // Extend from the ComponentModel trackable\n  trackable() {\n    return ComponentModel.resultExtend('trackable', [\n      '_isSubmitted',\n      '_score',\n      '_isCorrect',\n      '_attemptsLeft'\n    ]);\n  }\n\n  trackableType() {\n    return ComponentModel.resultExtend('trackableType', [\n      Boolean,\n      Number,\n      Boolean,\n      Number\n    ]);\n  }\n\n  /**\n   * Returns a string of the model type group.\n   * @returns {string}\n   */\n  getTypeGroup() {\n    return 'question';\n  }\n\n  init() {\n    this.setupDefaultSettings();\n    this.setLocking('_canSubmit', true);\n    this.updateRawScore();\n    super.init();\n  }\n\n  // Calls default methods to setup on questions\n  setupDefaultSettings() {\n    // Not sure this is needed anymore, keeping to maintain API\n    this.setupWeightSettings();\n    this.setupButtonSettings();\n  }\n\n  // Used to setup either global or local button text\n  setupButtonSettings() {\n    const globalButtons = Adapt.course.get('_buttons');\n\n    // Check if  '_buttons' attribute exists and if not use the globally defined buttons.\n    if (!this.has('_buttons')) {\n      this.set('_buttons', globalButtons);\n    } else {\n      // Check all the components buttons.\n      // If they are empty use the global defaults.\n      const componentButtons = this.get('_buttons');\n\n      for (const key in componentButtons) {\n        if (typeof componentButtons[key] === 'object') {\n          // Button text.\n          if (!componentButtons[key].buttonText && globalButtons[key].buttonText) {\n            componentButtons[key].buttonText = globalButtons[key].buttonText;\n          }\n\n          // ARIA labels.\n          if (!componentButtons[key].ariaLabel && globalButtons[key].ariaLabel) {\n            componentButtons[key].ariaLabel = globalButtons[key].ariaLabel;\n          }\n        }\n\n        if (!componentButtons[key] && globalButtons[key]) {\n          componentButtons[key] = globalButtons[key];\n        }\n      }\n    }\n  }\n\n  // Used to setup either global or local question weight/score\n  setupWeightSettings() {\n    // Not needed as handled by model defaults, keeping to maintain API\n  }\n\n  /// ///\n  // Submit process\n  /// /\n\n  // Use to check if the user is allowed to submit the question\n  // Maybe the user has to select an item?\n  canSubmit() {}\n\n  checkCanSubmit() {\n    this.set('_canSubmit', this.canSubmit(), { pluginName: 'adapt' });\n  }\n\n  // Used to update the amount of attempts the user has left\n  updateAttempts() {\n    const attemptsLeft = this.get('_attemptsLeft') || this.get('_attempts');\n\n    this.set('_attemptsLeft', attemptsLeft - 1);\n  }\n\n  // Used to set _isEnabled and _isSubmitted on the model\n  setQuestionAsSubmitted() {\n    this.set({\n      _isEnabled: false,\n      _isSubmitted: true,\n      _shouldShowMarking: this.shouldShowMarking\n    });\n  }\n\n  // Sets _isCorrect:true/false based upon isCorrect method below\n  markQuestion() {\n\n    if (this.isCorrect()) {\n      this.set('_isCorrect', true);\n    } else {\n      this.set('_isCorrect', false);\n    }\n\n    this.updateRawScore();\n\n  }\n\n  // Should return a boolean based upon whether to question is correct or not\n  isCorrect() {}\n\n  /**\n   * Used to set the legacy _score property based upon the _questionWeight and correctness\n   * @deprecated Please use get score, get maxScore and get minScore instead\n   */\n  setScore() {\n    const questionWeight = this.get('_questionWeight');\n    const answeredCorrectly = this.get('_isCorrect');\n    const score = answeredCorrectly ? questionWeight : 0;\n    this.set('_score', score);\n  }\n\n  updateRawScore() {\n    this.set({\n      _rawScore: this.score,\n      _maxScore: this.maxScore,\n      _minScore: this.minScore\n    });\n  }\n\n  /**\n   * Returns a numerical value between maxScore and minScore\n   * @type {number}\n   */\n  get score() {\n    return this.get('_isCorrect') ? this.maxScore : 0;\n  }\n\n  /**\n   * @type {number}\n   */\n  get maxScore() {\n    return this.get('_questionWeight');\n  }\n\n  /**\n   * @type {number}\n   */\n  get minScore() {\n    return 0;\n  }\n\n  // Checks if the question should be set to complete\n  // Calls setCompletionStatus and adds complete classes\n  checkQuestionCompletion() {\n\n    const isComplete = (this.get('_isCorrect') || this.get('_attemptsLeft') === 0);\n\n    if (isComplete) {\n      this.setCompletionStatus();\n    }\n\n    return isComplete;\n\n  }\n\n  // Updates buttons based upon question state by setting\n  // _buttonState on the model which buttonsView listens to\n  updateButtons() {\n\n    const isInteractionComplete = this.get('_isInteractionComplete');\n    const isCorrect = this.get('_isCorrect');\n    const isEnabled = this.get('_isEnabled');\n    const buttonState = this.get('_buttonState');\n    const canShowModelAnswer = this.get('_canShowModelAnswer');\n\n    if (isInteractionComplete) {\n\n      if (isCorrect || !canShowModelAnswer) {\n        // Use correct instead of complete to signify button state\n        this.set('_buttonState', BUTTON_STATE.CORRECT);\n\n      } else {\n\n        switch (buttonState) {\n          case BUTTON_STATE.SUBMIT:\n          case BUTTON_STATE.HIDE_CORRECT_ANSWER:\n            this.set('_buttonState', BUTTON_STATE.SHOW_CORRECT_ANSWER);\n            break;\n          default:\n            this.set('_buttonState', BUTTON_STATE.HIDE_CORRECT_ANSWER);\n        }\n\n      }\n\n    } else {\n\n      if (isEnabled) {\n        this.set('_buttonState', BUTTON_STATE.SUBMIT);\n      } else {\n        this.set('_buttonState', BUTTON_STATE.RESET);\n      }\n    }\n\n  }\n\n  // Used to setup the correct, incorrect and partly correct feedback\n  setupFeedback() {\n    if (!this.has('_feedback')) return;\n\n    if (this.get('_isCorrect')) {\n      this.setupCorrectFeedback();\n    } else if (this.isPartlyCorrect()) {\n      this.setupPartlyCorrectFeedback();\n    } else {\n      this.setupIncorrectFeedback();\n    }\n  }\n\n  // Used by the question to determine if the question is incorrect or partly correct\n  // Should return a boolean\n  isPartlyCorrect() {}\n\n  setupCorrectFeedback() {\n    this.set({\n      feedbackTitle: this.getFeedbackTitle(),\n      feedbackMessage: Handlebars.compile(this.get('_feedback').correct)(this.toJSON())\n    });\n  }\n\n  setupPartlyCorrectFeedback() {\n    const feedback = this.get('_feedback')._partlyCorrect;\n\n    if (feedback?.final) {\n      this.setAttemptSpecificFeedback(feedback);\n    } else {\n      this.setupIncorrectFeedback();\n    }\n  }\n\n  setupIncorrectFeedback() {\n    this.setAttemptSpecificFeedback(this.get('_feedback')._incorrect);\n  }\n\n  setAttemptSpecificFeedback(feedback) {\n    const body = (this.get('_attemptsLeft') && feedback.notFinal) || feedback.final;\n\n    this.set({\n      altFeedbackTitle: this.getAltFeedbackTitle(),\n      feedbackTitle: this.getFeedbackTitle(),\n      feedbackMessage: Handlebars.compile(body)(this.toJSON())\n    });\n  }\n\n  getAltFeedbackTitle() {\n    return this.get('_feedback').altTitle || Adapt.course.get('_globals')._accessibility.altFeedbackTitle || '';\n  }\n\n  getFeedbackTitle() {\n    const title = this.get('_feedback').title || this.get('displayTitle') || this.get('title') || '';\n    return Handlebars.compile(title)(this.toJSON());\n  }\n\n  /**\n   * Used to determine whether the learner is allowed to interact with the question component or not.\n   * @return {Boolean}\n   */\n  isInteractive() {\n    return !this.get('_isComplete') || (this.get('_isEnabled') && !this.get('_isSubmitted'));\n  }\n\n  checkIfResetOnRevisit() {\n    super.checkIfResetOnRevisit();\n    // Setup button view state\n    this.set('_buttonState', this.get('_isInteractionComplete')\n      ? BUTTON_STATE.HIDE_CORRECT_ANSWER\n      : BUTTON_STATE.SUBMIT\n    );\n  }\n\n  /**\n   * Reset the model to let the user have another go (not the same as attempts)\n   * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\n   * @param {boolean} [canReset] Defaults to this.get('_canReset')\n   * @returns {boolean}\n   */\n  reset(type = 'hard', canReset = this.get('_canReset')) {\n    const wasReset = super.reset(type, canReset);\n    if (!wasReset) return false;\n    const attempts = this.get('_attempts');\n    this.set({\n      _attemptsLeft: attempts,\n      _isCorrect: undefined,\n      _isCorrectAnswerShown: false,\n      _isSubmitted: false,\n      _buttonState: BUTTON_STATE.SUBMIT,\n      _shouldShowMarking: this.shouldShowMarking\n    });\n    return true;\n  }\n\n  // Reset question for subsequent attempts\n  setQuestionAsReset() {\n    this.set({\n      _isEnabled: true,\n      _isSubmitted: false,\n      _shouldShowMarking: this.shouldShowMarking\n    });\n    this.resetQuestion();\n  }\n\n  /**\n   * Used by the question view to reset the options of the component.\n   * This is triggered when the reset button is clicked so it shouldn't be a full reset.\n   */\n  resetQuestion() {}\n\n  refresh() {\n    this.trigger('question:refresh');\n  }\n\n  getButtonState() {\n    if (this.get('_isCorrect')) {\n      return BUTTON_STATE.CORRECT;\n    }\n\n    if (this.get('_attemptsLeft') === 0) {\n      return this.get('_canShowModelAnswer') ? BUTTON_STATE.SHOW_CORRECT_ANSWER : BUTTON_STATE.INCORRECT;\n    }\n\n    return this.get('_isSubmitted') ? BUTTON_STATE.RESET : BUTTON_STATE.SUBMIT;\n  }\n\n  // Returns an object specific to the question type, e.g. if the question\n  // is a 'choice' this should contain an object with:\n  // - correctResponsesPattern[]\n  // - choices[]\n  getInteractionObject() {\n    return {};\n  }\n\n  // Returns a string detailing how the user answered the question.\n  getResponse() {}\n\n  // Returns a string describing the type of interaction: \"choice\" and \"matching\" supported (see scorm wrapper)\n  getResponseType() {}\n\n  /**\n   * Called at the end of the onSubmitClicked view function.\n   */\n  onSubmitted() {\n    // Stores the current attempt state\n    if (this.get('_shouldStoreAttempts')) this.addAttemptObject();\n    this.set('_shouldShowMarking', this.shouldShowMarking);\n  }\n\n  /** @type {boolean} */\n  get shouldShowMarking() {\n    return (!this.isInteractive() && this.get('_canShowMarking') && this.get('_isInteractionComplete'));\n  }\n\n}\n\n// This abstract model needs to registered to support deprecated view-only questions\ncomponents.register('question', { model: QuestionModel });\n\nexport default QuestionModel;\n","import Adapt from 'core/js/adapt';\nimport ComponentView from 'core/js/views/componentView';\nimport ButtonsView from 'core/js/views/buttonsView';\nimport BUTTON_STATE from 'core/js/enums/buttonStateEnum';\nimport a11y from 'core/js/a11y';\nimport log from 'core/js/logging';\nimport data from 'core/js/data';\nimport location from 'core/js/location';\nimport 'core/js/models/questionModel';\n\nclass QuestionView extends ComponentView {\n\n  className() {\n    return [\n      'component',\n      'is-question',\n      this.model.get('_component').toLowerCase(),\n      this.model.get('_id'),\n      this.model.get('_classes'),\n      this.setVisibility(),\n      'is-' + this.model.get('_layout'),\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\n      (this.model.get('_isOptional') ? 'is-optional' : ''),\n      (this.model.get('_canShowModelAnswer') ? 'can-show-model-answer' : ''),\n      (this.model.get('_canShowFeedback') ? 'can-show-feedback' : ''),\n      (this.model.get('_canShowMarking') ? 'can-show-marking' : '')\n    ].join(' ');\n  }\n\n  initialize(...args) {\n    // Allow isInteractive to be used in jsx templates\n    this.isInteractive = this.isInteractive.bind(this);\n    super.initialize(...args);\n  }\n\n  /**\n   * Used to determine whether the learner is allowed to interact with the question component or not.\n   * @return {Boolean}\n   * @deprecated since v6.0.5 please use this.model.isInteractive, this.model.get('_shouldShowMarking') or this.model.shouldShowMarking\n  */\n  isInteractive() {\n    log.deprecated('questionView.isInteractive please use this.model.isInteractive, this.model.get(\\'_shouldShowMarking\\') or this.model.shouldShowMarking');\n    return this.model.isInteractive();\n  }\n\n  preRender() {\n    // Setup listener for _isEnabled\n    this.listenTo(this.model, 'change:_isEnabled', this.onEnabledChanged);\n\n    this.listenTo(this.model, 'question:refresh', this.refresh);\n\n    // Checks to see if the question should be reset on revisit\n    if (this.checkIfResetOnRevisit !== QuestionView.prototype.checkIfResetOnRevisit) {\n      log.deprecated('QuestionView.checkIfResetOnRevisit, please use QuestionModel.checkIfResetOnRevisit');\n    }\n    this.checkIfResetOnRevisit();\n    _.defer(() => this.ensureLegacyLifecycleState());\n    // This method helps setup default settings on the model\n    this._runModelCompatibleFunction('setupDefaultSettings');\n    // Blank method for setting up questions before rendering\n    this.setupQuestion();\n  }\n\n  // Used in the question view to disabled the question when _isEnabled has been set to false\n  onEnabledChanged(model, changedAttribute) {\n\n    // If isEnabled == false add disabled class\n    // else remove disabled class\n    if (!changedAttribute) {\n      this.$('.component__widget').addClass('is-disabled');\n      this.disableQuestion();\n    } else {\n      this.$('.component__widget').removeClass('is-disabled');\n      this.enableQuestion();\n    }\n\n  }\n\n  // Used by the question to disable the question during submit and complete stages\n  disableQuestion() {}\n\n  // Used by the question to enable the question during interactions\n  enableQuestion() {}\n\n  /**\n   * Used to check if the question should reset on revisit\n   * @deprecated since core v6.0.1 Please use QuestionModel.checkIfResetOnRevisit\n   */\n  checkIfResetOnRevisit() {\n    const canReset = (this.model.get('_canReset') !== false);\n    const isResetOnRevisit = this.model.get('_isResetOnRevisit');\n    // If reset is enabled set defaults\n    // Call blank method for question to handle\n    if (!canReset || !isResetOnRevisit) return;\n    // Skip if calling the empty function definition\n    if (this.resetQuestionOnRevisit === QuestionView.prototype.resetQuestionOnRevisit) return;\n    // Warn if using a legacy resetQuestionOnRevisit\n    log.deprecated('QuestionView.resetQuestionOnRevisit, please QuestionModel.reset');\n    // Defer is added to allow the component to render\n    _.defer(() => {\n      this.resetQuestionOnRevisit(isResetOnRevisit);\n    });\n  }\n\n  /**\n   * Ensure the view is in the correct state on first render\n   * @private\n   */\n  ensureLegacyLifecycleState() {\n    const isInteractionComplete = this.model.get('_isInteractionComplete');\n    if (isInteractionComplete) {\n      this.onHideCorrectAnswerClicked();\n      return;\n    }\n    this.onResetClicked();\n  }\n\n  /**\n   * Used by the question to reset the question when revisiting the component\n   * @param {string} type\n   * @deprecated since core v6.0.1 Please use QuestionModel.reset\n   */\n  resetQuestionOnRevisit(type) {}\n\n  // Left blank for question setup - should be used instead of preRender\n  setupQuestion() {}\n\n  // Calls default methods to setup after the question is rendered\n  postRender() {\n    this.addButtonsView();\n    this.onQuestionRendered();\n  }\n\n  // Used to setup buttonsView and sets up the internal events for the question\n  addButtonsView() {\n    this.buttonsView = new ButtonsView({ model: this.model, el: this.$('.btn__container') });\n\n    this.listenTo(this.buttonsView, 'buttons:stateUpdate', this.onButtonStateUpdate);\n\n  }\n\n  onButtonStateUpdate(buttonState) {\n\n    switch (buttonState) {\n      case BUTTON_STATE.SUBMIT:\n        this.onSubmitClicked();\n        break;\n      case BUTTON_STATE.RESET:\n        this.onResetClicked();\n        break;\n      case BUTTON_STATE.SHOW_CORRECT_ANSWER:\n        this.onShowCorrectAnswerClicked();\n        break;\n      case BUTTON_STATE.HIDE_CORRECT_ANSWER:\n        this.onHideCorrectAnswerClicked();\n        break;\n      case BUTTON_STATE.SHOW_FEEDBACK:\n        this.showFeedback();\n        break;\n    }\n\n  }\n\n  // Blank method used just like postRender is for presentational components\n  onQuestionRendered() {}\n\n  // Triggered when the submit button is clicked\n  onSubmitClicked() {\n    // canSubmit is setup in questions and should return a boolean\n    // If the question stops the user form submitting - show instruction error\n    // and give a blank method, onCannotSubmit to the question\n    const canSubmit = this._runModelCompatibleFunction('canSubmit');\n\n    if (!canSubmit) {\n      this.showInstructionError();\n      this.onCannotSubmit();\n      return;\n    }\n\n    // Used to update the amount of attempts the question has\n    this._runModelCompatibleFunction('updateAttempts');\n\n    // Used to set attributes on the model after being submitted\n    // Also adds a class of submitted\n    this._runModelCompatibleFunction('setQuestionAsSubmitted');\n\n    // Used to store the users answer for later\n    // This is a blank method given to the question\n    this._runModelCompatibleFunction('storeUserAnswer');\n\n    // Used to set question as correct:true/false\n    // Calls isCorrect which is blank for the question\n    // to fill out and return a boolean\n    this._runModelCompatibleFunction('markQuestion', 'isCorrect');\n\n    // Used by the question to set the score on the model\n    this._runModelCompatibleFunction('setScore');\n\n    // Used to check if the question is complete\n    // Triggers setCompletionStatus and adds class to widget\n    this._runModelCompatibleFunction('checkQuestionCompletion');\n\n    // Used by the question to display markings on the component\n    if (this.model.shouldShowMarking) {\n      this.showMarking();\n    }\n\n    this.recordInteraction();\n\n    // Used to setup the feedback by checking against\n    // question isCorrect or isPartlyCorrect\n    this._runModelCompatibleFunction('setupFeedback');\n\n    // Used to trigger an event so plugins can display feedback\n    // Do this before updating the buttons so that the focus can be\n    // shifted immediately\n    this.showFeedback();\n\n    // Force height re-calculations before the submit button\n    // becomes disabled.\n    $(window).resize();\n\n    // Used to update buttonsView based upon question state\n    // Update buttons happens before showFeedback to preserve tabindexes and after setupFeedback to allow buttons to use feedback attribute\n    this._runModelCompatibleFunction('updateButtons');\n\n    this.model.onSubmitted();\n    this.onSubmitted();\n  }\n\n  showInstructionError() {\n    Adapt.trigger('questionView:showInstructionError', this);\n  }\n\n  // Blank method for question to fill out when the question cannot be submitted\n  onCannotSubmit() {}\n\n  // Blank method for question to fill out when the question was successfully submitted\n  onSubmitted() {}\n\n  // Used to set _isEnabled and _isSubmitted on the model\n  // Also adds a 'submitted' class to the widget\n  setQuestionAsSubmitted() {\n    this.model.setQuestionAsSubmitted();\n    this.$('.component__widget').addClass('is-submitted');\n  }\n\n  // This is important and should give the user feedback on how they answered the question\n  // Normally done through ticks and crosses by adding classes\n  showMarking() {}\n\n  // Checks if the question should be set to complete\n  // Calls setCompletionStatus and adds complete classes\n  checkQuestionCompletion() {\n\n    const isComplete = this.model.checkQuestionCompletion();\n\n    if (isComplete) {\n      this.$('.component__widget').addClass('is-complete show-user-answer');\n    }\n\n  }\n\n  recordInteraction() {\n    if (this.model.get('_recordInteraction') === true || !this.model.has('_recordInteraction')) {\n      Adapt.trigger('questionView:recordInteraction', this);\n    }\n  }\n\n  // Used to show feedback based upon whether _canShowFeedback is true\n  showFeedback() {\n\n    if (this.model.get('_canShowFeedback')) {\n      Adapt.trigger('questionView:showFeedback', this);\n    } else {\n      Adapt.trigger('questionView:disabledFeedback', this);\n    }\n\n  }\n\n  onResetClicked() {\n    this.setQuestionAsReset();\n\n    this._runModelCompatibleFunction('resetUserAnswer');\n\n    this.model.checkCanSubmit();\n\n    this._runModelCompatibleFunction('updateButtons');\n\n    // onResetClicked is called as part of the checkIfResetOnRevisit\n    // function and as a button click. if the view is already rendered,\n    // then the button was clicked, focus on the first tabbable element\n    if (!this.model.get('_isReady')) return;\n    // Attempt to get the current page location\n    const currentModel = data.findById(location._currentId);\n    // Make sure the page is ready\n    if (!currentModel?.get('_isReady')) return;\n    // Focus on the first readable item in this element\n    a11y.focusNext(this.$el, { preventScroll: true });\n  }\n\n  setQuestionAsReset() {\n    this.model.setQuestionAsReset();\n    this.resetQuestion();\n    this.$('.component__widget').removeClass('is-submitted');\n  }\n\n  /**\n   * Used by the question view to reset the look and feel of the component.\n   * This is triggered when the reset button is clicked so it shouldn't be a full reset.\n   */\n  resetQuestion() {}\n\n  refresh() {\n    this.model.set('_buttonState', this.model.getButtonState());\n\n    if (this.model.shouldShowMarking) {\n      this.showMarking();\n    }\n\n    if (this.buttonsView) {\n      _.defer(this.buttonsView.refresh.bind(this.buttonsView));\n    }\n  }\n\n  onShowCorrectAnswerClicked() {\n    this.setQuestionAsShowCorrect();\n\n    this._runModelCompatibleFunction('updateButtons');\n\n    this.showCorrectAnswer();\n  }\n\n  setQuestionAsShowCorrect() {\n    this.$('.component__widget')\n      .addClass('is-submitted show-correct-answer')\n      .removeClass('show-user-answer');\n  }\n\n  // Used by the question to display the correct answer to the user\n  showCorrectAnswer() {\n    this.model.set('_isCorrectAnswerShown', true);\n  }\n\n  onHideCorrectAnswerClicked() {\n    this.setQuestionAsHideCorrect();\n\n    this._runModelCompatibleFunction('updateButtons');\n\n    this.hideCorrectAnswer();\n  }\n\n  setQuestionAsHideCorrect() {\n    this.$('.component__widget')\n      .addClass('is-submitted show-user-answer')\n      .removeClass('show-correct-answer');\n  }\n\n  // Used by the question to display the users answer and\n  // hide the correct answer\n  // Should use the values stored in storeUserAnswer\n  hideCorrectAnswer() {\n    this.model.set('_isCorrectAnswerShown', false);\n  }\n\n  // Time elapsed between the time the interaction was made available to the learner for response and the time of the first response\n  getLatency() {\n    return null;\n  }\n\n  // This function is overridden if useQuestionModeOnly: false. see below.\n  _runModelCompatibleFunction(name, lookForViewOnlyFunction) {\n    return this.model[name](); // questionModel Only\n  }\n}\n\nQuestionView._isQuestionType = true;\n\n/* BACKWARDS COMPATIBILITY SECTION\n* This section below is only for compatibility between the separated questionView+questionModel and the old questionView\n* Remove this section in when all components use questionModel and there is no need to have model behaviour in the questionView\n*/\n\nclass ViewOnlyQuestionViewCompatibilityLayer extends QuestionView {\n\n  /* All of these functions have been moved to the questionModel.js file.\n    * On the rare occasion that they have not been overridden by the component and\n          that they call the view only questionView version,\n          these functions are included as redirects to the new Question Model.\n          It is very unlikely that these are needed but they are included to ensure compatibility.\n    * If you need to override these in your component you should now make and register a component model.\n    * Please remove them from your question component's view.\n  */\n\n  // Returns an object specific to the question type.\n  getInteractionObject() {\n    log.deprecated('QuestionView.getInteractionObject, please use QuestionModel.getInteractionObject');\n    return this.model.getInteractionObject();\n  }\n\n  // Retturns a string detailing how the user answered the question.\n  getResponse() {\n    log.deprecated('QuestionView.getInteractionObject, please use QuestionModel.getInteractionObject');\n    return this.model.getResponse();\n  }\n\n  // Returns a string describing the type of interaction: \"choice\" and \"matching\" supported (see scorm wrapper)\n  getResponseType() {\n    log.deprecated('QuestionView.getResponseType, please use QuestionModel.getResponseType');\n    return this.model.getResponseType();\n  }\n\n  // Calls default methods to setup on questions\n  setupDefaultSettings() {\n    log.deprecated('QuestionView.setupDefaultSettings, please use QuestionModel.setupDefaultSettings');\n    return this.model.setupDefaultSettings();\n  }\n\n  // Used to setup either global or local button text\n  setupButtonSettings() {\n    log.deprecated('QuestionView.setupButtonSettings, please use QuestionModel.setupButtonSettings');\n    return this.model.setupButtonSettings();\n  }\n\n  // Used to setup either global or local question weight/score\n  setupWeightSettings() {\n    log.deprecated('QuestionView.setupWeightSettings, please use QuestionModel.setupWeightSettings');\n    return this.model.setupWeightSettings();\n  }\n\n  // Use to check if the user is allowed to submit the question\n  // Maybe the user has to select an item?\n  canSubmit() {\n    log.deprecated('QuestionView.canSubmit, please use QuestionModel.canSubmit');\n    return this.model.canSubmit();\n  }\n\n  // Used to update the amount of attempts the user has left\n  updateAttempts() {\n    log.deprecated('QuestionView.updateAttempts, please use QuestionModel.updateAttempts');\n    return this.model.updateAttempts();\n  }\n\n  // This is important for returning or showing the users answer\n  // This should preserve the state of the users answers\n  storeUserAnswer() {\n    log.deprecated('QuestionView.storeUserAnswer, please use QuestionModel.storeUserAnswer');\n    return this.model.storeUserAnswer();\n  }\n\n  // Used by the question view to reset the stored user answer\n  resetUserAnswer() {\n    log.deprecated('QuestionView.resetUserAnswer, please use QuestionModel.resetUserAnswer');\n    return this.model.resetUserAnswer();\n  }\n\n  // Sets _isCorrect:true/false based upon isCorrect method below\n  markQuestion() {\n\n    if (this._isInViewOnlyCompatibleMode('isCorrect')) {\n\n      if (this.isCorrect()) {\n        this.model.set('_isCorrect', true);\n      } else {\n        this.model.set('_isCorrect', false);\n      }\n\n      this.model.set({\n        _rawScore: this.model.get('_isCorrect') ? this.model.get('_questionWeight') : 0,\n        _maxScore: this.model.get('_questionWeight'),\n        _minScore: 0\n      });\n\n    } else {\n      return this.model.markQuestion();\n    }\n  }\n\n  // Should return a boolean based upon whether to question is correct or not\n  isCorrect() {\n    log.deprecated('QuestionView.isCorrect, please use QuestionModel.isCorrect');\n    return this.model.isCorrect();\n  }\n\n  // Used to set the score based upon the _questionWeight\n  setScore() {\n    log.deprecated('QuestionView.setScore, please use QuestionModel.setScore');\n    return this.model.setScore();\n  }\n\n  // Updates buttons based upon question state by setting\n  // _buttonState on the model which buttonsView listens to\n  updateButtons() {\n    log.deprecated('QuestionView.updateButtons, please use QuestionModel.updateButtons');\n    return this.model.updateButtons();\n  }\n\n  // Used to setup the correct, incorrect and partly correct feedback\n  setupFeedback() {\n\n    if (this._isInViewOnlyCompatibleMode('isPartlyCorrect')) {\n\n      // Use view based feedback where necessary\n      if (this.model.get('_isCorrect')) {\n        this._runModelCompatibleFunction('setupCorrectFeedback');\n      } else if (this.isPartlyCorrect()) {\n        this._runModelCompatibleFunction('setupPartlyCorrectFeedback');\n      } else {\n        this._runModelCompatibleFunction('setupIncorrectFeedback');\n      }\n\n    } else {\n      // Use model based feedback\n      this.model.setupFeedback();\n    }\n\n  }\n\n  // Used by the question to determine if the question is incorrect or partly correct\n  // Should return a boolean\n  isPartlyCorrect() {\n    log.deprecated('QuestionView.isPartlyCorrect, please use QuestionModel.isPartlyCorrect');\n    return this.model.isPartlyCorrect();\n  }\n\n  setupCorrectFeedback() {\n    log.deprecated('QuestionView.setupCorrectFeedback, please use QuestionModel.setupCorrectFeedback');\n    return this.model.setupCorrectFeedback();\n  }\n\n  setupPartlyCorrectFeedback() {\n    log.deprecated('QuestionView.setupPartlyCorrectFeedback, please use QuestionModel.setupPartlyCorrectFeedback');\n    return this.model.setupPartlyCorrectFeedback();\n  }\n\n  setupIncorrectFeedback() {\n    log.deprecated('QuestionView.setupIncorrectFeedback, please use QuestionModel.setupIncorrectFeedback');\n    return this.model.setupIncorrectFeedback();\n  }\n\n  // Helper functions for compatibility layer\n  _runModelCompatibleFunction(name, lookForViewOnlyFunction) {\n    if (this._isInViewOnlyCompatibleMode(name, lookForViewOnlyFunction)) {\n      return this[name](); // questionView\n    } else {\n      return this.model[name](); // questionModel\n    }\n  }\n\n  _isInViewOnlyCompatibleMode(name, lookForViewOnlyFunction) {\n    // return false uses the model function questionModel\n    // return true uses the view only function questionView\n\n    const checkForFunction = (lookForViewOnlyFunction || name);\n\n    // if the function does NOT exist on the view at all, use the model only\n    if (!this.constructor.prototype[checkForFunction]) return false; // questionModel\n\n    // if the function DOES exist on the view and MATCHES the compatibility function above, use the model only\n    const hasCompatibleVersion = (Object.prototype.hasOwnProperty.call(ViewOnlyQuestionViewCompatibilityLayer.prototype, checkForFunction));\n    const usingCompatibleVersion = (this.constructor.prototype[checkForFunction] === ViewOnlyQuestionViewCompatibilityLayer.prototype[checkForFunction]);\n    if (hasCompatibleVersion && usingCompatibleVersion) {\n      switch (checkForFunction) {\n        case 'setupFeedback':\n        case 'markQuestion':\n          return true; // questionView\n      }\n      return false; // questionModel\n    }\n\n    // if the function DOES exist on the view and does NOT match the compatibility function above, use the view function\n    return true; // questionView\n  }\n\n};\n\n// return question view class extended with the compatibility layer\nexport default ViewOnlyQuestionViewCompatibilityLayer;\n\n/* END OF BACKWARDS COMPATIBILITY SECTION */\n","import QuestionView from 'core/js/views/questionView';\n\nclass MatchingView extends QuestionView {\n\n  preinitialize() {\n    this.setActiveOption = (...args) => this.model.setActiveOption(...args);\n    this.setHighlightedOption = (...args) => this.model.setHighlightedOption(...args);\n  }\n\n  setupQuestion() {\n    this.model.setupRandomisation();\n    this.model.setupInitialHighlighted();\n  }\n\n  onQuestionRendered() {\n    this.setReadyStatus();\n  }\n\n}\n\nMatchingView.template = 'matching.jsx';\n\nexport default MatchingView;\n","import LockingModel from 'core/js/models/lockingModel';\n\nexport default class ItemModel extends LockingModel {\n\n  defaults() {\n    return {\n      _isActive: false,\n      _isVisited: false,\n      _score: 0\n    };\n  }\n\n  reset() {\n    this.set({ _isActive: false, _isVisited: false });\n  }\n\n  toggleActive(isActive = !this.get('_isActive')) {\n    this.set('_isActive', isActive);\n  }\n\n  toggleVisited(isVisited = !this.get('_isVisited')) {\n    this.set('_isVisited', isVisited);\n  }\n\n}\n","import ItemModel from 'core/js/models/itemModel';\n\nexport default class MatchingItemModel extends ItemModel {\n\n  defaults() {\n    return ItemModel.resultExtend('defaults', {\n      _isHighlighted: false\n    });\n  }\n\n  toggleHighlighted(isHighlighted = !this.get('_isHighlighted')) {\n    this.set('_isHighlighted', isHighlighted);\n  }\n\n}\n","import ComponentModel from 'core/js/models/componentModel';\nimport ItemModel from 'core/js/models/itemModel';\n\nexport default class ItemsComponentModel extends ComponentModel {\n\n  toJSON() {\n    const json = super.toJSON();\n    // Make sure _items is updated from child collection\n    json._items = this.getChildren().toJSON();\n    return json;\n  }\n\n  init() {\n    this.setUpItems();\n    this.listenTo(this.getChildren(), {\n      all: this.onAll,\n      'change:_isActive': this.setVisitedStatus,\n      'change:_isVisited': this.checkCompletionStatus\n    });\n    super.init();\n  }\n\n  restoreUserAnswers() {\n    const booleanArray = this.get('_userAnswer');\n    if (!booleanArray) return;\n    this.getChildren().forEach((child, index) => child.set('_isVisited', booleanArray[index]));\n  }\n\n  storeUserAnswer() {\n    const booleanArray = this.getChildren().map(child => child.get('_isVisited'));\n    this.set('_userAnswer', booleanArray);\n  }\n\n  setUpItems() {\n    // see https://github.com/adaptlearning/adapt_framework/issues/2480\n    const items = this.get('_items') || [];\n    items.forEach((item, index) => (item._index = index));\n    this.setChildren(new Backbone.Collection(items, { model: ItemModel }));\n  }\n\n  getItem(index) {\n    return this.getChildren().findWhere({ _index: index });\n  }\n\n  getVisitedItems() {\n    return this.getChildren().where({ _isVisited: true });\n  }\n\n  getActiveItems() {\n    return this.getChildren().where({ _isActive: true });\n  }\n\n  getActiveItem() {\n    return this.getChildren().findWhere({ _isActive: true });\n  }\n\n  areAllItemsCompleted() {\n    return this.getVisitedItems().length === this.getChildren().length;\n  }\n\n  checkCompletionStatus() {\n    this.setVisitedStatus();\n    this.storeUserAnswer();\n    if (!this.areAllItemsCompleted()) return;\n    this.setCompletionStatus();\n  }\n\n  /**\n   * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\n   * @param {boolean} [canReset] Defaults to this.get('_canReset')\n   * @returns {boolean}\n   */\n  reset(type = 'hard', canReset = this.get('_canReset')) {\n    const wasReset = super.reset(type, canReset);\n    if (!wasReset) return false;\n    this.getChildren().each(item => item.reset());\n    return true;\n  }\n\n  resetActiveItems() {\n    this.getChildren().each(item => item.toggleActive(false));\n  }\n\n  setActiveItem(index) {\n    const item = this.getItem(index);\n    if (!item) return;\n\n    const activeItem = this.getActiveItem();\n    if (activeItem) activeItem.toggleActive(false);\n    item.toggleActive(true);\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport QuestionModel from 'core/js/models/questionModel';\nimport ItemsComponentModel from 'core/js/models/itemsComponentModel';\n\nclass BlendedItemsComponentQuestionModel extends QuestionModel {\n\n  init() {\n    ItemsComponentModel.prototype.init.call(this);\n    super.init();\n  }\n\n  /**\n   * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\n   * @param {boolean} [canReset] Defaults to this.get('_canReset')\n   * @returns {boolean}\n   */\n  reset(type = 'hard', canReset = this.get('_canReset')) {\n    ItemsComponentModel.prototype.reset.call(this, type, canReset);\n    return super.reset(type, canReset);\n  }\n\n}\n// extend BlendedItemsComponentQuestionModel with ItemsComponentModel\nObject.getOwnPropertyNames(ItemsComponentModel.prototype).forEach(name => {\n  if (name === 'constructor' || name === 'init' || name === 'reset') return;\n  Object.defineProperty(BlendedItemsComponentQuestionModel.prototype, name, {\n    value: ItemsComponentModel.prototype[name]\n  });\n});\n\nexport default class ItemsQuestionModel extends BlendedItemsComponentQuestionModel {\n\n  init() {\n    super.init();\n    this.set('_isRadio', this.isSingleSelect());\n    this.listenTo(this.getChildren(), 'change:_isActive', this.checkCanSubmit);\n    this.checkCanSubmit();\n  }\n\n  restoreUserAnswers() {\n    if (!this.get('_isSubmitted')) return;\n\n    const itemModels = this.getChildren();\n    const userAnswer = this.get('_userAnswer');\n    itemModels.each(item => {\n      item.toggleActive(userAnswer[item.get('_index')]);\n    });\n\n    this.setQuestionAsSubmitted();\n    this.markQuestion();\n    this.setScore();\n    this.setupFeedback();\n  }\n\n  setupRandomisation() {\n    if (!this.get('_isRandom') || !this.get('_isEnabled')) return;\n    const children = this.getChildren();\n    children.set(children.shuffle());\n  }\n\n  // check if the user is allowed to submit the question\n  canSubmit() {\n    const activeItems = this.getActiveItems();\n    return activeItems.length > 0;\n  }\n\n  // This is important for returning or showing the users answer\n  // This should preserve the state of the users answers\n  storeUserAnswer() {\n    const items = this.getChildren().slice(0);\n    items.sort((a, b) => a.get('_index') - b.get('_index'));\n    const userAnswer = items.map(itemModel => itemModel.get('_isActive'));\n    this.set('_userAnswer', userAnswer);\n  }\n\n  isCorrect() {\n    const allChildren = this.getChildren();\n    const activeChildren = allChildren.filter(itemModel => itemModel.get('_isActive'));\n\n    const isItemCorrect = itemModel => itemModel.get('_shouldBeSelected') && !itemModel.get('_isPartlyCorrect');\n    const isItemPartlyCorrect = itemModel => itemModel.get('_isPartlyCorrect');\n    const isItemIncorrect = itemModel => !itemModel.get('_shouldBeSelected') && !itemModel.get('_isPartlyCorrect');\n\n    const sum = (list, predicate) => list.reduce((sum, item) => sum + (predicate(item) ? 1 : 0), 0);\n\n    const props = {\n      _numberOfRequiredAnswers: sum(allChildren, isItemCorrect),\n      _numberOfCorrectAnswers: sum(activeChildren, isItemCorrect),\n      _numberOfPartlyCorrectAnswers: sum(activeChildren, isItemPartlyCorrect),\n      _numberOfIncorrectAnswers: sum(activeChildren, isItemIncorrect)\n    };\n\n    activeChildren.forEach(itemModel => itemModel.set('_isCorrect', itemModel.get('_shouldBeSelected')));\n\n    props._isAtLeastOneCorrectSelection = (props._numberOfCorrectAnswers || props._numberOfPartlyCorrectAnswers);\n\n    const numberOfSelectableAnswers = this.get('_selectable');\n    const hasSelectableCorrectAnswers = (props._numberOfCorrectAnswers === numberOfSelectableAnswers);\n    const hasAllCorrectAnswers = (props._numberOfCorrectAnswers === props._numberOfRequiredAnswers);\n    const hasCorrectAnswers = (hasSelectableCorrectAnswers || hasAllCorrectAnswers);\n    const hasIncorrectAnswers = props._numberOfIncorrectAnswers;\n    const hasPartlyCorrectAnswers = props._numberOfPartlyCorrectAnswers;\n\n    this.set(props);\n\n    return hasCorrectAnswers && !hasIncorrectAnswers && !hasPartlyCorrectAnswers;\n  }\n\n  // Sets the score based upon the questionWeight\n  // Can be overwritten if the question needs to set the score in a different way\n  setScore() {\n    const questionWeight = this.get('_questionWeight');\n    const answeredCorrectly = this.get('_isCorrect');\n    const score = answeredCorrectly ? questionWeight : 0;\n    this.set('_score', score);\n  }\n\n  get score() {\n    if (!this.get('_hasItemScoring')) return super.score;\n    const children = this.getChildren()?.toArray() || [];\n    return children.reduce((score, child) => (score += child.get('_isActive') ? child.get('_score') || 0 : 0), 0);\n  }\n\n  get maxScore() {\n    if (!this.get('_hasItemScoring')) return super.maxScore;\n    const children = this.getChildren()?.toArray() || [];\n    const scores = children.map(child => child.get('_score') || 0);\n    scores.sort((a, b) => a - b);\n    return scores.reverse().slice(0, this.get('_selectable')).filter(score => score > 0).reduce((maxScore, score) => (maxScore += score), 0);\n  }\n\n  get minScore() {\n    if (!this.get('_hasItemScoring')) return super.minScore;\n    const children = this.getChildren()?.toArray() || [];\n    const scores = children.map(child => child.get('_score') || 0);\n    scores.sort((a, b) => a - b);\n    return scores.slice(0, this.get('_selectable')).filter(score => score < 0).reduce((minScore, score) => (minScore += score), 0);\n  }\n\n  setupFeedback() {\n    if (!this.has('_feedback')) return;\n\n    if (this.get('_isCorrect')) {\n      this.setupCorrectFeedback();\n      return;\n    }\n\n    if (this.isPartlyCorrect()) {\n      this.setupPartlyCorrectFeedback();\n      return;\n    }\n\n    // apply individual item feedback\n    const activeItem = this.getActiveItem();\n    if (this.isSingleSelect() && activeItem.get('feedback')) {\n      this.setupIndividualFeedback(activeItem);\n      return;\n    }\n\n    this.setupIncorrectFeedback();\n  }\n\n  setupIndividualFeedback(selectedItem) {\n    const json = this.toJSON();\n    this.set({\n      feedbackTitle: Handlebars.compile(this.getFeedbackTitle(this.get('_feedback')))(json),\n      feedbackMessage: Handlebars.compile(selectedItem.get('feedback'))(json)\n    });\n  }\n\n  isPartlyCorrect() {\n    return this.get('_isAtLeastOneCorrectSelection');\n  }\n\n  resetUserAnswer() {\n    this.set('_userAnswer', []);\n  }\n\n  isAtActiveLimit() {\n    const selectedItems = this.getActiveItems();\n    return (selectedItems.length === this.get('_selectable'));\n  }\n\n  isSingleSelect() {\n    return (this.get('_selectable') === 1);\n  }\n\n  getLastActiveItem() {\n    const selectedItems = this.getActiveItems();\n    return selectedItems[selectedItems.length - 1];\n  }\n\n  /**\n   * Reset the question items for another attempt\n   */\n  resetQuestion() {\n    this.resetItems();\n  }\n\n  resetItems() {\n    this.resetActiveItems();\n    this.set('_isAtLeastOneCorrectSelection', false);\n  }\n\n  getInteractionObject() {\n    const interactions = {\n      correctResponsesPattern: [],\n      choices: []\n    };\n\n    interactions.choices = this.getChildren().map(itemModel => {\n      return {\n        id: (itemModel.get('_index') + 1).toString(),\n        description: itemModel.get('text')\n      };\n    });\n\n    const correctItems = this.getChildren().filter(itemModel => {\n      return itemModel.get('_shouldBeSelected');\n    });\n\n    interactions.correctResponsesPattern = [\n      correctItems.map(itemModel => {\n        // indexes are 0-based, we need them to be 1-based for cmi.interactions\n        return String(itemModel.get('_index') + 1);\n      }).join('[,]')\n    ];\n\n    return interactions;\n  }\n\n  /**\n  * used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\n  * returns the user's answers as a string in the format '1,5,2'\n  */\n  getResponse() {\n    const activeItems = this.getActiveItems();\n    const activeIndexes = activeItems.map(itemModel => {\n      // indexes are 0-based, we need them to be 1-based for cmi.interactions\n      return itemModel.get('_index') + 1;\n    });\n    return activeIndexes.join(',');\n  }\n\n  /**\n  * used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\n  */\n  getResponseType() {\n    return 'choice';\n  }\n\n  /**\n   * Creates a string explaining the answer(s) the learner should have chosen\n   * Used by ButtonsView to retrieve question-specific correct answer text for the ARIA\n   * 'live region' that gets updated when the learner selects the 'show correct answer' button\n   * @return {string}\n   */\n  getCorrectAnswerAsText() {\n    const globals = Adapt.course.get('_globals')._components['_' + this.get('_component')];\n    const isSingleSelect = this.isSingleSelect();\n    const ariaAnswer = isSingleSelect ? globals?.ariaCorrectAnswer : globals?.ariaCorrectAnswers;\n    if (!ariaAnswer) return;\n\n    const correctOptions = this.getChildren().where({ _shouldBeSelected: true });\n    const correctAnswer = isSingleSelect ?\n      correctOptions[0]?.get('text') :\n      correctOptions.map(correctOption => correctOption.get('text')).join('<br>');\n\n    return Handlebars.compile(ariaAnswer)({ correctAnswer });\n  }\n\n  /**\n   * Creates a string listing the answer(s) the learner chose\n   * Used by ButtonsView to retrieve question-specific user answer text for the ARIA\n   * 'live region' that gets updated when the learner selects the 'hide correct answer' button\n   * @return {string}\n   */\n  getUserAnswerAsText() {\n    const globals = Adapt.course.get('_globals')._components['_' + this.get('_component')];\n    const isSingleSelect = this.isSingleSelect();\n    const ariaAnswer = isSingleSelect ? globals?.ariaUserAnswer : globals?.ariaUserAnswers;\n    if (!ariaAnswer) return;\n\n    const selectedItems = this.getActiveItems();\n    const userAnswer = isSingleSelect ?\n      selectedItems[0].get('text') :\n      selectedItems.map(selectedItem => selectedItem.get('text')).join('<br>');\n\n    return Handlebars.compile(ariaAnswer)({ userAnswer });\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport MatchingItemModel from './MatchingItemModel';\nimport ItemsQuestionModel from 'core/js/models/itemsQuestionModel';\n\nexport default class MatchingModel extends ItemsQuestionModel {\n\n  toJSON() {\n    const json = super.toJSON();\n    // Make sure _items and _options is updated from child collection\n    json._items = this.get('_items');\n    json._options = this.getChildren().toJSON();\n    return json;\n  }\n\n  setUpItems() {\n    let index = 0;\n    const items = (this.get('_items') || []);\n    const options = items.reduce((options, item, itemIndex) => {\n      item._index = itemIndex;\n      const itemOptions = (item._options || []);\n      itemOptions.forEach((option, optionIndex) => {\n        option._index = index++;\n        option._optionIndex = optionIndex;\n        option._itemIndex = item._index;\n        option._shouldBeSelected = Boolean(option._isCorrect);\n      });\n      options.push(...itemOptions);\n      return options;\n    }, []);\n    this.set({\n      _items: items,\n      _selectable: items.length\n    });\n    // Use _options for getChildren instead of _items.\n    // Note: This creates a small gap between the json config and the ItemsQuestionModel apis\n    // as 'item' in the api refers now to 'options' from the json. Doing this allows the options\n    // to inherit the scoring, save/restore and completion mechanisms normally reserve for _items\n    this.setChildren(new Backbone.Collection(options, { model: MatchingItemModel }));\n  }\n\n  setupInitialHighlighted() {\n    this.get('_items')?.forEach(({ _index }) => {\n      const selectOption = this.getActiveItemOption(_index) || this.getFirstItemOption(_index);\n      selectOption?.toggleHighlighted(true);\n    });\n  }\n\n  resetItems() {\n    super.resetItems();\n    this.resetHighlightedItems();\n    this.setupInitialHighlighted();\n  }\n\n  resetHighlightedItems() {\n    this.getChildren().forEach(option => option.toggleHighlighted(false));\n  }\n\n  canSubmit() {\n    // Can submit if every item has an active option\n    const options = this.getChildren().models;\n    const activeCount = options.reduce((count, option) => (count + (option.get('_isActive') ? 1 : 0)), 0);\n    const canSubmit = (activeCount === this.get('_selectable'));\n    return canSubmit;\n  }\n\n  getItemOptions(itemIndex) {\n    return this.getChildren().filter(option => (option.get('_itemIndex') === itemIndex));\n  }\n\n  getActiveItemOption(itemIndex) {\n    return this.getItemOptions(itemIndex).find(option => option.get('_isActive'));\n  }\n\n  getFirstItemOption(itemIndex) {\n    return this.getItemOptions(itemIndex)[0];\n  }\n\n  getCorrectItemOption(itemIndex) {\n    const activeOption = this.getActiveItemOption(itemIndex);\n    return activeOption.get('_shouldBeSelected')\n      ? activeOption\n      : this.getItemOptions(itemIndex).find(option => option.get('_shouldBeSelected'));\n  }\n\n  setHighlightedOption(optionIndex) {\n    const itemIndex = this.getItem(optionIndex).get('_itemIndex');\n    const itemOptions = this.getItemOptions(itemIndex);\n    itemOptions.forEach(option => {\n      const isHighlighted = (option.get('_index') === optionIndex);\n      option.toggleHighlighted(isHighlighted);\n    });\n  }\n\n  setActiveOption(optionIndex) {\n    const itemIndex = this.getItem(optionIndex).get('_itemIndex');\n    const itemOptions = this.getItemOptions(itemIndex);\n    itemOptions.forEach(option => {\n      const isActive = (option.get('_index') === optionIndex);\n      option.toggleHighlighted(isActive);\n      option.toggleActive(isActive);\n    });\n    this.unsetDuplicateOptions(optionIndex);\n  }\n\n  unsetDuplicateOptions(optionIndex) {\n    const allowOnlyUniqueAnswers = this.get('_allowOnlyUniqueAnswers');\n    if (!allowOnlyUniqueAnswers) return;\n    const itemIndex = this.getItem(optionIndex).get('_itemIndex');\n    const activeItemOption = this.getActiveItemOption(itemIndex);\n    const activeItemOptionText = activeItemOption.get('text');\n    const otherActiveOptions = this.getChildren().filter(option => (option !== activeItemOption) && option.get('_isActive'));\n    otherActiveOptions.forEach(option => {\n      const optionText = option.get('text');\n      const hasMatchingText = (activeItemOptionText === optionText);\n      if (!hasMatchingText) return;\n      option.toggleHighlighted(false);\n      option.toggleActive(false);\n    });\n  }\n\n  get maxScore() {\n    if (!this.get('_hasItemScoring')) return super.maxScore;\n    const items = this.get('_items') || [];\n    const maxItemScores = items.map(({ _index }) => {\n      const itemOptions = this.getItemOptions(_index);\n      const optionScores = itemOptions.map(child => child.get('_score') || 0);\n      optionScores.sort((a, b) => a - b);\n      return optionScores[optionScores.length - 1] || 0;\n    });\n    maxItemScores.sort((a, b) => a - b);\n    return maxItemScores.reverse().filter(score => score > 0).reduce((maxScore, score) => (maxScore += score), 0);\n  }\n\n  get minScore() {\n    if (!this.get('_hasItemScoring')) return super.minScore;\n    const items = this.get('_items') || [];\n    const minItemScores = items.map(({ _index }) => {\n      const itemOptions = this.getItemOptions(_index);\n      const optionScores = itemOptions.map(child => child.get('_score') || 0);\n      optionScores.sort((a, b) => a - b);\n      return optionScores[0] || 0;\n    });\n    minItemScores.sort((a, b) => a - b);\n    return minItemScores.filter(score => score < 0).reduce((minScore, score) => (minScore += score), 0);\n  }\n\n  /**\n   * Used by tracking extensions to return an object containing the component's specific interactions.\n   */\n  getInteractionObject() {\n    const items = this.get('_items');\n    const interactions = {\n      correctResponsesPattern: null,\n      source: null,\n      target: null\n    };\n    // This contains an array with a single string value, matching the source 'id' with the correct\n    // matching target 'id' value. An example is as follows:\n    // [ \"1[.]1_2[,]2[.]2_3\" ]\n    interactions.correctResponsesPattern = [\n      items.map((item) => {\n        // Offset the item index and use it as a group identifier.\n        const itemPosition = item._index + 1;\n        const itemOptions = this.getItemOptions(item._index).sort((a, b) => a.get('_index') - b.get('_index'));\n        return [\n          itemPosition,\n          // Get the correct item(s).\n          itemOptions.filter(option => option.get('_shouldBeSelected')).map(option => {\n            // Prefix the option's index and offset by 1.\n            const optionPosition = option.get('_optionIndex') + 1;\n            return `${itemPosition}_${optionPosition}`;\n          })\n        ].join('[.]');\n      }).join('[,]')\n    ];\n    // The 'source' property contains an array of all the stems/questions, e.g.\n    // [{id: \"1\", description: \"First question\"}, {id: \"2\", description: \"Second question\"}]\n    interactions.source = items.map(item => {\n      const itemPosition = item._index + 1;\n      return {\n        // Offset by 1.\n        id: `${itemPosition}`,\n        description: item.text\n      };\n    }).flat(Infinity);\n    // The 'target' property contains an array of all the option responses, with the 'id'\n    // prefixed to indicate the grouping, e.g.\n    // [  {id: \"1_1\": description: \"First option, group 1\"},\n    //    {id: \"1_2\": description: \"Second option, group 1\"}\n    //    {id: \"2_1\": description: \"First option, group 2\"}  ]\n    interactions.target = items.map(item => {\n      // Offset by 1, as these values are not zero-indexed.\n      const itemPosition = item._index + 1;\n      const itemOptions = this.getItemOptions(item._index).sort((a, b) => a.get('_index') - b.get('_index'));\n      return itemOptions.map(option => {\n        const optionPosition = option.get('_optionIndex') + 1;\n        return {\n          id: `${itemPosition}_${optionPosition}`,\n          description: option.get('text')\n        };\n      });\n    }).flat(Infinity);\n    return interactions;\n  }\n\n  /**\n   * Used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\n   * @return {string} the user's answers as a string in the format \"1.1#2.3#3.2\" assuming user selected option 1 in drop-down 1,\n   * option 3 in drop-down 2 and option 2 in drop-down 3. The '#' character will be changed to either ',' or '[,]' by adapt-contrib-spoor,\n   * depending on which SCORM version is being used.\n   */\n  getResponse() {\n    const items = this.get('_items');\n    const responses = items.map(({ _index }) => {\n      const activeOption = this.getActiveItemOption(_index);\n      // convert from 0-based to 1-based counting\n      const itemIndex = _index + 1;\n      const optionIndex = activeOption.get('_optionIndex') + 1;\n      return `${itemIndex}.${optionIndex}`;\n    });\n    return responses.join('#');\n  }\n\n  /**\n   * Used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\n   * @return {string}\n   */\n  getResponseType() {\n    return 'matching';\n  }\n\n  /**\n   * Creates a string explaining the answers the learner should have chosen\n   * Used by ButtonsView to retrieve question-specific correct answer text for the ARIA\n   * 'live region' that gets updated when the learner selects the 'show correct answer' button\n   * @return {string}\n   */\n  getCorrectAnswerAsText() {\n    const correctAnswerTemplate = Adapt.course.get('_globals')._components._matching.ariaCorrectAnswer;\n    const ariaAnswer = this.get('_items').map(item => {\n      const correctOption = this.getCorrectItemOption(item._index);\n      return Handlebars.compile(correctAnswerTemplate)({\n        itemText: item.text,\n        correctAnswer: correctOption.get('text')\n      });\n    }).join('<br>');\n\n    return ariaAnswer;\n  }\n\n  /**\n   * Creates a string listing the answers the learner chose\n   * Used by ButtonsView to retrieve question-specific user answer text for the ARIA\n   * 'live region' that gets updated when the learner selects the 'hide correct answer' button\n   * @return {string}\n   */\n  getUserAnswerAsText() {\n    const userAnswerTemplate = Adapt.course.get('_globals')._components._matching.ariaUserAnswer;\n    const items = this.get('_items');\n    const ariaAnswer = items.map(item => {\n      const activeOption = this.getActiveItemOption(item._index);\n      return Handlebars.compile(userAnswerTemplate)({\n        itemText: item.text,\n        userAnswer: activeOption.get('text')\n      });\n    }).join('<br>');\n\n    return ariaAnswer;\n  }\n}\n","import components from 'core/js/components';\nimport MatchingView from './MatchingView';\nimport MatchingModel from './MatchingModel';\n\nexport default components.register('matching', {\n  view: MatchingView,\n  model: MatchingModel\n});\n","import QuestionView from 'core/js/views/questionView';\n\nclass McqView extends QuestionView {\n\n  initialize(...args) {\n    this.onKeyPress = this.onKeyPress.bind(this);\n    this.onItemSelect = this.onItemSelect.bind(this);\n    this.onItemFocus = this.onItemFocus.bind(this);\n    this.onItemBlur = this.onItemBlur.bind(this);\n    super.initialize(...args);\n  }\n\n  setupQuestion() {\n    this.model.setupRandomisation();\n  }\n\n  onQuestionRendered() {\n    this.setReadyStatus();\n  }\n\n  onKeyPress(event) {\n    if (event.which !== 13) return;\n    // <ENTER> keypress\n    this.onItemSelect(event);\n  }\n\n  onItemFocus(event) {\n    if (!this.model.isInteractive()) return;\n\n    const index = parseInt($(event.currentTarget).data('adapt-index'));\n    const item = this.model.getChildren().findWhere({ _index: index });\n    item.set('_isHighlighted', true);\n  }\n\n  onItemBlur(event) {\n    const index = $(event.currentTarget).data('adapt-index');\n    const item = this.model.getChildren().findWhere({ _index: index });\n    item.set('_isHighlighted', false);\n  }\n\n  onItemSelect(event) {\n    if (!this.model.isInteractive()) return;\n\n    const index = $(event.currentTarget).data('adapt-index');\n    const itemModel = this.model.getItem(index);\n    let shouldSelect = !itemModel.get('_isActive');\n\n    if (this.model.isSingleSelect()) {\n      // Assume a click is always a selection\n      shouldSelect = true;\n      this.model.resetActiveItems();\n    } else if (shouldSelect && this.model.isAtActiveLimit()) {\n      // At the selection limit, deselect the last item\n      this.model.getLastActiveItem().toggleActive(false);\n    }\n\n    // Select or deselect accordingly\n    itemModel.toggleActive(shouldSelect);\n  }\n\n  // Used by the question view to reset the look and feel of the component.\n  resetQuestion() {\n    this.model.resetItems();\n  }\n\n}\n\nMcqView.template = 'mcq.jsx';\n\nexport default McqView;\n","import ItemsQuestionModel from 'core/js/models/itemsQuestionModel';\n\nexport default class McqModel extends ItemsQuestionModel {}\n","import components from 'core/js/components';\nimport McqView from './McqView';\nimport McqModel from './McqModel';\n\nexport default components.register('mcq', {\n  model: McqModel,\n  view: McqView\n});\n","import ComponentView from 'core/js/views/componentView';\n\nclass TextView extends ComponentView {\n\n  postRender() {\n    this.setReadyStatus();\n    this.setupInview();\n  }\n\n  setupInview() {\n    const selector = this.getInviewElementSelector();\n    if (!selector) return this.setCompletionStatus();\n    this.setupInviewCompletion(selector);\n  }\n\n  /**\n   * determines which element should be used for inview logic - body, instruction or title - and returns the selector for that element\n   */\n  getInviewElementSelector() {\n    if (this.model.get('body')) return '.component__body';\n    if (this.model.get('instruction')) return '.component__instruction';\n    if (this.model.get('displayTitle')) return '.component__title';\n    return null;\n  }\n\n}\n\nTextView.template = 'text.jsx';\n\nexport default TextView;\n","import ComponentModel from 'core/js/models/componentModel';\n\nexport default class TextModel extends ComponentModel {}\n","import components from 'core/js/components';\nimport TextView from './TextView';\nimport TextModel from './TextModel';\n\nexport default components.register('text', {\n  model: TextModel,\n  view: TextView\n});\n","import McqView from 'components/adapt-contrib-mcq/js/McqView';\n\nclass MoralMachineGmcqView extends McqView {\n\n  onQuestionRendered() {\n    this.$('.js-item-label').imageready(() => this.setReadyStatus());\n    if (this.model.attributes._isComplete) {\n      this.$('.btn__action').html(this.model.get('_buttons')[\"_reset\"][\"buttonText\"]);\n    }\n  }\n\n  onIsCompleteChange(model, isComplete) {\n    this.$('.btn__action').html(model.get('_buttons')[\"_reset\"][\"buttonText\"]);\n  }\n\n  onSubmitted() {\n    this.$('.btn__action').html(this.model.get('_buttons')[\"_reset\"][\"buttonText\"]);\n  }\n\n}\n\nMoralMachineGmcqView.template = 'gmcq.jsx';\n\nexport default MoralMachineGmcqView;\n","import McqModel from 'components/adapt-contrib-mcq/js/McqModel';\n\nexport default class MoralMachineGmcqModel extends McqModel {\n\tisCorrect() {\n\t\treturn true;\n\t}\n}\n","import Adapt from 'core/js/adapt';\nimport MoralMachineGmcqView from './MoralMachineGmcqView';\nimport MoralMachineGmcqModel from './MoralMachineGmcqModel';\n\nexport default Adapt.register('moral-machine-gmcq', {\n  model: MoralMachineGmcqModel,\n  view: MoralMachineGmcqView\n});\n","define([\n  'core/js/adapt',\n  'core/js/models/componentModel'\n], function(Adapt, ComponentModel) {\n\n  class MoralMachineResultsResultsModel extends ComponentModel {\n    \n    init(...args) {\n      this.set('originalBody', this.get('body'));// save the original body text so we can restore it when the assessment is reset\n\n      this.listenTo(Adapt, {\n        'assessments:complete': this.onAssessmentComplete,\n        'assessments:reset': this.onAssessmentReset\n      });\n\n      super.init(...args);\n    }\n\n    /**\n     * Checks to see if the assessment was completed in a previous session or not\n     */\n    async checkIfAssessmentComplete() {\n      if (!Adapt.assessment || this.get('_assessmentId') === undefined) {\n        return;\n      }\n\n      const assessmentModel = Adapt.assessment.get(this.get('_assessmentId'));\n      if (!assessmentModel || assessmentModel.length === 0) return;\n\n      if (Adapt.config.get('_xapi')._queryURL) {\n        await this.loadDataFromXAPI(assessmentModel);\n      }\n\n      const state = assessmentModel.getState();\n      const isResetOnRevisit = assessmentModel.get('_assessment')._isResetOnRevisit;\n      if (state.isComplete && (!state.allowResetIfPassed || !isResetOnRevisit)) {\n        this.onAssessmentComplete(state,assessmentModel);\n        return;\n      }\n      this.setVisibility();\n    }\n   \n    initScoring(scoreObj,counts,multiplier) {\n      for (let j =0; j < scoreObj.length; j++) {\n        if (scoreObj[j].choices == \"Avoid Intervention\") {\n          counts[\"Intervene\"] = (counts[\"Intervene\"] || 0) + (1 * multiplier);\n        }\n        if (scoreObj[j].choices == \"Save people in car\") {\n          counts[\"Save pedestrians\"] = (counts[\"Save pedestrians\"] || 0) + (1 * multiplier);\n        }\n        if (scoreObj[j].choices == \"Uphold law\") {\n          counts[\"Disobey law\"] = (counts[\"Disobey law\"] || 0) + (1 * multiplier);\n        }\n        if (scoreObj[j].choices == \"Save pets\") {\n          counts[\"Save humans\"] = (counts[\"Save humans\"] || 0) + (1 * multiplier);\n        }\n        if (scoreObj[j].choices == \"Save more people\") {\n          counts[\"Save less people\"] = (counts[\"Save less people\"] || 0) + (1 * multiplier);\n        }\n        if (scoreObj[j].choices == \"Save robbers\") {\n          counts[\"Save professionals\"] = (counts[\"Save professionals\"] || 0) + (1 * multiplier);\n        }\n        if (scoreObj[j].choices == \"Save old\") {\n          counts[\"Save young\"] = (counts[\"Save young\"] || 0) + (1 * multiplier);\n        }\n      }\n      return counts;\n    }\n\n    updateScoring(scoreObj,counts,multiplier) {\n\n      let arr = [];\n\n      for(let i = 0; i < scoreObj.length; i++) {\n       arr.push(scoreObj[i].choices)\n      }\n\n      arr.forEach((x) => {\n        counts[x] = (counts[x] || 0) + (1 * multiplier);\n        if (x == \"Avoid Intervention\") { \n         counts[\"Intervene\"] = counts[\"Intervene\"] - (1 * multiplier);\n        }\n        if (x == \"Save people in car\") {\n          counts[\"Save pedestrians\"] = counts[\"Save pedestrians\"] - (1 * multiplier);\n        }\n        if (x == \"Uphold law\") {\n          counts[\"Disobey law\"] = counts[\"Disobey law\"] - (1 * multiplier);\n        }\n        if (x == \"Save pets\") {\n          counts[\"Save humans\"] = counts[\"Save humans\"] - (1 * multiplier);\n        }\n        if (x == \"Save more people\") {\n          counts[\"Save less people\"] = counts[\"Save less people\"] - (1 * multiplier);\n        }\n        if (x == \"Save robbers\") {\n          counts[\"Save professionals\"] = counts[\"Save professionals\"] - (1 * multiplier);\n        }\n        if (x == \"Save old\") {\n          counts[\"Save young\"] = counts[\"Save young\"] - (1 * multiplier);\n        }\n      })\n\n       return counts;\n    }\n\n    async fetchDataFromXAPI(componentID) {\n      var xapiQueryEndpoint = Adapt.config.get('_xapi')._queryURL;\n      var activityID = Adapt.config.get('_xapi')._activityID;\n      var componentURI = encodeURIComponent(activityID + \"#/id/\" + componentID);\n\n      var dataURL = xapiQueryEndpoint + \"?activity=\" + componentURI;\n      const response = await fetch(dataURL);\n      const json = await response.json();\n      return json;\n    }\n\n    async loadDataFromXAPI(assessmentModel) {\n      var components = assessmentModel._getAllQuestionComponents();\n      for (let ci = 0; ci < components.length; ci++) {\n        var component = components[ci];\n        component[\"APIdata\"] = await this.fetchDataFromXAPI(component.get(\"_id\"));\n      }\n      //Load all the previous responses here into an object that can be referenced later when assessment is complete, or even before?\n    }\n\n    onAssessmentComplete(state, assessmentModel) {\n      if (this.get('_assessmentId') === undefined ||\n          this.get('_assessmentId') !== state.id) return;\n          \n      let \n        // counting choices\n        counts = {},\n        othersCounts = {},\n        savedCount = {},\n        allCharacterCount = {},\n        finalArr = [],\n        mostKilled,\n        mostSaved;\n              \n      // view()\n      // TODO: Jack this is the new bit and the only real difference so far from the vanilla AssessmentResults component. It might not even belong here but it gives you an idea.\n      var components = assessmentModel._getAllQuestionComponents();\n  \n      //for (let ci = 0; ci < components.length; ci++) {\n      //  var component = components[ci];\n      assessmentModel._getAllQuestionComponents().forEach(component => {\n\n        let arr = [];\n        let responses = {};\n        let totalResponses = 0;\n        \n        if (component.APIdata) {\n          responses = component.APIdata.responses;\n          totalResponses = component.APIdata.completion;\n        }\n\n        for(let i = 0; i < 2; i++) {\n          var item = component.getChildren().models[i].attributes.scoring;\n          counts = this.initScoring(item,counts,1);\n          if (component.APIdata) {\n            othersCounts = this.initScoring(item,othersCounts,totalResponses);\n            othersCounts = this.updateScoring(item,othersCounts,responses[i].count);\n          }\n        }\n\n        // Get and process the active item. \n        let scoreObj = {};\n        //Build the array that you need to render the results (the graphical thing)       \n        try {\n          scoreObj = component.getActiveItems()[0].attributes.scoring;\n          counts = this.updateScoring(scoreObj,counts,1);\n        } catch (error) {\n          return;\n        }\n      \n        function getCharacterCounts(activeItem) {\n          var saved = activeItem.attributes[\"saved characters\"];\n          for(let i=0;i<saved.length;i++) {\n            var Character = saved[i][\"character\"];\n            var count = saved[i][\"number\"];\n            allCharacterCount[Character] = (allCharacterCount[Character] || 0) + count;\n          }\n          var killed = activeItem.attributes[\"killed characters\"];\n          for(let i=0;i<killed.length;i++) {\n            var Character = killed[i][\"character\"];\n            var count = killed[i][\"number\"];\n            allCharacterCount[Character] = (allCharacterCount[Character] || 0) + count;\n          }\n          return allCharacterCount;\n        }\n\n        function getSavedCounts(activeItem) {\n          var saved = activeItem.attributes[\"saved characters\"];\n          for(let i=0;i<saved.length;i++) {\n            var Character = saved[i][\"character\"];\n            var count = saved[i][\"number\"];\n            var gender = Character.split(\" \")[0];\n            counts[gender] = (counts[gender] || 0) + count;\n            savedCount[Character] = (savedCount[Character] || 0) + count;\n          }\n          return savedCount;\n        }\n\n        allCharacterCount = getCharacterCounts(component.getActiveItems()[0]);\n        savedCount = getSavedCounts(component.getActiveItems()[0]);    \n        \n      });\n\n      finalArr.push([savedCount, allCharacterCount, counts ]);\n\n      let keys = {};\n      let values = {};\n\n      try {\n        keys = Object.values(finalArr[0][2])\n        values = Object.keys(finalArr[0][2])\n      } catch(error) {\n        return;\n      }\n\n      let results = {\n        counts: finalArr[0][2],\n        savedCount: finalArr[0][0],\n        allCharacterCount: finalArr[0][1],\n        othersCounts: othersCounts,\n        keys: keys,\n        values: values\n      }\n\n      this.setResults(results)\n\n      /*\n      make shortcuts to some of the key properties in the state object so that\n      content developers can just use {{attemptsLeft}} in json instead of {{state.attemptsLeft}}\n      */\n      this.set({\n        _state: state,\n        attempts: state.attempts,\n        attemptsSpent: state.attemptsSpent,\n        attemptsLeft: state.attemptsLeft,\n        score: state.counts,\n        scoreAsPercent: state.scoreAsPercent,\n        maxScore: state.maxScore,\n        isPass: state.isPass,\n        results: results\n      });\n\n      this.checkRetryEnabled(state);\n\n      this.setFeedbackText(this.getFeedbackText(results));\n\n      this.toggleVisibility(true);\n\n    }\n\n    getResults(){\n      return this.results;\n    }\n\n    setResults(object) {\n      this.results = object;\n      \n    }\n\n    checkRetryEnabled(state) {\n      const assessmentModel = Adapt.assessment.get(state.id);\n      if (!assessmentModel.canResetInPage()) return false;\n\n      const isRetryEnabled = true;\n      const isAttemptsLeft = (state.attemptsLeft > 0 || state.attemptsLeft === 'infinite');\n      const showRetry = isRetryEnabled && isAttemptsLeft;\n\n      this.set({\n        _isRetryEnabled: showRetry,\n        retryFeedback: showRetry ? this.get('_retry').feedback : ''\n      });\n    }\n\n    setFeedbackText(outputs) {\n\n      /*Template example\n      <div class=\"moralMachineResults__container\"><div id=\"top\">{{{preference}}}</div><div  id=\"main\">{{{save-people-in-car}}} {{{avoid-intervention}}}</div></div>\n      */\n\n      var template = Handlebars.compile(this.get('_feedbackTemplate'));\n      var feedback = template(outputs);\n      this.set({\n        feedback,\n        body: this.get('_completionBody')\n      });\n    }\n\n    getUserAnswersTemplate() {\n      // Set results template\n      let userAnswers = {\n        \"age-preference\": {\n          \"Save old\": 0,\n          \"Save young\": 0,\n        },\n        \"saving-more-lives\": {\n          \"Save less people\": 0,\n          \"Save more people\": 0,\n        },\n        \"gender-preference\": {\n          \"Female\": 0,\n          \"Male\": 0,\n        },\n        \"save-people-in-car\": {\n          \"Save people in car\": 0,\n          \"Save pedestrians\": 0,\n        },\n        \"species-preference\": {\n          \"Save humans\": 0,\n          \"Save pets\": 0,\n        },\n        \"upholding-the-law\": {\n          \"Uphold law\": 0,\n          \"Disobey law\": 0,\n        },\n        \"social-value-preference\": {\n          \"Save professionals\": 0,\n          \"Save robbers\": 0,\n        },\n        \"avoid-intervention\": {\n         \"Avoid Intervention\": 0,\n         \"Intervene\": 0,\n        },\n      };\n      return userAnswers;\n    }\n\n    nestedToUnestedChanges(counts,userAnswers) {\n      //Populate the userAnswers object\n      if (counts == undefined) {\n        return;\n      } else {\n        // loop on the changingObj\n        for (const [key1, value] of Object.entries(counts)) {\n          // loop on the first obj for every entry of the changing obj\n          for (const [key2, _] of Object.entries(userAnswers)) {\n            // checking if the obj has a property of the changing obj's key\n            if (userAnswers[key2].hasOwnProperty(key1)) {\n              // adding the value\n              userAnswers[key2][key1] += value;\n            }\n          }\n        }\n      }\n      return userAnswers;\n    }\n\n    removeZeroValues(userAnswers) {\n      // Remove user answers where there is no data (zero as the value)\n      \n      const keys = Object.keys(userAnswers);\n      const values = Object.values(userAnswers);\n\n      keys.map((key) => {\n        const property = userAnswers[key];\n        const propertyKeys = Object.keys(userAnswers[key]);\n      });\n\n      const finalObj = {};\n\n      keys.forEach((key) => {\n        const property = userAnswers[key];\n        const propertyKeys = Object.keys(property);\n        const hasNonZeroEntries = propertyKeys.some(\n          (propertyKey) => property[propertyKey] !== 0\n        );\n\n        if (hasNonZeroEntries) {\n              finalObj[key] = userAnswers[key];\n          }\n      });\n\n      return finalObj;\n    }\n\n    getBarPosition(values) {\n      var total = 0;\n      var firstValue = -1;\n      for (let key in values) {\n       total += values[key];\n       if (firstValue < 0) {\n        firstValue = values[key];\n       }\n      }\n      var totalPercent = 100 / total;\n      var newCountOne = firstValue * totalPercent;\n      return newCountOne;\n    }\n\n    getFeedbackText(results) {\n      let outputs = {};\n      let userAnswers = this.getUserAnswersTemplate();\n      let othersAnswers = this.getUserAnswersTemplate();\n      try {\n        userAnswers = this.nestedToUnestedChanges(results.counts,userAnswers);\n        othersAnswers = this.nestedToUnestedChanges(results.othersCounts,othersAnswers);\n      } catch (error) {\n        console.log(error);\n      }\n      userAnswers = this.removeZeroValues(userAnswers);\n      othersAnswers = this.removeZeroValues(othersAnswers);\n\n      var savedTableDetail = \"\";\n      var percentages = [];\n      \n      Object.keys(results[\"allCharacterCount\"]).forEach(character => {\n        let total = results[\"allCharacterCount\"][character];\n        let saved = results.savedCount[character] || 0;\n        percentages.push([character,(saved/total || 0)]);\n      });\n\n      percentages.sort(function(a, b) {\n        return b[1] - a[1];\n      });\n      \n      percentages.forEach(function(item) {\n        let character = item[0];\n        let total = results[\"allCharacterCount\"][character];\n        let saved = results.savedCount[character] || 0;\n        if (character.split(\" \")[0] == \"Pet\") {\n          savedTableDetail += \"<td><img class='pet-summary' src='assets/character/\" + character.replaceAll(\" \",\"_\") + \".png'></img><br/>\" + saved + \"/\" + total + \"</td>\"  \n        } else {\n          savedTableDetail += \"<td><img class='character-summary' src='assets/character/\" + character.replaceAll(\" \",\"_\") + \".png'></img><br/>\" + saved + \"/\" + total + \"</td>\"\n        }\n      });\n        \n      outputs[\"characters-saved\"] = \n      `\n      <sub-section id=\"mostSaved\" class=\"characters\">\n        <h3>Saved characters / Total</h3>\n        <table id=\"Characters\">\n          <tr>\n          ${savedTableDetail}\n          </tr>\n        </table>\n      </sub-section>\n      `;\n\n      //Place we now need to handle the userAnser and the answer of others.\n\n      let keysForView;\n      let arrForBar = [];\n      let valuesForBar = [];\n      let barPositions = {};\n\n      if (userAnswers.length === 0) {\n        return;\n      } else {\n        keysForView = Object.keys(userAnswers);\n        Object.keys(userAnswers).map((key) => {\n          barPositions[key] = { \n            \"user\": this.getBarPosition(userAnswers[key]),\n            \"others\": this.getBarPosition(othersAnswers[key])\n           };\n        })\n      }\n      \n      var index = 0;\n      var offsets = {};\n      for (let key in barPositions) {\n        outputs[key] = `\n          <sub-section id=\"question-${key}\">\n            <h3>${key.replaceAll(\"-\", \" \")}</h3>\n            <panel>\n              <left><img class=\"results-img\" src=\"./assets/${key}_left.svg\"/></left>\n              <canvas id=\"canvas-${key}\" height=\"60\" width=\"300\">\n              </canvas>\n              <right><img class=\"results-img\" src=\"./assets/${key}_right.svg\"/></right>\n            </panel>\n          </sub-section>\n          <script>\n            if (typeof ctxArray === \"undefined\") {\n              var ctxArray = [];\n            }\n            ctxArray[\"${key}\"] = []\n            ctxArray[\"${key}\"][\"ctx\"] = document.getElementById(\"canvas-${key}\").getContext(\"2d\");\n            ctxArray[\"${key}\"][\"c\"] = document.getElementById(\"canvas-${key}\");\n            drawTemplate(ctxArray[\"${key}\"][\"c\"],ctxArray[\"${key}\"][\"ctx\"]);\n            drawLine(ctxArray[\"${key}\"][\"c\"],ctxArray[\"${key}\"][\"ctx\"],${barPositions[key][\"user\"]},\"You\",\"top\");\n            drawLine(ctxArray[\"${key}\"][\"c\"],ctxArray[\"${key}\"][\"ctx\"],${barPositions[key][\"others\"]},\"Others\",\"bottom\");\n          </script>\n        `;\n        index++;\n      };\n\n      return outputs;\n    }\n\n\n    setVisibility() {\n      if (!Adapt.assessment) return;\n\n      const assessmentModel = Adapt.assessment.get(this.get('_assessmentId'));\n      if (!assessmentModel || assessmentModel.length === 0) return;\n\n      const state = assessmentModel.getState();\n      const isAttemptInProgress = state.attemptInProgress;\n      const isComplete = !isAttemptInProgress && state.isComplete;\n      const isVisibleBeforeCompletion = this.get('_isVisibleBeforeCompletion') || false;\n      const isVisible = isVisibleBeforeCompletion || isComplete;\n\n      this.toggleVisibility(isVisible);\n    }\n\n    toggleVisibility (isVisible) {\n      if (isVisible === undefined) {\n        isVisible = !this.get('_isVisible');\n      }\n\n      this.set('_isVisible', isVisible, { pluginName: 'assessmentResults' });\n    }\n\n    checkCompletion() {\n      if (this.get('_setCompletionOn') === 'pass' && !this.get('isPass')) {\n        return;\n      }\n\n      this.setCompletionStatus();\n      \n    }\n\n    /**\n     * Handles resetting the component whenever its corresponding assessment is reset\n     * The component can either inherit the assessment's reset type or define its own\n     */\n    onAssessmentReset(state) {\n      if (this.get('_assessmentId') === undefined ||\n          this.get('_assessmentId') !== state.id) return;\n\n      let resetType = this.get('_resetType');\n      if (!resetType || resetType === 'inherit') {\n        resetType = state.resetType || 'hard';// backwards compatibility - state.resetType was only added in assessment v2.3.0\n      }\n      this.reset(resetType, true);\n    }\n\n    reset(...args) {\n      this.set({\n        body: this.get('originalBody'),\n        state: null,\n        feedback: '',\n        retryFeedback: '',\n        _isRetryEnabled: false\n      });\n\n      super.reset(...args);\n    }\n  }\n\n  return MoralMachineResultsResultsModel;\n\n});\n","define([\"core/js/adapt\", \"core/js/views/componentView\", \"libraries/canvas-helper\"], function (\n  Adapt,\n  ComponentView\n) {\n  class MoralMachineResultsView extends ComponentView {\n    events() {\n      return {\n        \"click .js-assessment-retry-btn\": \"onRetryClicked\",\n      };\n    }\n\n    preRender() {\n      this.model.setLocking(\"_isVisible\", false);\n      \n      this.listenTo(Adapt.parentView, \"preRemove\", function () {\n        this.model.unsetLocking(\"_isVisible\");\n      });\n\n      this.listenTo(this.model, {\n        \"change:_feedbackBand\": this.addClassesToArticle,\n        \"change:body\": this.render,\n      });\n    }\n\n    postRender() {\n      this.model.checkIfAssessmentComplete();\n      this.setReadyStatus();\n      this.setupInviewCompletion(\n        \".component__inner\",\n        this.model.checkCompletion.bind(this.model)\n      );\n    }\n\n    /**\n     * Resets the state of the assessment and optionally redirects the user\n     * back to the assessment for another attempt.\n     */\n    onRetryClicked() {\n      const state = this.model.get('_state');\n      Adapt.assessment.get(state.id).reset(null, (wasReset) => {\n        if (!wasReset) return;\n        \n        if (this.model.get(\"_retry\")._routeToAssessment === true) {\n          Adapt.navigateToElement(\".\" + state.articleId);\n        }\n      });\n    }\n    /**\n     * If there are classes specified for the feedback band, apply them to the containing article\n     * This allows for custom styling based on the band the user's score falls into\n     */\n    addClassesToArticle(model, value) {\n      if (!value || !value._classes) return;\n\n      this.$el.parents(\".article\").addClass(value._classes);\n    }\n\n  }\n\n  MoralMachineResultsView.template = \"assessmentResults\";\n\n  return MoralMachineResultsView;\n});\n","define([\n  'core/js/adapt',\n  './moralMachineResultsModel',\n  './moralMachineResultsView'\n], function(Adapt, MoralMachineResultsModel, MoralMachineResultsView) {\n\n  return Adapt.register(\"moralMachineResults\", {\n    model: MoralMachineResultsModel,\n    view: MoralMachineResultsView\n  });\n\n});\n","define([\n  'core/js/adapt',\n  'core/js/views/articleView'\n], function(Adapt, AdaptArticleView) {\n\n  var BlockSliderView = {\n\n    _isReady: false,\n    _disableAnimationOnce: false,\n\n    events: {\n      \"click [data-block-slider]\": \"_onBlockSliderClick\"\n    },\n\n    preRender: function() {\n      AdaptArticleView.prototype.preRender.call(this);\n\n      if (!this.model.isBlockSliderEnabled()) {\n        this.$el.addClass('is-disabled');\n        return;\n      }\n\n      this._blockSliderPreRender();\n    },\n\n    _blockSliderPreRender: function() {\n      Adapt.wait.for(function(done){\n        this.resolveQueue = done;\n      }.bind(this));\n      this._blockSliderSetupEventListeners();\n    },\n\n    _blockSliderSetupEventListeners: function() {\n\n      this._blockSliderResizeHeight = this._blockSliderResizeHeight.bind(this);\n\n      this.listenTo(Adapt, {\n        \"device:resize\": this._onBlockSliderResize,\n        \"device:changed\": this._onBlockSliderDeviceChanged,\n        \"page:scrollTo\": this._onBlockSliderPageScrollTo,\n        \"page:scrolledTo\": this._onBlockSliderPageScrolledTo\n      });\n\n      this.listenToOnce(Adapt, \"remove\", this._onBlockSliderRemove);\n      this.listenToOnce(this.model, \"change:_isReady\", this._onBlockSliderReady);\n\n      var duration = this.model.get(\"_articleBlockSlider\")._slideAnimationDuration || 200;\n\n      this._blockSliderHideOthers = _.debounce(this._blockSliderHideOthers.bind(this), duration);\n\n    },\n\n    render: function() {\n\n      if (this.model.isBlockSliderEnabled()) {\n\n        this._blockSliderRender();\n\n      } else AdaptArticleView.prototype.render.call(this);\n\n    },\n\n    _blockSliderRender: function() {\n      Adapt.trigger(this.constructor.type + 'View:preRender view:render', this);\n\n      this._blockSliderConfigureVariables();\n\n      var data = this.model.toJSON();\n      var template = Handlebars.templates['articleBlockSlider-article'];\n      this.$el.html(template(data));\n\n      Adapt.trigger(this.constructor.type + 'View:render', this);\n\n      this.addChildren();\n\n      this.$el.addClass('abs');\n\n      this.delegateEvents();\n\n      this.$el.imageready(function() {\n        _.delay(this._blockSliderPostRender.bind(this), 500);\n      }.bind(this));\n\n      return this;\n    },\n\n    _blockSliderConfigureVariables: function() {\n      var blocks = this.model.getChildren().models.filter(model => model.isTypeGroup('block'));\n      var totalBlocks = blocks.length;\n      var itemButtons = [];\n\n      for (var i = 0, l = totalBlocks; i < l; i++) {\n        itemButtons.push({\n          _className: (i === 0 ? \"home\" : \"not-home\") + (\" i\"+i),\n          _index: i,\n          _includeNumber: i !== 0,\n          _title: blocks[i].get('title')\n        });\n      }\n\n      this.model.set({\n        _currentBlock: 0,\n        _totalBlocks: totalBlocks,\n        _itemButtons: itemButtons\n      });\n    },\n\n    _blockSliderConfigureControls: function() {\n\n      var duration = this.model.get(\"_articleBlockSlider\")._slideAnimationDuration || 200;\n\n      if (this._disableAnimationOnce) animate = false;\n      var _currentBlock = this.model.get(\"_currentBlock\");\n      var _totalBlocks = this.model.get(\"_totalBlocks\");\n\n      var $left = this.$el.find(\"[data-block-slider='left']\");\n      var $right = this.$el.find(\"[data-block-slider='right']\");\n\n      if (_currentBlock === 0) {\n        $left.a11y_cntrl_enabled(false);\n        $right.a11y_cntrl_enabled(true);\n      } else if (_currentBlock == _totalBlocks - 1 ) {\n        $left.a11y_cntrl_enabled(true);\n        $right.a11y_cntrl_enabled(false);\n      } else {\n        $left.a11y_cntrl_enabled(true);\n        $right.a11y_cntrl_enabled(true);\n      }\n\n      var $indexes = this.$el.find(\"[data-block-slider='index']\");\n      $indexes.a11y_cntrl_enabled(true).removeClass(\"is-selected\");\n      $indexes.eq(_currentBlock).a11y_cntrl_enabled(false).addClass(\"is-selected is-visited\");\n\n      var $blocks = this.$el.find(\".block\");\n      if (!$blocks.length) return;\n\n      $blocks.a11y_on(false).eq(_currentBlock).a11y_on(true);\n    },\n\n    _blockSliderSetButtonLayout: function() {\n      var buttonsLength = this.model.get('_itemButtons').length;\n      var itemwidth = 100 / buttonsLength;\n      this.$('.js-abs-btn-tab').css({\n        width: itemwidth + '%'\n      });\n    },\n\n    _blockSliderPostRender: function() {\n      this._blockSliderConfigureControls(false);\n\n      this._onBlockSliderDeviceChanged();\n\n      var startIndex = this.model.get(\"_articleBlockSlider\")._startIndex || 0;\n\n      this._blockSliderMoveIndex(startIndex, false);\n\n      Adapt.trigger(this.constructor.type + 'View:postRender', this);\n\n    },\n\n    _onBlockSliderReady: function() {\n      this._blockSliderHideOthers();\n      _.delay(function(){\n        this._blockSliderConfigureControls(false);\n        this._onBlockSliderResize();\n        this.resolveQueue();\n        this._isReady = true;\n      }.bind(this), 250);\n      this.$(\".component\").on(\"resize\", this._blockSliderResizeHeight);\n    },\n\n    _onBlockSliderClick: function(event) {\n      event.preventDefault();\n\n      var id = $(event.currentTarget).attr(\"data-block-slider\");\n\n      switch(id) {\n        case \"left\":\n          this._blockSliderMoveLeft();\n          break;\n        case \"index\":\n          var index = parseInt($(event.currentTarget).attr(\"data-block-slider-index\"));\n          this._blockSliderMoveIndex(index);\n          break;\n        case \"right\":\n          this._blockSliderMoveRight();\n          break;\n      }\n\n    },\n\n    _blockSliderMoveLeft: function() {\n      if (this.model.get(\"_currentBlock\") === 0) return;\n\n      var index = this.model.get(\"_currentBlock\");\n      this._blockSliderMoveIndex(--index);\n    },\n\n    _blockSliderMoveIndex: function(index, animate) {\n      if (this.model.get(\"_currentBlock\") != index) {\n\n        this.model.set(\"_currentBlock\", index);\n\n        Adapt.trigger('media:stop');//in case any of the blocks contain media that's been left playing by the user\n\n        this._blockSliderSetVisible(this.model.getChildren().models[index], true);\n        this._blockSliderResizeHeight(animate);\n        this._blockSliderScrollToCurrent(animate);\n        this._blockSliderConfigureControls(animate);\n      }\n\n      var duration = this.model.get(\"_articleBlockSlider\")._slideAnimationDuration || 200;\n\n      if (this._disableAnimationOnce) animate = false;\n\n      if (animate !== false) {\n        _.delay(function() {\n          $(window).resize();\n        }, duration);\n        return;\n      }\n\n      $(window).resize();\n\n    },\n\n    _blockSliderMoveRight: function() {\n      if (this.model.get(\"_currentBlock\") == this.model.get(\"_totalBlocks\") - 1 ) return;\n\n      var index = this.model.get(\"_currentBlock\");\n      this._blockSliderMoveIndex(++index);\n    },\n\n    _blockSliderScrollToCurrent: function(animate) {\n      var isEnabled = this._blockSliderIsEnabledOnScreenSizes();\n      var $container = this.$el.find(\".js-abs-slide-container\");\n\n      if (!isEnabled) {\n        return $container.scrollLeft(0);\n      }\n\n      var blocks = this.$el.find(\".block\");\n      var blockWidth = $(blocks[0]).outerWidth();\n      var lastIndex = blocks.length - 1;\n      var currentBlock = this.model.get('_currentBlock');\n      var isRTL = Adapt.config.get('_defaultDirection') === 'rtl';\n      var totalLeft = isRTL ? (lastIndex - currentBlock) * blockWidth : currentBlock * blockWidth;\n\n      this._blockSliderShowAll();\n\n      var duration = this.model.get('_articleBlockSlider')._slideAnimationDuration || 200;\n\n      if (this._disableAnimationOnce) animate = false;\n\n      if (animate === false) {\n        _.defer(function(){\n          $container.scrollLeft(totalLeft);\n          this._blockSliderHideOthers();\n        }.bind(this));\n        return;\n      }\n\n      $container.stop(true).animate({scrollLeft: totalLeft}, duration, function() {\n        $container.scrollLeft(totalLeft);\n        this._blockSliderHideOthers();\n      }.bind(this));\n    },\n\n    _blockSliderIsEnabledOnScreenSizes: function() {\n      var isEnabledOnScreenSizes = this.model.get(\"_articleBlockSlider\")._isEnabledOnScreenSizes;\n\n      var sizes = isEnabledOnScreenSizes.split(\" \");\n      if (sizes.indexOf(Adapt.device.screenSize) > -1) {\n        return true;\n      }\n      return false;\n    },\n\n    _blockSliderShowAll: function() {\n      this._blockSliderHideOthers.cancel();\n\n      this.model.getChildren().models.filter(model => model.isTypeGroup('block')).forEach(function(block) {\n        this._blockSliderSetVisible(block, true);\n      }.bind(this));\n    },\n\n    _blockSliderHideOthers: function() {\n      var currentIndex = this.model.get('_currentBlock');\n      this.model.getChildren().models.filter(model => model.isTypeGroup('block')).forEach(function(block, index) {\n        var makeVisible = (index === currentIndex);\n        this._blockSliderSetVisible(block, makeVisible);\n      }.bind(this));\n    },\n\n    _blockSliderSetVisible: function(model, makeVisible) {\n      this.$el.find(\".\" + model.get('_id') + \" *\").css(\"visibility\", makeVisible ? \"\" : \"hidden\");\n    },\n\n    _onBlockSliderResize: function() {\n      this._blockSliderResizeWidth(false);\n      this._blockSliderResizeHeight(false);\n      this._blockSliderScrollToCurrent(false);\n      this._blockSliderResizeTab();\n    },\n\n    _blockSliderResizeHeight: function(animate) {\n      if (!this._isReady) animate = false;\n      var $container = this.$el.find(\".js-abs-slide-container\");\n      var isEnabled = this._blockSliderIsEnabledOnScreenSizes();\n\n      if (!isEnabled) {\n        this._blockSliderShowAll();\n        return $container.velocity(\"stop\").css({\"height\": \"\", \"min-height\": \"\"});\n      }\n\n      var currentBlock = this.model.get(\"_currentBlock\");\n      var $blocks = this.$el.find(\".block\");\n\n      var currentHeight = $container.height();\n      var blockHeight = $blocks.eq(currentBlock).height();\n\n      var maxHeight = -1;\n      $container.find(\".block\").each(function() {\n        if ($(this).height() > maxHeight) {\n          maxHeight = $(this).height();\n        }\n      });\n\n      var duration = (this.model.get(\"_articleBlockSlider\")._heightAnimationDuration || 200) * 2;\n\n      if (this._disableAnimationOnce) animate = false;\n\n      if (this.model.get(\"_articleBlockSlider\")._hasUniformHeight) {\n        if (animate === false) {\n          $container.css({\"height\": maxHeight+\"px\"});\n        } else {\n          $container.velocity(\"stop\").velocity({\"height\": maxHeight+\"px\"}, {duration: duration });//, easing: \"ease-in\"});\n        }\n      } else if (currentHeight <= blockHeight) {\n\n        if (animate === false) {\n          $container.css({\"height\": blockHeight+\"px\"});\n        } else {\n          $container.velocity(\"stop\").velocity({\"height\": blockHeight+\"px\"}, {duration: duration });//, easing: \"ease-in\"});\n        }\n\n      } else if (currentHeight > blockHeight) {\n\n        if (animate === false) {\n          $container.css({\"height\": blockHeight+\"px\"});\n        } else {\n          $container.velocity(\"stop\").velocity({\"height\": blockHeight+\"px\"}, {duration: duration });//, easing: \"ease-in\"});\n        }\n\n      }\n\n      var minHeight = this.model.get(\"_articleBlockSlider\")._minHeight;\n      if (minHeight) {\n        $container.css({\"min-height\": minHeight+\"px\"});\n      }\n\n    },\n\n    _blockSliderResizeTab: function() {\n      if (!this.model.get(\"_articleBlockSlider\")._hasTabs) return;\n\n      this._blockSliderSetButtonLayout();\n\n      this.$('.js-abs-btn-tab').css({\n        height: \"\"\n      });\n\n      var parentHeight = this.$('.js-abs-btn-tab').parent().height();\n      this.$('.js-abs-btn-tab').css({\n        height: parentHeight + 'px'\n      });\n\n      var toolbarHeight = this.$('.js-abs-btn-tab-container').height();\n      var additionalMargin = '30';\n      this.$('.js-abs-btn-tab-container').css({\n        top: '-' + (toolbarHeight + (additionalMargin/2)) + 'px'\n      });\n\n      var toolbarMargin = parseFloat(toolbarHeight) + parseFloat(additionalMargin);\n      this.$('.js-abs-slide-container').css({\n        marginTop: toolbarMargin + 'px'\n      });\n    },\n\n    _blockSliderResizeWidth: function() {\n      var isEnabled = this._blockSliderIsEnabledOnScreenSizes();\n      var $blockContainer = this.$el.find(\".js-abs-block-container\");\n      var $blocks = this.$el.find(\".block\");\n\n      if (!isEnabled) {\n        $blocks.css(\"width\", \"\");\n        return $blockContainer.css({\"width\": \"100%\"});\n      }\n\n      var $container = this.$el.find(\".js-abs-slide-container\");\n\n      $blocks.css(\"width\", $container.width()+\"px\");\n\n      var blockWidth = $($blocks[0]).outerWidth();\n      var totalWidth = $blocks.length * (blockWidth);\n\n      $blockContainer.width(totalWidth + \"px\");\n\n    },\n\n    _onBlockSliderDeviceChanged: function() {\n      var showToolbar = this._blockSliderIsEnabledOnScreenSizes();\n      this.$('.js-abs-toolbar, .js-abs-toolbar-bottom').toggleClass('u-display-none', !showToolbar);\n\n      _.delay(function() {\n        $(window).resize();\n      }, 250);\n    },\n\n    _onBlockSliderPageScrollTo: function(selector) {\n      this._disableAnimationOnce = true;\n      _.defer(function() {\n        this._disableAnimationOnce = false;\n      }.bind(this));\n\n      if (typeof selector === \"object\") selector = selector.selector;\n\n      if (!this._blockSliderIsEnabledOnScreenSizes()) {\n        return;\n      }\n\n      if (this.$el.find(selector).length === 0) return;\n\n      var id = selector.substr(1);\n\n      var model = Adapt.findById(id);\n      if (!model) return;\n\n      var block = model.get('_type') === 'block' ? model : model.findAncestor('blocks');\n      if (!block) return;\n      this.model.getChildren().models.filter(model => model.isTypeGroup('block')).find((item, index) => {\n        if (item.get('_id') !== block.get('_id')) return;\n        _.defer(() => this._blockSliderMoveIndex(index, false));\n        return true;\n      });\n    },\n\n    _onBlockSliderPageScrolledTo: function() {\n      _.defer(function() {\n        this._blockSliderScrollToCurrent(false);\n      }.bind(this));\n    },\n\n    _onBlockSliderRemove: function() {\n      this._blockSliderRemoveEventListeners();\n    },\n\n    _blockSliderRemoveEventListeners: function() {\n      this.$(\".component\").off(\"resize\", this._blockSliderResizeHeight);\n      this.stopListening(Adapt, \"device:changed\", this._onBlockSliderDeviceChanged);\n    }\n  };\n\n  return BlockSliderView;\n\n});\n","define([\n  'core/js/adapt'\n], function(Adapt) {\n\n  var BlockSliderModel = {\n\n    isBlockSliderEnabled: function() {\n      var config = this.get('_articleBlockSlider');\n      if (!config || !config._isEnabled || (config._isDisabledWhenAccessibilityActive && Adapt.accessibility.isActive())) {\n        return false;\n      }\n\n      return true;\n    }\n\n  };\n\n  return BlockSliderModel;\n\n});\n","define([\n  'core/js/views/articleView',\n  'core/js/models/articleModel',\n  './adapt-articleView',\n  './adapt-articleModel'\n], function(ArticleView, ArticleModel, ArticleViewExtension, ArticleModelExtension) {\n\n  /*\n    Here we are extending the articleView and articleModel in Adapt.\n    This is to accomodate the block slider functionality on the article.\n    The advantage of this method is that the block slider behaviour can utilize all of the predefined article behaviour in both the view and the model.\n  */\n\n  //Extends core/js/views/articleView.js\n  var ArticleViewInitialize = ArticleView.prototype.initialize;\n  ArticleView.prototype.initialize = function(options) {\n    if (this.model.get(\"_articleBlockSlider\")) {\n      //extend the articleView with new functionality\n      _.extend(this, ArticleViewExtension);\n    }\n    //initialize the article in the normal manner\n    return ArticleViewInitialize.apply(this, arguments);\n  };\n\n  //Extends core/js/models/articleModel.js\n  var ArticleModelInitialize = ArticleModel.prototype.initialize;\n  ArticleModel.prototype.initialize = function(options) {\n    if (this.get(\"_articleBlockSlider\")) {\n      //extend the articleModel with new functionality\n      _.extend(this, ArticleModelExtension);\n\n      //initialize the article in the normal manner\n      var returnValue = ArticleModelInitialize.apply(this, arguments);\n\n      return returnValue;\n    }\n\n    //initialize the article in the normal manner if no assessment\n    return ArticleModelInitialize.apply(this, arguments);\n  };\n\n});\n","import Adapt from 'core/js/adapt';\nimport logging from 'core/js/logging';\nimport AdaptArticleView from 'core/js/views/articleView';\n\nconst AssessmentView = {\n\n  postRender() {\n    AdaptArticleView.prototype.postRender.call(this);\n    if (this.model.isAssessmentEnabled()) {\n      this._setupEventListeners();\n\n      const config = this.model.getConfig();\n      if (config?._questions?._canShowMarking === false) {\n        this.$el.addClass('has-no-marking');\n      }\n    }\n    this.$el.addClass('is-assessment');\n  },\n\n  _setupEventListeners() {\n    this.listenTo(Adapt, {\n      'assessments:complete': this._onAssessmentComplete,\n      'assessments:reset': this._onAssessmentReset,\n      remove: this._onRemove\n    });\n  },\n\n  _removeEventListeners() {\n    this.stopListening(Adapt, {\n      'assessments:complete': this._onAssessmentComplete,\n      'assessments:reset': this._onAssessmentReset\n    });\n  },\n\n  _onAssessmentComplete(state, model) {\n    if (state.id !== this.model.get('_assessment')._id) return;\n\n    logging.info('assessment complete', state, model);\n  },\n\n  _onAssessmentReset(state, model) {\n    if (state.id !== this.model.get('_assessment')._id) return;\n\n    logging.info('assessment reset', state, model);\n\n  },\n\n  _onRemove() {\n    this._removeEventListeners();\n  }\n\n};\n\nexport default AssessmentView;\n","import data from 'core/js/data';\n\nclass QuestionBank {\n\n  constructor(quizBankId, articleId) {\n    this._bankId = quizBankId;\n    this._articleId = articleId;\n    this._unusedQuestionBlocks = null;\n    this._count = null;\n  }\n\n  calculateAvailableQuestionBlocks(count) {\n    this._count = parseInt(count);\n    const articleModel = data.findById(this._articleId);\n    const children = articleModel.getAvailableChildModels();\n    this._availableQuestionBlocks = children.map(blockModel => {\n      if (blockModel.get('_assessment')?._quizBankID !== this._bankId) return null;\n      return blockModel;\n    }).filter(Boolean);\n    const availableQuestionBlockIds = this._availableQuestionBlocks?.map(block => block.get('_id')) || [];\n    const unusedQuestionBlockIds = this._unusedQuestionBlocks?.map(block => block.get('_id')) || [];\n    const haveBlocksChanged = Boolean(_.difference(unusedQuestionBlockIds, availableQuestionBlockIds).length);\n    if (!haveBlocksChanged) return;\n    // Reset the unused question blocks if there are unused blocks which aren't available blocks\n    this._unusedQuestionBlocks = null;\n  }\n\n  getRandomQuestionBlocks() {\n    const questionBlocks = [];\n    let i = 0;\n    while (i++ < this._count) {\n      const nextBlock = this.unusedQuestionBlocks.shift();\n      questionBlocks.push(nextBlock);\n    }\n    return questionBlocks;\n  }\n\n  get unusedQuestionBlocks() {\n    const hasUnusedQuestion = Boolean(this._unusedQuestionBlocks?.length);\n    if (!hasUnusedQuestion) {\n      // Start again with all questions blocks, shuffled\n      this._unusedQuestionBlocks = _.shuffle(this._availableQuestionBlocks.slice(0));\n    }\n    return this._unusedQuestionBlocks;\n  }\n\n}\n\nexport default QuestionBank;\n","import Adapt from 'core/js/adapt';\nimport data from 'core/js/data';\nimport logging from 'core/js/logging';\nimport location from 'core/js/location';\nimport router from 'core/js/router';\nimport QuestionBank from './adapt-assessmentQuestionBank';\n\nlet givenIdCount = 0;\nconst assessmentConfigDefaults = {\n  _isEnabled: true,\n  _questions: {\n    _resetType: 'soft',\n    _canShowFeedback: false,\n    _canShowMarking: false,\n    _canShowModelAnswer: false\n  },\n  _suppressMarking: false,\n  _isPercentageBased: true,\n  _scoreToPass: 100,\n  _correctToPass: 100,\n  _includeInTotalScore: true,\n  _assessmentWeight: 1,\n  _isResetOnRevisit: true,\n  _reloadPageOnReset: true,\n  _attempts: 'infinite',\n  _allowResetIfPassed: false\n};\n\nconst AssessmentModel = {\n\n  _getCurrentQuestionComponents() {\n    return this.findDescendantModels('block')\n      .filter(block => block.get('_isAvailable'))\n      .reduce((questions, block) => questions.concat(block.findDescendantModels('question')), []);\n  },\n\n  _getAllQuestionComponents() {\n    return this.findDescendantModels('question');\n  },\n\n  // Private functions\n  _postInitialize() {\n    if (!this.isAssessmentEnabled()) return;\n\n    const assessmentConfig = this.getConfig();\n\n    Object.assign(this, {\n      _originalChildModels: null,\n      _questionBanks: null,\n      _forceResetOnRevisit: false\n    });\n\n    let attemptsLeft;\n    switch (assessmentConfig._attempts) {\n      case 'infinite': case 0: case undefined: case -1: case null:\n        attemptsLeft = 'infinite';\n        break;\n      default:\n        attemptsLeft = assessmentConfig._attempts;\n        break;\n    }\n\n    this.set({\n      _assessmentCompleteInSession: false,\n      _attemptInProgress: false,\n      _isAssessmentComplete: false,\n      _numberOfQuestionsAnswered: 0,\n      _lastAttemptScoreAsPercent: 0,\n      _attempts: attemptsLeft,\n      _attemptsLeft: attemptsLeft,\n      _attemptsSpent: 0\n    });\n\n    this.listenToOnce(Adapt, 'app:dataReady', this._onDataReady);\n    this.listenTo(Adapt, 'remove', this._onRemove);\n\n  },\n\n  init() {\n    // save original children\n    this._originalChildModels = this.getChildren().models;\n\n    this.setupCurrentQuestionComponents();\n\n    this._setAssessmentOwnershipOnChildrenModels();\n\n    // ensure the _questions attribute is set up (see https://github.com/adaptlearning/adapt_framework/issues/2971)\n    this._updateQuestionsState();\n  },\n\n  setupCurrentQuestionComponents() {\n    const assessmentQuestionsConfig = this.getConfig()._questions;\n    this._getAllQuestionComponents().forEach(component => {\n      component.set({\n        _canShowFeedback: assessmentQuestionsConfig._canShowFeedback,\n        _canShowMarking: assessmentQuestionsConfig._canShowMarking,\n        _canShowModelAnswer: assessmentQuestionsConfig._canShowModelAnswer\n      });\n    });\n  },\n\n  _setAssessmentOwnershipOnChildrenModels() {\n    // mark all children components as belonging to an assessment\n    const assessmentConfig = this.get('_assessment');\n    const childConfig = {\n      _isPartOfAssessment: true,\n      _assessmentId: assessmentConfig._id\n    };\n\n    for (const blockModel of this._originalChildModels) {\n      blockModel.set(childConfig);\n      // make sure components are set to _isPartOfAssessment for plp checking\n      blockModel.setOnChildren(childConfig);\n    }\n  },\n\n  // prevent default\n  checkIfResetOnRevisit() {},\n\n  _onDataReady() {\n    // register assessment\n    Adapt.assessment.register(this);\n  },\n\n  _setupAssessmentData(force, callback) {\n    const assessmentConfig = this.getConfig();\n    const state = this.getState();\n    const hasAttemptsLeft = (state.attemptsLeft > 0 || state.attemptsLeft === 'infinite');\n    const isFirstAttempt = (state.attemptsSpent === 0);\n    const shouldResetOnRevisit = (isFirstAttempt || assessmentConfig._isResetOnRevisit) && !this.get('_attemptInProgress');\n    const shouldResetAssessment = (shouldResetOnRevisit && !state.isPass && hasAttemptsLeft) || force === true;\n    const shouldResetQuestions = (shouldResetOnRevisit && (state.allowResetIfPassed || !state.isPass)) || force === true;\n    if (shouldResetAssessment || shouldResetQuestions) {\n      Adapt.trigger('assessments:preReset', this.getState(), this);\n    }\n    let quizModels;\n    if (shouldResetAssessment) {\n      if (isFirstAttempt || assessmentConfig?._questions?._resetType === 'hard') {\n        this.set({\n          _numberOfQuestionsAnswered: 0,\n          _isAssessmentComplete: false,\n          _assessmentCompleteInSession: false,\n          _score: 0\n        });\n      } else {\n        this.set({\n          _assessmentCompleteInSession: false\n        });\n      }\n      this.getChildren().models = this._originalChildModels;\n      if (assessmentConfig?._banks._isEnabled &&\n        assessmentConfig?._banks._split.length > 1) {\n        quizModels = this._setupBankedAssessment();\n      } else if (assessmentConfig?._randomisation._isEnabled) {\n        quizModels = this._setupRandomisedAssessment();\n      }\n    }\n    if (!quizModels) {\n      // leave the order as before, completed or not\n      quizModels = this.getChildren().models;\n    } else if (quizModels.length === 0) {\n      quizModels = this.getChildren().models;\n      logging.warn('assessment: Not enough unique questions to create a fresh assessment, using last selection');\n    }\n    this.getChildren().models = quizModels;\n    this.setupCurrentQuestionComponents();\n    if (shouldResetAssessment || shouldResetQuestions) {\n      this._resetQuestions();\n      this.set('_attemptInProgress', true);\n      Adapt.trigger('assessments:reset', this.getState(), this);\n    }\n    if (!state.isComplete) {\n      this.set('_attemptInProgress', true);\n    }\n    this._overrideQuestionComponentSettings();\n    this._setupQuestionListeners();\n    this._checkNumberOfQuestionsAnswered();\n    this._updateQuestionsState();\n    Adapt.assessment.saveState();\n    this.trigger('reset');\n    if (shouldResetAssessment || shouldResetQuestions) {\n      Adapt.trigger('assessments:postReset', this.getState(), this);\n    }\n  },\n\n  _setupBankedAssessment() {\n    const assessmentConfig = this.getConfig();\n    this._setupBanks();\n    // Get random questions from banks\n    let questionModels = this._questionBanks.flatMap(questionBank => questionBank.getRandomQuestionBlocks());\n    // If overall question order should be randomized\n    if (assessmentConfig._banks._randomisation) {\n      questionModels = _.shuffle(questionModels);\n    }\n    return questionModels;\n  },\n\n  _setupBanks() {\n    const assessmentConfig = this.getConfig();\n    const bankSplits = assessmentConfig._banks._split.split(',');\n    const hasBankSplitsChanged = (bankSplits.length !== this._questionBanks?.length);\n    if (hasBankSplitsChanged) {\n      // Generate new question banks if the split has changed\n      this._questionBanks = [];\n    }\n    bankSplits.forEach((count, index) => {\n      const bankId = (index + 1);\n      const articleId = this.get('_id');\n      // Keep question bank instances to preserve unused blocks over multi asessment attempts inside a session\n      this._questionBanks[bankId] = (this._questionBanks[bankId] || new QuestionBank(bankId, articleId));\n      // Recalculate available blocks incase they have changed or the count has changed in the split\n      this._questionBanks[bankId].calculateAvailableQuestionBlocks(count);\n    });\n  },\n\n  _setupRandomisedAssessment() {\n    const assessmentConfig = this.getConfig();\n\n    const randomisationModel = assessmentConfig._randomisation;\n    const blockModels = this.getChildren().models;\n\n    let questionModels = _.shuffle(blockModels);\n\n    if (randomisationModel._blockCount > 0) {\n      questionModels = questionModels.slice(0, randomisationModel._blockCount);\n    }\n\n    return questionModels;\n  },\n\n  _overrideQuestionComponentSettings() {\n    const newSettings = this._getMarkingSettings();\n\n    // Add any additional setting overrides here\n    const questionConfig = this.getConfig()._questions;\n    if (Object.prototype.hasOwnProperty.call(questionConfig, '_canShowFeedback')) {\n      newSettings._canShowFeedback = questionConfig._canShowFeedback;\n    }\n\n    if (!_.isEmpty(newSettings)) {\n      const questionComponents = this._getAllQuestionComponents();\n      questionComponents.forEach(model => model.set(newSettings, { pluginName: '_assessment' }));\n    }\n  },\n\n  _setupQuestionListeners() {\n    this._removeQuestionListeners();\n    this.listenTo(this, 'bubble:change:_isInteractionComplete', this._onCompletionEvent);\n  },\n\n  _checkNumberOfQuestionsAnswered() {\n    const questionComponents = this._getCurrentQuestionComponents();\n    const numberOfQuestionsAnswered = questionComponents.filter(model => model.get('_isInteractionComplete')).length;\n    this.set('_numberOfQuestionsAnswered', numberOfQuestionsAnswered);\n  },\n\n  _removeQuestionListeners() {\n    this.stopListening(this, 'bubble:change:_isInteractionComplete', this._onCompletionEvent);\n  },\n\n  _onCompletionEvent(event) {\n    if (event.target?.isTypeGroup('block')) return this._onBlockCompleted(event.target, event.value);\n    if (event.target?.isTypeGroup('questions')) return this._onQuestionCompleted(event.target, event.value);\n  },\n\n  _onBlockCompleted(blockModel, value) {\n    if (value === false) return;\n    const questionModels = blockModel.findDescendantModels('question');\n    questionModels.forEach(questionModel => {\n      this._onQuestionCompleted(questionModel, value);\n    });\n    if (!blockModel.get('_isInteractionComplete')) return;\n    this._checkAssessmentComplete();\n  },\n\n  _onQuestionCompleted(questionModel, value) {\n    if (value === false) return;\n    if (!questionModel.get('_isInteractionComplete')) return;\n\n    const numberOfQuestionsAnswered = this._getCurrentQuestionComponents().reduce((count, question) => (count += question.get('_isSubmitted') ? 1 : 0), 0);\n    this.set('_numberOfQuestionsAnswered', numberOfQuestionsAnswered);\n\n    this._updateQuestionsState();\n    Adapt.assessment.saveState();\n\n    this._checkAssessmentComplete();\n  },\n\n  _checkAssessmentComplete() {\n    const allQuestionsAdded = (this.get('_requireCompletionOf') !== Number.POSITIVE_INFINITY);\n    if (!allQuestionsAdded) return;\n    const numberOfQuestionsAnswered = this.get('_numberOfQuestionsAnswered');\n    const allQuestionsAnswered = (numberOfQuestionsAnswered >= this._getCurrentQuestionComponents().length);\n    if (!allQuestionsAnswered) return;\n    this._onAssessmentComplete();\n  },\n\n  _onAssessmentComplete() {\n    const wasAttemptInProgess = this.get('_attemptInProgress');\n    if (!wasAttemptInProgess) return;\n    this.set('_attemptInProgress', false);\n    this._spendAttempt();\n    const _scoreAsPercent = this._getScoreAsPercent();\n    const _score = this._getScore();\n    const _maxScore = this._getMaxScore();\n    const _minScore = this._getMinScore();\n    const _correctCount = this._getCorrectCount();\n    const _correctAsPercent = this._getCorrectAsPercent();\n    const _questionCount = this._getQuestionCount();\n    this.set({\n      _scoreAsPercent,\n      _score,\n      _maxScore,\n      _minScore,\n      _correctAsPercent,\n      _correctCount,\n      _questionCount,\n      _lastAttemptScoreAsPercent: _scoreAsPercent,\n      _assessmentCompleteInSession: true,\n      _isAssessmentComplete: true\n    });\n    this._updateQuestionsState();\n    this._checkIsPass();\n    this._removeQuestionListeners();\n    if (this._isMarkingSuppressionEnabled() && (!this._isAttemptsLeft() || this._isPassed())) {\n      _.defer(() => {\n        this._overrideMarkingSettings();\n        this._refreshQuestions();\n      });\n    }\n    Adapt.trigger('assessments:complete', this.getState(), this);\n  },\n\n  _updateQuestionsState() {\n    const questionComponents = this._getCurrentQuestionComponents();\n    const questions = questionComponents.map(model => ({\n      _id: model.get('_id'),\n      _isCorrect: model.get('_isCorrect') ?? null\n    }));\n    this.set('_questions', questions);\n  },\n\n  _checkIsPass() {\n    const assessmentConfig = this.getConfig();\n\n    const isPercentageBased = assessmentConfig._isPercentageBased;\n    const scoreToPass = assessmentConfig._scoreToPass;\n    const correctToPass = assessmentConfig._correctToPass || 0;\n\n    const scoreAsPercent = this.get('_scoreAsPercent');\n    const score = this.get('_score');\n    const correctAsPercent = this.get('_correctAsPercent');\n    const correctCount = this.get('_correctCount');\n\n    const isPass = isPercentageBased\n      ? (scoreAsPercent >= scoreToPass && correctAsPercent >= correctToPass)\n      : (score >= scoreToPass && correctCount >= correctToPass);\n\n    this.set('_isPass', isPass);\n  },\n\n  _getMarkingSettings() {\n    let markingSettings = {};\n\n    if (this._shouldSuppressMarking()) {\n      markingSettings = {\n        _canShowMarking: false,\n        _canShowModelAnswer: false\n      };\n    } else {\n      const questionConfig = this.getConfig()._questions;\n\n      if (Object.prototype.hasOwnProperty.call(questionConfig, '_canShowModelAnswer')) {\n        markingSettings._canShowModelAnswer = questionConfig._canShowModelAnswer;\n      }\n\n      if (Object.prototype.hasOwnProperty.call(questionConfig, '_canShowMarking')) {\n        markingSettings._canShowMarking = questionConfig._canShowMarking;\n      }\n    }\n\n    return markingSettings;\n  },\n\n  _overrideMarkingSettings() {\n    const newMarkingSettings = this._getMarkingSettings();\n    const questionComponents = this._getAllQuestionComponents();\n    questionComponents.forEach(model => model.set(newMarkingSettings, { pluginName: '_assessment' }));\n  },\n\n  _refreshQuestions() {\n    const questionComponents = this._getCurrentQuestionComponents();\n    questionComponents.forEach(model => model.refresh());\n  },\n\n  _shouldSuppressMarking() {\n    return this._isMarkingSuppressionEnabled() && this._isAttemptsLeft() && !this._isPassed();\n  },\n\n  _isMarkingSuppressionEnabled() {\n    const assessmentConfig = this.getConfig();\n    return assessmentConfig._suppressMarking;\n  },\n\n  _isAttemptsLeft() {\n    if (this.get('_attemptsLeft') === 0) return false;\n    return true;\n  },\n\n  _isPassed() {\n    return this.get('_isAssessmentComplete') && this.get('_isPass');\n  },\n\n  _spendAttempt() {\n    if (!this._isAttemptsLeft()) return false;\n\n    let attemptsSpent = this.get('_attemptsSpent');\n    this.set('_attemptsSpent', ++attemptsSpent);\n\n    if (this.get('_attempts') === 'infinite') return true;\n\n    let attemptsLeft = this.get('_attemptsLeft');\n    this.set('_attemptsLeft', --attemptsLeft);\n\n    return true;\n  },\n\n  _getScore() {\n    const questionComponents = this._getCurrentQuestionComponents();\n    const score = questionComponents.reduce((score, model) => (score += model.score || 0), 0);\n    return score;\n  },\n\n  _getMaxScore() {\n    const questionComponents = this._getCurrentQuestionComponents();\n    const maxScore = questionComponents.reduce((maxScore, model) => (maxScore += model.maxScore || 0), 0);\n    return maxScore;\n  },\n\n  _getMinScore() {\n    const questionComponents = this._getCurrentQuestionComponents();\n    const minScore = questionComponents.reduce((minScore, model) => (minScore += model.minScore || 0), 0);\n    return minScore;\n  },\n\n  _getScoreAsPercent() {\n    const minScore = this._getMinScore();\n    const maxScore = this._getMaxScore();\n    const score = this._getScore();\n    const range = (maxScore - minScore);\n    return (range === 0) ? 0 : Math.round(((score - minScore) / range) * 100);\n  },\n\n  _getCorrectCount() {\n    return this._getCurrentQuestionComponents().reduce((count, model) => (count += model.get('_isCorrect') ? 1 : 0), 0);\n  },\n\n  _getQuestionCount() {\n    return this._getCurrentQuestionComponents().length;\n  },\n\n  _getCorrectAsPercent() {\n    const questionCount = this._getQuestionCount();\n    return (questionCount === 0) ? 0 : Math.round((this._getCorrectCount() / questionCount) * 100);\n  },\n\n  _getLastAttemptScoreAsPercent() {\n    return this.get('_lastAttemptScoreAsPercent');\n  },\n\n  _checkReloadPage() {\n    if (!this.canResetInPage()) return false;\n\n    const parentId = this.getParent().get('_id');\n    const currentLocation = location._currentId;\n\n    // check if on assessment page and should rerender page\n    if (currentLocation !== parentId) return false;\n    if (!this.get('_isReady')) return false;\n\n    return true;\n  },\n\n  _reloadPage(callback) {\n    const assessmentConfig = this.getConfig();\n    this._forceResetOnRevisit = true;\n    this.listenToOnce(Adapt, 'pageView:ready', async () => {\n      if (assessmentConfig._scrollToOnReset) {\n        await router.navigateToElement(this.get('_id'));\n      }\n      callback();\n    });\n    _.delay(() => {\n      Backbone.history.navigate('#/id/' + location._currentId, { replace: true, trigger: true });\n    }, 250);\n  },\n\n  _resetQuestions() {\n    const assessmentConfig = this.getConfig();\n    const questionModels = this._getCurrentQuestionComponents();\n    questionModels.forEach(model => model.reset(assessmentConfig._questions._resetType, true));\n  },\n\n  _onRemove() {\n    this._removeQuestionListeners();\n  },\n\n  _setCompletionStatus() {\n    this.set({\n      _isComplete: true,\n      _isInteractionComplete: true\n    });\n  },\n\n  _checkIfQuestionsWereRestored() {\n    if (this.get('_assessmentCompleteInSession')) return;\n    if (!this.get('_isAssessmentComplete')) return;\n\n    // fix for courses that do not remember the user selections\n    // force assessment to reset if user revisits an assessment page in a new session which is completed\n    let wereQuestionsRestored = true;\n\n    const questions = this.get('_questions');\n    for (const question of questions) {\n      const questionModel = data.findById(question._id);\n      if (questionModel.get('_isAvailable') && !questionModel.get('_isSubmitted')) {\n        wereQuestionsRestored = false;\n        break;\n      }\n    }\n\n    if (!wereQuestionsRestored) {\n      this.set('_assessmentCompleteInSession', true);\n      return true;\n    }\n\n    return false;\n  },\n\n  // Public Functions\n  isAssessmentEnabled() {\n    if (this.get('_assessment')?._isEnabled) return true;\n    return false;\n  },\n\n  canResetInPage() {\n    const assessmentConfig = this.getConfig();\n    if (assessmentConfig._reloadPageOnReset === false) return false;\n    return true;\n  },\n\n  reset(force, callback) {\n\n    const assessmentConfig = this.getConfig();\n\n    // check if forcing reset via page revisit or force parameter\n    force = this._forceResetOnRevisit || force === true;\n    this._forceResetOnRevisit = false;\n\n    const isPageReload = this._checkReloadPage();\n\n    // stop resetting if not complete or not allowed\n    if (this.get('_assessmentCompleteInSession') &&\n      !assessmentConfig._isResetOnRevisit &&\n      !isPageReload &&\n      !force) {\n      // eslint-disable-next-line node/no-callback-literal\n      if (typeof callback === 'function') callback(false);\n      return false;\n    }\n\n    // check if new session and questions not restored\n    const wereQuestionsRestored = this._checkIfQuestionsWereRestored();\n    force = force || wereQuestionsRestored;\n    // the assessment is going to be reset so we must reset attempts\n    // otherwise assessment may not be set up properly in next session\n    if (force && !this._isAttemptsLeft()) {\n      this.set({\n        _attemptsLeft: this.get('_attempts'),\n        _attemptsSpent: 0\n      });\n    }\n\n    const allowResetIfPassed = this.get('_assessment')._allowResetIfPassed;\n    // stop resetting if no attempts left and allowResetIfPassed is false\n    if (!this._isAttemptsLeft() && !force && !allowResetIfPassed) {\n      // eslint-disable-next-line node/no-callback-literal\n      if (typeof callback === 'function') callback(false);\n      return false;\n    }\n\n    if (!isPageReload) {\n      this._setupAssessmentData(force);\n      // eslint-disable-next-line node/no-callback-literal\n      if (typeof callback === 'function') callback(true);\n    } else {\n      this._reloadPage(() => {\n        // eslint-disable-next-line node/no-callback-literal\n        if (typeof callback === 'function') callback(true);\n      });\n    }\n\n    return true;\n  },\n\n  getSaveState() {\n    const state = this.getState();\n    let blocks;\n    const cfg = this.getConfig();\n    const banksActive = cfg._banks?._isEnabled && cfg._banks._split.length > 1;\n    const randomisationActive = cfg._randomisation?._isEnabled;\n\n    if (!banksActive && !randomisationActive) {\n      // include presentation blocks in save state so that blocks without questions aren't removed\n      blocks = this.findDescendantModels('block');\n    } else {\n      blocks = state.questions.map(question => data.findById(question._id).getParent());\n    }\n    blocks = [...new Set(blocks)]\n      .filter(block => block.trackingPosition);\n    const blockTrackingPositions = blocks.map(block => block.trackingPosition);\n    const blockCompletion = blocks.map(block => {\n      const questions = block.findDescendantModels('question');\n      return questions.map(question => question.get('_isCorrect') || false);\n    });\n    const blockData = [blockTrackingPositions, blockCompletion];\n\n    const saveState = [\n      state.isComplete ? 1 : 0,\n      state.attemptsSpent,\n      state.maxScore || 0,\n      state.score,\n      state.attemptInProgress ? 1 : 0,\n      state.minScore || 0,\n      state.correctAsPercent || 0,\n      state.correctCount || 0,\n      state.questionCount || 0\n    ];\n\n    const dataPackage = [saveState, blockData];\n\n    return dataPackage;\n  },\n\n  setRestoreState(dataPackage) {\n    const restoreState = dataPackage[0];\n    const blockData = dataPackage[1];\n    const _isAssessmentComplete = restoreState[0] === 1;\n    const attempts = this.get('_attempts');\n    const _attemptsSpent = restoreState[1];\n    const maxScore = restoreState[2];\n    const score = restoreState[3];\n    const _scoreAsPercent = score ? Math.round(score / maxScore * 100) : 0;\n    const _attemptInProgress = restoreState[4] === 1;\n    const minScore = restoreState[5];\n    const correctAsPercent = restoreState[6];\n    const correctCount = restoreState[7];\n    const questionCount = restoreState[8];\n\n    const blocks = blockData[0].map(trackingPosition => {\n      if (typeof trackingPosition === 'number') {\n        // Backwards compability for courses which use _trackingId at block level\n        return data.findWhere({ _trackingId: trackingPosition });\n      }\n      return data.findByTrackingPosition(trackingPosition);\n    });\n\n    if (blocks.length) {\n      const nonBlockChildren = this.getChildren().models.filter(model => !model.isTypeGroup('block'));\n      this.getChildren().models = blocks.concat(nonBlockChildren);\n    }\n\n    const _questions = [];\n    blocks.forEach((block, blockIndex) => {\n      const blockQuestions = block.findDescendantModels('question');\n      blockQuestions.forEach((question, questionIndex) => {\n        _questions.push({\n          _id: question.get('_id'),\n          _isCorrect: blockData[1][blockIndex][questionIndex]\n        });\n      });\n    });\n\n    this.set({\n      _isAssessmentComplete,\n      _assessmentCompleteInSession: false,\n      _attemptsSpent,\n      _attemptInProgress,\n      _attemptsLeft: (attempts === 'infinite' ? attempts : attempts - _attemptsSpent),\n      _maxScore: maxScore || this._getMaxScore(),\n      _minScore: minScore || this._getMinScore(),\n      _score: score || 0,\n      _scoreAsPercent,\n      _correctAsPercent: correctAsPercent || 0,\n      _correctCount: correctCount || 0,\n      _questions,\n      _questionCount: questionCount || 0,\n      _lastAttemptScoreAsPercent: _scoreAsPercent\n    });\n\n    if (_isAssessmentComplete) this._checkIsPass();\n\n    Adapt.trigger('assessments:restored', this.getState(), this);\n\n  },\n\n  getState() {\n    // return the current state of the assessment\n    // create snapshot of values so as not to create memory leaks\n    const assessmentConfig = this.getConfig();\n\n    const state = {\n      id: assessmentConfig._id,\n      type: 'article-assessment',\n      pageId: this.getParent().get('_id'),\n      articleId: this.get('_id'),\n      isEnabled: assessmentConfig._isEnabled,\n      isComplete: this.get('_isAssessmentComplete'),\n      isPercentageBased: assessmentConfig._isPercentageBased,\n      scoreToPass: assessmentConfig._scoreToPass,\n      score: this.get('_score'),\n      scoreAsPercent: this.get('_scoreAsPercent'),\n      maxScore: this.get('_maxScore'),\n      minScore: this.get('_minScore'),\n      correctCount: this.get('_correctCount'),\n      correctAsPercent: this.get('_correctAsPercent'),\n      correctToPass: assessmentConfig._correctToPass,\n      questionCount: this.get('_questionCount'),\n      isPass: this.get('_isPass'),\n      includeInTotalScore: assessmentConfig._includeInTotalScore,\n      assessmentWeight: assessmentConfig._assessmentWeight,\n      attempts: this.get('_attempts'),\n      attemptsSpent: this.get('_attemptsSpent'),\n      attemptsLeft: this.get('_attemptsLeft'),\n      attemptInProgress: this.get('_attemptInProgress'),\n      lastAttemptScoreAsPercent: this.get('_lastAttemptScoreAsPercent'),\n      questions: this.get('_questions'),\n      resetType: assessmentConfig._questions._resetType,\n      allowResetIfPassed: assessmentConfig._allowResetIfPassed,\n      questionModels: new Backbone.Collection(this._getCurrentQuestionComponents())\n    };\n\n    return state;\n  },\n\n  getConfig() {\n    let assessmentConfig = this.get('_assessment');\n\n    if (!assessmentConfig) {\n      assessmentConfig = $.extend(true, {}, assessmentConfigDefaults);\n    } else {\n      assessmentConfig = $.extend(true, {}, assessmentConfigDefaults, assessmentConfig);\n    }\n\n    if (assessmentConfig._id === undefined) {\n      assessmentConfig._id = 'givenId' + (givenIdCount++);\n    }\n\n    this.set('_assessment', assessmentConfig);\n\n    return assessmentConfig;\n  }\n};\n\nexport default AssessmentModel;\n","import Adapt from 'core/js/adapt';\nimport offlineStorage from 'core/js/offlineStorage';\nimport wait from 'core/js/wait';\nimport data from 'core/js/data';\nimport logging from 'core/js/logging';\n\n/*\n  * Here we setup a registry for all assessments\n  */\nconst assessmentsConfigDefaults = {\n  _isPercentageBased: true,\n  _scoreToPass: 100,\n  _isDefaultsLoaded: true\n};\n\nclass Assessment extends Backbone.Controller {\n\n  initialize() {\n    this._assessments = Object.assign([], {\n      _byPageId: {},\n      _byAssessmentId: {}\n    });\n    this.listenTo(Adapt, {\n      'assessments:complete': this._onAssessmentsComplete,\n      'router:location': this._checkResetAssessmentsOnRevisit,\n      'router:plugin': this._handleRoute,\n      'app:dataReady': this._onDataReady\n    });\n  }\n\n  _onAssessmentsComplete(state) {\n    const assessmentId = state.id;\n\n    state.isComplete = true;\n\n    if (assessmentId === undefined) return;\n\n    if (!this._getStateByAssessmentId(assessmentId)) {\n      logging.warn('assessments: state was not registered when assessment was created');\n    }\n\n    this.saveState();\n\n    this._setPageProgress();\n\n    this._checkAssessmentsComplete();\n\n  }\n\n  _restoreModelState(assessmentModel) {\n\n    if (!this._saveStateModel) {\n      this._saveStateModel = offlineStorage.get('a');\n    }\n    if (this._saveStateModel) {\n      const state = assessmentModel.getState();\n      if (this._saveStateModel[state.id]) {\n        assessmentModel.setRestoreState(offlineStorage.deserialize(this._saveStateModel[state.id]));\n      }\n    }\n\n  }\n\n  /*\n    * Allow navigating to an assessment via the URL.\n    */\n  _handleRoute(plugin, id) {\n    if ((plugin !== 'assessment' && plugin !== 'article-assessment') || id === undefined) {\n      return;\n    }\n\n    // Check the 'id' passed is that of an article.\n    if (!data.findById(id)) {\n      // The 'id' passed may have been the assessment _id/name, not the article _id.\n      const assessment = Adapt.assessment._assessments._byAssessmentId[id];\n      if (assessment) {\n        // Set 'id' to the article _id.\n        id = assessment.get('_id');\n      } else {\n        logging.warn('Assessment not found with _id: ' + id);\n        return;\n      }\n    }\n\n    _.defer(() => {\n      // Defer this call so that the router's _canNavigate flag is true.\n      Backbone.history.navigate('#/id/' + id, { trigger: true, replace: true });\n    });\n  }\n\n  _checkResetAssessmentsOnRevisit(toObject) {\n    /*\n      * Here we hijack router:location to reorganise the assessment blocks\n      * this must happen before trickle listens to block completion\n      */\n    if (toObject._contentType !== 'page') return;\n\n    // initialize assessment on page visit before pageView:preRender (and trickle)\n    const pageAssessmentModels = this._getAssessmentByPageId(toObject._currentId);\n    if (pageAssessmentModels === undefined) return;\n\n    /*\n      * Here we further hijack the router to ensure the asynchronous assessment\n      * reset completes before routing completes\n      */\n    wait.for(function resetAllAssessments(allAssessmentHaveReset) {\n\n      const numberOfAssessments = pageAssessmentModels.length;\n      let numberOfResetAssessments = 0;\n      const forceAssessmentReset = false;\n\n      pageAssessmentModels.forEach(model => {\n\n        model.reset(forceAssessmentReset, () => {\n          numberOfResetAssessments++;\n          const haveAllModelsReset = (numberOfResetAssessments === numberOfAssessments);\n          if (!haveAllModelsReset) {\n            return;\n          }\n          allAssessmentHaveReset();\n        });\n      });\n    });\n\n    this._setPageProgress();\n  }\n\n  _onDataReady() {\n    this._assessments = Object.assign([], {\n      _byPageId: {},\n      _byAssessmentId: {}\n    });\n\n    this._restoredCount = 0;\n  }\n\n  _checkAssessmentsComplete() {\n    let allAssessmentsComplete = true;\n    let assessmentToPostBack = 0;\n    const states = this._getStatesByAssessmentId();\n\n    const assessmentStates = [];\n\n    for (const id in states) {\n      const state = states[id];\n      if (!state.includeInTotalScore) continue;\n      if (!state.isComplete) {\n        allAssessmentsComplete = false;\n        break;\n      }\n      assessmentToPostBack++;\n      assessmentStates.push(state);\n    }\n\n    if (!allAssessmentsComplete || assessmentToPostBack === 0) return false;\n\n    if (assessmentToPostBack === 1) {\n      this._setupSingleAssessmentConfiguration(assessmentStates[0]);\n    }\n\n    _.defer(() => Adapt.trigger('assessment:complete', this.getState()));\n\n    return true;\n  }\n\n  _setupSingleAssessmentConfiguration(assessmentState) {\n    const assessmentsConfig = Adapt.course.get('_assessment');\n    $.extend(true, assessmentsConfig, {\n      _isPercentageBased: assessmentState.isPercentageBased,\n      _scoreToPass: assessmentState.scoreToPass\n    });\n    Adapt.course.set('_assessment', assessmentsConfig);\n  }\n\n  _getAssessmentByPageId(pageId) {\n    return this._assessments._byPageId[pageId];\n  }\n\n  _getStateByAssessmentId(assessmentId) {\n    if (assessmentId === undefined) {\n      return null;\n    }\n\n    return this._assessments._byAssessmentId[assessmentId].getState();\n  }\n\n  _getStatesByAssessmentId() {\n    const states = {};\n    for (const assessmentModel of this._assessments) {\n      if (!assessmentModel.get('_isAvailable')) continue;\n      const state = assessmentModel.getState();\n      states[state.id] = state;\n    }\n    return states;\n  }\n\n  _setPageProgress() {\n    // set _subProgressTotal and _subProgressComplete on pages that have assessment progress indicator requirements\n\n    for (const [ id, assessments ] of Object.entries(this._assessments._byPageId)) {\n\n      const availableAssessments = assessments.filter(model => model.get('_isAvailable'));\n\n      const assessmentsTotal = availableAssessments.length;\n      let assessmentsPassed = 0;\n\n      for (const assessment of availableAssessments) {\n        const assessmentState = assessment.getState();\n\n        if (assessmentState.includeInTotalScore && !assessmentState.isPass) continue;\n\n        if (assessmentState.isComplete) {\n          assessmentsPassed++;\n        }\n      }\n\n      const pageModel = data.findById(id);\n      pageModel?.set({\n        _subProgressTotal: assessmentsTotal,\n        _subProgressComplete: assessmentsPassed\n      });\n\n    }\n  }\n\n  _addToAssessmentIdMap(id, model) {\n    if (id === undefined) {\n      logging.warn('An assessment has been registered with an undefined value for \"_id\"');\n      return;\n    }\n\n    if (id === '') {\n      logging.warn('An assessment has been registered with an empty value for \"_id\"');\n    }\n\n    if (!this._assessments._byAssessmentId[id]) {\n      this._assessments._byAssessmentId[id] = model;\n    } else {\n      logging.warn('An assessment with an _id of \"' + id + '\" already exists!');\n    }\n  }\n\n  _setupQuestionNumbering() {\n    const getRelatedQuestions = data => {\n      const currentAssessmentId = data._assessmentId;\n      const currentAssessment = Adapt.assessment.get(currentAssessmentId);\n      return currentAssessment.getState().questions;\n    };\n\n    Handlebars.registerHelper('questionNumber', function getQuestionNumber() {\n      const data = this.view?.model.toJSON() || this;\n      if (!data._isPartOfAssessment) return;\n\n      const related = _.pluck(getRelatedQuestions(data), '_id');\n\n      return related.indexOf(data._id) + 1;\n    });\n\n    Handlebars.registerHelper('questionCount', function getTotalQuestions() {\n      const data = this.view ? this.view.model.toJSON() : this;\n      if (!data._isPartOfAssessment) return;\n      return getRelatedQuestions(data).length;\n    });\n  }\n\n  // Public functions\n  register(assessmentModel) {\n    const state = assessmentModel.getState();\n    const assessmentId = state.id;\n    const pageId = state.pageId;\n\n    if (this._assessments._byPageId[pageId] === undefined) {\n      this._assessments._byPageId[pageId] = [];\n    }\n\n    this._assessments._byPageId[pageId].push(assessmentModel);\n\n    this._addToAssessmentIdMap(assessmentId, assessmentModel);\n\n    this._assessments.push(assessmentModel);\n\n    this._restoreModelState(assessmentModel);\n    this._restoredCount++;\n\n    Adapt.trigger('assessments:register', state, assessmentModel);\n\n    this._setPageProgress();\n\n    this._setupQuestionNumbering();\n\n    if (this._restoredCount === this._assessments.length) {\n      // Since all assessments have been stored, broadcast an\n      // event which has the collated state.\n      Adapt.trigger('assessment:restored', this.getState());\n    }\n  }\n\n  get(id) {\n    return (id === undefined)\n      ? this._assessments.slice(0)\n      : this._assessments._byAssessmentId[id];\n  }\n\n  saveState() {\n\n    this._saveStateModel = {};\n    for (const assessmentModel of this._assessments) {\n      const state = assessmentModel.getState();\n      this._saveStateModel[state.id] = offlineStorage.serialize(assessmentModel.getSaveState());\n    }\n\n    offlineStorage.set('a', this._saveStateModel);\n  }\n\n  getConfig() {\n    let assessmentsConfig = Adapt.course.get('_assessment');\n\n    if (assessmentsConfig?._isDefaultsLoaded) {\n      return assessmentsConfig;\n    }\n\n    if (assessmentsConfig === undefined) {\n      assessmentsConfig = $.extend(true, {}, assessmentsConfigDefaults);\n    } else {\n      assessmentsConfig = $.extend(true, {}, assessmentsConfigDefaults, assessmentsConfig);\n    }\n\n    Adapt.course.set('_assessment', assessmentsConfig);\n\n    return assessmentsConfig;\n  }\n\n  getState() {\n    const assessmentsConfig = this.getConfig();\n\n    let score = 0;\n    let maxScore = 0;\n    let minScore = 0;\n    let correctCount = 0;\n    let questionCount = 0;\n    let assessments = 0;\n    const states = this._getStatesByAssessmentId();\n    let assessmentsComplete = 0;\n\n    for (const id in states) {\n      const state = states[id];\n      if (!state.includeInTotalScore) continue;\n      if (state.isComplete) assessmentsComplete++;\n      assessments++;\n      maxScore += state.maxScore / state.assessmentWeight;\n      minScore += state.minScore / state.assessmentWeight;\n      score += state.score / state.assessmentWeight;\n      correctCount += state.correctCount / state.assessmentWeight;\n      questionCount += state.questionCount / state.assessmentWeight;\n    }\n\n    const isComplete = assessmentsComplete === assessments;\n\n    const scoreRange = (maxScore - minScore);\n    const scoreAsPercent = (scoreRange === 0) ? 0 : Math.round(((score - minScore) / scoreRange) * 100);\n    const correctAsPercent = (questionCount === 0) ? 0 : Math.round((correctCount / questionCount) * 100);\n\n    if (assessmentsConfig._correctToPass === undefined) {\n      logging.warnOnce('Assessment course config is missing _correctToPass');\n    }\n\n    const scoreToPass = assessmentsConfig._scoreToPass;\n    const correctToPass = assessmentsConfig._correctToPass || scoreToPass;\n    const isPercentageBased = assessmentsConfig._isPercentageBased;\n\n    const isPass = isComplete && (isPercentageBased\n      ? scoreAsPercent >= scoreToPass && correctAsPercent >= correctToPass\n      : score >= scoreToPass && correctCount >= correctToPass);\n\n    const canRetry = Object.values(states).some(state => {\n      const isFailed = !state.isPass;\n      const hasAttemptsLeft = (state.attemptsLeft > 0 || state.attemptsLeft === 'infinite');\n      return (isFailed && hasAttemptsLeft);\n    });\n\n    return {\n      isComplete,\n      isPercentageBased,\n      isPass,\n      maxScore,\n      minScore,\n      score,\n      scoreToPass,\n      scoreAsPercent,\n      correctCount,\n      correctAsPercent,\n      correctToPass,\n      questionCount,\n      assessmentsComplete,\n      assessments,\n      canRetry\n    };\n  }\n}\n\nexport default (Adapt.assessment = new Assessment());\n","import ArticleView from 'core/js/views/articleView';\nimport ArticleModel from 'core/js/models/articleModel';\nimport AdaptAssessmentArticleView from './adapt-assessmentArticleView';\nimport AdaptAssessmentArticleModel from './adapt-assessmentArticleModel';\nimport './assessment';\n\n/*\n  * Here we are extending the articleView and articleModel in Adapt.\n  * This is to accomodate the assessment functionality on the article.\n  * The advantage of this method is that the assessment behaviour can utilize all of the predefined article behaviour in both the view and the model.\n  */\n\n// Extends core/js/views/articleView.js\nconst ArticleViewInitialize = ArticleView.prototype.initialize;\nArticleView.prototype.initialize = function(options) {\n  if (this.model.get('_assessment')?._isEnabled === true) {\n    // extend the articleView with new functionality\n    Object.assign(this, AdaptAssessmentArticleView);\n  }\n  // initialize the article in the normal manner\n  return ArticleViewInitialize.apply(this, arguments);\n};\n\n// Extends core/js/models/articleModel.js\nconst ArticleModelInitialize = ArticleModel.prototype.initialize;\nArticleModel.prototype.initialize = function(options) {\n  if (this.get('_assessment')?._isEnabled === true) {\n    // extend the articleModel with new functionality\n    Object.assign(this, AdaptAssessmentArticleModel);\n\n    // initialize the article in the normal manner\n    const returnValue = ArticleModelInitialize.apply(this, arguments);\n\n    // initialize assessment article\n    this._postInitialize();\n\n    return returnValue;\n  }\n\n  // initialize the article in the normal manner if no assessment\n  return ArticleModelInitialize.apply(this, arguments);\n};\n","import QuestionModel from 'core/js/models/questionModel';\n\nexport function getMMCorrectness(questionModels) {\n  const userAnswer = questionModels[0].attributes._userAnswer;\n  var direction = \"\";\n  if (userAnswer[0]) {\n    direction =  questionModels[0]._childrenCollection.models[0].attributes.direction;\n  } else {\n    direction = questionModels[0]._childrenCollection.models[1].attributes.direction;\n  }\n  if (direction == \"go straight\") {\n    return 'incorrect';\n  } else {\n    return 'correct';\n  }\n}\n\nexport function getCorrectness(model) {\n  const questionModels = model.getAllDescendantModels().concat([model]).filter(model => model instanceof QuestionModel);\n  if(questionModels[0].attributes._component == \"moral-machine-gmcq\") {\n    return getMMCorrectness(questionModels);\n  } else {\n  const numberOfCorrect = (questionModels.filter(child => (child.isCorrect()) && !child.get('_isOptional'))).length;\n  const numberOfPartlyCorrect = (questionModels.filter(child => (child.isPartlyCorrect()) && !child.get('_isOptional'))).length;\n  const isCorrect = questionModels.every(child => child.isCorrect() || child.get('_isOptional'));\n  const isPartlyCorrect = (numberOfCorrect > 0) || (numberOfPartlyCorrect > 0);\n  return isCorrect ?\n    'correct' :\n    isPartlyCorrect ?\n      'partlyCorrect' :\n      'incorrect';\n  }\n}","import Adapt from 'core/js/adapt';\nimport data from 'core/js/data';\nimport ComponentModel from 'core/js/models/componentModel';\nimport {\n  getCorrectness\n} from './correctness';\nimport offlineStorage from 'core/js/offlineStorage';\nimport logging from 'core/js/logging';\n\n/** @typedef {import(\"core/js/models/adaptModel\").default} AdaptModel */\n\nexport default class BranchingSet {\n\n  constructor(options = {}) {\n    /** @type {AdaptModel} */\n    this.model = options.model;\n    this.setupModels();\n  }\n\n  setupModels() {\n    const containerId = this.model.get('_id');\n    const children = [\n      ...this.model.getChildren(),\n      ...data.filter(model => model.get('_branching')?._containerId === containerId)\n    ].filter(Boolean);\n    // Hide all branching container original children as only clones will be displayed\n    children.forEach(child => {\n      const config = child.get('_branching');\n      if (!config) return;\n      config._containerId = config._containerId || containerId;\n      // Make direct children unavailable\n      const isDirectChild = (child.getParent().get('_id') === containerId);\n      if (isDirectChild) child.setOnChildren({ _isAvailable: false });\n      child.set({\n        _isBranchChild: true,\n        _isBranchClone: false\n      });\n      const descendants = [child].concat(child.getAllDescendantModels(true));\n      // Link all branch questions to their original ids ready for\n      // cloning and to facilitate save + restore\n      descendants.forEach(descendant => {\n        descendant.set('_branchOriginalModelId', descendant.get('_id'));\n        // Stop original items saving their own attemptStates as attemptStates are used to save/restore branching\n        if (descendant.isTypeGroup('component')) descendant.set('_shouldStoreAttempts', false);\n      });\n    });\n  }\n\n  initialize() {\n    this._wasInitialized = true;\n    this.disableParentCompletion();\n    const wasRestored = this.restore();\n    if (wasRestored) {\n      // Check if the next model needs loading, this will happen if the previous\n      // item was completed in a previous session and before the next item has loaded,\n      // such as when a trickle button is enabled but not yet clicked\n      const nextModel = this.getNextModel();\n      if (typeof nextModel !== 'object') return;\n      this.addNextModel(nextModel, true, false, true);\n      return;\n    }\n    this.addFirstModel();\n  }\n\n  disableParentCompletion() {\n    this.model.set({\n      _canRequestChild: true,\n      _requireCompletionOf: Number.POSITIVE_INFINITY\n    });\n  }\n\n  enableParentCompletion() {\n    this.model.set('_requireCompletionOf', -1);\n    // Synchronously check completion, this.model.checkCompletionStatus is async\n    Adapt.checkingCompletion();\n    this.model.checkCompletionStatusFor('_isComplete');\n    Adapt.checkingCompletion();\n    this.model.checkCompletionStatusFor('_isInteractionComplete');\n  }\n\n  get startId() {\n    return this.model.get('_branching')?._start;\n  }\n\n  set startId(modelId) {\n    const config = this.model.get('_branching');\n    if (!config) return;\n    config._start = modelId;\n  }\n\n  checkResetOnStartChange() {\n    const config = this.model.get('_branching');\n    if (!config._start) return;\n    const isAtCorrectStart = (this.isAtStart && this.branchedModels[0]?.get('_branchOriginalModelId') === config._start);\n    if (isAtCorrectStart || !this.isAtStart || this.isAtEnd) return;\n    this.reset({ removeViews: true });\n  }\n\n  restore() {\n    const branching = offlineStorage.get('b');\n    if (!branching) return;\n    const id = this.model.get('_id');\n    if (!branching[id]) return;\n    const trackingPositions = offlineStorage.deserialize(branching[id]);\n    trackingPositions.forEach((trackingPosition, index) => {\n      const isLast = (index === trackingPositions.length - 1);\n      const model = data.findByTrackingPosition(trackingPosition);\n      this.addNextModel(model, false, true, isLast);\n    });\n    if (this.isAtEnd) {\n      this.enableParentCompletion();\n    }\n    return true;\n  }\n\n  addFirstModel() {\n    // Find and add the first child if the container was not restored\n    const model = this.getNextModel();\n    this.addNextModel(model, true, false);\n  }\n\n  getNextModel({ isTheoretical = false } = {}) {\n    const config = this.model.get('_branching');\n    const branchingModels = this.models;\n    const branchedModels = this.branchedModels;\n\n    const isBeforeStart = !branchedModels.length;\n    if (isBeforeStart) {\n      const hasStartId = Boolean(config._start);\n      const firstModel = hasStartId ?\n        branchingModels.find(model => model.get('_id') === config._start) :\n        branchingModels[0];\n      return firstModel;\n    }\n\n    const lastChildModel = branchedModels[branchedModels.length - 1];\n    const isLastIncomplete = !lastChildModel.get('_isComplete') && !lastChildModel.get('_isOptional');\n    if (isLastIncomplete && !isTheoretical) {\n      return false;\n    }\n\n    const lastChildConfig = lastChildModel.get('_branching');\n    if (!lastChildConfig) return true;\n\n    // Branch from the last model's correctness, if configured\n    const correctness = getCorrectness(lastChildModel);\n    const nextId = lastChildConfig._force || lastChildConfig[`_${correctness}`];\n    if (!nextId) return true;\n\n    function findNextModel(nextId) {\n      const isRelativeId = nextId.includes('@');\n      if (!isRelativeId) {\n        return branchingModels.find(model => model.get('_id') === nextId);\n      }\n      const originalLastChildModel = data.findById(lastChildModel.get('_branchOriginalModelId'));\n      const nextModel = originalLastChildModel.findRelativeModel(nextId);\n      const wasModelAlreadyUsed = nextModel.get('_isAvailable');\n      if (wasModelAlreadyUsed) return true;\n      return nextModel;\n    }\n\n    const nextModel = findNextModel(nextId);\n    // Mark as finished\n    if (nextModel === true) return true;\n    if (nextModel === undefined) {\n      // Set the start block of a different branching set\n      const nextBranchingSet = Adapt.branching.getSubsetByModelId(nextId);\n      if (!nextBranchingSet) {\n        logging.error(`Cannot branch to a model that isn't contained in a branching set: ${nextId} from ${lastChildModel.get('_id')}`);\n        return true;\n      }\n      if (!isTheoretical) nextBranchingSet.startId = nextId;\n      // Mark as finished\n      return true;\n    }\n    // Provide the next model\n    return nextModel;\n  }\n\n  addNextModel(nextModel, shouldSave = true, shouldRestore = false, isLast = true) {\n    // Clear the set's current back() position\n    this.model.set({\n      _branchLastPreviousIndex: null\n    });\n    // Increment the original model's attempts\n    const attemptIndex = (nextModel.get('_branchAttempts') || 0);\n    nextModel.set('_branchAttempts', attemptIndex + 1);\n    let isAnyPartRestored = false;\n    const cloned = nextModel.deepClone((clone, model) => {\n      clone.set({\n        _id: `${model.get('_id')}_branching_${attemptIndex}`, // Replicable ids for bookmarking\n        _isAvailable: true,\n        _isBranchClone: true\n      });\n      if (model === nextModel) {\n        clone.set('_parentId', this.model.get('_id'));\n      }\n      // Remove tracking ids as these will change depending on the branches\n      // Clone attempt states are stored on the original model in their order of occurance\n      if (clone.has('_trackingId')) {\n        clone.unset('_trackingId');\n      }\n      if (clone instanceof ComponentModel) {\n        // Clear clone response history\n        clone.set('_attemptStates', false);\n        if (shouldRestore) {\n          // Restore the attempt state from the original model in occurance order\n          const attemptObjects = model.getAttemptObjects();\n          const hasAttemptRecord = (attemptObjects.length && attemptObjects[attemptIndex]);\n          if (hasAttemptRecord) {\n            clone.set(attemptObjects[attemptIndex]);\n            isAnyPartRestored = true;\n            return;\n          }\n          // If the clone is in the middle of a branching and does not have an\n          // attempt record, then the save must have failed or be missing\n          if (!isLast) {\n            clone.setCompletionStatus();\n            isAnyPartRestored = true;\n          }\n        }\n      }\n      // Reset if not restored or not a component\n      clone.reset('hard', true);\n    });\n    if (isAnyPartRestored) {\n      // Make sure to explicitly set the block to complete if complete\n      // This helps trickle setup locking correctly\n      const areAllDescendantsComplete = cloned.getAllDescendantModels(true).every(model => model.get('_isComplete') || model.get('_isOptional'));\n      if (areAllDescendantsComplete) {\n        cloned.setCompletionStatus();\n      }\n    }\n    if (shouldSave) {\n      this.saveNextModel(nextModel);\n    }\n    return cloned;\n  }\n\n  /**\n   * @param {AdaptModel} nextModel\n   */\n  saveNextModel(nextModel) {\n    const branching = offlineStorage.get('b') || {};\n    const id = this.model.get('_id');\n    const trackingIds = (branching[id] && offlineStorage.deserialize(branching[id])) || [];\n    trackingIds.push(nextModel.trackingPosition);\n    branching[id] = offlineStorage.serialize(trackingIds);\n    offlineStorage.set('b', branching);\n  }\n\n  get models() {\n    const containerId = this.model.get('_id');\n    return data.filter(model => {\n      if (model.get('_isBranchClone')) return false;\n      const config = model.get('_branching');\n      if (!config) return false;\n      return (config._containerId === containerId);\n    });\n  }\n\n  get branchedModels() {\n    const containerId = this.model.get('_id');\n    return data.filter(model => {\n      if (!model.get('_isBranchClone')) return false;\n      const config = model.get('_branching');\n      if (!config) return false;\n      return (config._containerId === containerId);\n    });\n  }\n\n  get isAtStart() {\n    const branchedModels = this.branchedModels;\n    const firstChild = branchedModels[0];\n    const lastChild = branchedModels[branchedModels.length - 1];\n    return (firstChild === lastChild);\n  }\n\n  get isEffectivelyComplete() {\n    const isEffectivelyComplete = this.branchedModels.every(childModel => {\n      const requireCompletionOf = childModel.get('_requireCompletionOf');\n      const hasStandardCompletionCriteria = (requireCompletionOf !== -1);\n      if (hasStandardCompletionCriteria) return false;\n      // Excludes non-trackable extension components, like trickle buttons\n      const areAllAvailableTrackableChildrenComplete = childModel.getChildren()\n        .filter(model => model.get('_isAvailable') && model.get('_isTrackable'))\n        .every(model => model.get('_isComplete') || model.get('_isOptional'));\n      return areAllAvailableTrackableChildrenComplete;\n    });\n    return isEffectivelyComplete && this.isAtEnd;\n  }\n\n  get isAtEnd() {\n    return (this.getNextModel({ isTheoretical: true }) === true);\n  }\n\n  async reset({ removeViews = false } = {}) {\n    if (this._isInReset || !this._wasInitialized) return;\n    this._isInReset = true;\n    this.disableParentCompletion();\n    const parentView = data.findViewByModelId(this.model.get('_id'));\n    const childViews = parentView?.getChildViews();\n    const branchedModels = this.branchedModels;\n    branchedModels.forEach(model => {\n      if (Adapt.parentView && removeViews) {\n        const view = data.findViewByModelId(model.get('_id'));\n        if (view) {\n          view.remove();\n          childViews.splice(childViews.findIndex(v => v === view), 1);\n          parentView.nthChild--;\n        }\n      }\n      data.remove(model);\n    });\n    if (removeViews) parentView?.setChildViews(childViews);\n    this.model.getChildren().remove(branchedModels);\n    this.model.findDescendantModels('component').forEach(model => model.set('_attemptStates', []));\n    const branching = offlineStorage.get('b') || {};\n    const id = this.model.get('_id');\n    const trackingIds = [];\n    branching[id] = offlineStorage.serialize(trackingIds);\n    offlineStorage.set('b', branching);\n    this.addFirstModel();\n    await Adapt.parentView?.addChildren();\n    Adapt.checkingCompletion();\n    this.model.checkCompletionStatusFor('_isComplete');\n    this._isInReset = false;\n    return true;\n  }\n\n}\n","import Backbone from 'backbone';\nimport Adapt from 'core/js/adapt';\nimport data from 'core/js/data';\nimport logging from 'core/js/logging';\nimport ComponentModel from 'core/js/models/componentModel';\nimport offlineStorage from 'core/js/offlineStorage';\nimport BranchingSet from './BranchingSet';\n\nclass Branching extends Backbone.Controller {\n\n  initialize() {\n    /** @type {[BranchingSet]} */\n    this._rawSets = [];\n    this.openPopupCount = 0;\n    this.shouldContinueOnPopupClose = false;\n    this.listenTo(Adapt, {\n      'app:dataReady': this.onAppDataReady,\n      'popup:opened': this.onPopupOpened,\n      'popup:closed': this.onPopupClosed,\n      'assessments:reset': this.onAssessmentReset\n    });\n    this.listenTo(Adapt.articles, 'change:_isComplete', this.onArticleReset);\n  }\n\n  async onAppDataReady() {\n    const config = Adapt.course.get('_branching');\n    if (!config || !config._isEnabled) return;\n    // Wait for all other app:dataReady handlers to finish\n    if (this._isAwaitingDataReady) return;\n    this._isAwaitingDataReady = true;\n    await data.whenReady();\n    this.warnForSpoorMisconfiguration();\n    this._isAwaitingDataReady = false;\n    this.setupBranchingModels();\n    this.setupEventListeners();\n    Adapt.trigger('branching:dataReady');\n  }\n\n  warnForSpoorMisconfiguration() {\n    const config = Adapt.config.get('_spoor');\n    const isMisconfigured = (config?._isEnabled && config?._tracking?._shouldStoreAttempts === false);\n    if (!isMisconfigured) return;\n    logging.error('Branching: Spoor is misconfigured. Branching requires _spoor._tracking._shouldStoreAttempts = true');\n  }\n\n  setupBranchingModels() {\n    this._rawSets.length = 0;\n    const containerModels = data.filter(model => {\n      const type = model.get('_type');\n      if (type === 'course') return false;\n      const config = model.get('_branching');\n      if (!config || !config._isEnabled) return false;\n      if (type === 'article' && config._onChildren === undefined) {\n        // Assume this is the authoring tool and that an article\n        // is always a branching container.\n        config._onChildren = true;\n        model.set('_branching', config);\n      }\n      return (config._onChildren === true);\n    });\n    containerModels.forEach(containerModel => {\n      const set = new BranchingSet({ model: containerModel });\n      this._rawSets.push(set);\n    });\n    this._rawSets.forEach(set => set.initialize());\n  }\n\n  get subsets() {\n    return this._rawSets;\n  }\n\n  getSubsetByModelId(modelId) {\n    return this._rawSets.find(set => set.model.get('_id') === modelId || set.models.find(model => model.get('_id') === modelId));\n  }\n\n  setupEventListeners() {\n    this.listenTo(Adapt, 'view:requestChild', this.onRequestChild);\n    this.listenTo(data, 'change:_isComplete', this.onComplete);\n  }\n\n  onRequestChild(event) {\n    const set = this.getSubsetByModelId(event.target.model.get('_id'));\n    if (!set) return;\n    set.checkResetOnStartChange();\n    const nextModel = set.getNextModel();\n    if (nextModel === false) {\n      // Previous model isn't complete\n      return;\n    }\n    if (nextModel === true) {\n      // No further models, manually check completion of branching container\n      set.enableParentCompletion();\n      return;\n    }\n    const clonedModel = set.addNextModel(nextModel);\n    event.model = clonedModel;\n    // Stop rendering children in this parent to allow for user responses\n    event.stopNext();\n  }\n\n  onPopupOpened() {\n    this.openPopupCount++;\n  }\n\n  onPopupClosed() {\n    this.openPopupCount--;\n    if (!this.shouldContinueOnPopupClose || this.openPopupCount > 0) return;\n    this.shouldContinueOnPopupClose = false;\n    this.continue();\n  }\n\n  onArticleReset(model, isComplete) {\n    if (isComplete) return;\n    const set = this.getSubsetByModelId(model.get('_id'));\n    if (!set) return;\n    set.reset({ removeViews: true });\n  }\n\n  onAssessmentReset(state) {\n    const set = this.getSubsetByModelId(state.articleId);\n    if (!set) return;\n    set.reset({ removeViews: true });\n  }\n\n  async continue() {\n    if (!Adapt.parentView) return;\n\n    if (this.openPopupCount) {\n      this.shouldContinueOnPopupClose = true;\n      return;\n    }\n    await Adapt.parentView.addChildren();\n  }\n\n  onComplete(model, value) {\n    if (!value) return;\n    this.continueAfterBranchChild(model);\n    this.saveBranchQuestionAttemptHistory(model);\n  }\n\n  continueAfterBranchChild(model) {\n    this.checkIfIsEffectivelyComplete(model);\n    if (!model.get('_isBranchChild') || !model.get('_isAvailable')) return;\n    _.defer(() => this.continue());\n  }\n\n  /**\n   * Check if, excluding _isTrackable: false elements, that the branching is\n   * effectively complete and set completion criteria accordingly.\n   * @param {Backbone.model} model\n   */\n  checkIfIsEffectivelyComplete(model) {\n    const childModel = model.getParent();\n    if (!childModel) return;\n    const isBranchChild = childModel.get('_isBranchChild');\n    if (!isBranchChild) return;\n    const containerModel = childModel.getParent();\n    const set = this.getSubsetByModelId(containerModel.get('_id'));\n    if (!set?.isEffectivelyComplete) return;\n    // Allow assessment to complete at the end, before the last trickle button is clicked\n    set.enableParentCompletion();\n  }\n\n  saveBranchQuestionAttemptHistory(model) {\n    if (!(model instanceof ComponentModel)) return;\n    const branchOriginModelId = model.get('_branchOriginalModelId');\n    if (!branchOriginModelId) return;\n    const originModel = data.findById(branchOriginModelId);\n    originModel.addAttemptObject(model.getAttemptObject());\n    offlineStorage.save();\n  }\n\n}\n\nexport default (Adapt.branching = new Branching());\n","import Adapt from 'core/js/adapt';\n\nclass Completion extends Backbone.Controller {\n\n  initialize() {\n    this.subProgressCompleted = 0;\n    this.subProgressTotal = 0;\n    this.nonAssessmentCompleted = 0;\n    this.nonAssessmentTotal = 0;\n    this.assessmentCompleted = 0;\n    this.assessmentTotal = 0;\n  }\n\n  // Calculate completion of a contentObject\n  calculateCompletion(contentObjectModel) {\n\n    const completion = Adapt.completion;\n\n    const viewType = contentObjectModel.get('_type');\n    const isComplete = contentObjectModel.get('_isComplete') ? 1 : 0;\n    let children;\n\n    switch (viewType) {\n      case 'page': {\n        // If it's a page\n        children = contentObjectModel.getAllDescendantModels().filter(model => {\n          return model.get('_isAvailable') && !model.get('_isOptional');\n        });\n\n        const availableChildren = this.filterAvailableChildren(children);\n        const components = this.getPageLevelProgressEnabledModels(availableChildren);\n        const nonAssessmentComponents = this.getNonAssessmentComponents(components);\n\n        completion.nonAssessmentTotal = nonAssessmentComponents.length;\n        completion.nonAssessmentCompleted = this.getComponentsCompleted(nonAssessmentComponents).length;\n\n        const assessmentComponents = this.getAssessmentComponents(components);\n\n        completion.assessmentTotal = assessmentComponents.length;\n        completion.assessmentCompleted = this.getComponentsInteractionCompleted(assessmentComponents).length;\n\n        if (contentObjectModel.get('_pageLevelProgress')._excludeAssessments !== true) {\n          completion.subProgressCompleted = contentObjectModel.get('_subProgressComplete') || 0;\n          completion.subProgressTotal = contentObjectModel.get('_subProgressTotal') || 0;\n        }\n\n        const showPageCompletionCourse = Adapt.course.get('_pageLevelProgress')?._showPageCompletion !== false;\n        const showPageCompletionPage = contentObjectModel.get('_pageLevelProgress')?._showPageCompletion !== false;\n\n        if (showPageCompletionCourse && showPageCompletionPage) {\n          // optionally add one point extra for page completion to eliminate incomplete pages and full progress bars\n          // if _showPageCompletion is true then the progress bar should also consider it so add 1 to nonAssessmentTotal\n          completion.nonAssessmentCompleted += isComplete;\n          completion.nonAssessmentTotal += 1;\n        }\n\n        break;\n      }\n      case 'menu': case 'course': {\n        // If it's a sub-menu\n        children = contentObjectModel.getChildren().models;\n        children.forEach(contentObject => {\n          const completionObject = Adapt.completion.calculateCompletion(contentObject);\n          completion.subProgressCompleted += completionObject.subProgressCompleted || 0;\n          completion.subProgressTotal += completionObject.subProgressTotal || 0;\n          completion.nonAssessmentTotal += completionObject.nonAssessmentTotal;\n          completion.nonAssessmentCompleted += completionObject.nonAssessmentCompleted;\n          completion.assessmentTotal += completionObject.assessmentTotal;\n          completion.assessmentCompleted += completionObject.assessmentCompleted;\n        });\n        break;\n      }\n\n    }\n\n    return completion;\n  }\n\n  getNonAssessmentComponents(models) {\n    return models.filter(model => {\n      return !model.get('_isPartOfAssessment');\n    });\n  }\n\n  getAssessmentComponents(models) {\n    return models.filter(model => {\n      return model.get('_isPartOfAssessment');\n    });\n  }\n\n  getComponentsCompleted(models) {\n    return models.filter(item => {\n      return item.get('_isComplete');\n    });\n  }\n\n  getComponentsInteractionCompleted(models) {\n    return models.filter(item => {\n      return item.get('_isComplete');\n    });\n  }\n\n  // Get only those models who were enabled for pageLevelProgress\n  getPageLevelProgressEnabledModels(models) {\n    return models.filter(model => {\n      const config = model.get('_pageLevelProgress');\n      return config?._isEnabled;\n    });\n  }\n\n  unavailableInHierarchy(parents) {\n    if (!parents) return;\n    return parents.some(parent => {\n      return !parent.get('_isAvailable');\n    });\n  }\n\n  filterAvailableChildren(children) {\n    const availableChildren = [];\n\n    for (let i = 0, count = children.length; i < count; i++) {\n      const parents = children[i].getAncestorModels();\n      if (this.unavailableInHierarchy(parents)) continue;\n      availableChildren.push(children[i]);\n    }\n\n    return availableChildren;\n  }\n\n  calculatePercentageComplete(model) {\n    const completionObject = this.calculateCompletion(model);\n    // take all assessment, nonassessment and subprogress into percentage\n    // this allows the user to see if assessments have been passed, if assessment components can be retaken, and all other component's completion\n    const completed = completionObject.nonAssessmentCompleted + completionObject.assessmentCompleted + completionObject.subProgressCompleted;\n    const total = completionObject.nonAssessmentTotal + completionObject.assessmentTotal + completionObject.subProgressTotal;\n    const percentageComplete = Math.floor((completed / total) * 100);\n    return percentageComplete;\n  }\n\n}\n\nexport default (Adapt.completion = new Completion());\n","import Adapt from 'core/js/adapt';\n\nclass PageLevelProgressIndicatorView extends Backbone.View {\n\n  tagName() {\n    return 'span';\n  }\n\n  initialize(options) {\n    options = options || {};\n    this.parent = options.parent;\n    this.calculatePercentage = options.calculatePercentage || this.calculatePercentage;\n    this.ariaLabel = options.ariaLabel || '';\n    this.type = options.type || this.model.get('_type');\n    this.addClasses();\n    this.setUpEventListeners();\n    this.setPercentageComplete();\n    this.render();\n    this.refresh();\n  }\n\n  addClasses() {\n    this.$el.addClass([\n      'pagelevelprogress__indicator',\n      'is-' + this.type\n    ].join(' '));\n  }\n\n  checkAria() {\n    if (!this.ariaLabel) {\n      this.$el.attr('aria-hidden', true);\n      return;\n    }\n    const data = this.getRenderData();\n    this.$('.js-indicator-aria-label').html(Handlebars.compile(this.ariaLabel)(data));\n  }\n\n  setUpEventListeners() {\n    if (this.parent) {\n      this.listenToOnce(this.parent, 'postRemove', this.remove);\n    } else {\n      this.listenTo(Adapt, 'remove', this.remove);\n    }\n    this.listenTo(this.model, 'change:_isComplete', this.refresh);\n    if (!this.collection) return;\n    this.listenTo(this.collection, 'change:_isComplete', this.refresh);\n  }\n\n  setPercentageComplete() {\n    const percentage = this.calculatePercentage();\n    this.model.set('percentageComplete', percentage);\n    return percentage;\n  }\n\n  calculatePercentage() {\n    return this.model.get('_isComplete') ? 100 : 0;\n  }\n\n  render() {\n    const data = this.getRenderData();\n    const template = Handlebars.templates[this.constructor.template];\n    this.$el.html(template(data));\n  }\n\n  getRenderData() {\n    const data = this.model.toJSON();\n    data.ariaLabel = this.ariaLabel;\n    data.type = this.type;\n    return data;\n  }\n\n  refresh() {\n    this.checkCompletion();\n    this.checkAria();\n    this.$('.js-indicator-bar').css({\n      width: this.calculatePercentage() + '%'\n    });\n  }\n\n  checkCompletion() {\n    const percentage = this.setPercentageComplete();\n    this.$el\n      .toggleClass('is-complete', percentage === 100)\n      .toggleClass('is-incomplete', percentage !== 100);\n  }\n\n}\n\nPageLevelProgressIndicatorView.template = 'pageLevelProgressIndicator';\n\nexport default PageLevelProgressIndicatorView;\n","import Adapt from 'core/js/adapt';\nimport PageLevelProgressIndicatorView from './PageLevelProgressIndicatorView';\n\nclass PageLevelProgressItemView extends Backbone.View {\n\n  className() {\n    return [\n      'pagelevelprogress__item drawer__item',\n      this.model.get('_type') + '__indicator'\n    ].join(' ');\n  }\n\n  attributes() {\n    return {\n      role: 'listitem'\n    };\n  }\n\n  initialize() {\n    this.listenTo(Adapt, 'remove', this.remove);\n    this.render();\n    this.addIndicator();\n  }\n\n  render() {\n    const data = this.model.toJSON();\n    const template = Handlebars.templates[this.constructor.template];\n    this.$el.html(template(data));\n  }\n\n  addIndicator() {\n    if (this.model.get('_isOptional')) return;\n    const item = new PageLevelProgressIndicatorView({\n      model: this.model\n    });\n    this.$('.js-indicator').append(item.$el);\n  }\n\n}\n\nPageLevelProgressItemView.template = 'pageLevelProgressItem';\n\nexport default PageLevelProgressItemView;\n","import Adapt from 'core/js/adapt';\nimport data from 'core/js/data';\nimport router from 'core/js/router';\nimport PageLevelProgressItemView from './PageLevelProgressItemView';\n\nexport default class PageLevelProgressView extends Backbone.View {\n\n  className() {\n    return 'pagelevelprogress';\n  }\n\n  events() {\n    return {\n      'click .js-pagelevelprogress-item-click': 'scrollToPageElement'\n    };\n  }\n\n  initialize() {\n    this.listenTo(Adapt, 'remove', this.remove);\n    this.render();\n    this.addChildren();\n  }\n\n  async scrollToPageElement(event) {\n    if (event && event.preventDefault) event.preventDefault();\n\n    const $target = $(event.currentTarget);\n    if ($target.is('.is-disabled')) return;\n\n    const id = $target.attr('data-pagelevelprogress-id');\n    const model = data.findById(id);\n\n    if (!model.get('_isRendered')) {\n      try {\n        await Adapt.parentView.renderTo(id);\n      } catch (err) {\n        return;\n      }\n    }\n\n    const currentComponentSelector = `.${id}`;\n\n    Adapt.once('drawer:closed', () => {\n      router.navigateToElement(currentComponentSelector, { duration: 400 });\n    }).trigger('drawer:closeDrawer', $(currentComponentSelector));\n  }\n\n  render() {\n    const template = Handlebars.templates.pageLevelProgress;\n    this.$el.html(template({}));\n  }\n\n  addChildren() {\n    const $children = this.$('.js-children');\n    this.collection.each(model => {\n      $children.append(new PageLevelProgressItemView({\n        model\n      }).$el);\n    });\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport drawer from 'core/js/drawer';\nimport completionCalculations from './completionCalculations';\nimport PageLevelProgressView from './PageLevelProgressView';\nimport PageLevelProgressIndicatorView from './PageLevelProgressIndicatorView';\n\nexport default class PageLevelProgressNavigationView extends Backbone.View {\n\n  tagName() {\n    return 'button';\n  }\n\n  className() {\n    return 'btn-icon nav__btn nav__pagelevelprogress-btn pagelevelprogress__nav-btn';\n  }\n\n  attributes() {\n    return {\n      'data-order': (Adapt.course.get('_globals')?._extensions?._pageLevelProgress?._navOrder || 0)\n    };\n  }\n\n  events() {\n    return {\n      click: 'onProgressClicked'\n    };\n  }\n\n  initialize() {\n    _.bindAll(this, 'updateProgressBar');\n    this.setUpEventListeners();\n    this.render();\n    this.addIndicator();\n    this.deferredUpdate();\n  }\n\n  setUpEventListeners() {\n    this.listenTo(Adapt, {\n      remove: this.remove,\n      'router:location': this.updateProgressBar,\n      'view:childAdded pageLevelProgress:update': this.refreshProgressBar\n    });\n  }\n\n  render() {\n    const template = Handlebars.templates.pageLevelProgressNavigation;\n    this.$el.html(template({}));\n  }\n\n  addIndicator() {\n    this.indicatorView = new PageLevelProgressIndicatorView({\n      model: this.model,\n      collection: this.collection,\n      calculatePercentage: this._getPageCompletionPercentage,\n      ariaLabel: Adapt.course.get('_globals')._extensions._pageLevelProgress.pageLevelProgressIndicatorBar\n    });\n    this.$el.prepend(this.indicatorView.$el);\n  }\n\n  _getPageCompletionPercentage() {\n    return completionCalculations.calculatePercentageComplete(this.model);\n  }\n\n  deferredUpdate() {\n    _.defer(this.updateProgressBar);\n  }\n\n  updateProgressBar() {\n    this.indicatorView.refresh();\n  }\n\n  refreshProgressBar() {\n    this.collection.repopulate();\n    this.updateProgressBar();\n  }\n\n  onProgressClicked(event) {\n    if (event && event.preventDefault) event.preventDefault();\n    drawer.triggerCustomView(new PageLevelProgressView({\n      collection: this.collection\n    }).$el, false);\n  }\n\n  remove() {\n    super.remove();\n    this.collection.reset();\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport completionCalculations from './completionCalculations';\n\nexport default class PageLevelProgressCollection extends Backbone.Collection {\n\n  initialize(models, options) {\n    this.listenTo(Adapt, 'remove', this.reset);\n    if (!options?.pageModel) return;\n    this._pageModel = options.pageModel;\n    this.repopulate();\n  }\n\n  repopulate() {\n    this.reset();\n    if (!this._pageModel) return;\n\n    const allDescendants = this._pageModel.getAllDescendantModels(true);\n    const currentPageItems = allDescendants.filter(item => {\n      return item.get('_isAvailable') === true;\n    });\n    const availableItems = completionCalculations.filterAvailableChildren(currentPageItems);\n    const enabledProgressItems = completionCalculations.getPageLevelProgressEnabledModels(availableItems);\n\n    this.add(enabledProgressItems);\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport data from 'core/js/data';\nimport location from 'core/js/location';\nimport completionCalculations from './completionCalculations';\nimport PageLevelProgressNavigationView from './PageLevelProgressNavigationView';\nimport PageLevelProgressIndicatorView from './PageLevelProgressIndicatorView';\nimport PageLevelProgressCollection from './PageLevelProgressCollection';\n\nclass PageLevelProgress extends Backbone.Controller {\n\n  initialize() {\n    this.listenTo(Adapt, {\n      'app:dataReady': this.onDataReady,\n      'app:languageChanged': this.onLanguageChange\n    });\n  }\n\n  getCourseConfig() {\n    return Adapt.course.get('_pageLevelProgress');\n  }\n\n  onDataReady() {\n    // Do not proceed if pageLevelProgress is not enabled in course.json\n    const coursePLPConfig = this.getCourseConfig();\n    if (!coursePLPConfig?._isEnabled) return;\n    this.setUpEventListeners();\n  }\n\n  onLanguageChange() {\n    this.stopListening();\n    this.initialize();\n  }\n\n  setUpEventListeners() {\n    const headerIndicatorTypes = [\n      'menu',\n      'menuItem',\n      'page',\n      'article',\n      'block',\n      'component'\n    ];\n\n    const headerIndicatorEventNames = headerIndicatorTypes\n      .concat([''])\n      .join('View:render ');\n\n    this.listenTo(Adapt, headerIndicatorEventNames, this.renderHeaderIndicatorView);\n\n    this.listenTo(Adapt, {\n      'menuItemView:postRender': this.renderMenuItemIndicatorView,\n      'router:page': this.renderNavigationView\n    });\n\n    this.listenTo(Adapt.course, 'bubble:change:_isComplete', this.onCompletionChange);\n  }\n\n  onCompletionChange(event) {\n    if (!location._currentId) return;\n\n    const currentModel = data.findById(location._currentId);\n    const completionState = {\n      currentLocation: completionCalculations.calculatePercentageComplete(currentModel),\n      course: completionCalculations.calculatePercentageComplete(Adapt.course)\n    };\n    const hasChanged = !_.isMatch(this._previousCompletionState, completionState);\n    if (!hasChanged) return;\n\n    this._previousCompletionState = completionState;\n    Adapt.trigger('pageLevelProgress:percentageCompleteChange', completionState);\n  }\n\n  renderHeaderIndicatorView(view) {\n    const model = view.model;\n    const config = model.get('_pageLevelProgress');\n    if (!config?._isEnabled || !config?._isCompletionIndicatorEnabled) return;\n\n    const pageModel = model.findAncestor('contentobject');\n    const pageConfig = pageModel && pageModel.get('_pageLevelProgress');\n    if (!pageConfig?._isEnabled) return;\n\n    const $headings = view.$('.js-heading');\n    $headings.each((index, el) => {\n      const $el = $(el);\n      const indicatorView = new PageLevelProgressIndicatorView({\n        parent: view,\n        model\n      });\n      indicatorView.$el.insertAfter($el);\n    });\n  }\n\n  // This should add/update progress on menuView\n  renderMenuItemIndicatorView(view) {\n    // Do not render on menu, only render on menu items\n    if (view.model.get('_id') === location._currentId) return;\n\n    // Progress bar should not render for course viewType\n    const viewType = view.model.get('_type');\n    if (viewType === 'course') return;\n\n    // Do not proceed if pageLevelProgress is not enabled for the content object\n    const pageLevelProgress = view.model.get('_pageLevelProgress');\n    if (!pageLevelProgress?._isEnabled) return;\n\n    view.$el.find('.js-menu-item-progress').append(new PageLevelProgressIndicatorView({\n      parent: view,\n      model: view.model,\n      type: 'menu-item',\n      calculatePercentage: this._getMenuItemCompletionPercentage.bind(view),\n      ariaLabel: Adapt.course.get('_globals')._extensions._pageLevelProgress.pageLevelProgressMenuBar\n    }).$el);\n  }\n\n  _getMenuItemCompletionPercentage() {\n    return completionCalculations.calculatePercentageComplete(this.model);\n  }\n\n  // This should add/update progress on page navigation bar\n  renderNavigationView(pageModel) {\n    // Do not render if turned off at course level\n    const coursePLPConfig = this.getCourseConfig();\n    if (coursePLPConfig?._isShownInNavigationBar === false) return;\n\n    // Do not proceed if pageLevelProgress is not enabled for the content object\n    const pagePLPConfig = pageModel.get('_pageLevelProgress');\n    if (!pagePLPConfig?._isEnabled) return;\n\n    const collection = new PageLevelProgressCollection(null, {\n      pageModel\n    });\n\n    if (collection.length === 0) return;\n\n    $('.nav__drawer-btn').after(new PageLevelProgressNavigationView({\n      model: pageModel,\n      collection\n    }).$el);\n  }\n\n}\n\nexport default (Adapt.pageLevelProgress = new PageLevelProgress());\n","import Adapt from 'core/js/adapt';\nimport components from 'core/js/components';\nimport data from 'core/js/data';\nimport logging from 'core/js/logging';\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\nimport CourseModel from 'core/js/models/courseModel';\n\n/**\n * Utility function for applying deep defaults\n * @param {Object} original\n * @param  {...Object} defaultObjects\n * @returns {Object} Returns original\n */\nexport function _deepDefaults(original, ...defaultObjects) {\n  defaultObjects.reverse();\n  defaultObjects.forEach(defaults => {\n    const keyValuePairs = Object.entries(defaults);\n    keyValuePairs.forEach(([ key, defaultValue ]) => {\n      const isRecursiveObject = (typeof defaultValue === 'object' && !Array.isArray(defaultValue) && defaultValue !== null);\n      if (isRecursiveObject) {\n        original[key] = _deepDefaults(original[key] || {}, defaultValue);\n        return;\n      }\n      const isValueAlreadySet = Object.prototype.hasOwnProperty.call(original, key);\n      if (isValueAlreadySet) return;\n      original[key] = defaultValue;\n    });\n  });\n  return original;\n}\n\nexport const configDefaults = {\n  _isEnabled: false,\n  _isInherited: false,\n  _autoScroll: true,\n  _scrollTo: '@block +1',\n  _onChildren: false,\n  _button: {\n    _isEnabled: true,\n    _isFullWidth: true,\n    _autoHide: false,\n    _hasIcon: false,\n    _styleBeforeCompletion: 'hidden',\n    _styleAfterClick: 'hidden',\n    _component: 'trickle-button',\n    _className: '',\n    text: 'Continue',\n    ariaLabel: '',\n    startText: '',\n    startAriaLabel: '',\n    finalText: '',\n    finalAriaLabel: ''\n  },\n  _stepLocking: {\n    _isEnabled: true,\n    _isCompletionRequired: true,\n    _isLockedOnRevisit: false\n  }\n};\n\n/**\n * @param {Backbone.Model} model\n * @returns {Boolean}\n */\nexport function isModelArticleWithOnChildren(model) {\n  const type = model.get('_type');\n  const trickleConfig = model.get('_trickle');\n  return (type === 'article' && trickleConfig?._onChildren !== false);\n}\n\n/**\n * @param {Backbone.Model} model\n * @returns {Boolean}\n */\nexport function isModelBlockWithArticleNotChildren(model) {\n  const type = model.get('_type');\n  const parentTrickleConfig = model.getParent()?.get('_trickle');\n  return (type === 'block' && parentTrickleConfig?._isEnabled === true && parentTrickleConfig?._onChildren === false);\n}\n\n/**\n * Get the default trickle configuration for the given model\n * @param {Backbone.Model} model\n */\nexport function getModelConfigDefaults(model) {\n  const type = model.get('_type');\n  const config = {};\n  // Setup default legacy article behaviour, onChildren === isArticle if omitted\n  _deepDefaults(config, configDefaults, {\n    _onChildren: (type === 'article')\n  });\n  // Default startText and finalText when _onChildren: true\n  if (config._onChildren) {\n    config._button.startText = config._button.startText ?? 'Begin';\n    config._button.startAriaLabel = config._button.startAriaLabel ?? '';\n    config._button.finalText = config._button.finalText ?? 'Finish';\n    config._button.finalAriaLabel = config._button.finalAriaLabel ?? '';\n  }\n  // Force step locking for _isFullWidth buttons\n  if (config._button._isFullWidth) {\n    config._stepLocking._isEnabled = true;\n  }\n  return config;\n}\n\n/**\n * Returns an array of models from which to derive a trickle config or null\n * @param {Backbone.Model} configModel\n * @returns {[Backbone.Model]|null}\n */\nexport function getModelInheritanceChain(configModel) {\n  if (!data.isReady) throw new Error('Trickle cannot resolve inheritance chains until data is ready');\n  const type = configModel.get('_type');\n  if (type === 'block') {\n    const parentModel = configModel.getParent();\n    const parentConfig = parentModel.get('_trickle');\n    const blockConfig = configModel.get('_trickle');\n    const isParentEnabledNotOnChildren = (parentConfig?._isEnabled && parentConfig._onChildren === false);\n    const isNoChildConfig = (!blockConfig?._isEnabled);\n    if (isParentEnabledNotOnChildren && isNoChildConfig) {\n      return null;\n    }\n    return [ configModel, parentModel ].filter(ancestor => {\n      const config = ancestor.get('_trickle');\n      // Remove models with no config and models which explicitly require inheritance\n      return (config && !config._isInherited);\n    });\n  }\n  if (type === 'article') {\n    return [ configModel ];\n  }\n  return null;\n};\n\n/**\n * Returns the derived trickle configuration for the given model\n * @param {Backbone.Model} model\n * @returns {Object}\n */\nexport function getModelConfig(model) {\n  const inheritance = getModelInheritanceChain(model);\n  if (!inheritance?.length || isModelArticleWithOnChildren(model) || isModelBlockWithArticleNotChildren(model)) return null;\n  const config = $.extend(true, {}, ...inheritance.reverse().map((inheritModel, index, arr) => {\n    const isLast = (index === arr.length - 1);\n    const defaults = isLast ? getModelConfigDefaults(inheritModel) : null;\n    return $.extend(true, {}, defaults, inheritModel.get('_trickle'));\n  }));\n  if (!config._isEnabled) return null;\n  return config;\n}\n\n/**\n * Returns the first model in the inheritance chain with _onChildren: true\n * @param {Backbone.Model} model\n * @returns {Backbone.Model}\n */\nexport function getModelContainer(model) {\n  const inheritance = getModelInheritanceChain(model);\n  return inheritance?.find(inheritModel => {\n    const defaults = getModelConfigDefaults(inheritModel);\n    const config = $.extend(true, {}, defaults, inheritModel.get('_trickle'));\n    return config._onChildren;\n  });\n}\n\n/**\n * Fetch the defined or default completion attribute on which trickle should\n * listen for completion\n * @return {string}\n */\nexport function getCompletionAttribute(model = null) {\n  return getModelConfig(model)?._completionAttribute || Adapt.config.get('_trickle')?._completionAttribute || '_isComplete';\n}\n\n/**\n * Reapply trickle locks if the completion attribute has changed on the given model\n * @param {Backbone.Model} model\n */\nexport function checkApplyLocks(model) {\n  if (!data.isReady) return;\n  const completionAttribute = getCompletionAttribute(model);\n  const hasCompletionChanged = Object.prototype.hasOwnProperty.call(model.changed, completionAttribute);\n  const hasAvailabilityChanged = Object.prototype.hasOwnProperty.call(model.changed, '_isAvailable');\n  if (!hasCompletionChanged && !hasAvailabilityChanged) return;\n  // Apply the locks lazily\n  debouncedApplyLocks();\n}\n\n/**\n * Calculates and applies the new locking state for each sub-page model according\n * to each trickle configuration\n */\nexport function applyLocks() {\n  if (!data.isReady) return;\n  const locks = {};\n  const modelsById = {};\n  // Fetch the component model from the store incase it needs overriding by another extension\n  const TrickleButtonModel = components.getModelClass('trickle-button');\n  // Check all models for trickle potential\n  Adapt.course.getAllDescendantModels(true).filter(model => model.get('_isAvailable')).forEach(siteModel => {\n    const trickleConfig = getModelConfig(siteModel);\n    if (!isEnabled(siteModel, { trickleConfig })) return;\n    const isModelLocked = isLocked(siteModel, { trickleConfig });\n    const id = siteModel.get('_id');\n    modelsById[id] = siteModel;\n    locks[id] = locks[id] || false;\n    // Apply lock to all subsequent models\n    const subsequentLockingModels = _getAncestorNextSiblings(siteModel);\n    subsequentLockingModels.forEach((model, index) => {\n      const id = model.get('_id');\n      const isButtonModel = (model instanceof TrickleButtonModel);\n      // Do not stop at TrickleButtonModels\n      model.set('_isTrickled', !isButtonModel);\n      // Store the new locking state of each model in the locks variable\n      // Don't unlock anything that was locked in a previous group\n      modelsById[id] = model;\n      locks[id] = locks[id] || isModelLocked;\n      // Don't modify the children if they are managed by another locking mechanism\n      if (model.get('_lockType')) return;\n      // Cascade inherited locks through the hierarchyd\n      model.getAllDescendantModels().forEach(descendant => {\n        const descendantId = descendant.get('_id');\n        modelsById[descendantId] = descendant;\n        locks[descendantId] = locks[id];\n      });\n    });\n  });\n  // Apply only changed locking states\n  Object.entries(locks).forEach(([ id, isModelLocked ]) => {\n    const model = modelsById[id];\n    const wasLocked = model.get('_isLocked');\n    if (wasLocked === isModelLocked) return;\n    model.set('_isLocked', isModelLocked);\n  });\n  logTrickleState();\n}\n\nexport function isEnabled(model, { trickleConfig = getModelConfig(model) } = {}) {\n  return (trickleConfig?._isEnabled === true);\n}\n\nexport function isLocked(model, { trickleConfig = getModelConfig(model) } = {}) {\n  const isStepLocked = Boolean(trickleConfig?._stepLocking?._isEnabled);\n  if (!isStepLocked) return false;\n  const isCompletionRequired = Boolean(trickleConfig?._stepLocking?._isCompletionRequired);\n  const completionAttribute = getCompletionAttribute(model);\n  if (!isCompletionRequired) {\n    const TrickleModel = components.getModelClass('trickle-button');\n    const trickleButton = model.getAvailableChildModels().find(model => model instanceof TrickleModel);\n    const isTrickleButtonComplete = Boolean(trickleButton?.get(completionAttribute));\n    return !isTrickleButtonComplete;\n  }\n  const isModelLocked = !model?.get(completionAttribute) &&\n    !model?.get('_isOptional');\n  return isModelLocked;\n}\n\nexport const debouncedApplyLocks = _.debounce(applyLocks, 1);\n\n/**\n * Returns all of the contentobject descendant models directly subsequent to the\n * given model through each ancestor\n * If fromModel is a block; its block next siblings and article next siblings\n * @param {Backbone.Model} child\n * @returns {Array<Backbone.Model>}\n */\nexport function _getAncestorNextSiblings(fromModel) {\n  if (!fromModel) return [];\n  // Fetch all subsequent siblings\n  const allSiblings = fromModel.getParent().getAvailableChildModels();\n  const subsequentSiblings = allSiblings.slice(allSiblings.findIndex(sibling => sibling === fromModel) + 1);\n  // Fetch all ancestors between the page and the child\n  const allAncestors = fromModel.getAncestorModels();\n  const inPageAncestors = allAncestors.slice(0, allAncestors.findIndex(parent => parent instanceof ContentObjectModel) + 1);\n  // Move from the next ancestor down as we already have the parent's children (fromModel siblings)\n  // Collect all subsequent in-page ancestor siblings\n  const subsequentInPageAncestors = [];\n  inPageAncestors.slice(1).forEach((grandParent, previousIndex) => {\n    const parent = inPageAncestors[previousIndex];\n    const allGrandParentChildren = grandParent.getAvailableChildModels();\n    const subsequentAncestorSiblings = allGrandParentChildren.slice(allGrandParentChildren.findIndex(child => child === parent) + 1);\n    subsequentInPageAncestors.push(...subsequentAncestorSiblings);\n  });\n  // Combine and return entire set\n  const subsequentContentObjectDescendantModels = subsequentSiblings.concat(subsequentInPageAncestors);\n  return subsequentContentObjectDescendantModels;\n}\n\n/**\n * Adds trickle button components in their relevant places throughout the course\n */\nexport function addButtonComponents() {\n  // Fetch the component model from the store incase it needs overriding by another extension\n  const TrickleButtonModel = components.getModelClass('trickle-button');\n  let uid = 0;\n  data.forEach(buttonModelSite => {\n    if (buttonModelSite instanceof CourseModel) return;\n    const trickleConfig = getModelConfig(buttonModelSite);\n    if (!trickleConfig || !trickleConfig?._isEnabled || buttonModelSite.get('_isTrickleSiteConfigured')) return;\n    buttonModelSite.set('_isTrickleSiteConfigured', true);\n    const parentId = buttonModelSite.get('_id');\n    const trickleButtonModel = new TrickleButtonModel({\n      _id: `trickle-${uid++}`,\n      _type: 'component',\n      _component: 'trickle-button',\n      _parentId: parentId,\n      _isAvailable: true,\n      _layout: 'full',\n      _trickle: { _isEnabled: true },\n      _renderPosition: 'outer-append',\n      _isTrackable: false\n    });\n    trickleButtonModel.setupModel();\n    // This line would usually append a trickle button to an article or block\n    buttonModelSite.getChildren().add(trickleButtonModel);\n  });\n}\n\n/**\n * Pretty print locking state for current page\n */\nexport function logTrickleState() {\n  if (logging._config?._level !== 'debug') return;\n  if (!Adapt.parentView?.model?.isTypeGroup('page')) {\n    logging.debug('TRICKLE GLOBAL STATE');\n    Adapt.course.getAllDescendantModels(true).filter(model => model.get('_isAvailable')).forEach(model => {\n      const isLocked = model.get('_isLocked');\n      const isTrickled = model.get('_isTrickled');\n      logging.debug(`${' '.repeat(model.getAncestorModels().length)}${model.get('_type')} ${model.get('_id')} isLocked: ${isLocked} isTrickled: ${isTrickled}`);\n    });\n    return;\n  }\n  logging.debug('TRICKLE STATE');\n  Adapt.parentView.model.getAllDescendantModels(true).filter(model => model.get('_isAvailable')).forEach(model => {\n    const isLocked = model.get('_isLocked');\n    const isTrickled = model.get('_isTrickled');\n    logging.debug(`${' '.repeat(model.getAncestorModels().length)}${model.get('_type')} ${model.get('_id')} isLocked: ${isLocked} isTrickled: ${isTrickled}`);\n  });\n}\n\n/**\n * Utility functions for trickle model operations\n */\nexport default {\n  _deepDefaults,\n  configDefaults,\n  getModelConfigDefaults,\n  getModelInheritanceChain,\n  getModelConfig,\n  getModelContainer,\n  getCompletionAttribute,\n  checkApplyLocks,\n  applyLocks,\n  debouncedApplyLocks,\n  _getAncestorNextSiblings,\n  addButtonComponents,\n  logTrickleState\n};\n","import Adapt from 'core/js/adapt';\nimport wait from 'core/js/wait';\nimport components from 'core/js/components';\nimport data from 'core/js/data';\nimport a11y from 'core/js/a11y';\nimport {\n  checkApplyLocks,\n  addButtonComponents,\n  applyLocks,\n  debouncedApplyLocks,\n  getModelConfig,\n  isModelArticleWithOnChildren\n} from './models';\nimport router from 'core/js/router';\n\n/** @typedef {import('core/js/childEvent').default} ChildEvent  */\n\nclass TrickleController extends Backbone.Controller {\n\n  initialize() {\n    this.checkIsFinished = _.debounce(this.checkIsFinished, 1);\n\n    this.listenTo(data, {\n      ready: this.onDataReady\n    });\n  }\n\n   async onDataReady() {\n    const trickleConfig = Adapt.config.get('_trickle');\n    if (trickleConfig?._isEnabled === false) return;\n\n    this.setUpEventListeners();\n\n    wait.for(done => {\n      addButtonComponents();\n      applyLocks();\n      done();\n    });\n  }\n\n  setUpEventListeners() {\n    this.listenTo(data, {\n      // Check that the locking is accurate after any completion, this happens asynchronously\n      'change:_isInteractionComplete change:_isComplete change:_isAvailable add remove': checkApplyLocks,\n      // Check whether trickle is finished after any locking changes\n      'change:_isLocked': this.checkIsFinished\n    });\n\n    this.listenTo(Adapt, {\n      // Reapply locks after assessment reset, this happens asynchronously where possible\n      'assessments:reset': this.onAssessmentReset,\n      // Reset trickle's global state when changing content objects\n      'contentObjectView:preRender': this.reset,\n      // Stop rendering where necessary before a child is rendered\n      'view:addChild': this.onAddChildView,\n      // Temporarily remove trickle from the current content object\n      'trickle:kill': this.kill\n    });\n  }\n\n  onAssessmentReset() {\n    // If mid render then apply locks immediately\n    const isMidRender = !Adapt.parentView?.model.get('_isReady');\n    if (isMidRender) return applyLocks();\n    // Otherwise apply them lazily\n    debouncedApplyLocks();\n  }\n\n  /**\n   * Returns true if the current page is or was locked by trickle\n   */\n  get isStarted() {\n    return Boolean(Adapt.parentView?.model.get('_isTrickleStarted'));\n  }\n\n  set isStarted(value) {\n    if (!Adapt.parentView) return;\n    Adapt.parentView.model.set('_isTrickleStarted', value);\n    if (!value) return;\n    Adapt.trigger('trickle:started');\n  }\n\n  /**\n   * When each child view is added to its parent, check to see if trickle should\n   * stop the render at this child according to the locking state\n   * @param {ChildEvent} event\n   */\n  onAddChildView(event) {\n    if (this.isKilled) return;\n    if (event.hasRequestChild) applyLocks();\n    const isManagedByTrickleAndLocked = (event.model.get('_isTrickled') && event.model.get('_isLocked'));\n    if (!isManagedByTrickleAndLocked) return;\n    event.stop();\n  }\n\n  /**\n   * Returns true if the current page is locked by trickle\n   */\n  get isTrickling() {\n    const isTrickling = Adapt.parentView.model.getAllDescendantModels().some(model => {\n      return model.get('_isAvailable') && model.get('_isTrickled') && model.get('_isLocked');\n    });\n    return isTrickling;\n  }\n\n  /**\n   * Make the framework try to render the next set of children\n   */\n  async continue() {\n    applyLocks();\n    await Adapt.parentView.addChildren();\n    await Adapt.parentView.whenReady();\n  }\n\n  /**\n   * Scroll to the next section as defined by the trickle configuration on the\n   * specified model\n   * @param {Backbone.Model} fromModel\n   */\n  async scroll(fromModel) {\n    const trickleConfig = getModelConfig(fromModel);\n    if (!trickleConfig?._isEnabled) return false;\n\n    if (isModelArticleWithOnChildren(fromModel)) return false;\n\n    const isAutoScrollOff = !trickleConfig._autoScroll;\n    const hasTrickleButton = trickleConfig._button._isEnabled;\n    if (isAutoScrollOff && !hasTrickleButton) {\n      return;\n    }\n\n    const getScrollToId = () => {\n      const scrollTo = trickleConfig._scrollTo;\n      const firstCharacter = scrollTo.substr(0, 1);\n      switch (firstCharacter) {\n        case '@': {\n          // NAVIGATE BY RELATIVE TYPE\n          // Allows trickle to scroll to a sibling / cousin component\n          // relative to the current trickle item\n          const relativeModel = fromModel.findRelativeModel(scrollTo, {\n            filter: model => model.get('_isAvailable')\n          });\n          if (relativeModel === undefined) return;\n          return relativeModel.get('_id');\n        }\n        case '.':\n          // NAVIGATE BY CLASS\n          return scrollTo.substr(1, scrollTo.length - 1);\n        default:\n          return scrollTo;\n      }\n    };\n\n    let scrollToId = getScrollToId();\n    if (scrollToId === '') return;\n\n    const isDescendant = Adapt.parentView.model.getAllDescendantModels().some(model => {\n      return model.get('_id') === scrollToId;\n    });\n    if (!isDescendant) {\n      applyLocks();\n      // Navigate to another content object\n      const model = data.findById(scrollToId);\n      const contentObject = model.isTypeGroup('contentobject') ? model : model.findAncestor('contentobject');\n      await router.navigateToElement(contentObject.get('_id'));\n      // Recalculate the relative id after the page is ready as it may change\n      scrollToId = getScrollToId();\n      await router.navigateToElement(scrollToId);\n      return;\n    }\n\n    await Adapt.parentView.renderTo(scrollToId);\n\n    if (hasTrickleButton) {\n      // Only set focus if there is a trickle button - see https://github.com/adaptlearning/adapt_framework/issues/2813\n      a11y.focusFirst($('.' + scrollToId), { preventScroll: true });\n    }\n\n    if (isAutoScrollOff) return false;\n\n    const duration = trickleConfig._scrollDuration || 500;\n    router.navigateToElement('.' + scrollToId, { duration });\n  }\n\n  /**\n   * Returns true if the current page was locked by trickle and is now finished\n   */\n  get isFinished() {\n    if (!Adapt.parentView) return false;\n    return Boolean(!this.isStarted || Adapt.parentView.model.get('_isTrickleFinished') || this.isKilled);\n  }\n\n  set isFinished(value) {\n    if (!Adapt.parentView) return;\n    Adapt.parentView.model.set('_isTrickleFinished', value);\n    if (!value) return;\n    Adapt.trigger('trickle:finished');\n  }\n\n  checkIsFinished() {\n    if (!this.isStarted) return;\n    if (this.isKilled || this.isFinished) return;\n    if (this.isTrickling) return;\n    this.isFinished = true;\n  }\n\n  /**\n   * Turn off all trickle locking, continue rendering and set the page model state as killed\n   */\n  async kill() {\n    // Fetch the component model from the store incase it needs overriding by another extension\n    const TrickleModel = components.getModelClass('trickle-button');\n    this.isKilled = true;\n    Adapt.parentView.model.getAllDescendantModels().forEach(model => {\n      const isButtonModel = (model instanceof TrickleModel);\n      if (isButtonModel) {\n        model.setCompletionStatus();\n      }\n      if (!model.get('_isTrickled')) return;\n      model.set('_isLocked', false);\n    });\n    await this.continue();\n  }\n\n  /**\n   * Returns true if the current page was locked by trickle and is now killed\n   */\n  get isKilled() {\n    if (!Adapt.parentView) return false;\n    return !this.isStarted || Adapt.parentView.model.get('_isTrickleKilled');\n  }\n\n  set isKilled(value) {\n    if (!Adapt.parentView) return;\n    Adapt.parentView.model.set('_isTrickleKilled', value);\n    if (!value) return;\n    Adapt.trigger('trickle:killed');\n  }\n\n  /**\n   * Reset the page trickle state\n   */\n  reset() {\n    this.isKilled = false;\n    if (!this.isTrickling) {\n      this.isStarted = false;\n      this.isFinished = false;\n      return;\n    }\n    this.isStarted = true;\n    this.isFinished = false;\n  }\n\n}\n\nexport default new TrickleController();\n","import Adapt from 'core/js/adapt';\nimport a11y from 'core/js/a11y';\nimport ComponentView from 'core/js/views/componentView';\nimport controller from './controller';\nimport {\n  getModelConfig,\n  getCompletionAttribute\n} from './models';\n\n/** @typedef {import('core/js/modelEvent').default} ModelEvent  */\n\nclass TrickleButtonView extends ComponentView {\n\n  className() {\n    const config = getModelConfig(this.model.getParent());\n    return [\n      'trickle',\n      this.model.get('_id'),\n      config._button._component,\n      config._button._isFullWidth && 'is-full-width',\n      config._button._className\n    ].filter(Boolean).join(' ');\n  }\n\n  events() {\n    return {\n      'click .js-trickle-btn': 'onButtonClick'\n    };\n  }\n\n  initialize() {\n    this.openPopupCount = 0;\n    this.isAwaitingPopupClose = false;\n    this.wasButtonClicked = false;\n    this.model.calculateButtonText();\n    this.calculateButtonState();\n    this.setupEventListeners();\n    this.render();\n    if (!this.model.isEnabled()) {\n      this.setCompletionStatus();\n    }\n    _.defer(this.setReadyStatus.bind(this));\n  }\n\n  /**\n   * Taking account of open popups, recalculate the button visible and enabled states\n   */\n  calculateButtonState() {\n    const isDisabledByPopups = (this.openPopupCount > 0);\n    this.model.calculateButtonState(isDisabledByPopups, this.wasButtonClicked);\n  }\n\n  render() {\n    const data = this.model.toJSON();\n    data._globals = Adapt.course.get('_globals');\n    data._trickle = getModelConfig(this.model.getParent());\n    this.$el.html(Handlebars.templates[TrickleButtonView.template](data));\n  }\n\n  setupEventListeners() {\n    this.tryButtonAutoHide = this.tryButtonAutoHide.bind(this);\n    // Add async delay on each call to onParent complete\n    // to wait for autoscroll question feedback notify to appear\n    const onParentComplete = this.onParentComplete.bind(this);\n    this.onParentComplete = (...args) => _.delay(() => onParentComplete(...args), 100);\n    this.listenTo(Adapt.parentView, 'postRemove', this.onRemove);\n    this.listenTo(Adapt, 'trickle:killed', this.updateButtonState);\n    if (this.model.isStepUnlocked() && this.model.isFinished()) {\n      // Already complete, no need to listen to anything else\n      return;\n    }\n    this.$el.on('onscreen', this.tryButtonAutoHide);\n    this.listenTo(Adapt, {\n      'popup:opened': this.onPopupOpened,\n      'popup:closed': this.onPopupClosed\n    });\n    const parentModel = this.model.getParent();\n    const completionAttribute = getCompletionAttribute(parentModel);\n    this.listenTo(parentModel, {\n      'change:_requireCompletionOf': this.onStepUnlocked,\n      [`bubble:change:${completionAttribute}`]: this.onStepUnlocked,\n      [`change:${completionAttribute}`]: this.onParentComplete\n    });\n  }\n\n  /**\n   * Keep count of the number of open popups\n   */\n  onPopupOpened() {\n    this.openPopupCount++;\n    const shouldUserInteractWithButton = (this.model.isStepUnlocked() && !this.model.isFinished());\n    if (!shouldUserInteractWithButton) return;\n    this.updateButtonState();\n  }\n\n  /**\n   * Keep count of the number of open popups\n   */\n  async onPopupClosed() {\n    this.openPopupCount--;\n    if (this.openPopupCount) return;\n    if (this.isAwaitingPopupClose) {\n      // Had completed with an open popup, perform final part of finishing\n      return this.finish();\n    }\n    const shouldUserInteractWithButton = (this.model.isStepUnlocked() && !this.model.isFinished());\n    if (!shouldUserInteractWithButton) return;\n    this.updateButtonState();\n    await Adapt.parentView.addChildren();\n  }\n\n  /**\n   * Modify the DOM according to the current button states\n   */\n  updateButtonState() {\n    this.calculateButtonState();\n    const isButtonHidden = !(this.model.get('_isButtonVisible') && !this.model.get('_isButtonAutoHidden'));\n    this.$('.js-trickle-btn-container').toggleClass('u-display-none', isButtonHidden);\n    const isButtonDisabled = this.model.get('_isButtonDisabled');\n    const $button = this.$('.js-trickle-btn');\n    const $ariaLabel = this.$('.aria-label');\n    a11y.toggleEnabled($button, !isButtonDisabled);\n    if (!isButtonDisabled) {\n      // move focus forward if it's on the aria-label\n      if (document.activeElement instanceof HTMLElement && document.activeElement.isSameNode($ariaLabel[0])) {\n        a11y.focusNext($ariaLabel);\n      }\n      // make label unfocusable as it is no longer needed\n      a11y.toggleAccessibleEnabled($ariaLabel, false);\n    }\n    const $buttonText = this.$('.js-trickle-btn-text');\n    const text = this.model.get('buttonText');\n    const ariaLabel = this.model.get('buttonAriaLabel');\n    $buttonText.html(text);\n    $button.attr('aria-label', ariaLabel);\n  }\n\n  /**\n   * Update the button state when any completion changes occur in the trickle button\n   * parent or descendants\n   * @param {ModelEvent} event\n   */\n  async onStepUnlocked(event) {\n    if (event.value === false) return;\n    // Defer to allow for a feedback notify to open\n    _.defer(this.updateButtonState.bind(this));\n  }\n\n  async onButtonClick() {\n    const wasComplete = this.model.get('_isComplete');\n    // Assuming step locking completion is required, setting this model as complete\n    // will cause onParentComplete to fire\n    this.model.setCompletionStatus();\n    this.wasButtonClicked = true;\n    const isStepLockingCompletionRequired = this.model.isStepLockingCompletionRequired();\n    if (isStepLockingCompletionRequired && !wasComplete) return;\n    // Assuming step locking completion is NOT required, continue and scroll\n    await this.continue();\n  }\n\n  /**\n   * Fires when all children in the button parent are complete, including the button\n   */\n  async onParentComplete(model, value) {\n    if (!value) return;\n    const parentModel = this.model.getParent();\n    const completionAttribute = getCompletionAttribute(parentModel);\n    this.stopListening(parentModel, {\n      [`bubble:change:${completionAttribute}`]: this.onStepUnlocked,\n      [`change:${completionAttribute}`]: this.onParentComplete\n    });\n    if (controller.isKilled) return;\n    if (this.openPopupCount > 0) {\n      // Has completed with an open popup, defer finish until popup closed\n      this.isAwaitingPopupClose = true;\n      return;\n    }\n    await this.finish();\n  }\n\n  /**\n   * Stop listening, update the button and continue if required\n   */\n  async finish() {\n    this.stopListening(Adapt, {\n      'popup:opened': this.onPopupOpened,\n      'popup:closed': this.onPopupClosed\n    });\n    this.updateButtonState();\n    const isStepLockingCompletionRequired = this.model.isStepLockingCompletionRequired();\n    if (!isStepLockingCompletionRequired) return;\n    // Continue and scroll only if steplocking completion is required\n    await this.continue();\n  }\n\n  /**\n   * Causes Adapt to attempt to render more children and scroll to the next content\n   * element if required\n   */\n  async continue() {\n    const parent = this.model.getParent();\n    await controller.continue();\n    await controller.scroll(parent);\n  }\n\n  tryButtonAutoHide() {\n    if (!this.model.get('_isButtonVisible')) return;\n    const trickleConfig = getModelConfig(this.model.getParent());\n    if (!trickleConfig._button._autoHide) {\n      this.model.set('_isButtonAutoHidden', false);\n      return;\n    }\n    const measurements = this.$el.onscreen();\n    // This is to fix common miscalculation issues\n    const isJustOffscreen = (measurements.bottom > -100);\n    const isButtonAutoHidden = !measurements.onscreen && !isJustOffscreen;\n    this.model.set('_isButtonAutoHidden', isButtonAutoHidden);\n    this.updateButtonState();\n  }\n\n  onRemove() {\n    this.$el.off('onscreen', this.tryButtonAutoHide);\n    this.remove();\n  }\n\n}\n\nTrickleButtonView.template = 'trickle-button';\n\nexport default TrickleButtonView;\n","import controller from './controller';\nimport ComponentModel from 'core/js/models/componentModel';\nimport {\n  getModelContainer,\n  getModelConfig,\n  getCompletionAttribute,\n  applyLocks\n} from './models';\n\nexport default class TrickleButtonModel extends ComponentModel {\n\n  init() {\n    super.init();\n    if (!this.isStepComplete()) return;\n    this.setCompletionStatus();\n  }\n\n  /**\n   * @returns {boolean} true if the button is enabled in its trickle configuration\n   */\n  isEnabled() {\n    const trickleConfig = getModelConfig(this.getParent());\n    const isEnabled = trickleConfig._isEnabled && trickleConfig._button?._isEnabled;\n    return isEnabled;\n  }\n\n  /**\n   * @return {boolean} true if page truncation (step locking) is active\n   */\n  isStepLocking() {\n    const config = getModelConfig(this.getParent());\n    const isStepLocking = config._stepLocking?._isEnabled;\n    return isStepLocking;\n  }\n\n  /**\n   * @return {boolean} true if completion is required to unlock this step\n   */\n  isStepLockingCompletionRequired() {\n    const config = getModelConfig(this.getParent());\n    const isStepLockingCompletionRequired = config._stepLocking &&\n      config._stepLocking._isEnabled &&\n      config._stepLocking._isCompletionRequired;\n    return isStepLockingCompletionRequired;\n  }\n\n  /**\n   * @returns {boolean} true if all available siblings are complete, optional or not available\n   */\n  isStepUnlocked() {\n    const parentModel = this.getParent();\n    const completionAttribute = getCompletionAttribute(parentModel);\n    // Check if completion is blocked by another extension\n    const isCompletionBlocked = (parentModel.get('_requireCompletionOf') === Number.POSITIVE_INFINITY);\n    if (isCompletionBlocked) return;\n    return this.getSiblings().every(sibling => {\n      if (sibling === this) {\n        return true;\n      }\n      return sibling.get(completionAttribute) ||\n        sibling.get('_isOptional') ||\n        !sibling.get('_isAvailable');\n    });\n  }\n\n  /**\n   * @returns {boolean} true if the parent container is already complete\n   */\n  isStepComplete() {\n    const parentModel = this.getParent();\n    const completionAttribute = getCompletionAttribute(parentModel);\n    const isParentComplete = parentModel.get(completionAttribute);\n    return isParentComplete;\n  }\n\n  /**\n   * @returns {boolean} true if this button should always be locked on revisit\n   */\n  isStepLockedOnRevisit() {\n    const trickleConfig = getModelConfig(this.getParent());\n    return Boolean(trickleConfig._stepLocking._isLockedOnRevisit);\n  }\n\n  /**\n   * @return {boolean} true if completion is not required or if completion has been fulfilled\n   * and the button has been clicked\n   */\n  isFinished() {\n    const isStepUnlocked = this.isStepUnlocked();\n    const isStepLockingCompletionRequired = this.isStepLockingCompletionRequired();\n    const isButtonComplete = this.get('_isComplete');\n    const isFinished = ((isStepUnlocked || !isStepLockingCompletionRequired) && isButtonComplete);\n    return isFinished;\n  }\n\n  isLastInContentObject() {\n    const contentObject = this.findAncestor('contentobject');\n    const allDescendants = contentObject.getAllDescendantModels(true);\n    const lastDescendant = allDescendants[allDescendants.length - 1];\n    return (this === lastDescendant);\n  }\n\n  /**\n   * Apply start and final text amongst the current siblings\n   * Siblings in assessments can be randomised so this must be derived at runtime\n   */\n  calculateButtonText() {\n    const parentModel = this.getParent();\n    const trickleConfig = getModelConfig(parentModel);\n    let isStart = false;\n    let isFinal = false;\n    if (trickleConfig._onChildren) {\n      const parentId = parentModel.get('_id');\n      const trickleParent = getModelContainer(parentModel);\n      const trickleSiblings = trickleParent.getAllDescendantModels(true).filter(model => {\n        return model.get('_isAvailable') && model.get('_isTrickled');\n      });\n      const index = trickleSiblings.findIndex(model => model.get('_id') === parentId);\n      isStart = (index === 0);\n      isFinal = (index === trickleSiblings.length - 1 && !trickleParent.get('_canRequestChild'));\n    }\n    const text = (isStart && trickleConfig._button.startText) ?\n      trickleConfig._button.startText :\n      (isFinal && trickleConfig._button.finalText) ?\n        trickleConfig._button.finalText :\n        trickleConfig._button.text;\n    const ariaLabel = (isStart && trickleConfig._button.startAriaLabel) ?\n      trickleConfig._button.startAriaLabel :\n      (isFinal && trickleConfig._button.finalAriaLabel) ?\n        trickleConfig._button.finalAriaLabel :\n        trickleConfig._button.ariaLabel;\n    this.set({\n      buttonText: text,\n      buttonAriaLabel: ariaLabel\n    });\n  }\n\n  /**\n   * Will reset this button if the step has been unlocked and should be relocked\n   * on revisit\n   */\n  checkIfResetOnRevisit() {\n    if (this.isFinished() && !this.isStepLockedOnRevisit()) return;\n    this.set({\n      _isComplete: false,\n      _isInteractionComplete: false\n    });\n    applyLocks();\n  }\n\n  /**\n   * Calculate the current button visible and enabled states\n   * @param {boolean} isButtonDisableForced Set to true to signify that the button must not be enabled\n   * @param {boolean} isButtonHiddenForced Set to true to signify that the button must not be visible\n   */\n  calculateButtonState(isButtonDisableForced = false, isButtonHiddenForced = false) {\n    if (!this.isEnabled()) {\n      this.set({\n        _isButtonVisible: false,\n        _isButtonDisabled: !this.isStepUnlocked()\n      });\n      return;\n    };\n\n    const trickleConfig = getModelConfig(this.getParent());\n    if (this.isLastInContentObject() && trickleConfig._button._showEndOfPage === false) {\n      return this.set({\n        _isButtonVisible: false,\n        _isButtonDisabled: true\n      });\n    }\n\n    const isTrickleKilled = controller.isKilled;\n    const isStepUnlocked = this.isStepUnlocked() || isTrickleKilled;\n    const isFinished = this.isFinished() || isTrickleKilled;\n    const isButtonVisibleBeforeCompletion = (trickleConfig._button._styleBeforeCompletion !== 'hidden');\n    // Force button to be hidden after completion if _isFullWidth, otherwise absolutely positioned buttons will stack\n    const isButtonVisibleAfterCompletion = (trickleConfig._button._styleAfterClick !== 'hidden') && !trickleConfig._button._isFullWidth;\n\n    const isStepLockingCompletionRequired = this.isStepLockingCompletionRequired();\n\n    const isNoCompletionRequiredAndLockedVisible = (!isStepLockingCompletionRequired && !isFinished && isButtonVisibleBeforeCompletion);\n    const isNoCompletionRequiredAndUnlockedVisible = (!isStepLockingCompletionRequired && isStepUnlocked && !isFinished);\n    const isNoCompletionRequiredAndFinishedVisible = (!isStepLockingCompletionRequired && isFinished && isButtonVisibleAfterCompletion);\n    const isStepLockedAndVisibleBeforeCompletion = (isStepLockingCompletionRequired && !isStepUnlocked && isButtonVisibleBeforeCompletion && !isButtonHiddenForced);\n    const isFinishedAndVisibleAfterCompletion = (isStepLockingCompletionRequired && isFinished && isButtonVisibleAfterCompletion);\n    const isStepUnlockedAndButtonIncomplete = (isStepLockingCompletionRequired && isStepUnlocked && !isFinished);\n\n    const isButtonVisible = isNoCompletionRequiredAndLockedVisible ||\n      isNoCompletionRequiredAndUnlockedVisible ||\n      isNoCompletionRequiredAndFinishedVisible ||\n      isStepLockedAndVisibleBeforeCompletion ||\n      isFinishedAndVisibleAfterCompletion ||\n      isStepUnlockedAndButtonIncomplete;\n\n    const isButtonEnabledBeforeCompletion = (trickleConfig._button._styleBeforeCompletion !== 'disabled');\n    const isButtonEnabledAfterCompletion = (trickleConfig._button._styleAfterClick !== 'disabled');\n\n    const isNoCompletionRequiredAndLockedEnabled = (!isStepLockingCompletionRequired && !isFinished && isButtonEnabledBeforeCompletion);\n    const isNoCompletionRequiredAndUnlockedEnabled = (!isStepLockingCompletionRequired && isStepUnlocked && !isFinished);\n    const isNoCompletionRequiredAndFinishedEnabled = (!isStepLockingCompletionRequired && isFinished && isButtonEnabledAfterCompletion);\n    const isStepUnlockedAndButtonIncompleteWithoutButtonDisabledForced = (isStepLockingCompletionRequired && isStepUnlockedAndButtonIncomplete && !isButtonDisableForced);\n    const isFinishedAndEnabledAfterCompletion = (isStepLockingCompletionRequired && isFinished && isButtonEnabledAfterCompletion);\n\n    const isButtonEnabled = isNoCompletionRequiredAndLockedEnabled ||\n      isNoCompletionRequiredAndUnlockedEnabled ||\n      isNoCompletionRequiredAndFinishedEnabled ||\n      isStepUnlockedAndButtonIncompleteWithoutButtonDisabledForced ||\n      isFinishedAndEnabledAfterCompletion ||\n      false;\n\n    this.set({\n      _isButtonVisible: isButtonVisible,\n      _isButtonDisabled: !isButtonEnabled\n    });\n  }\n\n}\n","import components from 'core/js/components';\nimport TrickleButtonView from './TrickleButtonView';\nimport TrickleButtonModel from './TrickleButtonModel';\n\nexport default components.register('trickle-button', {\n  view: TrickleButtonView,\n  model: TrickleButtonModel\n});\n","import Adapt from 'core/js/adapt';\nimport controller from './controller';\nimport models from './models';\nimport trickleButton from './trickleButton';\nimport TrickleButtonModel from './TrickleButtonModel';\nimport TrickleButtonView from './TrickleButtonView';\n\n// Export main API\nexport default (Adapt.trickle = controller);\n\n// Export everything\nexport {\n  controller,\n  models,\n  trickleButton,\n  TrickleButtonModel,\n  TrickleButtonView\n};\n","const TUTOR_TYPE = ENUM([\n  'NOTIFY',\n  'INLINE',\n  'OVERLAY',\n  'NONE'\n]);\n\nexport default TUTOR_TYPE;\n","import Adapt from 'core/js/adapt';\nimport TUTOR_TYPE from './TUTOR_TYPE';\n\nexport default class TutorModel extends Backbone.Model {\n\n  defaults() {\n    return {\n      _type: TUTOR_TYPE.NOTIFY.asLowerCase,\n      _classes: '',\n      _hasNotifyBottomButton: false,\n      _button: {\n        text: '{{_globals._extensions._tutor.hideFeedback}}',\n        ariaLabel: '{{_globals._extensions._tutor.hideFeedback}}'\n      },\n      ...Adapt.course.get('_tutor')\n    };\n  }\n\n  initialize(data, parentModel) {\n    data = $.extend(true, this.defaults(), data?._isInherited === true ? null : data, {\n      _attributes: { 'data-adapt-id': parentModel.get('_id') },\n      _id: parentModel.get('_id'),\n      _shouldRenderId: false,\n      altTitle: parentModel.get('altFeedbackTitle'),\n      title: parentModel.get('feedbackTitle'),\n      body: parentModel.get('feedbackMessage')\n    });\n    data._classes += ` tutor ${this.getOriginClasses(parentModel)}`;\n    this.set(data);\n  }\n\n  getOriginClasses(model) {\n    const component = model.get('_component');\n    const extension = model.get('_extension');\n\n    return [\n      model.get('_isCorrect') ?\n        'is-correct' :\n        model.get('_isAtLeastOneCorrectSelection') ?\n          'is-partially-correct' :\n          'is-incorrect',\n      component && `is-component is-${component}`,\n      extension && `is-extension is-${extension}`\n    ].filter(Boolean).join(' ');\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport notify from 'core/js/notify';\n\nexport default class TutorNotify extends Backbone.Controller {\n\n  initialize(options) {\n    this.parentView = options.parentView;\n    this.listenToOnce(Adapt, 'notify:closed', this.onNotifyClosed);\n    this.triggerNotify();\n  }\n\n  triggerNotify() {\n    const {\n      _hasNotifyBottomButton: isButtonEnabled,\n      _button: { text: promptText }\n    } = this.model.toJSON();\n\n    this.notifyOptions = {\n      ...this.model.toJSON(),\n      _prompts: isButtonEnabled && [{\n        promptText: Handlebars.compile(promptText)({ _globals: Adapt.course.get('_globals') })\n      }],\n      _type: isButtonEnabled ? 'prompt' : 'popup'\n    };\n\n    notify.create(this.notifyOptions);\n    Adapt.trigger('tutor:opened', this.parentView, this.notifyOptions);\n  }\n\n  onNotifyClosed() {\n    Adapt.trigger('tutor:closed', this.parentView, this.notifyOptions);\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport BUTTON_STATE from 'core/js/enums/buttonStateEnum';\nimport a11y from 'core/js/a11y';\n\nexport default class TutorView extends Backbone.View {\n\n  className() {\n    return [\n      'tutor',\n      `tutor-type-${this.model.get('_type')}`,\n      this.model.get('_classes')\n    ].join(' ');\n  }\n\n  events() {\n    return { 'click .js-tutor-btn': 'onCloseClick' };\n  }\n\n  initialize(options) {\n    this.parentView = options.parentView;\n    this.buttonsView = this.parentView.buttonsView;\n    this.listenTo(this.parentView, 'postRemove', this.onTutorClosed);\n    this.listenTo(this.buttonsView, 'buttons:stateUpdate', this.onButtonsStateUpdate);\n    this.render();\n  }\n\n  render() {\n    this.$el.html(Handlebars.templates.tutor(this.model.toJSON()));\n    _.defer(this.postRender.bind(this));\n  }\n\n  postRender() {\n    this.toggleFeedback({ shouldOpen: true });\n  }\n\n  toggleFeedback({ shouldOpen, shouldManageFocus = true } = {}) {\n    const animation = this.model.get('_type') === 'inline' ? 'slide' : 'fade';\n\n    const onAnimationEnd = shouldOpen ?\n      this.onTutorOpened.bind(this, shouldManageFocus) :\n      this.onTutorClosed.bind(this, shouldManageFocus);\n\n    if (shouldManageFocus) {\n      a11y.toggleEnabled(this.buttonsView.$('.js-btn-feedback'), !shouldOpen);\n    }\n\n    this.$('.tutor__inner').stop()[`${animation}Toggle`](200, onAnimationEnd);\n  }\n\n  onCloseClick() {\n    this.toggleFeedback({ shouldOpen: false });\n  }\n\n  onTutorOpened(shouldManageFocus) {\n    if (shouldManageFocus) {\n      a11y.focus(this.$('.tutor__inner'), { defer: true, preventScroll: true });\n    }\n    Adapt.trigger('tutor:opened', this.parentView, this.model.toJSON());\n  }\n\n  onTutorClosed(shouldManageFocus) {\n    if (shouldManageFocus) {\n      const $showFeedbackButton = this.buttonsView.$('.js-btn-feedback');\n      a11y.focus($showFeedbackButton, { defer: true, preventScroll: true });\n    }\n    Adapt.trigger('tutor:closed', this.parentView, this.model.toJSON());\n    this.remove();\n  }\n\n  onButtonsStateUpdate(state) {\n    if (state !== BUTTON_STATE.RESET) return;\n    this.toggleFeedback({ shouldOpen: false, shouldManageFocus: false });\n  }\n\n}\n","import Adapt from 'core/js/adapt';\nimport TutorModel from './TutorModel';\nimport TutorNotify from './TutorNotify';\nimport TutorView from './TutorView';\nimport TUTOR_TYPE from './TUTOR_TYPE';\n\nclass Tutor extends Backbone.Controller {\n\n  initialize() {\n    this.listenTo(Adapt, 'questionView:showFeedback', this.onQuestionViewShowFeedback);\n  }\n\n  onQuestionViewShowFeedback(view) {\n    const parentModel = view.model;\n    const tutorModel = new TutorModel(parentModel.get('_tutor'), parentModel);\n    const options = { model: tutorModel, parentView: view };\n\n    switch (TUTOR_TYPE(tutorModel.get('_type').toUpperCase())) {\n      case TUTOR_TYPE.NOTIFY:\n        new TutorNotify(options);\n        break;\n      case TUTOR_TYPE.INLINE:\n      case TUTOR_TYPE.OVERLAY:\n        view.$('.component__inner').append(new TutorView(options).$el);\n        break;\n      case TUTOR_TYPE.NONE:\n      default:\n        // do nothing\n    }\n  }\n\n}\n\nexport default (Adapt.tutor = new Tutor());\n","/*\n * adapt-contrib-xapi\n * License      - http://github.com/adaptlearning/adapt_framework/LICENSE\n * Maintainers  - Dennis Heaney <dennis@learningpool.com>\n *              - Barry McKay <barry@learningpool.com>\n *              - Brian Quinn <brian@learningpool.com>\n */\ndefine([\n  'core/js/adapt',\n  'core/js/enums/completionStateEnum',\n  'libraries/async.min',\n  'libraries/xapiwrapper.min',\n  'libraries/url-polyfill.min'\n], function(Adapt, COMPLETION_STATE, Async) {\n\n  'use strict';\n\n  /**\n   * @callback ErrorOnlyCallback\n   * @param {?Error} error\n   */\n  var xAPI = Backbone.Model.extend({\n\n    /** Declare defaults and model properties */\n\n    // Default model properties.\n    defaults: {\n      lang: 'en-US',\n      displayLang: 'en-US',\n      generateIds: false,\n      activityId: null,\n      actor: null,\n      shouldTrackState: true,\n      shouldUseRegistration: false,\n      componentBlacklist: 'blank,graphic',\n      isInitialised: false,\n      state: {}\n    },\n\n    startAttemptDuration: 0,\n    startTimeStamp: null,\n    courseName: '',\n    courseDescription: '',\n    defaultLang: 'en-US',\n    isComplete: false,\n    debug: false,\n\n    // Default events to send statements for.\n    coreEvents: {\n      Adapt: {\n        'router:page': false,\n        'router:menu': false,\n        'assessments:complete': true,\n        'questionView:recordInteraction': true\n      },\n      contentObjects: {\n        'change:_isComplete': false\n      },\n      articles: {\n        'change:_isComplete': false\n      },\n      blocks: {\n        'change:_isComplete': false\n      },\n      components: {\n        'change:_isComplete': true\n      }\n    },\n\n    // An object describing the core Adapt framework collections.\n    coreObjects: {\n      course: 'course',\n      contentObjects: ['menu', 'page'],\n      articles: 'article',\n      blocks: 'block',\n      components: 'component',\n      offlineStorage: 'offlineStorage'\n    },\n\n    /** Implementation starts here */\n    initialize: function() {\n      if (!Adapt.config) {\n        return;\n      }\n\n      this.config = Adapt.config.get('_xapi');\n\n      if (!this.getConfig('_isEnabled')) {\n        return this;\n      }\n\n      Adapt.wait.begin();\n\n      // Initialize the xAPIWrapper.\n      this.initializeWrapper(_.bind(function(error) {\n        if (error) {\n          this.onInitialised(error);\n          return this;\n        }\n\n        this.set({\n          activityId: (this.getLRSAttribute('activity_id') || this.getConfig('_activityID') || this.getBaseUrl()),\n          displayLang: Adapt.config.get('_defaultLanguage'),\n          lang: this.getConfig('_lang'),\n          generateIds: this.getConfig('_generateIds'),\n          shouldTrackState: this.getConfig('_shouldTrackState'),\n          shouldUseRegistration: this.getConfig('_shouldUseRegistration') || false,\n          componentBlacklist: this.getConfig('_componentBlacklist') || [],\n          cookieDomain: this.getConfig('_cookiePrefix')\n        });\n\n        var componentBlacklist = this.get('componentBlacklist');\n\n        if (!_.isArray(componentBlacklist)) {\n          // Create the blacklist array and force the items to lowercase.\n          componentBlacklist = componentBlacklist.split(/,\\s?/).map(function(component) {\n            return component.toLowerCase();\n          });\n        }\n\n        this.set('componentBlacklist', componentBlacklist);\n\n        if (!this.validateProps()) {\n          var error = new Error('Missing required properties');\n          Adapt.log.error('adapt-contrib-xapi: xAPI Wrapper initialisation failed', error);\n          this.onInitialised(error);\n          return this;\n        }\n\n        this.startTimeStamp = new Date();\n        this.courseName = Adapt.course.get('displayTitle') || Adapt.course.get('title');\n        this.courseDescription = Adapt.course.get('description') || '';\n\n        // Send the 'launched' and 'initialized' statements.\n        var statements = [\n          this.getCourseStatement(ADL.verbs.launched),\n          this.getCourseStatement(ADL.verbs.initialized)\n        ];\n\n        this.sendStatements(statements, _.bind(function(error) {\n          if (error) {\n            this.onInitialised(error);\n            return this;\n          }\n\n          if (['ios', 'android'].indexOf(Adapt.device.OS) > -1) {\n            $(document).on('visibilitychange', this.onVisibilityChange.bind(this));\n          } else {\n            $(window).on('beforeunload unload', this.sendUnloadStatements.bind(this));\n          }\n\n          if (!this.get('shouldTrackState')) {\n            // xAPI is not managing the state.\n            this.onInitialised();\n            return this;\n          }\n\n          // Retrieve the course state.\n          this.getState(_.bind(function(error) {\n            if (error) {\n              this.onInitialised(error);\n              return this;\n            }\n\n            if (_.isEmpty(this.get('state'))) {\n              // This is a new attempt, send 'attempted'.\n              this.sendStatement(this.getCourseStatement(ADL.verbs.attempted));\n            } else {\n              // This is a continuation of an existing attempt, send 'resumed'.\n              this.sendStatement(this.getCourseStatement(ADL.verbs.resumed));\n            }\n\n            this.restoreState();\n            this.onInitialised();\n            return this;\n          }, this));\n        }, this));\n      }, this));\n    },\n\n    /**\n     * Replace the hard-coded _learnerInfo data in _globals with the actual data from the LRS.\n     */\n    getLearnerInfo: function() {\n      var globals = Adapt.course.get('_globals');\n\n      if (!globals._learnerInfo) {\n          globals._learnerInfo = {};\n      }\n\n      _.extend(globals._learnerInfo, Adapt.offlineStorage.get('learnerinfo'));\n    },\n  \n    /**\n     * Intializes the ADL xapiWrapper code.\n     * @param {ErrorOnlyCallback} callback\n     */\n    initializeWrapper: function(callback) {\n      // If no endpoint has been configured, assume the ADL Launch method.\n      if (!this.getConfig('_endpoint')) {\n        //check to see if configuration has been passed in URL\n        this.xapiWrapper = window.xapiWrapper || ADL.XAPIWrapper;\n        if (this.checkWrapperConfig()) {\n          // URL had all necessary configuration so we continue using it.\n          // Set the LRS specific properties.\n          this.set({\n            registration: this.getLRSAttribute('registration'),\n            actor: this.getLRSAttribute('actor')\n          });\n\n          this.xapiWrapper.strictCallbacks = true;\n\n          callback();\n        } else {\n          // If no endpoint is configured, assume this is using the ADL launch method.\n          ADL.launch(_.bind(function(error, launchData, xapiWrapper) {\n            if (error) {\n              return callback(error);\n            }\n\n            // Initialise the xAPI wrapper.\n            this.xapiWrapper = xapiWrapper;\n\n            this.set({\n              actor: launchData.actor\n            });\n\n            this.xapiWrapper.strictCallbacks = true;\n\n            callback();\n          }, this), true, true);\n        }\n      } else {\n        // The endpoint has been defined in the config, so use the static values.\n        // Initialise the xAPI wrapper.\n        this.xapiWrapper = window.xapiWrapper || ADL.XAPIWrapper;\n\n        // Set any attributes on the xAPIWrapper.\n        var configError;\n        try {\n          this.setWrapperConfig();\n        } catch (error) {\n          configError = error;\n        }\n\n        if (configError) {\n          return callback(error);\n        }\n\n        function uuidv4() {\n          return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>\n            (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\n          );\n        }\n\n        function getDomain(url) {\n          var domain = new URL(url).hostname;\n          var elems = domain.split('.');\n          var iMax = elems.length - 1;\n          \n          var isSecondLevel = elems.length >= 3 && (elems[iMax] + elems[iMax - 1]).length <= 5;\n          var tld = elems.splice( isSecondLevel ? -3 : -2 ).join('.');\n          if (tld != \"localhost\") {\n            return \".\"+tld;\n          }\n          return tld;\n        }\n\n        function setCookie(cname, cvalue, exdays) {\n          const d = new Date();\n          d.setTime(d.getTime() + (exdays*24*60*60*1000));\n          let expires = \"expires=\"+ d.toUTCString();\n          document.cookie = cname + \"=\" + cvalue + \";\" + expires + \";path=/;domain=\"+getDomain(window.location);\n        }      \n\n        function getCookie(cname) {\n          let name = cname + \"=\";\n          let decodedCookie = decodeURIComponent(document.cookie);\n          let ca = decodedCookie.split(';');\n          for(let i = 0; i <ca.length; i++) {\n            let c = ca[i];\n            while (c.charAt(0) == ' ') {\n              c = c.substring(1);\n            }\n            if (c.indexOf(name) == 0) {\n              return c.substring(name.length, c.length);\n            }\n          }\n          return \"\";\n        }\n        if (this.debug) {\n          console.log('xAPI: Checking Cookies for actor, or generating random actor'); \n        }\n        let cookieDomain = this.getConfig('_cookiePrefix');\n        if (getCookie(cookieDomain + '.actor') !== \"\") {\n          //  this.xapiWrapper.lrs.actor = `{\"objectType\":\"Agent\",\"name\":\"Testy+McTestface\",\"account\":{\"homePage\":\"http://www.example.com/users\",\"name\":\"1234567890\"}}`\n          this.xapiWrapper.lrs.actor = `${getCookie(cookieDomain + '.actor')}`\n          if(this.debug) { \n            console.log('xAPI: an actor exists in cookies and is:')\n            console.log(`${getCookie(cookieDomain + '.actor')}`)\n          }\n          this.set({\n            registration: getCookie(cookieDomain + '.registration'),\n            actor: JSON.parse(getCookie(cookieDomain + '.actor'))\n          });\n          // insertActorAsUrl();\n          this.xapiWrapper.strictCallbacks = true;\n          callback(); \n        } else if (getCookie(cookieDomain + '.actor') === \"\") {\n          if(this.debug) { \n            console.log('xAPI: actor does not exist in local storage') \n          }\n\n          var courseUser = `${uuidv4()}`\n          var actor = {\n            \"objectType\": \"Agent\",\n            \"name\": courseUser,\n            \"account\": {\n              \"homePage\": \"https://theodi.org\",\n              \"name\": courseUser\n            }\n          }\n          \n          // an actor does not exist in the url so set one from local storage\n          setCookie(cookieDomain + '.actor', JSON.stringify(actor), 365);\n          setCookie(cookieDomain + '.registration', courseUser, 365);\n          this.set({\n            registration: courseUser,\n            actor: actor\n          });\n          if(this.debug) { \n            console.log('xAPI: Generated new actor');\n            console.log(actor);\n            console.log(getCookie(cookieDomain + 'actor'));\n          }\n          this.xapiWrapper.strictCallbacks = true;\n          callback(); \n        } else {\n          if(this.debug) { \n            console.log('xAPI: Failed to generate actor, looking for actor in config?'); \n          }\n\n          // Set the LRS specific properties.\n          this.set({\n            registration: this.getLRSAttribute('registration'),\n            actor: this.getLRSAttribute('actor')\n          });\n\n          this.xapiWrapper.strictCallbacks = true;\n\n          callback();\n        }\n      }\n    },\n\n    /**\n     * Triggers 'plugin:endWait' event (if required).\n     */\n    onInitialised: function(error) {\n      this.set({ isInitialised: !!!error });\n\n      Adapt.wait.end();\n\n      _.defer(function() {\n        if (error) {\n          Adapt.trigger('xapi:lrs:initialize:error', error);\n          return;\n        }\n\n        Adapt.trigger('xapi:lrs:initialize:success');\n      });\n    },\n\n    onLanguageChanged: function(newLanguage) {\n      // Update the language.\n      this.set({ displayLang: newLanguage });\n\n      // Since a language change counts as a new attempt, reset the state.\n      this.deleteState(function() {\n        // Send a statement to track the (new) course.\n        this.sendStatement(this.getCourseStatement(ADL.verbs.launched));\n      });\n    },\n\n    /**\n     * Sends 'suspended' and 'terminated' statements to the LRS when the window\n     * is closed or the browser app is minimised on a device. Sends a 'resume'\n     * statement when switching back to a suspended session.\n     */\n    onVisibilityChange: function() {\n      if (document.visibilityState === 'visible') {\n        this.isTerminated = false;\n\n        return this.sendStatement(this.getCourseStatement(ADL.verbs.resumed));\n      }\n\n      this.sendUnloadStatements();\n    },\n\n    // Sends (optional) 'suspended' and 'terminated' statements to the LRS.\n    sendUnloadStatements: function() {\n      if (this.isTerminated) {\n        return;\n      }\n\n      var statements = [];\n\n      if (!this.isComplete) {\n        // If the course is still in progress, send the 'suspended' verb.\n        statements.push(this.getCourseStatement(ADL.verbs.suspended));\n      }\n\n      // Always send the 'terminated' verb.\n      statements.push(this.getCourseStatement(ADL.verbs.terminated));\n\n      // Note: it is not possible to intercept these synchronous statements.\n      this.sendStatementsSync(statements);\n\n      this.isTerminated = true;\n    },\n\n    /**\n    * Check Wrapper to see if all parameters needed are set.\n    */\n    checkWrapperConfig: function() {\n      if (this.xapiWrapper.lrs.endpoint && this.xapiWrapper.lrs.actor\n        && this.xapiWrapper.lrs.auth && this.xapiWrapper.lrs.activity_id ) {\n          return true;\n        } else {\n          return false;\n        }\n    },\n\n    /**\n     * Attempt to extract endpoint, user and password from the config.json.\n     */\n    setWrapperConfig: function() {\n      var keys = ['endpoint', 'user', 'password'];\n      var newConfig = {};\n\n      _.each(keys, function(key) {\n        var val = this.getConfig('_' + key);\n\n        if (val) {\n          // Note: xAPI wrapper requires a trailing slash and protocol to be present\n          if (key === 'endpoint') {\n            val = val.replace(/\\/?$/, '/');\n\n            if (!/^https?:\\/\\//i.test(val)) {\n              Adapt.log.warn('adapt-contrib-xapi: \"_endpoint\" value is missing protocol (defaulting to http://)');\n\n              val = 'http://' + val;\n            }\n          }\n\n          newConfig[key] = val;\n        }\n      }, this);\n\n      if (!_.isEmpty(newConfig)) {\n        this.xapiWrapper.changeConfig(newConfig);\n\n        if (!this.xapiWrapper.testConfig()) {\n          throw new Error('Incorrect xAPI configuration detected');\n        }\n      }\n    },\n\n    /**\n     * Gets the URL the course is currently running on.\n     * @return {string} The URL to the current course.\n     */\n    getBaseUrl: function() {\n      var url = window.location.origin + window.location.pathname;\n\n      Adapt.log.info('adapt-contrib-xapi: Using detected URL (' + url + ') as ActivityID');\n\n      return url;\n    },\n\n    getAttemptDuration: function() {\n      return this.startAttemptDuration + this.getSessionDuration();\n    },\n\n    getSessionDuration: function() {\n      return Math.abs((new Date()) - this.startTimeStamp);\n    },\n\n    /**\n     * Converts milliseconds to an ISO8601 duration\n     * @param {int} inputMilliseconds - Duration in milliseconds\n     * @return {string} - Duration in ISO8601 format\n     */\n    convertMillisecondsToISO8601Duration: function(inputMilliseconds) {\n      var hours;\n      var minutes;\n      var seconds;\n      var i_inputMilliseconds = parseInt(inputMilliseconds, 10);\n      var i_inputCentiseconds;\n      var inputIsNegative = '';\n      var rtnStr = '';\n\n      // Round to nearest 0.01 seconds.\n      i_inputCentiseconds = Math.round(i_inputMilliseconds / 10);\n\n      if (i_inputCentiseconds < 0) {\n        inputIsNegative = '-';\n        i_inputCentiseconds = i_inputCentiseconds * -1;\n      }\n\n      hours = parseInt(((i_inputCentiseconds) / 360000), 10);\n      minutes = parseInt((((i_inputCentiseconds) % 360000) / 6000), 10);\n      seconds = (((i_inputCentiseconds) % 360000) % 6000) / 100;\n\n      rtnStr = inputIsNegative + 'PT';\n      if (hours > 0) {\n        rtnStr += hours + 'H';\n      }\n\n      if (minutes > 0) {\n        rtnStr += minutes + 'M';\n      }\n\n      rtnStr += seconds + 'S';\n\n      return rtnStr;\n    },\n\n    setupListeners: function() {\n      if (!this.get('isInitialised')) {\n        Adapt.log.warn('adapt-contrib-xapi: Unable to setup listeners for xAPI');\n        return;\n      }\n\n      // Allow surfacing the learner's info in _globals.\n      this.getLearnerInfo()\n\n      this.listenTo(Adapt, 'app:languageChanged', this.onLanguageChanged);\n\n      if (this.get('shouldTrackState')) {\n        this.listenTo(Adapt, 'state:change', this.sendState);\n      }\n\n      // Use the config to specify the core events.\n      this.coreEvents = _.extend(this.coreEvents, this.getConfig('_coreEvents'));\n\n      // Always listen out for course completion.\n      this.listenTo(Adapt, 'tracking:complete', this.onTrackingComplete);\n\n      // Conditionally listen to the events.\n      // Visits to the menu.\n      if (this.coreEvents['Adapt']['router:menu']) {\n        this.listenTo(Adapt, 'router:menu', this.onItemExperience);\n      }\n\n      // Visits to a page.\n      if (this.coreEvents['Adapt']['router:page']) {\n        this.listenTo(Adapt, 'router:page', this.onItemExperience);\n      }\n\n      // When an interaction takes place on a question.\n      if (this.coreEvents['Adapt']['questionView:recordInteraction']) {\n        this.listenTo(Adapt, 'questionView:recordInteraction', this.onQuestionInteraction);\n      }\n\n      // When an assessment is completed.\n      if (this.coreEvents['Adapt']['assessments:complete']) {\n        this.listenTo(Adapt, 'assessments:complete', this.onAssessmentComplete);\n      }\n\n      // Standard completion events for the various collection types, i.e.\n      // course, contentobjects, articles, blocks and components.\n      _.each(_.keys(this.coreEvents), function(key) {\n        if (key !== 'Adapt') {\n          var val = this.coreEvents[key];\n\n          if (typeof val === 'object' && val['change:_isComplete'] === true) {\n            this.listenTo(Adapt[key], 'change:_isComplete', this.onItemComplete);\n          }\n        }\n      }, this);\n    },\n\n    /**\n     * Gets an xAPI Activity (with an 'id of the activityId) representing the course.\n     * @returns {ADL.XAPIStatement.Activity} Activity representing the course.\n     */\n    getCourseActivity: function() {\n      var object = new ADL.XAPIStatement.Activity(this.get('activityId'));\n      var name = {};\n      var description = {};\n\n      name[this.get('displayLang')] = this.courseName;\n      description[this.get('displayLang')] = this.courseDescription;\n\n      object.definition = {\n        type: ADL.activityTypes.course,\n        name: name,\n        description: description\n      };\n\n      return object;\n    },\n\n    /**\n     * Creates an xAPI statement related to the Adapt.course object.\n     * @param {object | string} verb - A valid ADL.verbs object or key.\n     * @param {object} [result] - An optional result object.\n     * @return A valid ADL statement object.\n     */\n    getCourseStatement: function(verb, result) {\n      if (typeof result === 'undefined') {\n        result = {};\n      }\n\n      var object = this.getCourseActivity()\n\n      // Append the duration.\n      switch (verb) {\n        case ADL.verbs.launched:\n        case ADL.verbs.initialized:\n        case ADL.verbs.attempted: {\n          result.duration = 'PT0S';\n          break;\n        }\n\n        case ADL.verbs.failed:\n        case ADL.verbs.passed:\n        case ADL.verbs.suspended: {\n          result.duration = this.convertMillisecondsToISO8601Duration(this.getAttemptDuration());\n          break;\n        }\n\n        case ADL.verbs.terminated: {\n          result.duration = this.convertMillisecondsToISO8601Duration(this.getSessionDuration());\n          break;\n        }\n      }\n\n      return this.getStatement(this.getVerb(verb), object, result);\n    },\n\n    /**\n     * Gets a name object from a given model.\n     * @param {Backbone.Model} model - An instance of Adapt.Model (or Backbone.Model).\n     * @return {object} An object containing a key-value pair with the language code and name.\n     */\n    getNameObject: function(model) {\n      var name = {};\n\n      name[this.get('displayLang')] = model.get('displayTitle') || model.get('title');\n\n      return name;\n    },\n\n    /**\n     * Gets the activity type for a given model.\n     * @param {Backbone.Model} model - An instance of Adapt.Model (or Backbone.Model).\n     * @return {string} A URL to the current activity type.\n     */\n    getActivityType: function(model) {\n      var type = '';\n\n      switch (model.get('_type')) {\n        case 'component': {\n          type = model.get('_isQuestionType') ? ADL.activityTypes.interaction : ADL.activityTypes.media;\n          break;\n        }\n        case 'block':\n        case 'article': {\n          type = ADL.activityTypes.interaction; //??\n          break;\n        }\n        case 'course': {\n          type = ADL.activityTypes.course;\n          break;\n        }\n        case 'menu': {\n          type = ADL.activityTypes.module;\n          break;\n        }\n        case 'page': {\n          type = ADL.activityTypes.lesson;\n          break;\n        }\n      }\n\n      return type;\n    },\n\n    /**\n     * Sends an 'answered' statement to the LRS.\n     * @param {ComponentView} view - An instance of Adapt.ComponentView.\n     */\n    onQuestionInteraction: function(view) {\n      if (!view.model || view.model.get('_type') !== 'component' && !view.model.get('_isQuestionType')) {\n        return;\n      }\n\n      if (this.isComponentOnBlacklist(view.model.get('_component'))) {\n        // This component is on the blacklist, so do not send a statement.\n        return;\n      }\n\n      var object = new ADL.XAPIStatement.Activity(this.getUniqueIri(view.model));\n      var isComplete = view.model.get('_isComplete');\n      var lang = this.get('displayLang');\n      var statement;\n      var description = {};\n\n      description[this.get('displayLang')] = this.stripHtml(view.model.get('body'));\n\n      object.definition = {\n        name: this.getNameObject(view.model),\n        description: description,\n        type: ADL.activityTypes.question,\n        interactionType: view.getResponseType()\n      };\n\n      if (typeof view.getInteractionObject === 'function') {\n        // Get any extra interactions.\n        _.extend(object.definition, view.getInteractionObject());\n\n        // Ensure any 'description' properties are objects with the language map.\n        _.each(_.keys(object.definition), function(key) {\n          if (_.isArray(object.definition[key]) && object.definition[key].length !== 0) {\n            for (var i = 0; i < object.definition[key].length; i++) {\n              if (!object.definition[key][i].hasOwnProperty('description')) {\n                break;\n              }\n\n              if (typeof object.definition[key][i].description === 'string') {\n                var description = {};\n                description[lang] = object.definition[key][i].description;\n\n                object.definition[key][i].description = description;\n              }\n            }\n          }\n        });\n      }\n\n      var result = {\n        score: {\n          raw: view.model.get('_score') || 0\n        },\n        success: view.model.get('_isCorrect'),\n        completion: isComplete,\n        response: this.processInteractionResponse(object.definition.interactionType, view.getResponse())\n      };\n\n      // Answered\n      statement = this.getStatement(this.getVerb(ADL.verbs.answered), object, result);\n\n      this.addGroupingActivity(view.model, statement)\n      this.sendStatement(statement);\n    },\n\n    /**\n     * Removes the HTML tags/attributes and returns a string.\n     * @param {string} html - A string containing HTML\n     * @returns {string} The same string minus HTML\n     */\n    stripHtml: function(html) {\n      var tempDiv = document.createElement('div');\n      tempDiv.innerHTML = html;\n\n      return tempDiv.textContent || tempDiv.innerText || '';\n    },\n\n    /**\n     * In order to support SCORM 1.2 and SCORM 2004, some of the components return a non-standard\n     * response.\n     * @param {string} responseType - The type of the response.\n     * @param {string} response - The unprocessed response string.\n     * @returns {string} A response formatted for xAPI compatibility.\n     */\n    processInteractionResponse: function(responseType, response) {\n      switch (responseType) {\n        case 'choice': {\n          response = response.replace(/,|#/g, '[,]');\n\n          break;\n        }\n        case 'matching': {\n          // Example: 1[.]1_1[,]2[.]2_5\n          response = response\n            .split('#')\n            .map(function(val, i) {\n              return (i + 1) + '[.]' + val.replace('.', '_')\n            })\n            .join('[,]');\n          break;\n        }\n      }\n\n      return response;\n    },\n\n    /**\n     * Sends an xAPI statement when an item has been experienced.\n     * @param {AdaptModel} model - An instance of AdaptModel, i.e. ContentObjectModel, etc.\n     */\n    onItemExperience: function(model) {\n      if (model.get('_id') === 'course') {\n        // We don't really want to track actions on the home menu.\n        return;\n      }\n\n      var object = new ADL.XAPIStatement.Activity(this.getUniqueIri(model));\n      var statement;\n\n      object.definition = {\n        name: this.getNameObject(model),\n        type: this.getActivityType(model)\n      };\n\n      // Experienced.\n      statement = this.getStatement(this.getVerb(ADL.verbs.experienced), object);\n\n      this.addGroupingActivity(model, statement)\n      this.sendStatement(statement);\n    },\n\n    /**\n     * Checks if a given component is blacklisted from sending statements.\n     * @param {string} component - The name of the component.\n     * @returns {boolean} true if the component exists on the blacklist.\n     */\n    isComponentOnBlacklist: function(component) {\n      return this.get('componentBlacklist').indexOf(component) !== -1;\n    },\n\n    /**\n     * Sends an xAPI statement when an item has been completed.\n     * @param {AdaptModel} model - An instance of AdaptModel, i.e. ComponentModel, BlockModel, etc.\n     * @param {boolean} isComplete - Flag to indicate if the model has been completed\n     */\n    onItemComplete: function(model, isComplete) {\n      if (isComplete === false) {\n        // The item is not actually completed, e.g. it may have been reset.\n        return;\n      }\n\n      // If this is a question component (interaction), do not record multiple statements.\n      if (model.get('_type') === 'component' && model.get('_isQuestionType') === true\n        && this.coreEvents['Adapt']['questionView:recordInteraction'] === true\n        && this.coreEvents['components']['change:_isComplete'] === true) {\n        // Return because 'Answered' will already have been passed.\n        return;\n      }\n\n      if (model.get('_type') === 'component' && this.isComponentOnBlacklist(model.get('_component'))) {\n        // This component is on the blacklist, so do not send a statement.\n        return;\n      }\n\n      var result = { completion: true };\n      var object = new ADL.XAPIStatement.Activity(this.getUniqueIri(model));\n      var statement;\n\n      object.definition = {\n        name: this.getNameObject(model),\n        type: this.getActivityType(model)\n      };\n\n      // Completed.\n      statement = this.getStatement(this.getVerb(ADL.verbs.completed), object, result);\n\n      this.addGroupingActivity(model, statement)\n      this.sendStatement(statement);\n    },\n\n    /**\n     * Gets a lesson activity for a given page.\n     * @param {string|Adapt.Model} page - Either an Adapt contentObject model of type 'page', or the _id of one.\n     * @returns {XAPIStatement.Activity} Activity corresponding to the lesson.\n     */\n    getLessonActivity: function(page) {\n      var pageModel = (typeof page === 'string')\n        ? Adapt.findById(page)\n        : page\n      var activity = new ADL.XAPIStatement.Activity(this.getUniqueIri(pageModel))\n      var name = this.getNameObject(pageModel)\n\n      activity.definition = {\n        name: name,\n        type: ADL.activityTypes.lesson\n      }\n\n      return activity;\n    },\n\n    /**\n     * Adds a 'grouping' and/or 'parent' value to a statement's contextActivities.\n     * Note: the 'parent' is only added in the case of a question component which is part of\n     * an assessment. All articles, blocks and components are grouped by page.\n     * @param {Adapt.Model} model - Any Adapt model.\n     * @param {ADL.XAPIStatement} statement - A valid xAPI statement object.\n     */\n    addGroupingActivity: function(model, statement) {\n      var type = model.get('_type');\n\n      if (type !== 'course') {\n        // Add a grouping for the course.\n        statement.addGroupingActivity(this.getCourseActivity())\n      }\n\n      if (['article', 'block', 'component'].indexOf(type) !== -1) {\n        // Group these items by page/lesson.\n        var pageModel = model.findAncestor('pages')\n\n        statement.addGroupingActivity(this.getLessonActivity(pageModel));\n      }\n\n      if (type === 'component' && model.get('_isPartOfAssessment')) {\n        // Get the article containing this question component.\n        let articleModel = model.findAncestor('articles')\n\n        if (articleModel && articleModel.has('_assessment') && articleModel.get('_assessment')._isEnabled) {\n          // Set the assessment as the parent.\n          var assessment = {\n            id: articleModel.get('_assessment')._id,\n            articleId: articleModel.get('_id'),\n            type: 'article-assessment',\n            pageId: articleModel.get('_parentId')\n          }\n\n          statement.addParentActivity(this.getAssessmentObject(assessment))\n        }\n      }\n    },\n\n    /**\n     * Takes an assessment state and returns a results object based on it.\n     * @param {object} assessment - An instance of the assessment state.\n     * @return {object} - A result object containing score, success and completion properties.\n     */\n    getAssessmentResultObject: function(assessment) {\n      var result = {\n        score: {\n          scaled: (assessment.scoreAsPercent / 100),\n          raw: assessment.score,\n          min: 0,\n          max: assessment.maxScore\n        },\n        success: assessment.isPass,\n        completion: assessment.isComplete\n      };\n\n      return result;\n    },\n\n    /**\n     * Gets an Activity for use in an xAPI statement.\n     * @param {object} assessment - Object representing the assessment.\n     * @returns {ADL.XAPIStatement.Activity} - Activity representing the assessment.\n     */\n    getAssessmentObject: function(assessment) {\n      // Instantiate a Model so it can be used to obtain an IRI.\n      var fakeModel = new Backbone.Model({\n        _id: assessment.id || assessment.articleId,\n        _type: assessment.type,\n        pageId: assessment.pageId\n      });\n\n      var object = new ADL.XAPIStatement.Activity(this.getUniqueIri(fakeModel));\n      var name = {};\n\n      name[this.get('displayLang')] = assessment.id || 'Assessment';\n\n      object.definition = {\n        name: name,\n        type: ADL.activityTypes.assessment\n      };\n\n      return object\n    },\n\n    /**\n     * Sends an xAPI statement when an assessment has been completed.\n     * @param {object} assessment - Object representing the state of the assessment.\n     */\n    onAssessmentComplete: function(assessment) {\n      var self = this;\n\n      var object = this.getAssessmentObject(assessment)\n      var result = this.getAssessmentResultObject(assessment);\n      var statement;\n\n      if (assessment.isPass) {\n        // Passed.\n        statement = this.getStatement(this.getVerb(ADL.verbs.passed), object, result);\n      } else {\n        // Failed.\n        statement = this.getStatement(this.getVerb(ADL.verbs.failed), object, result);\n      }\n\n      statement.addGroupingActivity(this.getCourseActivity())\n      statement.addGroupingActivity(this.getLessonActivity(assessment.pageId))\n\n      // Delay so that component completion can be recorded before assessment completion.\n      _.delay(function() {\n        self.sendStatement(statement);\n      }, 500);\n    },\n\n    /**\n     * Gets a valid 'verb' object in the ADL.verbs and returns the correct language version.\n     * @param {object|stirng} verb - A valid ADL verb object or key, e.g. 'completed'.\n     * @return {object} An ADL verb object with 'id' and language specific 'display' properties.\n     */\n    getVerb: function(verb) {\n      if (typeof verb === 'string') {\n        var key = verb.toLowerCase();\n        verb = ADL.verbs[key];\n\n        if (!verb) {\n          Adapt.log.error('adapt-contrib-xapi: Verb \"' + key + '\" does not exist in ADL.verbs object');\n        }\n      }\n\n      if (typeof verb !== 'object') {\n        throw new Error('Unrecognised verb: ' + verb);\n      }\n\n      var lang = this.get('lang') || this.defaultLang;\n\n      var singleLanguageVerb = {\n        id: verb.id,\n        display: {}\n      };\n\n      var description = verb.display[lang];\n\n      if (description) {\n        singleLanguageVerb.display[lang] = description;\n      } else {\n        // Fallback in case the verb translation doesn't exist.\n        singleLanguageVerb.display[this.defaultLang] = verb.display[this.defaultLang];\n      }\n\n      return singleLanguageVerb;\n    },\n\n    /**\n     * Gets a unique IRI for a given model.\n     * @param {AdaptModel} model - An instance of an AdaptModel object.\n     * @return {string} An IRI formulated specific to the passed model.\n     */\n    getUniqueIri: function(model) {\n      var iri = this.get('activityId');\n      var type = model.get('_type');\n\n      if (type !== 'course') {\n        if (type === 'article-assessment') {\n          iri = iri + ['#', 'assessment', model.get('_id')].join('/');\n        } else {\n          iri = iri + ['#/id', model.get('_id')].join('/');\n        }\n      }\n\n      return iri;\n    },\n\n    /**\n     * Handler for the Adapt Framework's 'tracking:complete' event.\n     * @param {object} completionData\n     */\n    onTrackingComplete: function(completionData) {\n      var self = this;\n      var result = {};\n      var completionVerb;\n\n      // Check the completion status.\n      switch (completionData.status) {\n        case COMPLETION_STATE.PASSED: {\n          completionVerb = ADL.verbs.passed;\n          break;\n        }\n\n        case COMPLETION_STATE.FAILED: {\n          completionVerb = ADL.verbs.failed;\n          break;\n        }\n\n        default: {\n          completionVerb = ADL.verbs.completed;\n        }\n      }\n\n      if (completionVerb === ADL.verbs.completed) {\n        result = { completion: true };\n      } else {\n        // The assessment(s) play a part in completion, so use their result.\n        result = this.getAssessmentResultObject(completionData.assessment);\n      }\n\n      // Store a reference that the course has actually been completed.\n      this.isComplete = true;\n\n      _.defer(function() {\n        // Send the completion status.\n        self.sendStatement(self.getCourseStatement(completionVerb, result));\n      });\n    },\n\n    /**\n     * Refresh course progress from loaded state.\n     */\n    restoreState: function() {\n      var state = this.get('state');\n\n      if (_.isEmpty(state)) {\n        return;\n      }\n\n      var Adapt = require('core/js/adapt');\n\n      if (state.components) {\n        _.each(state.components, function(stateObject) {\n          var restoreModel = Adapt.findById(stateObject._id);\n          \n          if (restoreModel) {\n            restoreModel.setTrackableState(stateObject);\n          } else {\n            Adapt.log.warn('adapt-contrib-xapi: Unable to restore state for component: ' + stateObject._id);\n          }\n        });\n      }\n\n      if (state.blocks) {\n        _.each(state.blocks, function(stateObject) {\n          var restoreModel = Adapt.findById(stateObject._id);\n\n          if (restoreModel) {\n            restoreModel.setTrackableState(stateObject);\n          } else {\n            Adapt.log.warn('adapt-contrib-xapi: Unable to restore state for block: ' + stateObject._id);\n          }\n        });\n      }\n    },\n\n    /**\n     * Generate an XAPIstatement object for the xAPI wrapper sendStatement methods.\n     * @param {object} verb - A valid ADL.verbs object.\n     * @param {object} object -\n     * @param {object} [result] - optional\n     * @param {object} [context] - optional\n     * @return {ADL.XAPIStatement} A formatted xAPI statement object.\n     */\n    getStatement: function(verb, object, result, context) {\n      var statement = new ADL.XAPIStatement(\n        new ADL.XAPIStatement.Agent(this.get('actor')),\n        verb,\n        object\n      );\n\n      if (result && !_.isEmpty(result)) {\n        statement.result = result;\n      }\n\n      if (context) {\n        statement.context = context;\n      }\n\n      if (this.get('_generateIds')) {\n        statement.generateId();\n      }\n\n      return statement;\n    },\n\n    /**\n     * Sends the state to the or the given model to the configured LRS.\n     * @param {AdaptModel} model - The AdaptModel whose state has changed.\n     */\n    sendState: function(model, modelState) {\n      if (this.get('shouldTrackState') !== true) {\n        return;\n      }\n\n      var activityId = this.get('activityId');\n      var actor = this.get('actor');\n      var type = model.get('_type');\n      var state = this.get('state');\n      var registration = this.get('shouldUseRegistration') === true \n        ? this.get('registration')\n        : null;\n      var collectionName = _.findKey(this.coreObjects, function(o) {\n        return o === type || o.indexOf(type) > -1\n      });\n      var stateCollection = _.isArray(state[collectionName]) ? state[collectionName] : [];\n      var newState;\n\n      if (collectionName !== 'course' && collectionName !== 'offlineStorage') {\n        var index = _.findIndex(stateCollection, { _id: model.get('_id') });\n\n        if (index !== -1) {\n          stateCollection.splice(index, 1, modelState);\n        } else {\n          stateCollection.push(modelState);\n        }\n\n        newState = stateCollection;\n      } else {\n        newState = modelState;\n      }\n\n      // Update the locally held state.\n      state[collectionName] = newState;\n      this.set({\n        state: state\n      });\n\n      // Pass the new state to the LRS.\n      this.xapiWrapper.sendState(activityId, actor, collectionName, registration, newState, null, null, function(error, xhr) {\n        if (error) {\n          Adapt.trigger('xapi:lrs:sendState:error', error);\n        }\n\n        Adapt.trigger('xapi:lrs:sendState:success', newState);\n      });\n    },\n\n    /**\n     * Retrieves the state information for the current course.\n     * @param {ErrorOnlyCallback} [callback]\n     */\n    getState: function(callback) {\n      callback = _.isFunction(callback) ? callback : function() { };\n\n      var self = this;\n      var activityId = this.get('activityId');\n      var actor = this.get('actor');\n      var registration = this.get('shouldUseRegistration') === true \n        ? this.get('registration')\n        : null;\n      var state = {};\n\n      Async.each(_.keys(this.coreObjects), function(type, nextType) {\n        self.xapiWrapper.getState(activityId, actor, type, registration, null, function(error, xhr) {\n          _.defer(function() {\n            if (error) {\n              Adapt.log.warn('adapt-contrib-xapi: getState() failed for ' + activityId + ' (' + type + ')');\n              return nextType(error);\n            }\n\n            if (!xhr) {\n              Adapt.log.warn('adapt-contrib-xapi: getState() failed for ' + activityId + ' (' + type + ')');\n              return nextType(new Error('\\'xhr\\' parameter is missing from callback'));\n            }\n\n            if (xhr.status === 404) {\n              return nextType();\n            }\n\n            if (xhr.status !== 200) {\n              Adapt.log.warn('adapt-contrib-xapi: getState() failed for ' + activityId + ' (' + type + ')');\n              return nextType(new Error('Invalid status code ' + xhr.status + ' returned from getState() call'));\n            }\n\n            var response;\n            var parseError;\n\n            // Check for empty response, otherwise the subsequent JSON.parse() will fail.\n            if (xhr.response === '') {\n              return nextType();\n            }\n\n            try {\n              response = JSON.parse(xhr.response);\n            } catch (e) {\n              parseError = e;\n            }\n\n            if (parseError) {\n              return nextType(parseError);\n            }\n\n            if (!_.isEmpty(response)) {\n              state[type] = response;\n            }\n\n            return nextType();\n          });\n        });\n      }, function(error) {\n        if (error) {\n          Adapt.log.error('adapt-contrib-xapi:', error);\n          return callback(error);\n        }\n\n        if (!_.isEmpty(state)) {\n          self.set({ state: state });\n        }\n\n        Adapt.trigger('xapi:stateLoaded');\n\n        callback();\n      });\n    },\n\n    /**\n     * Deletes all state information for the current course.\n     * @param {ErrorOnlyCallback} [callback]\n     */\n    deleteState: function(callback) {\n      callback = _.isFunction(callback) ? callback : function() { };\n\n      var self = this;\n      var activityId = this.get('activityId');\n      var actor = this.get('actor');\n      var registration = this.get('shouldUseRegistration') === true \n        ? this.get('registration')\n        : null;\n \n      Async.each(_.keys(this.coreObjects), function(type, nextType) {\n        self.xapiWrapper.deleteState(activityId, actor, type, registration, null, null, function(error, xhr) {\n          if (error) {\n            Adapt.log.warn('adapt-contrib-xapi: deleteState() failed for ' + activityId + ' (' + type + ')');\n            return nextType(error);\n          }\n\n          if (!xhr) {\n            Adapt.log.warn('adapt-contrib-xapi: deleteState() failed for ' + activityId + ' (' + type + ')');\n            return nextType(new Error('\\'xhr\\' parameter is missing from callback'));\n          }\n\n          if (xhr.status !== 204) {\n            Adapt.log.warn('adapt-contrib-xapi: deleteState() failed for ' + activityId + ' (' + type + ')');\n            return nextType(new Error('Invalid status code ' + xhr.status + ' returned from getState() call'));\n          }\n\n          return nextType();\n        });\n      }, function(error) {\n        if (error) {\n          Adapt.log.error('adapt-contrib-xapi:', error);\n          return callback(error);\n        }\n\n        callback();\n      });\n    },\n\n    /**\n     * Retrieve a config item for the current course, e.g. '_activityID'.\n     * @param {string} key - The data attribute to fetch.\n     * @return {object|boolean} The attribute value, or false if not found.\n     */\n    getConfig: function(key) {\n      if (!this.config || key === '' || typeof this.config[key] === 'undefined') {\n        return false;\n      }\n\n      return this.config[key];\n    },\n\n    /**\n     * Retrieve an LRS attribute for the current session, e.g. 'actor'.\n     * @param {string} key - The attribute to fetch.\n     * @return {object|null} the attribute value, or null if not found.\n     */\n    getLRSAttribute: function(key) {\n      if (!this.xapiWrapper || !this.xapiWrapper.lrs || undefined === this.xapiWrapper.lrs[key]) {\n        return null;\n      }\n\n      try {\n        switch(key) {\n          case 'actor': {\n            var actor = JSON.parse(this.xapiWrapper.lrs[key]);\n\n            if (_.isArray(actor.name)) {\n              // Convert the name from an array to a string.\n              actor.name = actor.name[0];\n            }\n\n            if (_.isArray(actor.mbox)) {\n              // Convert mbox from an array to a string.\n              actor.mbox = actor.mbox[0];\n            }\n\n            // If the account is an array, some work will be required.\n            if (_.isArray(actor.account)) {\n              var account = {};\n\n              // Convert 'accountServiceHomePage' to 'homePage'.\n              if (typeof actor.account[0].accountServiceHomePage !== 'undefined') {\n                account.homePage = actor.account[0].accountServiceHomePage;\n              } else if (actor.account[0].homePage !== 'undefined') {\n                account.homePage = actor.account[0].homePage;\n              }\n\n              // Convert 'accountName' to 'name'.\n              if (typeof actor.account[0].accountName !== 'undefined') {\n                account.name = actor.account[0].accountName;\n              } else if (typeof actor.account[0].name !== 'undefined') {\n                account.name = actor.account[0].name;\n              }\n\n              // Out with the old array.\n              delete actor.account;\n\n              // In with the new object.\n              actor.account = account;\n            }\n\n            return actor;\n          }\n          // case 'registration': {\n          //   var registration = this.xapiWrapper.lrs[key];\n          //   if (!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(registration)) {\n          //     // The 'registration' isn't a valid UUID, generate one.\n          //     return ADL.ruuid();\n          //   } else {\n          //     return registration;\n          //   }\n          // }\n          default:\n            return this.xapiWrapper.lrs[key];\n        }\n      } catch (e) {\n        return null;\n      }\n    },\n\n    getLRSExtendedAttribute: function(key) {\n      var extended = this.getLRSAttribute('extended');\n      if (extended == null) {\n        return null;\n      }\n\n      try {\n        if (key === 'definition') {\n          return JSON.parse(extended.definition);\n        }\n\n        return extended[key];\n      } catch (e) {\n        return null;\n      }\n    },\n\n    /**\n     * Checks that the required properties -- actor and activityId -- are defined, and\n     * logs a warning if any of them are not.\n     * @return {boolean} true if the properties are valid, false otherwise.\n     */\n    validateProps: function() {\n      var errorCount = 0;\n\n      if (!this.get('actor') || typeof this.get('actor') !== 'object') {\n        Adapt.log.warn('adapt-contrib-xapi: \"actor\" attribute not found!');\n        errorCount++;\n      }\n\n      if (!this.get('activityId')) {\n        Adapt.log.warn('adapt-contrib-xapi: \"activityId\" attribute not found!');\n        errorCount++;\n      }\n\n      // if (!this.get('registration')) {\n      //   Adapt.log.warn('adapt-contrib-xapi: \"registration\" attribute not found!');\n      // }\n\n      if (errorCount > 0) {\n        return false;\n      }\n\n      return true;\n    },\n\n    /**\n     * Prepares to send a single xAPI statement to the LRS.\n     * @param {ADL.XAPIStatement} statement - A valid ADL.XAPIStatement object.\n     * @param {ADLCallback} [callback]\n     * @param {array} [attachments] - An array of attachments to pass to the LRS.\n     */\n    sendStatement: function(statement, callback, attachments) {\n      callback = _.isFunction(callback) ? callback : function() { };\n\n      if (!statement) {\n        return;\n      }\n\n      Adapt.trigger('xapi:preSendStatement', statement);\n\n      // Allow the trigger above to augment attachments if the attachments\n      // parameter is not set.\n      if (_.isUndefined(attachments) && statement.attachments) {\n        return this.processAttachments(statement, callback);\n      } else {\n        this.onStatementReady(statement, callback, attachments);\n      }\n    },\n\n    /**\n     * Sends statements using the Fetch API in order to make use of the keepalive\n     * feature not available in AJAX requests. This makes the sending of suspended\n     * and terminated statements more reliable.\n     */\n    sendStatementsSync: function(statements) {\n      var lrs = ADL.XAPIWrapper.lrs;\n\n      // Fetch not supported in IE and keepalive/custom headers\n      // not supported for CORS preflight requests so attempt\n      // to send the statement in the usual way\n      if (!window.fetch || this.isCORS(lrs.endpoint)) {\n        return this.sendStatements(statements);\n      }\n\n      var url = lrs.endpoint + 'statements';\n      var credentials = ADL.XAPIWrapper.withCredentials ? 'include' : 'omit';\n      var headers = {\n        'Content-Type': 'application/json',\n        'Authorization': lrs.auth,\n        'X-Experience-API-Version': ADL.XAPIWrapper.xapiVersion\n      };\n\n      // Add extended LMS-specified values to the URL\n      var extended = _.map(lrs.extended, function(value, key) {\n        return key + '=' + encodeURIComponent(value);\n      });\n\n      if (extended.length > 0) {\n        url += (url.indexOf('?') > -1 ? '&' : '?') + extended.join('&');\n      }\n\n      fetch(url, {\n        body: JSON.stringify(statements),\n        cache: 'no-cache',\n        credentials: credentials,\n        headers: headers,\n        mode: 'same-origin',\n        keepalive: true,\n        method: 'POST'\n      }).then(function() {\n        Adapt.trigger('xapi:lrs:sendStatement:success', statements);\n      }).catch(function(error) {\n        Adapt.trigger('xapi:lrs:sendStatement:error', error);\n      })\n    },\n\n    /**\n     * Determine if sending the statement involves a Cross Origin Request\n     * @param {string} url - the lrs endpoint\n     * @returns {boolean}\n     */\n    isCORS: function(url) {\n      var urlparts = url.toLowerCase().match(/^(.+):\\/\\/([^:\\/]*):?(\\d+)?(\\/.*)?$/);\n      var isCORS = (location.protocol.toLowerCase().replace(':', '') !== urlparts[1] || location.hostname.toLowerCase() !== urlparts[2]);\n      if (!isCORS) {\n        var urlPort = (urlparts[3] === null ? (urlparts[1] === 'http' ? '80' : '443') : urlparts[3]);\n        isCORS = (urlPort === location.port);\n      }\n\n      return isCORS;\n    },\n\n    /**\n     * Send an xAPI statement to the LRS once all async operations are complete\n     * @param {ADL.XAPIStatement} statement - A valid ADL.XAPIStatement object.\n     * @param {ADLCallback} [callback]\n     * @param {array} [attachments] - An array of attachments to pass to the LRS.\n     */\n    onStatementReady: function(statement, callback, attachments) {\n      this.xapiWrapper.sendStatement(statement, function(error) {\n        if (error) {\n          Adapt.trigger('xapi:lrs:sendStatement:error', error);\n          return callback(error);\n        }\n\n        Adapt.trigger('xapi:lrs:sendStatement:success', statement);\n        return callback();\n      }, attachments);\n    },\n\n    /**\n     * Process any attachments that have been added to the statement object by\n     * intercepting the send operation at the xapi:preSendStatement trigger\n     * If a url is specified for an attachment then retrieve the text content\n     * and store this instead\n     * @param {ADL.XAPIStatement} statement - A valid ADL.XAPIStatement object.\n     * @param {ADLCallback} [callback]\n     */\n    processAttachments: function(statement, callback) {\n      var attachments = statement.attachments;\n\n      Async.each(attachments, function(attachment, nextAttachment) {\n\n        // First check the attachment for a value\n        if (attachment.value) {\n          nextAttachment();\n        } else if (attachment.url) {\n          // If a url is specified then we need to obtain the string value\n          // Use native xhr so we can set the responseType to 'blob'\n          var xhr = new XMLHttpRequest();\n          xhr.onreadystatechange = function() {\n            if (this.readyState === 4 && this.status === 200) {\n\n              // Use FileReader to retrieve the blob contents as a string\n              var reader = new FileReader();\n              reader.onload = function() {\n\n                // Store the string value in the attachment object and\n                // delete the url property which is no longer needed\n                attachment.value = reader.result;\n                delete attachment.url;\n                nextAttachment()\n              };\n              reader.readAsBinaryString(this.response);\n            }\n          };\n          xhr.open('GET', attachment.url);\n          xhr.responseType = 'blob';\n          xhr.send();\n        } else {\n          Adapt.log.warn('Attachment object contained neither a value or url property.');\n        }\n      }, function() {\n        delete statement.attachments;\n        this.onStatementReady(statement, callback, attachments);\n      }.bind(this));\n    },\n\n    /**\n     * Sends multiple xAPI statements to the LRS.\n     * @param {ADL.XAPIStatement[]} statements - An array of valid ADL.XAPIStatement objects.\n     * @param {ErrorOnlyCallback} [callback]\n     */\n    sendStatements: function(statements, callback) {\n      callback = _.isFunction(callback) ? callback : function() { };\n\n      if (!statements || statements.length === 0) {\n        return;\n      }\n\n      Adapt.trigger('xapi:preSendStatements', statements);\n\n      // Rather than calling the wrapper's sendStatements() function, iterate\n      // over each statement and call sendStatement().\n      Async.each(statements, function(statement, nextStatement) {\n        this.sendStatement(statement, nextStatement);\n      }.bind(this), function(error) {\n        if (error) {\n          Adapt.log.error('adapt-contrib-xapi:', error);\n          return callback(error);\n        }\n\n        callback();\n      });\n    },\n\n    getGlobals: function() {\n      return _.defaults(\n        (\n          Adapt &&\n          Adapt.course &&\n          Adapt.course.get('_globals') &&\n          Adapt.course.get('_globals')._extensions &&\n          Adapt.course.get('_globals')._extensions._xapi\n        ) || {},\n        {\n          'confirm': 'OK',\n          'lrsConnectionErrorTitle': 'LRS not available',\n          'lrsConnectionErrorMessage': 'We were unable to connect to your Learning Record Store (LRS). This means that your progress cannot be recorded.'\n        }\n      );\n    },\n\n    showError: function() {\n      if (this.getConfig('_lrsFailureBehaviour') === 'ignore') {\n        return;\n      }\n\n      var notifyObject = {\n        title: this.getGlobals().lrsConnectionErrorTitle,\n        body: this.getGlobals().lrsConnectionErrorMessage,\n        confirmText: this.getGlobals().confirm\n      };\n\n      // Setup wait so that notify does not get dismissed when the page loads\n      Adapt.wait.begin();\n      Adapt.trigger('notify:alert', notifyObject);\n      // Ensure notify appears on top of the loading screen\n      $('.notify').css({ position: 'relative', zIndex: 5001 });\n      Adapt.once('notify:closed', Adapt.wait.end);\n    }\n  });\n\n  xAPI.getInstance = function() {\n    if (!xAPI.instance) {\n      xAPI.instance = new xAPI();\n    }\n\n    return xAPI.instance;\n  };\n\n  /** Adapt event listeners begin here */\n  Adapt.once('app:dataLoaded', function() {\n    var xapi = xAPI.getInstance();\n\n    xapi.initialize();\n\n    Adapt.on('adapt:initialize', function() {\n      xapi.setupListeners();\n    });\n\n    Adapt.on('xapi:lrs:initialize:error', function(error) {\n      Adapt.log.error('adapt-contrib-xapi: xAPI Wrapper initialisation failed', error);\n      xapi.showError();\n    });\n\n    Adapt.on('xapi:lrs:sendStatement:error', function(error) {\n      xapi.showError();\n    });\n\n    Adapt.on('xapi:lrs:sendState:error', function(error) {\n      xapi.showError();\n    });\n  });\n\n  return xAPI.getInstance();\n});\n","define([\n  'core/js/adapt',\n  './adapt-contrib-xapi'\n], function(Adapt, xapi) {\n\n  //xAPI handler for Adapt.offlineStorage interface.\n  var offlineStorage = {\n\n    load: function() {\n      // Use a lightweight fake model to pass into xAPI.sendState\n      var fakeModel = {\n        get: function() {\n          return 'offlineStorage';\n        }\n      };\n\n      var store = new Backbone.Model();\n      var isDataRestored = false;\n\n      Adapt.offlineStorage.initialize({\n\n        get: function(name) {\n          if (!name) {\n            return this.getAll();\n          }\n\n          if (!this.useTemporaryStore() && name.toLowerCase() === 'learnerinfo') {\n            return this.getLearnerInfo();\n          }\n\n          return store.get(name);\n        },\n\n        getAll: function() {\n          if (!isDataRestored) {\n            var state = xapi.get('state') || {};\n            store.set(state.offlineStorage);\n            isDataRestored = true;\n          }\n\n          //If not connected return just the store.\n          if (this.useTemporaryStore()) {\n            return store.toJSON();\n          }\n\n          return _.extend(store.toJSON(), {\n            learnerInfo: this.getLearnerInfo()\n          });\n        },\n\n        set: function(name, value) {\n          store.set(name, value);\n\n          // xAPI may not yet be initialised so use a soft trigger rather than hard calling xAPI.sendState\n          Adapt.trigger('state:change', fakeModel, store.toJSON());\n        },\n\n        useTemporaryStore: function() {\n          return !xapi.get('isInitialised');\n        },\n\n        /**\n         * @returns {{id: string, name: string, firstname: string, lastname: string}} The learner's id, full name (in the format Firstname Lastname), first and last names\n         */\n        getLearnerInfo: function() {\n          var actor = xapi.get('actor') || {};\n          var name = actor.name || '';\n          var lastname;\n          var firstname;\n          var matches = name.match(/(\\S+)\\s(.+)/);\n\n          if (matches && matches.length > 2) {\n            lastname = matches[2];\n            firstname = matches[1];\n          } else {\n            console.log('xAPI: actor name not in \"firstname lastname\" format');\n          }\n\n          return {\n            id: this.getLearnerId(actor),\n            name: name,\n            lastname: lastname,\n            firstname: firstname\n          };\n        },\n\n        /**\n         * Get the learner's id by checking the actor properties in the order 'name', 'openid', 'mbox'\n         * @param {object} actor\n         * @return {string} the learner's unique id\n         */\n        getLearnerId: function(actor) {\n          var name = actor.account && actor.account.name;\n\n          if (name) {\n            return name;\n          }\n\n          if (actor.openid) {\n            return actor.openid;\n          }\n\n          if (typeof actor.mbox === 'string' && actor.mbox.length > 0) {\n            return actor.mbox.replace('mailto:', '')\n          }\n\n          console.log('xAPI: could not determine the learner\\'s ID');\n\n          return null;\n        }\n\n      });\n    }\n\n  };\n\n  return offlineStorage;\n\n});\n","define([\n  'core/js/adapt',\n  './adapt-offlineStorage-xapi',\n  './adapt-contrib-xapi',\n], function(Adapt, offlineStorage) {\n\n  Adapt.on('app:dataLoaded', initialise);\n\n  function initialise() {\n    var config = Adapt.config.get('_xapi') || {};\n\n    if (!config._isEnabled) {\n      return;\n    }\n\n    offlineStorage.load();\n\n    // Wait for offline storage to be restored if _shouldTrackState is enabled\n    var successEvent = config._shouldTrackState ? 'xapi:stateLoaded' : 'xapi:lrs:initialize:success';\n\n    // Ensure that the course still loads if there is a connection error\n    Adapt.once('xapi:lrs:initialize:error ' + successEvent, function() {\n      Adapt.offlineStorage.get();\n      Adapt.offlineStorage.setReadyStatus();\n    });\n  }\n\n});","define(function(require) {\n\n  var Adapt = require('coreJS/adapt');\n\n  var DevtoolsModel = Backbone.Model.extend({\n\n    initialize:function() {\n      var config = Adapt.config.has('_devtools') ? Adapt.config.get('_devtools') : this.getDefaultConfig();\n      this.set(_.extend({\n        '_trickleEnabled':false,\n        '_hintingAvailable':true,\n        '_hintingEnabled':false,\n        '_toggleFeedbackAvailable':true,\n        '_feedbackEnabled':true,\n        '_autoCorrectAvailable':true,\n        '_autoCorrectEnabled':false,\n        '_altTextAvailable':true,\n        '_altTextEnabled':false,\n        '_tutorListener':null,\n        '_unlockAvailable':true,\n        '_unlocked':false,\n        '_toggleBankingAvailable':true,\n        '_traceFocusAvailable':true,\n        '_traceFocusEnabled':false,\n        '_extended':true\n      }, config));\n    },\n\n    getDefaultConfig:function() {\n      return {\n        '_isEnabled':false,\n        '_extended':true\n      };\n    },\n\n    toggleFeedback:function() {\n      this.set('_feedbackEnabled', !this.get('_feedbackEnabled'));\n    },\n\n    toggleHinting:function() {\n      this.set('_hintingEnabled', !this.get('_hintingEnabled'));\n    },\n\n    toggleAutoCorrect:function() {\n      this.set('_autoCorrectEnabled', !this.get('_autoCorrectEnabled'));\n    },\n\n    toggleAltText:function() {\n      this.set('_altTextEnabled', !this.get('_altTextEnabled'));\n    },\n\n    toggleTraceFocus:function() {\n      this.set('_traceFocusEnabled', !this.get('_traceFocusEnabled'));\n    }\n  });\n\n  return DevtoolsModel;\n\n});\n","define(function(require) {\n\n  var Adapt = require('coreJS/adapt');\n\n  var Hinting = _.extend({\n\n    initialize:function() {\n      this.listenTo(Adapt.devtools, 'change:_hintingEnabled', this.toggleHints);\n    },\n\n    toggleHints:function() {\n      var contentObject = Adapt.findById(Adapt.location._currentId);\n      var components = contentObject.findDescendantModels('components');\n      var renderedQuestions = _.filter(components, function(m) {\n        return m.get('_isQuestionType') === true && m.get('_isReady') === true;\n      });\n\n      _.each(renderedQuestions, function(model) {\n        this.setHinting($('.'+model.get('_id')), model, Adapt.devtools.get('_hintingEnabled'));\n      }, this);\n\n      if (Adapt.devtools.get('_hintingEnabled')) this.listenTo(Adapt, 'componentView:postRender', this.onComponentRendered);\n      else this.stopListening(Adapt, 'componentView:postRender');\n    },\n\n    onComponentRendered:function(view, hintingEnabled) {\n      if (view.model.get('_isQuestionType')) this.setHinting(view.$el, view.model);\n    },\n\n    setHinting:function($el, model, hintingEnabled) {\n      switch (model.get('_component')) {\n        case 'mcq':this.setMcqHinting($el, model, hintingEnabled !== false); break;\n        case 'gmcq':this.setGmcqHinting($el, model, hintingEnabled !== false); break;\n        case 'matching':this.setMatchingHinting($el, model, hintingEnabled !== false); break;\n        case 'ppq':this.setPpqHinting($el, model, hintingEnabled !== false); break;\n        case 'slider':this.setSliderHinting($el, model, hintingEnabled !== false); break;\n        case 'textinput':this.setTextInputHinting($el, model, hintingEnabled !== false); break;\n        case 'questionStrip':this.setQuestionStripHinting($el, model, hintingEnabled !== false); break;\n      }\n    },\n\n    setMcqHinting:function($el, model, hintingEnabled) {\n      if (hintingEnabled) {\n        _.each(model.get('_items'), function(item, index) {\n          $el.find('.js-mcq-item').eq(index).addClass(item._shouldBeSelected ? 'hint-is-correct' : 'hint-is-incorrect');\n        });\n      }\n      else {\n        $el.find('.js-mcq-item').removeClass('hint-is-correct hint-is-incorrect');\n      }\n    },\n\n    setGmcqHinting:function($el, model, hintingEnabled) {\n      if (hintingEnabled) {\n        _.each(model.get('_items'), function(item, index) {\n          $el.find('.js-mcq-item').eq(index).addClass(item._shouldBeSelected ? 'hint-is-correct' : 'hint-is-incorrect');\n        });\n      }\n      else {\n        $el.find('.js-mcq-item').removeClass('hint-is-correct hint-is-incorrect');\n      }\n    },\n\n    setMatchingHinting:function($el, model, hintingEnabled) {\n      if (hintingEnabled) {\n        _.each(model.get('_items'), function(item, itemIndex) {\n          var $item = $el.find('.item').eq(itemIndex);\n          var $options = $item.find('.js-dropdown-list-item');\n          _.each(item._options, function(option, optionIndex) {\n            /*if (Modernizr.touch) {*/\n            if (option._isCorrect) $options.eq(optionIndex+1).find('.js-dropdown-list-item-inner').append('<span class=\"hint\"> (correct)</span>');\n            /*}\n            else {\n              $options.eq(optionIndex+1).addClass(option._isCorrect ? 'hintCorrect' : 'hintIncorrect');\n            }*/\n          });\n        });\n      }\n      else {\n        /*if (Modernizr.touch) */\n        $el.find('.js-dropdown-list-item-inner .hint').remove();\n        /*else $el.find('option').removeClass('hintCorrect hintIncorrect');*/\n      }\n    },\n\n    setSliderHinting:function($el, model, hintingEnabled) {\n      if (hintingEnabled) {\n        var correctAnswer = model.get('_correctAnswer');\n        if (correctAnswer) {\n          $el.find('.js-slider-number').addClass('hint-is-incorrect');\n          $el.find('.js-slider-number[data-id=\"'+correctAnswer+'\"]').removeClass('hint-is-incorrect').addClass('hint-is-correct');\n        }\n        else {\n          $el.find('.js-slider-number').addClass('hint-is-incorrect');\n          var bottom = model.get('_correctRange')._bottom;\n          var top = model.get('_correctRange')._top;\n          for (var i = bottom; i <= top; i++)\n          $el.find('.js-slider-number[data-id=\"'+i+'\"]').removeClass('hint-is-incorrect').addClass('hint-is-correct');\n        }\n      }\n      else {\n        $el.find('.js-slider-number').removeClass('hint-is-correct hint-is-incorrect');\n      }\n    },\n\n    setTextInputHinting:function($el, model, hintingEnabled) {\n      if (hintingEnabled) {\n        _.each(model.get('_items'), function(item, index) {\n          if (model.get('_answers')) {\n            // generic answers\n            $el.find('.js-textinput-item').eq(index).find('input').attr('placeholder', model.get('_answers')[index][0]);\n          }\n          else {\n            // specific answers\n            $el.find('.js-textinput-item').eq(index).find('input').attr('placeholder', item._answers[0]);\n          }\n        });\n      }\n      else {\n        _.each(model.get('_items'), function(item, index) {\n          if (model.get('_answers')) {\n            $el.find('.js-textinput-item').eq(index).find('input').attr('placeholder', item.placeholder);\n          }\n        });\n      }\n    },\n\n    // --------------------------------------------------\n    // --------------------------------------------------\n    // NEEDS UPDATING?\n    // --------------------------------------------------\n    // --------------------------------------------------\n    setQuestionStripHinting:function($el, model, hintingEnabled) {\n      if (hintingEnabled) {\n        _.each(model.get('_items'), function(item, itemIndex) {\n          var $item = $el.find('.component-item').eq(itemIndex);\n          var $subItems = $item.find('.qs-strapline-header-inner:not(.qs-noop) .qs-strapline-title-inner');\n          _.each(item._subItems, function(subItem, subItemIndex) {\n            if (subItem._isCorrect) $subItems.eq(subItemIndex).append('<span class=\"hint\"> (correct)</span>');\n          });\n        });\n      }\n      else {\n        $el.find('.qs-strapline-title-inner .hint').remove();\n      }\n    },\n\n    setPpqHinting:function($el, model, hintingEnabled) {console.log('setPpqHinting', hintingEnabled);\n      if (!model.get('_developerMode')) {\n        $el.find('.ppq-correct-zone').toggleClass('display-none', !hintingEnabled);\n        $el.find('.ppq-pinboard').toggleClass('developer-mode', hintingEnabled);\n      }\n    }\n    // --------------------------------------------------\n    // --------------------------------------------------\n\n  }, Backbone.Events);\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    Hinting.initialize();\n  });\n\n  return Hinting;\n\n});\n","define(function(require) {\n\n  function isQuestionSupported(model) {\n    switch (model.get('_component')) {\n      case 'mcq':\n      case 'gmcq':\n      case 'matching':\n      case 'ppq':\n      case 'slider':\n      case 'textinput':\n      case 'questionStrip':return true;\n      default: return false;\n    }\n  }\n\n  return isQuestionSupported;\n\n});\n","define(function(require) {\n\n  var Adapt = require('coreJS/adapt');\n  var ItemsQuestionModel = undefined;\n  var Hinting = require('./hinting');\n  var isQuestionSupported = require('./is-question-supported');\n\n  var AutoAnswer = _.extend({\n\n    mousedownHandlers:[],\n\n    initialize:function() {\n      this.listenTo(Adapt, {\n        'componentView:postRender': this.componentRendered,\n        'remove': this.onRemove\n      });\n    },\n\n    componentRendered:function(view) {\n      if (isQuestionSupported(view.model)) {\n        if (view.buttonsView) {\n          var handler = _.bind(this.onQuestionMouseDown, this, view);\n          view.$el.on('mousedown', handler);\n          this.mousedownHandlers.push({\n            element:view.$el,\n            handler:handler\n          });\n        }\n        else if (Adapt.devtools.get('_debug')) {\n          console.warn('adapt-devtools: could not find submit button on '+view.model.get('_id'));\n        }\n      }\n    },\n\n    onQuestionMouseDown:function(view, e) {\n      // remove hinting if enabled\n      if (Adapt.devtools.get('_hintingEnabled')) Hinting.setHinting(view.$el, view.model, false);\n\n      if ((e.ctrlKey && !e.shiftKey) || Adapt.devtools.get('_autoCorrectEnabled')) {\n        this.answer(view);\n      }\n      else if (e.ctrlKey && e.shiftKey) {\n        this.answer(view, true);\n      }\n    },\n\n    isItemsQuestionModel:function(model) {\n      if (ItemsQuestionModel) {\n        return model instanceof ItemsQuestionModel;\n      } else if (ItemsQuestionModel === null) {\n        return false;\n      }\n\n      if (require.defined('core/js/models/'+'itemsQuestionModel')) {\n        ItemsQuestionModel = require('core/js/models/'+'itemsQuestionModel');\n        return model instanceof ItemsQuestionModel;\n      } else {\n        ItemsQuestionModel = null;\n        return false;\n      }\n    },\n\n    answer:function(view, incorrectly) {\n      if (view.model.get('_isSubmitted')) return;\n\n      if (Adapt.devtools.get('_debug')) {\n        console.log('adapt-devtools: answer '+view.model.get('_id')+(incorrectly === true ? ' incorrectly' : ''));\n      }\n\n      if (incorrectly === true) {\n        switch (view.model.get('_component')) {\n          case 'mcq':this.answerMultipleChoiceIncorrectly(view); break;\n          case 'gmcq':this.answerMultipleChoiceIncorrectly(view, true); break;\n          case 'matching':this.answerMatchingIncorrectly(view); break;\n          case 'ppq':this.answerPpqIncorrectly(view); break;\n          case 'slider':this.answerSliderIncorrectly(view); break;\n          case 'textinput':this.answerTextInputIncorrectly(view); break;\n          case 'questionStrip':this.answerQuestionStripIncorrectly(view); break;\n          default:this.answerUnsupportedIncorrectly(view);\n        }\n      }\n      else {\n        switch (view.model.get('_component')) {\n          case 'mcq':this.answerMultipleChoice(view); break;\n          case 'gmcq':this.answerMultipleChoice(view, true); break;\n          case 'matching':this.answerMatching(view); break;\n          case 'ppq':this.answerPpq(view); break;\n          case 'slider':this.answerSlider(view); break;\n          case 'textinput':this.answerTextInput(view); break;\n          case 'questionStrip':this.answerQuestionStrip(view); break;\n          default:this.answerUnsupported(view);\n        }\n      }\n\n      view.$('.js-btn-action').trigger('click');\n    },\n\n    answerMultipleChoice:function(view, isGraphical) {\n      var items = this.isItemsQuestionModel(view.model) ? view.model.getChildren().toJSON() : view.model.get('_items');\n      var noCorrectOptions = _.where(items, {'_shouldBeSelected':true}).length == 0;\n\n      if (this.isItemsQuestionModel(view.model)) {\n        if (noCorrectOptions) {\n          view.model.getItem(_.random(items.length - 1)).set('_isActive', true);\n        } else {\n          view.model.getChildren().forEach(item => {\n            if (item.get('_shouldBeSelected') && !item.get('_isActive') || !item.get('_shouldBeSelected') && item.get('_isActive')) {\n              item.toggleActive();\n            }\n          })\n        }\n        return;\n      }\n\n      if (noCorrectOptions) {\n        if (_.where(items, {'_isSelected':true}).length == 0) {\n          view.$(isGraphical ? '.js-item-input' : '.js-item-input').eq(_.random(items.length - 1)).trigger('change');\n        }\n      } else {\n        _.each(items, function(item, index) {\n          if (item._shouldBeSelected && !item._isSelected || !item._shouldBeSelected && item._isSelected) {\n            view.$(isGraphical ? '.js-item-input' : '.js-item-input').eq(index).trigger('change');\n          }\n        });\n      }\n    },\n\n    answerMultipleChoiceIncorrectly:function(view, isGraphical) {\n      var model = view.model;\n      var items = this.isItemsQuestionModel(model) ? model.getChildren().toJSON() : model.get('_items');\n      var itemCount = items.length;\n      var selectionStates = _.times(itemCount, function() {return false;});\n      // number of items that should be selected\n      var nShould = _.where(items, {_shouldBeSelected:true}).length;\n      // and number that should not\n      var nShouldNot = itemCount - nShould;\n      // decide how many items to select\n      var nSelect = model.get('_selectable');\n      // decide how many of these should be incorrect\n      var nIncorrect = nShouldNot == 0 ? 0 : _.random(nShould == 1 ? 1 : 0, Math.min(nShouldNot, nSelect));\n      // and how many should be correct\n      var nCorrect = nIncorrect == 0 ? _.random(1, Math.min(nShould - 1, nSelect)) : _.random(0, Math.min(nShould, nSelect - nIncorrect));\n\n      if (itemCount == 1 || nSelect == 0) {\n        console.warn('adapt-devtools: not possible to answer '+model.get('_id')+' incorrectly');\n        return;\n      }\n\n      for (var j = 0; j < nIncorrect; j++) {\n        // start at a random position in items to avoid bias (err is contingency for bad data)\n        for (var k=_.random(itemCount), err=itemCount, found=false; !found && err>=0; k++, err--) {\n          var index = k%itemCount;\n          if (selectionStates[index] === false) {\n            if (!items[index]._shouldBeSelected) selectionStates[index] = found = true;\n          }\n        }\n      }\n      for (var j = 0; j < nCorrect; j++) {\n        // start at a random position in items to avoid bias (err is contingency for bad data)\n        for (var k=_.random(itemCount), err=itemCount, found=false; !found && err>=0; k++, err--) {\n          var index = k%itemCount;\n          if (selectionStates[index] === false) {\n            if (items[index]._shouldBeSelected) selectionStates[index] = found = true;\n          }\n        }\n      }\n\n      if (this.isItemsQuestionModel(view.model)) {\n        view.model.getChildren().forEach((item, index) => {\n          if (selectionStates[index] && !item.get('_isActive') || !selectionStates[index] && item.get('_isActive')) {\n            item.toggleActive();\n          }\n        })\n        return;\n      }\n\n      _.each(items, function(item, index) {\n        if (selectionStates[index] && !item._isSelected || !selectionStates[index] && item._isSelected) {\n          view.$(isGraphical ? '.js-item-input' : '.js-item-input').eq(index).trigger('change');\n        }\n      });\n    },\n\n    answerMatching:function(view) {\n      _.each(view.model.get('_items'), function(item, itemIndex) {\n        var noCorrectOptions = _.where(item._options, {'_isCorrect':true}).length == 0;\n\n        if (noCorrectOptions) {\n          if (!view.dropdowns[itemIndex].getFirstSelectedItem()) {\n            var i = _.random(item._options.length - 1);\n            view.selectValue(itemIndex, i);\n          }\n        } else {\n          _.each(item._options, function(option, optionIndex) {\n            if (option._isCorrect) {\n              view.selectValue(itemIndex, option._index);\n            }\n          });\n        }\n      });\n    },\n\n    answerMatchingIncorrectly:function(view) {\n      var items = view.model.get('_items'), itemCount = items.length, nIncorrect = _.random(1, itemCount);\n      // decide which items to answer incorrectly (minimum one)\n      var selectionStates = _.shuffle(_.times(itemCount, function(i) {return i<nIncorrect;}));\n\n      _.each(items, function(item, itemIndex) {\n        var $select = view.$('select').eq(itemIndex);\n        var $options = $select.find('option');\n        // check if this item is to be answered incorrectly\n        if (selectionStates[itemIndex]) {\n          // start at a random position in options to avoid bias (err is contingency for bad data)\n          for (var count=item._options.length, i=_.random(count), err=count; err>=0; i++, err--)\n          if (!item._options[i%count]._isCorrect) {\n            if (view.selectValue) {\n              var option = item._options[i%count];\n              view.selectValue(itemIndex, option._index);\n            }\n            else if (view.model.setOptionSelected) {\n              var option = item._options[i%count];\n              $select.val(option.text);\n              $select.trigger('change');\n              view.model.setOptionSelected(itemIndex, i%count, true);\n            } else {\n              $options.eq((i%count)+1).prop('selected', true);\n            }\n            return;\n          }\n        }\n        else {\n          _.each(item._options, function(option, optionIndex) {\n            if (option._isCorrect) {\n              if (view.selectValue) {\n                view.selectValue(itemIndex, option._index);\n              }\n              else if (view.model.setOptionSelected) {\n                $select.val(option.text);\n                $select.trigger('change');\n                view.model.setOptionSelected(itemIndex, optionIndex, true);\n              } else {\n                $options.eq(optionIndex+1).prop('selected', true);\n              }\n            }\n          });\n        }\n      });\n    },\n    // --------------------------------------------------\n    // --------------------------------------------------\n\n    answerSlider:function(view) {\n      var correctAnswer = view.model.get('_correctAnswer');\n      if (correctAnswer) {\n        view.$('.js-slider-number[data-id=\"'+correctAnswer+'\"]').trigger('click');\n      }\n      else {\n        var bottom = view.model.get('_correctRange')._bottom;\n        var top = view.model.get('_correctRange')._top;\n        var d = top - bottom;\n        // select from range at random\n        view.$('.js-slider-number[data-id=\"'+(bottom+Math.floor(Math.random()*(d+1)))+'\"]').trigger('click');\n      }\n    },\n\n    answerSliderIncorrectly:function(view) {\n      var correctAnswer = view.model.get('_correctAnswer');\n      var start = view.model.get('_scaleStart'), end = view.model.get('_scaleEnd');\n      var incorrect = _.times(end-start+1, function(i) {return start+i;});\n      if (correctAnswer) {\n        incorrect.splice(correctAnswer-start, 1);\n      }\n      else {\n        var bottom = view.model.get('_correctRange')._bottom;\n        var top = view.model.get('_correctRange')._top;\n        incorrect.splice(bottom-start, top-bottom+1);\n      }\n      view.$('.js-slider-number[data-id=\"'+_.shuffle(incorrect)[0]+'\"]').trigger('click');\n    },\n\n    answerTextInput:function(view) {\n      var answers = view.model.get('_answers');\n      _.each(view.model.get('_items'), function(item, index) {\n        if (answers) view.$('.js-textinput-textbox').eq(index).val(answers[index][0]).trigger('change'); // generic answers\n        else view.$('.js-textinput-textbox').eq(index).val(item._answers[0]).trigger('change'); // specific answers\n      });\n    },\n\n    answerTextInputIncorrectly:function(view) {\n      var items = view.model.get('_items'), itemCount = items.length, nIncorrect = _.random(1, itemCount);\n      // decide which items to answer incorrectly (minimum one)\n      var selectionStates = _.shuffle(_.times(itemCount, function(i) {return i<nIncorrect;}));\n      var answers = view.model.get('_answers');\n      _.each(items, function(item, index) {\n        if (selectionStates[index]) {\n          view.$('.js-textinput-textbox').eq(index).val('***4n 1nc0rr3ct 4nsw3r***').trigger('change'); // probably\n        }\n        else {\n          if (answers) view.$('.js-textinput-textbox').eq(index).val(answers[index][0]).trigger('change');\n          else view.$('.js-textinput-textbox').eq(index).val(item._answers[0]).trigger('change');\n        }\n      });\n    },\n\n    // --------------------------------------------------\n    // --------------------------------------------------\n    // NEEDS UPDATING?\n    // --------------------------------------------------\n    // --------------------------------------------------\n    answerQuestionStrip:function(view) {\n      _.each(view.model.get('_items'), function(item, itemIndex) {\n        _.each(item._subItems, function(subItem, subItemIndex) {\n          if (subItem._isCorrect) view.setStage(itemIndex, subItemIndex, true);\n        });\n      });\n    },\n\n    answerQuestionStripIncorrectly:function(view) {\n      var items = view.model.get('_items'), itemCount = items.length, nIncorrect = _.random(1, itemCount);\n      // decide which items to answer incorrectly (minimum one)\n      var selectionStates = _.shuffle(_.times(itemCount, function(i) {return i<nIncorrect;}));\n\n      _.each(items, function(item, itemIndex) {\n        // check if this item is to be answered incorrectly\n        if (selectionStates[itemIndex]) {\n          // start at a random position in subitems to avoid bias (err is contingency for bad data)\n          for (var count=item._subItems.length, i=_.random(count), err=count; err>=0; i++, err--)\n          if (!item._subItems[i%count]._isCorrect) {\n            view.setStage(itemIndex, i%count, true);\n            return;\n          }\n        }\n        else {\n          _.each(item._subItems, function(subItem, subItemIndex) {\n            if (subItem._isCorrect) view.setStage(itemIndex, subItemIndex, true);\n          });\n        }\n      });\n    },\n\n    answerPpq:function(view) {\n      var model = view.model, items = model.get('_items'), itemCount = items.length;\n      // determine screen size\n      var isDesktop = Adapt.device.screenSize != 'small';\n      // select appropriate pinboard\n      var items = _.pluck(model.get('_items'), isDesktop ? 'desktop' : 'mobile');\n\n      var $pinboard = view.$('.ppq-pinboard');\n      var boardw = $pinboard.width();\n      var boardh = $pinboard.height();\n\n      for (i=0; i < itemCount; i++) {\n        var zone = items[i];\n        var pin = view.getNextUnusedPin();\n        var x = zone.left + zone.width / 2;\n        var y = zone.top + zone.height / 2;\n\n        console.log('using correct position',x+','+y);\n\n        pin.setPosition(x, y);\n\n        pin.$el.css({\n          'left':boardw * x / 100 - pin.$el.width() / 2,\n          'top':boardh * y / 100 - pin.$el.height()\n        });\n      }\n    },\n\n    answerPpqIncorrectly:function(view) {\n      var model = view.model, items = model.get('_items'), itemCount = items.length;\n      // determine screen size\n      var isDesktop = Adapt.device.screenSize != 'small';\n      // select appropriate pinboard\n      var items = _.pluck(model.get('_items'), isDesktop ? 'desktop' : 'mobile');\n      // decide how many items to select\n      var nSelect = _.random(model.get('_minSelection'), model.get('_maxSelection'));\n      // decide how many of these should be incorrect\n      var nIncorrect = _.random(1, nSelect);\n      // and how many should be correct\n      var nCorrect = nSelect - nIncorrect;\n\n      var $pinboard = view.$('.ppq-pinboard');\n      var boardw = $pinboard.width();\n      var boardh = $pinboard.height();\n\n      console.log('nIncorrect=', nIncorrect, 'nCorrect=', nCorrect);\n\n      var maxSize = function(zone) {\n        return zone.left < 1 && zone.top < 1 && zone.width > 9999 && zone.height > 9999;\n      };\n\n      // work with integers for accuracy and simplicity\n      items = _.map(items, function(item) {\n        return {\n          'left':Math.round(item.left * 100),\n          'top':Math.round(item.top * 100),\n          'width':Math.round(item.width * 100),\n          'height':Math.round(item.height * 100)\n        };\n      });\n\n      if (_.some(items, maxSize) || nSelect == 0) {\n        console.warn('adapt-devtools: not possible to answer '+model.get('_id')+' incorrectly');\n        return;\n      }\n\n      view.resetPins();\n\n      // simplified approach for readability; statistically probable that finding pin positions will be extremely quick\n\n      for (var i=0; i < nIncorrect; i++) {\n        var ok = false;\n        var x, y;\n\n        // find a suitable x-coordinate\n        while (!ok) {\n          x = _.random(1, 10000);\n          ok = !_.some(items, function(zone) {\n            return x >= zone.left && x < zone.left + zone.width && zone.top < 1 && zone.height > 9999;\n          });\n        }\n\n        ok = false;\n\n        // find a suitable y-coordinate\n        while (!ok) {\n          y = _.random(1, 10000);\n          ok = !_.some(items, function(zone) {\n            return x >= zone.left && x < zone.left + zone.width && y >= zone.top && y < zone.top + zone.height;\n          });\n        }\n\n        x = x / 100;\n        y = y / 100;\n\n        console.log('using incorrect position',x+','+y);\n\n        var pin = view.getNextUnusedPin();\n\n        pin.setPosition(x, y);\n\n        pin.$el.css({\n          'left':boardw * x / 100 - pin.$el.width() / 2,\n          'top':boardh * y / 100 - pin.$el.height()\n        });\n      }\n\n      // decide in which zones to place a pin\n      var correct = _.shuffle(_.times(itemCount, function(i) {return i;}));\n\n      for (i=0; i < nCorrect; i++) {\n        var zone = items[correct[i]];\n        var pin = view.getNextUnusedPin();\n        var x = zone.left + zone.width / 2;\n        var y = zone.top + zone.height / 2;\n\n        x = x / 100;\n        y = y / 100;\n\n        console.log('using correct position',x+','+y);\n\n        pin.setPosition(x, y);\n\n        pin.$el.css({\n          'left':boardw * x / 100 - pin.$el.width() / 2,\n          'top':boardh * y / 100 - pin.$el.height()\n        });\n      }\n    },\n    // --------------------------------------------------\n    // --------------------------------------------------\n\n    answerUnsupported:function(view) {\n      var model = view.model;\n\n      model.set({\"_isComplete\":true, \"_isInteractionComplete\":true, \"_isCorrect\":true, \"_isSubmitted\":true, \"_score\":1});\n      model.set(\"_attemptsLeft\", Math.max(0, model.get(\"_attempts\") - 1));\n    },\n\n    answerUnsupportedIncorrectly:function(view) {\n      var model = view.model;\n\n      model.set({\"_isComplete\":true, \"_isInteractionComplete\":true, \"_isCorrect\":false, \"_isSubmitted\":true, \"_score\":0});\n      model.set(\"_attemptsLeft\", Math.max(0, model.get(\"_attempts\") - 1));\n    },\n\n    onRemove:function() {\n      this.mousedownHandlers.forEach(tuple => {\n        tuple.element.off('mousedown', tuple.handler);\n      })\n    }\n  }, Backbone.Events);\n\n  Adapt.on('app:dataReady devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    AutoAnswer.initialize();\n  });\n\n  return AutoAnswer;\n\n});\n","define(function(require) {\n\n  var Adapt = require('coreJS/adapt');\n  var AutoAnswer = require('./auto-answer');\n\n  var PassHalfFail = _.extend({\n    syncIterations:1,\n    mouseTarget:null,\n\n    initialize:function() {\n      _.bindAll(this, 'onMouseDown', 'onMouseUp', 'onKeypress', 'onPassHalfFailComplete');\n      this._questionViews = [];\n      this._currentPageId = null;\n      this.listenTo(Adapt, 'pageView:preRender', this.onPagePreRender);\n      this.listenTo(Adapt, 'remove', this.onRemove);\n      $(window).off(\"keypress\", this.onKeypress);\n      $(window).off('mousedown', this.onMouseDown);\n      $(window).off('mouseup', this.onMouseUp);\n      $(window).on(\"keypress\", this.onKeypress);\n      $(window).on('mousedown', this.onMouseDown);\n      $(window).on('mouseup', this.onMouseUp);\n    },\n\n    _completeNonQuestions:function() {\n      var currentModel = Adapt.findById(Adapt.location._currentId);\n      var nonQuestions = _.filter(currentModel.findDescendantModels(\"components\"), function(m) {return m.get('_isQuestionType') !== true;});\n\n      _.each(nonQuestions, function(item) {\n        item.set(\"_isComplete\", true);\n        item.set(\"_isInteractionComplete\", true);\n      });\n    },\n\n    pass:function(callback) {\n      var i = 0, qs = this._questionViews, len = qs.length;\n\n      //this._completeNonQuestions();\n\n      // async to avoid locking up the interface\n      function step() {\n        for (var j=0, count=Math.min(PassHalfFail.syncIterations, len-i); j < count; i++, j++) {\n          AutoAnswer.answer(qs[i]);\n          if (!qs[i].model.get('_isSubmitted')) qs[i].$('.js-btn-action').trigger('click');\n        }\n        i == len ? callback() : setTimeout(step);\n      }\n\n      step();\n    },\n\n    half:function(callback) {\n      var notSubmitted = function(view) {return !view.model.get('_isSubmitted')};\n      var qs = _.shuffle(_.filter(this._questionViews, notSubmitted));\n      var i = 0, len = qs.length;\n\n      //this._completeNonQuestions();\n\n      // async to avoid locking up the interface\n      function step() {\n        for (var j=0, count=Math.min(PassHalfFail.syncIterations, len-i); j < count; i++, j++) {\n          AutoAnswer.answer(qs[i], i % 2 == 0);\n          if (!qs[i].model.get('_isSubmitted')) qs[i].$('.js-btn-action').trigger('click');\n        }\n        i == len ? callback() : setTimeout(step);\n      }\n\n      step();\n    },\n\n    fail:function(callback) {\n      var i = 0, qs = this._questionViews, len = qs.length;\n\n      //this._completeNonQuestions();\n\n      // async to avoid locking up the interface\n      function step() {\n        for (var j=0, count=Math.min(PassHalfFail.syncIterations, len-i); j < count; i++, j++) {\n          AutoAnswer.answer(qs[i], true);\n          if (!qs[i].model.get('_isSubmitted')) qs[i].$('.js-btn-action').trigger('click');\n        }\n        i == len ? callback() : setTimeout(step);\n      }\n\n      step();\n    },\n\n    onPagePreRender:function(view) {\n      this._currentPageId = view.model.get('_id');\n      this.listenTo(Adapt, 'componentView:postRender', this.onComponentRendered);\n    },\n\n    onRemove:function() {\n      this.stopListening(Adapt, 'componentView:postRender', this.onComponentRendered);\n      this._questionViews = [];\n    },\n\n    onComponentRendered:function(view) {\n      // check component is part of current page\n      if (view.model.has('_parentId') && view.model.findAncestor('contentObjects').get('_id') == this._currentPageId) {\n        if (view.model.get('_isQuestionType')) {\n          this._questionViews.push(view);\n        }\n      }\n    },\n\n    onMouseDown:function(e) {\n      if (e.which === 1) this.mouseTarget = e.target;\n    },\n  \n    onMouseUp:function(e) {\n      if (e.which === 1) this.mouseTarget = null;\n    },\n\n    onKeypress:function(e) {\n\t\t\tvar char = String.fromCharCode(e.which).toLowerCase();\n\n\t\t\tvar perform = function(type) {\n\t\t\t\tif (Adapt.devtools.get('_trickleEnabled')) Adapt.trigger(\"trickle:kill\");\n\n\t\t\t\tvar tutorEnabled = Adapt.devtools.get('_feedbackEnabled');\n\n\t\t\t\tif (tutorEnabled) Adapt.devtools.set('_feedbackEnabled', false);\n\n\t\t\t\tif (type == 'pass') this.pass(_.partial(this.onPassHalfFailComplete, tutorEnabled));\n\t\t\t\telse if (type == 'half') this.half(_.partial(this.onPassHalfFailComplete, tutorEnabled));\n\t\t\t\telse this.fail(_.partial(this.onPassHalfFailComplete, tutorEnabled));\n\n\t\t\t\tAdapt.trigger('drawer:closeDrawer');\n\t\t\t}.bind(this);\n\n      if (this.mouseTarget && $('.drawer .devtools').length === 0) {\n        switch (char) {\n          case 'p': return perform('pass');\n          case 'h': return perform('half');\n          case 'f': return perform('fail');\n        }\n      } else {\n        switch (char) {\n          case 'p': return perform('pass');\n          case 'h': return perform('half');\n          case 'f': return perform('fail');\n        }\n      }\n\t\t},\n\n\t\tonPassHalfFailComplete: function(tutorEnabled) {\n\t\t\tconsole.log('onPassHalfFailComplete');\n\n\t\t\tif (tutorEnabled) Adapt.devtools.set('_feedbackEnabled', true);\n\t\t}\n  }, Backbone.Events);\n\n  Adapt.on('app:dataReady devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    PassHalfFail.initialize();\n  });\n\n  return PassHalfFail;\n\n});\n","define([\n  'core/js/adapt',\n  'core/js/router'\n], function(Adapt, Router) {\n\n  var ToggleBanking = {\n\n    initialize: function() {\n      Adapt.articles.each(function(m) {\n        var config = this.getConfig(m);\n        if (m.has('_assessment') && m.get('_assessment')._banks && !m.get('_assessment')._banks._isEnabled) {\n          config._assessmentBankDisabled = true;\n        }\n      }, this);\n    },\n\n    getConfig: function(articleModel) {\n      if (!articleModel.has('_devtools')) articleModel.set('_devtools', {});\n      return articleModel.get('_devtools');\n    },\n\n    getBankedAssessmentsInCurrentPage: function() {\n      var pageModel = Adapt.findById(Adapt.location._currentId);\n      var f = function(m) {\n        var config = this.getConfig(m);\n        if (!config._assessmentBankDisabled &&\n          m.has('_assessment') &&\n          m.get('_assessment')._isEnabled &&\n          m.get('_assessment')._banks._split.length > 1) return true;\n\n        return false;\n      };\n\n      return Adapt.location._contentType === 'menu' ? [] : _.filter(pageModel.findDescendantModels('articles'), f, this);\n    },\n\n    toggle: function() {\n      var bankedAssessments = this.getBankedAssessmentsInCurrentPage();\n      var isBankingEnabled = function(m) { return m.get('_assessment')._banks._isEnabled; };\n      var enable = !_.some(bankedAssessments, isBankingEnabled);\n\n      _.each(bankedAssessments, function(articleModel) {\n        articleModel.get('_assessment')._banks._isEnabled = enable;\n        // set properties to trigger setup of assessment data\n        articleModel.set({\n          _attemptInProgress: false,\n          _isPass: false\n        });\n      });\n\n      // reload page\n      Router.handleId(Adapt.location._currentId);\n    }\n  };\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    ToggleBanking.initialize();\n  });\n\n  return ToggleBanking;\n\n});\n","define([\n  'core/js/adapt',\n  'core/js/router'\n], function(Adapt, Router) {\n\n  var MapView = Backbone.View.extend({\n\n    events: {\n      'click a': 'onLinkClicked'\n    },\n\n    initialize: function() {\n      this.$('html').addClass('has-devtools-map');\n      this._renderIntervalId = setInterval(this._checkRenderInterval.bind(this), 500);\n      this.listenTo(Adapt.components, 'change:_isComplete', this.onModelCompletionChanged);\n      this.listenTo(Adapt.blocks, 'change:_isComplete', this.onModelCompletionChanged);\n      this.listenTo(Adapt.articles, 'change:_isComplete', this.onModelCompletionChanged);\n      this.listenTo(Adapt.contentObjects, 'change:_isComplete', this.onModelCompletionChanged);\n      this.render();\n    },\n\n    render: function() {\n      var data = this.model;\n      // var startTime = new Date().getTime();\n\n      var template = Handlebars.templates.devtoolsMap;\n      this.$('body').html(template(data));\n\n      // console.log('adapt-devtools: map rendered in ' + ((new Date().getTime())-startTime) + ' ms');\n    },\n\n    remove: function() {\n      clearInterval(this._renderIntervalId);\n      this.$('body').html('Course closed!');\n      this.stopListening();\n      return this;\n    },\n\n    _checkRenderInterval: function() {\n      if (this._invalid) {\n        this._invalid = false;\n        this.render();\n      }\n    },\n\n    _getConfig: function(pageModel) {\n      if (!pageModel.has('_devtools')) pageModel.set('_devtools', {});\n      return pageModel.get('_devtools');\n    },\n\n    _disablePageIncompletePrompt: function(pageModel) {\n      var config = this._getConfig(pageModel);\n\n      if (pageModel.has('_pageIncompletePrompt')) {\n        config._pageIncompletePromptExists = true;\n        if (pageModel.get('_pageIncompletePrompt').hasOwnProperty('_isEnabled')) {\n          config._pageIncompletePromptEnabled = pageModel.get('_pageIncompletePrompt')._isEnabled;\n        }\n      } else {\n        config._pageIncompletePromptExists = false;\n        pageModel.set('_pageIncompletePrompt', {});\n      }\n\n      pageModel.get('_pageIncompletePrompt')._isEnabled = false;\n    },\n\n    _restorePageIncompletePrompt: function(pageModel) {\n      var config = this._getConfig(pageModel);\n\n      if (config._pageIncompletePromptExists) {\n        if (config.hasOwnProperty('_pageIncompletePromptEnabled')) pageModel.get('_pageIncompletePrompt')._isEnabled = config._pageIncompletePromptEnabled;\n        else delete pageModel.get('_pageIncompletePrompt')._isEnabled;\n      } else {\n        pageModel.unset('_pageIncompletePrompt');\n      }\n      delete config._pageIncompletePromptExists;\n      delete config._pageIncompletePromptEnabled;\n    },\n\n    onModelCompletionChanged: function() {\n      this.invalidate();\n    },\n\n    onLinkClicked: function(e) {\n      var $target = $(e.currentTarget);\n      var id = $target.attr('href').slice(1);\n      var model = Adapt.findById(id);\n\n      e.preventDefault();\n\n      if (e.ctrlKey && this.el.defaultView) {\n        id = id.replace(/-/g, '');\n        this.el.defaultView[id] = model;\n        this.el.defaultView.console.log('devtools: add property window.' + id + ':');\n        this.el.defaultView.console.log(model);\n      } else if (e.shiftKey) {\n        this.navigateAndDisableTrickle(id);\n      } else {\n        this.navigateAndDisableTrickleUpTo(id);\n      }\n    },\n\n    invalidate: function() {\n      this._invalid = true;\n    },\n\n    /**\n    * Navigate to the element with the given id (or as closely to it as possible). Disable trickle up to the given id.\n    * N.B. because trickle cannot be reliably manipulated in situ we must reload the page. Trickle remains disabled on\n    * affected article(s)|block(s).\n    */\n    navigateAndDisableTrickleUpTo: function(id) {\n      var model = Adapt.findById(id);\n      var pageModel = Adapt.findById(Adapt.location._currentId);\n\n      // first ensure page incomplete prompt won't activate\n      this._disablePageIncompletePrompt(pageModel);\n\n      // now navigate\n\n      if (model._siblings === 'contentObjects') {\n        Backbone.history.navigate('#/id/' + id, { trigger: true });\n      } else {\n        var level = model.get('_type') === 'component' ? model.getParent() : model;\n        var siblings = level.getParent().getChildren(); var sibling = null;\n        // disable trickle on all preceeding article(s)|block(s)\n        for (var i = 0, count = siblings.indexOf(level); i < count; i++) {\n          sibling = siblings.at(i);\n          console.log('disabling trickle on ' + sibling.get('_id'));\n          if (sibling.has('_trickle')) {\n            sibling.get('_trickle')._isEnabled = false;\n          } else {\n            sibling.set('_trickle', { _isEnabled: false });\n          }\n        }\n        // check if already on page\n        if (Adapt.location._currentId === model.findAncestor('contentObjects').get('_id')) {\n          this.listenToOnce(Adapt, 'pageView:ready', function(view) {\n            _.defer(function() {\n              Adapt.scrollTo($('.' + id));\n              this.checkVisibility(id);\n            }.bind(this));\n          });\n          if (Adapt.location._currentId === Adapt.course.get('_id')) Router.handleRoute ? Router.handleRoute() : Router.handleCourse();\n          else Router.handleId(Adapt.location._currentId);\n        } else {\n          this.listenToOnce(Adapt, 'pageView:ready', function() {\n            _.defer(function() {\n              this.checkVisibility(id);\n            }.bind(this));\n          });\n          Backbone.history.navigate('#/id/' + id, { trigger: true });\n        }\n      }\n\n      // restore pageIncompletePrompt config\n      this._restorePageIncompletePrompt(pageModel);\n\n      this.invalidate();\n    },\n\n    /**\n    * Navigate to the element with the given id (or as closely to it as possible). Disable trickle on containing\n    * page temporarily.\n    */\n    navigateAndDisableTrickle: function(id) {\n      var model = Adapt.findById(id);\n      var pageModel = Adapt.findById(Adapt.location._currentId);\n\n      // first ensure page incomplete prompt won't activate\n      this._disablePageIncompletePrompt(pageModel);\n\n      if (model._siblings === 'contentObjects') {\n        Backbone.history.navigate('#/id/' + id, { trigger: true });\n      } else {\n        // if already on page ensure trickle is disabled\n        if (Adapt.location._currentId === model.findAncestor('contentObjects').get('_id')) {\n          Adapt.devtools.set('_trickleEnabled', false);\n          Adapt.scrollTo($('.' + id));\n          this.checkVisibility(id);\n        } else {\n          // pick target model to determine trickle config according to trickle version (2.1 or 2.0.x)\n          var targetModel = Adapt.trickle ? model.findAncestor('contentObjects') : Adapt.course;\n\n          // if necessary disable trickle (until page is ready)\n          if (!targetModel.has('_trickle')) {\n            targetModel.set('_trickle', { _isEnabled: false });\n            this.listenToOnce(Adapt, 'pageView:ready', function() {\n              _.defer(function() {\n                targetModel.get('_trickle')._isEnabled = true;\n                this.checkVisibility(id);\n              }.bind(this));\n            });\n          } else if (targetModel.get('_trickle')._isEnabled) {\n            targetModel.get('_trickle')._isEnabled = false;\n            this.listenToOnce(Adapt, 'pageView:ready', function() {\n              _.defer(function() {\n                targetModel.get('_trickle')._isEnabled = true;\n                this.checkVisibility(id);\n              }.bind(this));\n            });\n          }\n\n          Backbone.history.navigate('#/id/' + id, { trigger: true });\n        }\n      }\n\n      // restore pageIncompletePrompt config\n      this._restorePageIncompletePrompt(pageModel);\n\n      this.invalidate();\n    },\n\n    checkVisibility: function(id) {\n      var model = Adapt.findById(id);\n      if ($('.' + id).is(':visible') || model === Adapt.course) return;\n\n      while (!$('.' + id).is(':visible') && model !== Adapt.course) {\n        model = model.getParent();\n        id = model.get('_id');\n      }\n      console.log('adapt-devtools::checkVisibility scrolling to ancestor ' + id);\n      Adapt.scrollTo($('.' + id));\n    }\n  });\n\n  var CourseMap = _.extend({\n    initialize: function() {\n      this.listenTo(Adapt, 'devtools:mapLoaded', this.onMapLoaded);\n      $(window).on('unload', this.onCourseClosed.bind(this));\n\n      function isMenu(options) {\n        if (this.get('_type') !== 'page') {\n          return options.fn(this);\n        }\n        return options.inverse(this);\n      }\n\n      function eachChild(options) {\n        var ret = '';\n        var children = this.getChildren().models;\n\n        for (var i = 0, j = children.length; i < j; i++) {\n          ret = ret + options.fn(children[i], { data: { index: i, first: i === 0, last: i === j - 1 } });\n        }\n\n        return ret;\n      }\n\n      function getId(options) {\n        const val = this.get('_id') || '';\n        return val.slice(-6);\n      }\n\n      function getProp(prop, options) {\n        return this.get(prop);\n      }\n\n      function isStringEmpty(str) {\n        return !str || (str.trim && str.trim().length === 0) || ($.trim(str).length === 0);\n      }\n\n      function getTitle(options) {\n        var t = this.get('displayTitle');\n        if (isStringEmpty(t)) t = this.get('title');\n        if (isStringEmpty(t)) t = this.get('_id');\n        return t;\n      }\n\n      function when(prop, options) {\n        if (this.get(prop)) {\n          return options.fn(this);\n        } else {\n          return options.inverse(this);\n        }\n      }\n\n      function isTrickled(options) {\n        var trickleConfig = this.get('_trickle');\n        var trickled = false;\n        var isBlock = this.get('_type') === 'block';\n\n        if (trickleConfig) trickled = (isBlock || trickleConfig._onChildren !== true) && trickleConfig._isEnabled;\n        else if (isBlock) {\n          trickleConfig = this.getParent().get('_trickle');\n          if (trickleConfig) trickled = trickleConfig._onChildren && trickleConfig._isEnabled;\n        }\n\n        if (trickled) {\n          return options.fn(this);\n        } else {\n          return options.inverse(this);\n        }\n      }\n\n      Handlebars.registerHelper('isMenu', isMenu);\n      Handlebars.registerHelper('eachChild', eachChild);\n      Handlebars.registerHelper('getId', getId);\n      Handlebars.registerHelper('getProp', getProp);\n      Handlebars.registerHelper('getTitle', getTitle);\n      Handlebars.registerHelper('when', when);\n      Handlebars.registerHelper('isTrickled', isTrickled);\n    },\n\n    open: function() {\n      if (!this.mapWindow) {\n        this.mapWindow = window.open('assets/map.html', 'Map');\n      } else {\n        this.mapWindow.focus();\n      }\n    },\n\n    onMapClosed: function() {\n      console.log('onMapClosed');\n      this.mapWindow = null;\n    },\n\n    onMapLoaded: function(mapWindow) {\n      console.log('onMapLoaded');\n      this.mapWindow = mapWindow;\n      this.mapWindow.focus();\n      $('html', this.mapWindow.document).addClass($('html', window.document).attr('class'));\n      this.mapView = new MapView({ model: Adapt, el: this.mapWindow.document });\n      $(this.mapWindow).on('unload', this.onMapClosed.bind(this));\n    },\n\n    onCourseClosed: function() {\n      if (this.mapView) {\n        this.mapView.remove();\n        // this.mapWindow.close();\n      }\n    }\n  }, Backbone.Events);\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    CourseMap.initialize();\n  });\n\n  return CourseMap;\n\n});\n","define(function(require) {\n\n  var Adapt = require('coreJS/adapt');\n  var AdaptModel = require('coreModels/adaptModel');\n  var QuestionView = require('coreViews/questionView');\n\n  var mouseTarget = null;\n\n  function onMouseDown(e) {\n    if (e.which == 1) mouseTarget = e.target;\n  }\n\n  function onMouseUp(e) {\n    if (e.which == 1) mouseTarget = null;\n  }\n\n  function onKeypress(e) {\n    var char = String.fromCharCode(e.which).toLowerCase();\n\n    if (mouseTarget) {\n      if (char == 'm') {\n        var model = Utils.getModelForElement(mouseTarget);\n\n        if (model) {\n          var id = model.get('_id').replace(/-/g, '');\n          window[id] = model;\n          console.log('devtools: add property window.'+id+':');\n          console.log(model.attributes);\n        }\n      }\n    }\n  }\n\n  function getAdaptCoreVersion() {\n    try {\n      if (Adapt.build && Adapt.build.has('package')) return Adapt.build.get('package').version || \">=v3.0.0\";\n      // v2.2.4-v2.2.5 not possible to distinguish\n      if (typeof AdaptModel.prototype.checkCompletionStatusFor == 'function') return \">=v2.2.3\";\n      if (typeof AdaptModel.prototype.setCompletionStatus == 'function') return \">=v2.0.10\";\n      if (typeof AdaptModel.prototype.checkLocking == 'function') return \"v2.0.9\";\n      if (typeof Adapt.checkingCompletion == 'function') return \"v2.0.8\";\n      if (typeof AdaptModel.prototype.getParents == 'function') return \"v2.0.7\";\n      if ($.a11y && $.a11y.options.hasOwnProperty('isIOSFixesEnabled')) return \"v2.0.5-v2.0.6\";\n      if (Adapt instanceof Backbone.Model) return \"v2.0.4\";\n      if (typeof QuestionView.prototype.recordInteraction == 'function') return \"v2.0.2-v2.0.3\";\n      if (typeof Adapt.findById == 'function') return \"v2.0.0-v2.0.1\";\n      return \"v1.x\";\n    }\n    catch (e) {\n      return 'unknown version';\n    }\n  }\n\n  var Utils = {\n    getModelForElement:function(element) {\n      var $target = $(element);\n\n      if ($target.length == 0) return false;\n\n      var id = $target.parents('[data-adapt-id]').data('adapt-id');\n\n      return !id ? false : Adapt.findById(id);\n    }\n  };\n\n  Adapt.once('adapt:initialize', function() {\n    var str = 'Version of Adapt core detected: '+getAdaptCoreVersion();\n    var horz = getHorzLine();\n\n    console.log(horz+'\\nVersion of Adapt core detected: '+getAdaptCoreVersion()+'\\n'+horz);\n\n    function getHorzLine() {\n      for (var s='', i=0, c=str.length; i<c; i++) s+='*';\n      return s;\n    }\n  });\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    $(window).on(\"keypress\", onKeypress);\n    $(window).on(\"mousedown\", onMouseDown);\n    $(window).on(\"mouseup\", onMouseUp);\n\n    // useful for command-line debugging\n    if (!window.Adapt) window.Adapt = Adapt;\n  });\n\n  return Utils;\n\n});\n","define(function(require) {\n\n  var Adapt = require('coreJS/adapt');\n\n  function onTrickleBegun() {\n    if (!Adapt.devtools.get('_trickleEnabled')) {\n      console.log('Trickle started');\n      Adapt.devtools.set('_trickleEnabled', true);\n      // listen for user request to end trickle\n      Adapt.devtools.once('change:_trickleEnabled', onTrickleChange);\n    }\n  }\n\n  function onTrickleEnded() {\n    console.log('Trickle ended');\n    Adapt.devtools.off('change:_trickleEnabled', onTrickleChange);\n    Adapt.devtools.set('_trickleEnabled', false);\n  }\n\n  function onTrickleChange() {\n    if (!Adapt.devtools.get('_trickleEnabled')) {\n      // user triggered\n      Adapt.trigger('trickle:kill');\n    }\n  }\n\n  function remove() {\n    if (Adapt.devtools.get('_trickleEnabled')) {\n      onTrickleEnded();\n    }\n  }\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    Adapt.on('trickle:interactionInitialize trickle:started', onTrickleBegun);\n    Adapt.on('trickle:kill trickle:finished', onTrickleEnded);\n    Adapt.on('remove', remove);\n  });\n\n});\n","define(function(require) {\n\n  var Adapt = require('coreJS/adapt');\n\n  function onShowFeedback() {\n    // trickle waits for tutor to close so pretend that this happens\n    //Adapt.trigger('tutor:opened'); trickle-tutorPlugin doesn't actually listen to this(!)\n    Adapt.trigger('tutor:closed');\n  }\n\n  function hushTutor() {\n    Adapt.devtools.set('_tutorListener', Adapt._events['questionView:showFeedback'].pop());\n    Adapt.on('questionView:showFeedback', onShowFeedback);\n  }\n\n  function reinstateTutor() {\n    Adapt.off('questionView:showFeedback', onShowFeedback);\n\n    if (!Adapt._events.hasOwnProperty('questionView:showFeedback')) {\n      Adapt._events['questionView:showFeedback'] = [];\n    }\n\n    Adapt._events['questionView:showFeedback'].push(Adapt.devtools.get('_tutorListener'));\n  }\n\n  function onFeedbackToggled() {\n    if (Adapt.devtools.get('_feedbackEnabled')) {\n      reinstateTutor();\n      $(document).off('mouseup', '.js-btn-feedback');\n    }\n    else {\n      hushTutor();\n      $(document).on('mouseup', '.js-btn-feedback', onFeedbackButtonClicked);\n    }\n  }\n\n  function onFeedbackButtonClicked(e) {\n    var classes = $(e.currentTarget).parents('.component').attr('class');\n    var componentId = /[\\s]+(c\\-[^\\s]+)/.exec(classes)[1];\n\n    if (componentId) {\n      // bring tutor back temporarily\n      reinstateTutor();\n      // tutor expects a view, but it's not actually needed\n      Adapt.trigger('questionView:showFeedback', {model:Adapt.findById(componentId)});\n      // and hush it again\n      hushTutor();\n    }\n    else console.error('devtools:onFeedbackButtonClicked: malformed component class name');\n  }\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    if (Adapt.devtools.get('_toggleFeedbackAvailable')) {\n      // assume single registrant is adapt-contrib-tutor\n      if (Adapt._events.hasOwnProperty('questionView:showFeedback') && Adapt._events['questionView:showFeedback'].length == 1) {\n        Adapt.devtools.on('change:_feedbackEnabled', onFeedbackToggled);\n      }\n      else {\n        console.warn('devtools: no tutor or multiple registrants of questionView:showFeedback so disabling ability to toggle feedback.');\n        Adapt.devtools.set('_toggleFeedbackAvailable', false);\n      }\n    }\n  });\n\n});\n","define(function(require) {\n\n  var Adapt = require('coreJS/adapt');\n\n  var AltText = _.extend({\n\n    initialize:function() {\n      this.listenTo(Adapt.devtools, 'change:_altTextEnabled', this.toggleAltText);\n\n      // if available we can use to avoid unnecessary checks\n      if (typeof MutationObserver == 'function') {\n        this.observer = new MutationObserver(_.bind(this.onDomMutation, this));\n      }\n    },\n\n    addTimer:function(fireNow) {\n      this.timerId = setInterval(_.bind(this.onTimer, this), 1000);\n      if (fireNow) this.onTimer();\n    },\n\n    removeTimer:function() {\n      clearInterval(this.timerId);\n    },\n\n    connectObserver:function() {\n      if (this.observer) this.observer.observe(document.getElementById('wrapper'), {\n        childList: true,\n        subtree:true,\n        attributes:true,\n        attributeFilter:['class', 'style']\n      });\n    },\n\n    disconnectObserver:function() {\n      if (this.observer) this.observer.disconnect();\n    },\n\n    toggleAltText:function() {\n      if (Adapt.devtools.get('_altTextEnabled')) {\n        this.addTimer(true);\n        this.connectObserver();\n      }\n      else {\n        this.removeTimer();\n        this.removeAllAnnotations();\n        this.disconnectObserver();\n      }\n    },\n\n    addAnnotation:function($img, $annotation) {\n      var template = Handlebars.templates['devtoolsAnnotation'];\n      var text = $img.attr('alt');\n\n      if (!text) text = $img.attr('aria-label');\n\n      var $annotation = $(template({text:text}));\n\n      if (!text) $annotation.addClass('has-annotation-warning');\n\n      $img.after($annotation);\n      $img.data('annotation', $annotation);\n\n      this.updateAnnotation($img, $annotation);\n    },\n\n    removeAnnotation:function($img, $annotation) {\n      $annotation.remove();\n      $img.removeData('annotation');\n    },\n\n    removeAllAnnotations:function() {\n      $('img').each(_.bind(function(index, element) {\n        var $img = $(element);\n        var $annotation = $img.data('annotation');\n\n        if ($annotation) this.removeAnnotation($img, $annotation);\n      }, this));\n    },\n\n    updateAnnotation:function($img, $annotation) {\n      var position = $img.position();\n      position.left += parseInt($img.css('marginLeft'), 10) + parseInt($img.css('paddingLeft'), 10);\n      position.top += parseInt($img.css('marginTop'), 10) + parseInt($img.css('paddingTop'), 10);\n      $annotation.css(position);\n    },\n\n    onDomMutation:function(mutations) {\n      this.mutated = true;\n    },\n\n    onTimer:function() {\n      if (this.mutated === false) return;\n      if (this.observer) this.mutated = false;\n\n      //console.log('devtools::toggle-alt-text:run check');\n\n      this.disconnectObserver();\n\n      $('img').each(_.bind(function(index, element) {\n        var $img = $(element);\n        var $annotation = $img.data('annotation');\n        var isVisible = $img.is(':visible');\n\n        if (isVisible) {\n          if (!$annotation) this.addAnnotation($img, $annotation);\n          else this.updateAnnotation($img, $annotation);\n        }\n        else if ($annotation) {\n          this.removeAnnotation($img, $annotation);\n        }\n      }, this));\n\n      this.connectObserver();\n    }\n  }, Backbone.Events);\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    AltText.initialize();\n  });\n\n  return AltText;\n\n});\n","define(function(require) {\n\n  var Adapt = require('coreJS/adapt');\n  var Router = require('coreJS/router');\n\n  function breakCoreLocking() {\n    Adapt.course.unset('_lockType');\n\n    breakLocks(Adapt.contentObjects);\n    breakLocks(Adapt.articles);\n    breakLocks(Adapt.blocks);\n\n    function breakLocks(collection) {\n      collection.each(function(model) {\n        model.unset('_lockType');\n        model.unset('_isLocked');\n      });\n    }\n  }\n\n  function onUnlocked() {\n    if (Adapt.devtools.get('_unlocked')) {\n      breakCoreLocking();\n      // reload the page/menu\n      if (Adapt.location._currentId == Adapt.course.get('_id')) Router.handleRoute ? Router.handleRoute() : Router.handleCourse();\n      else Router.handleId(Adapt.location._currentId);\n    }\n  }\n\n  // menu unlock legacy (for courses authored prior to v2.0.9 or which otherwise do not use core locking)\n  function onMenuPreRender(view) {\n    if (Adapt.devtools.get('_unlocked')) {\n      if (Adapt.location._currentId == view.model.get('_id')) {\n        view.model.once('change:_isReady', _.bind(onMenuReady, view));\n        view.model.getChildren().each(function(item) {\n          // first pass: attempt to manipulate commonly employed locking mechanisms\n          if (item.has('_lock')) item.set('_lock', item.get('_lock').length > -1 ? [] : false);\n          if (item._lock) item._lock = item._lock.length > -1 ? [] : false;\n          if (item._locked === true) item._locked = false;\n          if (item._isLocked === true) item._isLocked = false;\n        });\n      }\n    }\n  }\n\n  // menu unlock legacy (for courses authored prior to v2.0.9 or which otherwise do not use core locking)\n  function onMenuReady() {\n    if (Adapt.devtools.get('_unlocked')) {\n      // second pass: attempt to enable clickable elements\n      this.$('a, button').prop('disabled', false).css('pointer-events', 'auto');\n    }\n  }\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    if (Adapt.devtools.get('_unlockAvailable')) {\n      Adapt.devtools.on('change:_unlocked', onUnlocked);\n      Adapt.on('menuView:preRender', onMenuPreRender);\n    }\n  });\n\n});\n","define(function(require) {\n\n  var Adapt = require('coreJS/adapt');\n  var Router = require('coreJS/router');\n\n  var buffer = '';\n  var isMouseDown = false;\n  var hitArea = 100;\n  var coords = {};\n  var topLeftTapHold = false;\n  var topRightTapHold = false;\n  var listenType = 0;\n  var timeoutId;\n  var focusableElements = \"a,button,input,select,textarea,[tabindex],label\";\n\n  function onKeypress(e) {\n    var c = String.fromCharCode(e.which).toLowerCase();\n    buffer += c;\n    if (isMouseDown && c == '5' && !Adapt.devtools.get('_isEnabled')) enable();\n    else processBuffer();\n  }\n\n  function onMouseDown() {\n    isMouseDown = true;\n  }\n\n  function onMouseUp() {\n    isMouseDown = false;\n  }\n\n  function processBuffer() {\n    var blen = buffer.length;\n    if (blen > 100) buffer = buffer.substr(1,100);\n    blen = buffer.length;\n\n    if (buffer.substr( blen - (\"kcheat\").length, (\"kcheat\").length  ) == \"kcheat\") {\n      if (!Adapt.devtools.get('_isEnabled')) enable();\n    }\n  }\n\n  function enable() {\n    removeHooks();\n    Adapt.devtools.set('_isEnabled', true);\n    Adapt.trigger('devtools:enable');\n\n    // reload the menu/page\n    if (Adapt.location._currentId == Adapt.course.get('_id')) Router.handleRoute ? Router.handleRoute() : Router.handleCourse();\n    else Router.handleId(Adapt.location._currentId);\n  }\n\n  function addHooks() {\n    $(window).on(\"keypress\", onKeypress);\n    $(window).on(\"mousedown\", onMouseDown);\n    $(window).on(\"mouseup\", onMouseUp);\n\n    window.kcheat = function() {\n      buffer = \"kcheat\";\n      processBuffer();\n    };\n\n    Router.route('kcheat', 'kcheat', function() {\n      if (window.kcheat) window.kcheat();\n    });\n\n    if (Modernizr.touch) addTouchHook();\n  }\n\n  function removeHooks() {\n    $(window).off(\"keypress\", onKeypress);\n    $(window).off(\"mousedown\", onMouseDown);\n    $(window).off(\"mouseup\", onMouseUp);\n    window.kcheat = undefined;\n    if (Modernizr.touch) removeTouchHook();\n  }\n\n  function addTouchHook() {\n    $('body').on('touchstart', onTouchStart);\n    $('body').on('touchend', onTouchEnd);\n\n    // a11y will stop propagation of event on focusable elements so we need to listen specifically to these\n    $('body').on('touchstart', focusableElements, onTouchStart);\n  }\n\n  function removeTouchHook() {\n    clearTimeout(timeoutId);\n\n    $('body').off('touchstart', onTouchStart);\n    $('body').off('touchend', onTouchEnd);\n    $('body').off('touchstart', focusableElements, onTouchStart);\n  }\n\n  function onTouchStart(event){\n    var touches = event.originalEvent.touches;\n\n    if(touches.length != 1) return;\n\n    coords.x = touches[0].pageX;\n    coords.y = touches[0].pageY;\n\n    if (coords.x >= 0 && coords.x < hitArea && coords.y >= 0 && coords.y < hitArea) {\n      listenType = 1;\n    } else if (coords.x >= $(window).width() - hitArea && coords.x < $(window).width() && coords.y >= 0 && coords.y < hitArea) {\n      listenType = 2;\n    } else {\n      listenType = topLeftTapHold = topRightTapHold = false;\n    }\n\n    if (listenType) {\n      timeoutId = setTimeout(function() {\n        // if finger still held\n        if (listenType) {\n          if (listenType == 1) topLeftTapHold = true;\n          else if (listenType == 2) topRightTapHold = true;\n\n          if (topLeftTapHold && topRightTapHold) {\n            if (window.kcheat) window.kcheat();\n          }\n        }\n      }, 200);\n    }\n  }\n\n  function onTouchEnd(event) {\n    listenType = false;\n    clearTimeout(timeoutId);\n  }\n\n  Adapt.once('adapt:initialize', function() {\n    if (Adapt.devtools.get('_isEnabled')) return;\n\n    // some plugins (e.g. bookmarking) will manipulate the router so defer the call\n    _.defer(function () {addHooks();});\n  });\n\n});\n","define(function(require) {\n\n  var Adapt = require('coreJS/adapt');\n\n  var TraceFocus = _.extend({\n\n    openingTags:new RegExp(\"<[\\\\w-]+((\\\\s+[\\\\w-]+(\\\\s*=\\\\s*(?:\\\".*?\\\"|'.*?'|[^'\\\">\\\\s]+))*)+\\\\s*|\\\\s*)/?>\"),\n    consoleStyle:'background: lightgray; color: blue',\n\n    initialize:function() {\n      this.onFocusIn = _.bind(this.onFocusIn, this);\n\n      this.listenTo(Adapt.devtools, 'change:_traceFocusEnabled', this.toggleTraceFocus);\n\n      this.toggleTraceFocus();\n    },\n\n    toggleTraceFocus:function() {\n      if (Adapt.devtools.get('_traceFocusEnabled')) {\n        $('body').on('focusin', this.onFocusIn);\n      }\n      else {\n        $('body').off('focusin', this.onFocusIn);\n      }\n    },\n\n    onFocusIn:function(e) {\n      if (!$('html').is('.ie, .Edge')) return console.log('%cfocussed', this.consoleStyle, e.target);\n\n      var $el = $(e.target);\n\n      if (!$el[0] || !$el[0].outerHTML) return console.log('focussed: ', e.target);\n\n      var openingTag = this.openingTags.exec($el[0].outerHTML)[0];\n\n      if (openingTag) {\n        // add some context if possible\n        // strip leading whitespace/nbsp and get first line of text\n        var tokens = $el.text().replace(/[\\s\\xA0]*/, '').split(/\\r\\n|\\r|\\n/);\n\n        if (tokens[0]) openingTag = openingTag.slice(0, 20) + '[...]';\n\n        if ($('html').is('.ie8')) {\n          console.log('focussed: ', openingTag, tokens[0]);\n        } else {\n          console.log('focussed: ', openingTag, tokens[0], $el);\n        }\n      } else {\n        console.log('focussed: '+e.target);\n      }\n    }\n  }, Backbone.Events);\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    TraceFocus.initialize();\n  });\n\n  return TraceFocus;\n\n});\n","define([\n  'core/js/adapt',\n  './utils'\n], function(Adapt, Utils) {\n\n  var mouseTarget = null;\n\n  function init() {\n    $(window).on('keypress', onKeypress);\n    $(window).on('mousedown', onMouseDown);\n    $(window).on('mouseup', onMouseUp);\n  }\n\n  function onKeypress(e) {\n    var char = String.fromCharCode(e.which).toLowerCase();\n\n    if (mouseTarget) {\n      switch (char) {\n        case 'c': return complete(mouseTarget);\n        case 'r': return reset(mouseTarget);\n      }\n    }\n  }\n\n  function complete(element) {\n    var model = Utils.getModelForElement(element);\n    if (!model) return;\n\n    function doCompletion(component) {\n      component.set('_isComplete', true);\n    }\n\n    var descendantComponents = model.findDescendantModels('components');\n    if (!descendantComponents || descendantComponents.length === 0) {\n      console.log('devtools: completing', model.get('_id'));\n      doCompletion(model);\n      return;\n    }\n\n    console.log('devtools: completing all components in', model.get('_id'));\n    _.each(descendantComponents, function(model) {\n      doCompletion(model);\n    });\n  }\n\n  function reset(element) {\n    var model = Utils.getModelForElement(element);\n    if (!model) return;\n\n    var descendantComponents = model.findDescendantModels('components');\n    if (!descendantComponents || descendantComponents.length === 0) {\n      console.log('devtools: resetting', model.get('_id'));\n      model.reset(true, true);\n      return;\n    }\n    console.log('devtools: resetting all components in', model.get('_id'));\n    _.each(descendantComponents, function(model) {\n      model.reset(true, true);\n    });\n  }\n\n  function onMouseDown(e) {\n    if (e.which === 1) mouseTarget = e.target;\n  }\n\n  function onMouseUp(e) {\n    if (e.which === 1) mouseTarget = null;\n  }\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    init();\n  });\n\n});\n","/*\n* adapt-devtools\n* License - http://github.com/adaptlearning/adapt_framework/LICENSE\n* Maintainers - Chris Steele <chris.steele@kineo.com>, Oliver Foster <oliver.foster@kineo.com>\n*/\n\ndefine([\n  'core/js/adapt',\n  'core/js/models/adaptModel',\n  './devtools-model',\n  './pass-half-fail',\n  './toggle-banking',\n  './map',\n  './auto-answer',\n  './utils',\n  './end-trickle',\n  './hinting',\n  './toggle-feedback',\n  './toggle-alt-text',\n  './unlock',\n  './enable',\n  './toggle-trace-focus',\n  './toggle-completion'\n], function(Adapt, AdaptModel, DevtoolsModel, PassHalfFail, ToggleBanking, CourseMap) {\n\n  var navigationView;\n\n  var DevtoolsView = Backbone.View.extend({\n\n    className: 'devtools',\n\n    events: {\n      'click .end-trickle': 'onEndTrickle',\n      'change .hinting input': 'onToggleHinting',\n      'change .banking input': 'onToggleBanking',\n      'change .feedback input': 'onToggleFeedback',\n      'change .auto-correct input': 'onToggleAutoCorrect',\n      'change .alt-text input': 'onToggleAltText',\n      'click .unlock': 'onUnlock',\n      'click .open-map': 'onOpenMap',\n      'click .open-spoor-log': 'onOpenSpoorLog',\n      'click .complete-page': 'onCompletePage',\n      'click .complete-menu': 'onCompleteMenu',\n      'click .pass': 'onPassHalfFail',\n      'click .half': 'onPassHalfFail',\n      'click .fail': 'onPassHalfFail',\n      'change .trace-focus input': 'onToggleTraceFocus'\n    },\n\n    initialize: function() {\n      this.render();\n\n      this._checkUnlockVisibility();\n      this._checkSpoorLogVisibility();\n      this._checkTrickleEndVisibility();\n      this._checkBankingVisibility();\n      this._checkFeedbackVisibility();\n      this._checkHintingVisibility();\n      this._checkAutoCorrectVisibility();\n      this._checkAltTextVisibility();\n      this._checkPassHalfFailVisibility();\n      this._checkCompletePageVisibility();\n      this._checkCompleteMenuVisibility();\n      this._checkTraceFocusVisibility();\n    },\n\n    render: function() {\n      var data = Adapt.devtools.toJSON();\n      var template = Handlebars.templates['devtools'];\n      this.$el.html(template(data));\n      return this;\n    },\n\n    /*************************************************/\n    /** ******************* UNLOCK *******************/\n    /*************************************************/\n\n    _checkUnlockVisibility: function() {\n      // check if function available and not already activated\n      if (!Adapt.devtools.get('_unlockAvailable') || Adapt.devtools.get('_unlocked')) this.$('.unlock').addClass('u-display-none');\n      else this.$('.unlock').toggleClass('u-display-none', !this._checkForLocks());\n    },\n\n    _checkForLocks: function() {\n      if (typeof AdaptModel.prototype.checkLocking !== 'function') return Adapt.location._contentType === 'menu';\n\n      var hasLock = function(model) { return model.has('_lockType'); };\n\n      if (hasLock(Adapt.course)) return true;\n      if (Adapt.contentObjects.some(hasLock)) return true;\n      if (Adapt.articles.some(hasLock)) return true;\n      if (Adapt.blocks.some(hasLock)) return true;\n\n      return false;\n    },\n\n    onUnlock: function() {\n      Adapt.devtools.set('_unlocked', true);\n      this._checkUnlockVisibility();\n    },\n\n    /*************************************************/\n    /** ******************** MAP *********************/\n    /*************************************************/\n\n    onOpenMap: function() {\n      CourseMap.open();\n      Adapt.trigger('drawer:closeDrawer');\n    },\n\n    /*************************************************/\n    /** ******************* SPOOR ********************/\n    /*************************************************/\n\n    _checkSpoorLogVisibility: function() {\n      var spoorInstalled = require.defined('extensions/adapt-contrib-spoor/js/adapt-contrib-spoor');\n      if (spoorInstalled) return;\n      this.$('.open-spoor-log').addClass('is-disabled').attr('disabled', 'disabled');\n    },\n\n    onOpenSpoorLog: function() {\n      Adapt.trigger('drawer:closeDrawer');\n      if (Adapt.spoor) {\n        Adapt.spoor.scorm.showDebugWindow();\n        return;\n      }\n      require('extensions/adapt-contrib-spoor/js/scorm').showDebugWindow();\n    },\n\n    /*************************************************/\n    /** ****************** TRICKLE *******************/\n    /*************************************************/\n\n    _checkTrickleEndVisibility: function() {\n      this.$('.end-trickle').toggleClass('u-display-none', !Adapt.devtools.get('_trickleEnabled'));\n    },\n\n    onEndTrickle: function() {\n      Adapt.devtools.set('_trickleEnabled', false);\n      this._checkTrickleEndVisibility();\n    },\n\n    /*************************************************/\n    /** ************* QUESTION BANKING ***************/\n    /*************************************************/\n\n    _checkBankingVisibility: function() {\n      if (!Adapt.devtools.get('_toggleFeedbackAvailable')) {\n        this.$('.banking').addClass('u-display-none');\n        return;\n      }\n\n      var bankedAssessments = ToggleBanking.getBankedAssessmentsInCurrentPage();\n      var isBankingEnabled = function(m) {return m.get('_assessment')._banks._isEnabled;};\n\n      if (bankedAssessments.length > 0) {\n        this.$('.banking').removeClass('u-display-none');\n        this.$('.banking label').toggleClass('is-selected', _.some(bankedAssessments, isBankingEnabled));\n        return;\n      }\n      this.$('.banking').addClass('u-display-none');\n    },\n\n    onToggleBanking: function() {\n      ToggleBanking.toggle();\n      this._checkBankingVisibility();\n    },\n\n    /*************************************************/\n    /** ********* QUESTION FEEDBACK (TUTOR) **********/\n    /*************************************************/\n\n    _checkFeedbackVisibility: function() {\n      if (Adapt.devtools.get('_toggleFeedbackAvailable')) {\n        this.$('.feedback').removeClass('u-display-none');\n        this.$('.feedback label').toggleClass('is-selected', Adapt.devtools.get('_feedbackEnabled'));\n        return;\n      }\n      this.$('.feedback').addClass('u-display-none');\n    },\n\n    onToggleFeedback: function() {\n      Adapt.devtools.toggleFeedback();\n      this._checkFeedbackVisibility();\n    },\n\n    /*************************************************/\n    /** ************* QUESTION HINTING ***************/\n    /*************************************************/\n\n    _checkHintingVisibility: function() {\n      if (Adapt.devtools.get('_hintingAvailable')) {\n        this.$('.hinting').removeClass('u-display-none');\n        this.$('.hinting label').toggleClass('is-selected', Adapt.devtools.get('_hintingEnabled'));\n        return;\n      }\n      this.$('.hinting').addClass('u-display-none');\n    },\n\n    onToggleHinting: function() {\n      Adapt.devtools.toggleHinting();\n      this._checkHintingVisibility();\n    },\n\n    /*************************************************/\n    /** *************** AUTO CORRECT *****************/\n    /*************************************************/\n\n    _checkAutoCorrectVisibility: function() {\n      if (Adapt.devtools.get('_autoCorrectAvailable')) {\n        this.$('.is-toggle.auto-correct').removeClass('u-display-none');\n        this.$('.is-toggle.auto-correct label').toggleClass('is-selected', Adapt.devtools.get('_autoCorrectEnabled'));\n        this.$('.is-tip.auto-correct').toggleClass('u-display-none', Adapt.devtools.get('_autoCorrectEnabled'));\n        return;\n      }\n      this.$('.auto-correct').addClass('u-display-none');\n    },\n\n    onToggleAutoCorrect: function() {\n      Adapt.devtools.toggleAutoCorrect();\n      this._checkAutoCorrectVisibility();\n    },\n\n    /*************************************************/\n    /** ***************** ALT TEXT *******************/\n    /*************************************************/\n\n    _checkAltTextVisibility: function() {\n      if (Adapt.devtools.get('_altTextAvailable')) {\n        this.$('.is-toggle.alt-text').removeClass('u-display-none');\n        this.$('.is-toggle.alt-text label').toggleClass('is-selected', Adapt.devtools.get('_altTextEnabled'));\n        this.$('.is-tip.alt-text').toggleClass('u-display-none', Adapt.devtools.get('_altTextEnabled'));\n        return;\n      }\n      this.$('.alt-text').addClass('u-display-none');\n    },\n\n    onToggleAltText: function() {\n      Adapt.devtools.toggleAltText();\n      this._checkAltTextVisibility();\n    },\n\n    /*************************************************/\n    /** *************** COMPLETE PAGE ****************/\n    /*************************************************/\n\n    _checkCompletePageVisibility: function() {\n      var currentModel = Adapt.findById(Adapt.location._currentId);\n\n      if (currentModel.get('_type') !== 'page') {\n        this.$('.complete-page').addClass('u-display-none');\n        return;\n      }\n\n      var incomplete = currentModel.findDescendantModels('components', { where: { _isInteractionComplete: false } });\n\n      this.$('.complete-page').toggleClass('u-display-none', incomplete.length === 0);\n\n    },\n\n    onCompletePage: function(e) {\n      var currentModel = Adapt.findById(Adapt.location._currentId);\n\n      if (Adapt.devtools.get('_trickleEnabled')) Adapt.trigger('trickle:kill');\n\n      var incomplete = currentModel.findDescendantModels('components', { where: { _isInteractionComplete: false } });\n\n      incomplete.forEach(function(component) {\n        if (component.get('_isQuestionType')) {\n          component.set({\n            _isCorrect: true,\n            _isSubmitted: true,\n            _score: 1\n          });\n          component.set('_attemptsLeft', Math.max(0, component.set('_attempts') - 1));\n        }\n\n        component.set('_isComplete', true);\n        component.set(currentModel.has('_isInteractionsComplete') ? '_isInteractionsComplete' : '_isInteractionComplete', true);\n      });\n\n      Adapt.trigger('drawer:closeDrawer');\n    },\n\n    /*************************************************/\n    /** *************** COMPLETE MENU ****************/\n    /*************************************************/\n\n    _checkCompleteMenuVisibility: function() {\n      var currentModel = Adapt.findById(Adapt.location._currentId);\n\n      if (currentModel.get('_type') !== 'menu' && currentModel.get('_type') !== 'course') {\n        this.$('.complete-menu').addClass('u-display-none');\n        return;\n      }\n\n      var incomplete = currentModel.findDescendantModels('components', { where: { _isComplete: false } });\n\n      this.$('.complete-menu').toggleClass('u-display-none', incomplete.length === 0);\n\n    },\n\n    onCompleteMenu: function(e) {\n      var currentModel = Adapt.findById(Adapt.location._currentId);\n\n      if (Adapt.devtools.get('_trickleEnabled')) Adapt.trigger('trickle:kill');\n\n      var incomplete = currentModel.findDescendantModels('components', { where: { _isComplete: false } });\n      _.invoke(incomplete, 'set', '_isComplete', true);\n\n      Adapt.trigger('drawer:closeDrawer');\n    },\n\n    /************************************************************/\n    /** ***** Similar to original adapt-cheat functionality *****/\n    /************************************************************/\n\n    _checkPassHalfFailVisibility: function() {\n      var currentModel = Adapt.findById(Adapt.location._currentId);\n\n      if (currentModel.get('_type') !== 'page') {\n        this.$('.pass, .half, .fail').addClass('u-display-none');\n        return;\n      }\n\n      var unanswered = currentModel.findDescendantModels('components', { where: { _isQuestionType: true, _isSubmitted: false } });\n\n      if (unanswered.length === 0) this.$('.tip.pass-half-fail').html('');\n      else this.$('.is-tip.pass-half-fail').html('With the '+unanswered.length+' unanswered question(s) in this page do the following:');\n\n      this.$('.pass, .half, .fail').toggleClass('u-display-none', unanswered.length === 0);\n\n    },\n\n    onPassHalfFail: function(e) {\n      if (Adapt.devtools.get('_trickleEnabled')) Adapt.trigger('trickle:kill');\n\n      // potentially large operation so show some feedback\n      $('.js-loading').show();\n\n      var tutorEnabled = Adapt.devtools.get('_feedbackEnabled');\n\n      if (tutorEnabled) Adapt.devtools.set('_feedbackEnabled', false);\n\n      if ($(e.currentTarget).hasClass('pass')) PassHalfFail.pass(this.onPassHalfFailComplete.bind(this, tutorEnabled));\n      else if ($(e.currentTarget).hasClass('half')) PassHalfFail.half(this.onPassHalfFailComplete.bind(this, tutorEnabled));\n      else PassHalfFail.fail(this.onPassHalfFailComplete.bind(this, tutorEnabled));\n\n      Adapt.trigger('drawer:closeDrawer');\n    },\n\n    onPassHalfFailComplete: function(tutorEnabled) {\n      console.log('onPassHalfFailComplete');\n\n      if (tutorEnabled) Adapt.devtools.set('_feedbackEnabled', true);\n\n      $('.js-loading').hide();\n    },\n\n    /*************************************************/\n    /** ***************** EXTENDED *******************/\n    /*************************************************/\n\n    _checkTraceFocusVisibility: function() {\n      if (Adapt.devtools.get('_traceFocusAvailable')) {\n        this.$('.is-toggle.trace-focus').removeClass('u-display-none');\n        this.$('.is-toggle.trace-focus label').toggleClass('is-selected', Adapt.devtools.get('_traceFocusEnabled'));\n        return;\n      }\n      this.$('.trace-focus').addClass('u-display-none');\n    },\n\n    onToggleTraceFocus: function() {\n      Adapt.devtools.toggleTraceFocus();\n      this._checkTraceFocusVisibility();\n    }\n  });\n\n  var DevtoolsNavigationView = Backbone.View.extend({\n\n    initialize: function() {\n      var template = Handlebars.templates.devtoolsNavigation;\n\n      this.$el = $(template());\n\n      $('html').addClass('devtools-enabled').toggleClass('devtools-extended', Adapt.devtools.get('_extended'));\n\n      if (this.$el.is('a') || this.$el.is('button')) this.$el.on('click', this.onDevtoolsClicked.bind(this));\n      else this.$el.find('a, button').on('click', this.onDevtoolsClicked.bind(this));\n\n      // keep drawer item to left of PLP, resources, close button etc\n      this.listenTo(Adapt, 'pageView:postRender menuView:postRender', this.onContentRendered);\n      // ensure render occurs at least once (_isReady will not change to true on menus that exclude content objects)\n      this.listenToOnce(Adapt, 'pageView:postRender menuView:postRender', this.render);\n    },\n\n    render: function() {\n      $('.nav__inner').append(this.$el);\n      return this;\n    },\n\n    remove: function() {\n      this.$el.remove();\n      this.stopListening();\n      return this;\n    },\n\n    deferredRender: function() {\n      _.defer(this.render.bind(this));\n    },\n\n    onContentRendered: function(view) {\n      if (view.model.get('_id') === Adapt.location._currentId) {\n        this.stopListening(view.model, 'change:_isReady', this.deferredRender);\n        this.listenToOnce(view.model, 'change:_isReady', this.deferredRender);\n      }\n    },\n\n    onDevtoolsClicked: function(event) {\n      if (event && event.preventDefault) event.preventDefault();\n      Adapt.drawer.triggerCustomView(new DevtoolsView().$el, false);\n    }\n\n  });\n\n  Adapt.once('courseModel:dataLoaded', function() {\n    Adapt.devtools = new DevtoolsModel();\n  });\n\n  function initNavigationView() {\n    if (!Adapt.devtools.get('_isEnabled')) return;\n\n    if (navigationView) navigationView.remove();\n\n    navigationView = new DevtoolsNavigationView();\n  }\n\n  Adapt.once('adapt:initialize devtools:enable', function() {\n    initNavigationView();\n    Adapt.on('app:languageChanged', initNavigationView);\n  });\n\n});\n","import AdaptView from 'core/js/views/adaptView';\n\nclass MenuItemView extends AdaptView {\n\n  attributes() {\n    return AdaptView.resultExtend('attributes', {\n      'role': 'listitem',\n      'aria-labelledby': this.model.get('_id') + '-heading'\n    }, this);\n  }\n\n  className() {\n    return [\n      'menu-item',\n      this.constructor.className,\n      this.model.get('_id'),\n      this.model.get('_classes'),\n      this.setVisibility(),\n      this.setHidden(),\n      (this.model.get('_isVisited') ? 'is-visited' : ''),\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\n      (this.model.get('_isLocked') ? 'is-locked' : ''),\n      (this.model.get('_isOptional') ? 'is-optional' : '')\n    ].join(' ');\n  }\n\n  preRender() {\n    this.model.checkCompletionStatus();\n    this.model.checkInteractionCompletionStatus();\n  }\n\n  postRender() {\n    this.$el.imageready(this.setReadyStatus.bind(this));\n  }\n\n}\n\nMenuItemView.type = 'menuItem';\n\nexport default MenuItemView;\n","import ContentObjectView from 'core/js/views/contentObjectView';\nimport MenuItemView from 'core/js/views/menuItemView';\n\nclass MenuView extends ContentObjectView {}\n\nObject.assign(MenuView, {\n  /**\n   * TODO:\n   * child view here should not be fixed to the MenuItemView\n   * menus may currently rely on this\n   */\n  childContainer: '.js-children',\n  childView: MenuItemView,\n  type: 'menu',\n  template: 'menu'\n});\n\nexport default MenuView;\n","import MenuItemView from 'core/js/views/menuItemView';\nimport router from 'core/js/router';\n\nclass BoxMenuItemView extends MenuItemView {\n\n  className() {\n    return `${super.className()} boxmenu-item`;\n  }\n\n  events() {\n    return {\n      'click .js-btn-click': 'onClickMenuItemButton'\n    };\n  }\n\n  onClickMenuItemButton(event) {\n    if (event && event.preventDefault) event.preventDefault();\n    if (this.model.get('_isLocked')) return;\n    router.navigateToElement(this.model.get('_id'));\n  }\n}\n\nBoxMenuItemView.template = 'boxMenuItem';\n\nexport default BoxMenuItemView;\n","import MenuItemView from 'core/js/views/menuItemView';\nimport BoxMenuItemView from './BoxMenuItemView';\n\nclass BoxMenuGroupView extends MenuItemView {\n\n  className() {\n    return `${super.className()} boxmenu-group`;\n  }\n\n  postRender() {\n    _.defer(this.addChildren.bind(this));\n    this.$el.imageready(this.setReadyStatus.bind(this));\n    this.$el.parents('.boxmenu__item-container').addClass('has-groups');\n  }\n}\n\nBoxMenuGroupView.template = 'boxMenuGroup';\nBoxMenuGroupView.childContainer = '.js-group-children';\nBoxMenuGroupView.childView = BoxMenuItemView;\n\nexport default BoxMenuGroupView;\n","import Adapt from 'core/js/adapt';\nimport MenuView from 'core/js/views/menuView';\nimport BoxMenuItemView from './BoxMenuItemView';\nimport BoxMenuGroupView from './BoxMenuGroupView';\n\nclass BoxMenuView extends MenuView {\n\n  className() {\n    return `${super.className()} boxmenu`;\n  }\n\n  initialize() {\n    super.initialize();\n    this.setStyles();\n\n    this.listenTo(Adapt, 'device:changed', this.onDeviceResize);\n  }\n\n  onDeviceResize() {\n    this.setStyles();\n  }\n\n  addChildren() {\n    let nthChild = 0;\n    const models = this.model.getChildren().models;\n    const childViews = [];\n    models.forEach(model => {\n      if (!model.get('_isAvailable')) return;\n\n      if (model.get('_isHidden')) {\n        model.set('_isReady', true);\n        return;\n      }\n\n      nthChild++;\n      model.set('_nthChild', nthChild);\n\n      const ChildView = (model.get('_type') === 'menu' && model.get('_boxMenu') && model.get('_boxMenu')._renderAsGroup) ?\n        BoxMenuGroupView :\n        BoxMenuItemView;\n\n      const $parentContainer = this.$(this.constructor.childContainer);\n      const childView = new ChildView({ model });\n\n      childViews.push(childView);\n\n      $parentContainer.append(childView.$el);\n    });\n\n    this.setChildViews(childViews);\n  }\n\n  setStyles() {\n    this.addBackgroundLayer();\n    this.setBackgroundImage();\n    this.setBackgroundStyles();\n    this.processHeader();\n  }\n\n  addBackgroundLayer() {\n    if (this.$el.find(' > .background').length) return;\n    this.$background = $('<div class=\"background\" aria-hidden=\"true\"></div>')\n      .prependTo(this.$el);\n  }\n\n  setBackgroundImage() {\n    const config = this.model.get('_boxMenu');\n    const backgroundImages = config?._backgroundImage;\n    if (!backgroundImages) return;\n    const backgroundImage = backgroundImages[`_${Adapt.device.screenSize}`] ?? backgroundImages._small;\n    this.$el.toggleClass('has-bg-image', Boolean(backgroundImage));\n    this.$background\n      .css('background-image', backgroundImage ? 'url(' + backgroundImage + ')' : '');\n  }\n\n  setBackgroundStyles() {\n    const config = this.model.get('_boxMenu');\n    const styles = config?._backgroundStyles;\n    if (!styles) return;\n    this.$background.css({\n      'background-repeat': styles._backgroundRepeat,\n      'background-size': styles._backgroundSize,\n      'background-position': styles._backgroundPosition\n    });\n  }\n\n  processHeader() {\n    const config = this.model.get('_boxMenu');\n    const header = config?._menuHeader;\n    if (!header) return;\n    const $header = this.$('.menu__header');\n    this.addHeaderBackgroundLayer($header);\n    this.setHeaderBackgroundImage(header, $header);\n    this.setHeaderBackgroundStyles(header, $header);\n    this.setHeaderMinimumHeight(header, $header);\n  }\n\n  addHeaderBackgroundLayer($header) {\n    if ($header.find(' > .background').length) return;\n    this.$headerBackground = $('<div class=\"background\" aria-hidden=\"true\"></div>')\n      .prependTo($header);\n  }\n\n  setHeaderBackgroundImage(config, $header) {\n    const backgroundImages = config._backgroundImage;\n    if (!backgroundImages) return;\n    const backgroundImage = backgroundImages[`_${Adapt.device.screenSize}`] ?? backgroundImages._small;\n    $header.toggleClass('has-bg-image', Boolean(backgroundImage));\n    this.$headerBackground.css('background-image', backgroundImage ? 'url(' + backgroundImage + ')' : '');\n  }\n\n  setHeaderBackgroundStyles(config, $header) {\n    const styles = config._backgroundStyles;\n    if (!styles) return;\n    this.$headerBackground.css({\n      'background-repeat': styles._backgroundRepeat,\n      'background-size': styles._backgroundSize,\n      'background-position': styles._backgroundPosition\n    });\n  }\n\n  setHeaderMinimumHeight(config, $header) {\n    const minimumHeights = config._minimumHeights;\n    if (!minimumHeights) return;\n    const minimumHeight = minimumHeights[`_${Adapt.device.screenSize}`] ?? minimumHeights._small;\n    $header\n      .toggleClass('has-min-height', Boolean(minimumHeight))\n      .css('min-height', minimumHeight ? minimumHeight + 'px' : '');\n  }\n\n}\n\nBoxMenuView.template = 'boxMenu';\n\nexport default BoxMenuView;\n","import Adapt from 'core/js/adapt';\nimport MenuModel from 'core/js/models/menuModel';\nimport BoxMenuView from './BoxMenuView';\n\n// Use as default \"_type\": \"course\" or \"_type\": \"menu\" view.\n// Note: This is necessary to maintain legacy behaviour in the AAT where\n// only one menu is usable per course and the course / menu is assumed to be\n// a core model and use the only installed MenuView.\nAdapt.register('course menu', {\n  view: BoxMenuView\n});\n\n// Use for \"_component\": \"boxMenu\", or \"_view\": \"boxMenu\" and \"_model\": \"boxMenu\"\nAdapt.register('boxMenu', {\n  view: BoxMenuView,\n  model: MenuModel.extend({})\n});\n","define([\n  \"core/js/adapt\"\n], function(Adapt) {\n\n  var ThemeView = Backbone.View.extend({\n\n    className: function() {},\n\n    initialize: function() {\n      this.setStyles();\n\n      this.listenTo(Adapt, {\n        \"device:changed\": this.onDeviceResize,\n        \"remove\": this.remove\n      });\n    },\n\n    onDeviceResize: function() {\n      this.setStyles();\n    },\n\n    remove: function() {\n      Backbone.View.prototype.remove.call(this);\n\n      this.onRemove();\n    },\n\n    setStyles: function() {\n      this.setClasses();\n      this.setBackgroundImage();\n      this.setBackgroundStyles();\n      this.setMinimumHeight();\n      this.setCustomStyles();\n    },\n\n    setClasses: function() {\n      this.$el.addClass(this.className());\n    },\n\n    setBackgroundImage: function() {\n      \n      var backgroundImages = this.model.get(\"_backgroundImage\");\n\n      if (!backgroundImages) return;\n\n      var backgroundImage;\n\n      switch (Adapt.device.screenSize) {\n        case \"large\":\n          backgroundImage = backgroundImages._large;\n          break;\n        case \"medium\":\n          backgroundImage = backgroundImages._medium;\n          break;\n        default:\n          backgroundImage = backgroundImages._small;\n      }\n\n      if (backgroundImage) {\n        this.$el\n          .addClass(\"has-bg-image\")\n          .css(\"background-image\", \"url(\" + backgroundImage + \")\");\n      } else {\n        this.$el\n          .removeClass(\"has-bg-image\")\n          .css(\"background-image\", \"\");\n      }\n    },\n\n    setBackgroundStyles: function () {\n      var styles = this.model.get(\"_backgroundStyles\");\n\n      if (!styles) return;\n\n      this.$el.css({\n        'background-repeat': styles._backgroundRepeat,\n        'background-size': styles._backgroundSize,\n        'background-position': styles._backgroundPosition\n      });\n    },\n\n    setMinimumHeight: function() {\n      var minimumHeights = this.model.get(\"_minimumHeights\");\n\n      if (!minimumHeights) return;\n\n      var minimumHeight;\n\n      switch (Adapt.device.screenSize) {\n        case \"large\":\n          minimumHeight = minimumHeights._large;\n          break;\n        case \"medium\":\n          minimumHeight = minimumHeights._medium;\n          break;\n        default:\n          minimumHeight = minimumHeights._small;\n      }\n\n      if (minimumHeight) {\n        this.$el\n          .addClass(\"has-min-height\")\n          .css(\"min-height\", minimumHeight + \"px\");\n      } else {\n        this.$el\n          .removeClass(\"has-min-height\")\n          .css(\"min-height\", \"\");\n      }\n    },\n\n    setCustomStyles: function() {},\n\n    onRemove: function() {}\n\n  });\n\n  return ThemeView;\n\n});\n","define([\n  './themeView',\n  'core/js/adapt'\n], function(ThemeView, Adapt) {\n\n  var ThemePageView = ThemeView.extend({\n\n    className: function() {},\n\n    setCustomStyles: function() {\n      this.processHeader();\n    },\n\n    processHeader: function() {\n      var header = this.model.get('_pageHeader');\n\n      if (!header) return;\n\n      var $header = this.$('.page__header');\n\n      this.setHeaderBackgroundImage(header, $header);\n      this.setHeaderBackgroundStyles(header, $header);\n      this.setHeaderMinimumHeight(header, $header);\n    },\n\n    setHeaderBackgroundImage: function(config, $header) {\n      var backgroundImages = config._backgroundImage;\n\n      if (!backgroundImages) return;\n\n      var backgroundImage;\n\n      switch (Adapt.device.screenSize) {\n        case \"large\":\n          backgroundImage = backgroundImages._large;\n          break;\n        case \"medium\":\n          backgroundImage = backgroundImages._medium;\n          break;\n        default:\n          backgroundImage = backgroundImages._small;\n      }\n\n      if (backgroundImage) {\n        $header\n          .addClass(\"has-bg-image\")\n          .css(\"background-image\", \"url(\" + backgroundImage + \")\");\n      } else {\n        $header\n          .removeClass(\"has-bg-image\")\n          .css(\"background-image\", \"\");\n      }\n    },\n\n    setHeaderBackgroundStyles: function (config, $header) {\n      var styles = config._backgroundStyles;\n\n      if (!styles) return;\n\n      $header.css({\n        'background-repeat': styles._backgroundRepeat,\n        'background-size': styles._backgroundSize,\n        'background-position': styles._backgroundPosition\n      });\n    },\n\n    setHeaderMinimumHeight: function(config, $header) {\n      var minimumHeights = config._minimumHeights;\n\n      if (!minimumHeights) return;\n\n      var minimumHeight;\n\n      switch (Adapt.device.screenSize) {\n        case \"large\":\n          minimumHeight = minimumHeights._large;\n          break;\n        case \"medium\":\n          minimumHeight = minimumHeights._medium;\n          break;\n        default:\n          minimumHeight = minimumHeights._small;\n      }\n\n      if (minimumHeight) {\n        $header\n          .addClass(\"has-min-height\")\n          .css(\"min-height\", minimumHeight + \"px\");\n      } else {\n        $header\n          .removeClass(\"has-min-height\")\n          .css(\"min-height\", \"\");\n      }\n    },\n\n    onRemove: function() {}\n\n  });\n\n  return ThemePageView;\n\n});\n","define([\n  \"./themeView\",\n  \"core/js/adapt\"\n], function(ThemeView, Adapt) {\n\n  var ThemeArticleView = ThemeView.extend({\n\n    className: function() {},\n\n    setCustomStyles: function() {},\n\n    onRemove: function() {}\n\n  });\n\n  return ThemeArticleView;\n\n});\n","define([\n  \"./themeView\",\n  \"core/js/adapt\"\n], function(ThemeView, Adapt) {\n\n  var ThemeBlockView = ThemeView.extend({\n\n    className: function() {\n      return this.model.get(\"_isDividerBlock\") ? \"is-divider-block\" : \"\";\n    },\n\n    setCustomStyles: function() {},\n\n    onRemove: function() {}\n\n  });\n\n  return ThemeBlockView;\n\n});\n","define([\n  \"core/js/adapt\",\n  \"./themePageView\",\n  \"./themeArticleView\",\n  \"./themeBlockView\",\n  \"./themeView\"\n], function(Adapt, ThemePageView, ThemeArticleView, ThemeBlockView, ThemeView) {\n\n  function onDataReady() {\n    $(\"html\").addClass(Adapt.course.get(\"_courseStyle\"));\n  }\n\n  function onPostRender(view) {\n    var model = view.model;\n    var theme = model.get(\"_odi-generic\");\n\n    if (!theme) return;\n\n    switch (model.get(\"_type\")) {\n      case \"page\":\n        new ThemePageView({ model: new Backbone.Model(theme), el: view.$el });\n        break;\n      case \"article\":\n        new ThemeArticleView({ model: new Backbone.Model(theme), el: view.$el });\n        break;\n      case \"block\":\n        new ThemeBlockView({ model: new Backbone.Model(theme), el: view.$el });\n        break;\n      default:\n        new ThemeView({ model: new Backbone.Model(theme), el: view.$el });\n    }\n  }\n\n  Adapt.on({\n    \"app:dataReady\": onDataReady,\n    \"pageView:postRender articleView:postRender blockView:postRender\": onPostRender\n  });\n});\n","import Adapt from 'core/js/adapt';\nimport device from 'core/js/device';\nimport React, { useRef } from 'react';\nimport { prefixClasses, compile } from 'core/js/reactHelpers';\n\n/**\n * Content header for displayTitle, body, instruction text, etc.\n * instruction and mobileInstruction will switch automatically\n * @param {Object} props\n * @param {string} [props.displayTitle]\n * @param {string} [props.body]\n * @param {string} [props.instruction]\n * @param {string} [props.mobileInstruction]\n * @param {string} [props._type]\n * @param {string} [props._component]\n * @param {string} [props._disableAccessibilityState]\n */\nexport default function Header(props) {\n  // Create references to un-controlled view containers\n  const jsxHeading = useRef(null);\n  const {\n    _id,\n    displayTitle,\n    body,\n    instruction,\n    mobileInstruction,\n    _type,\n    _component,\n    _disableAccessibilityState,\n    _isA11yComponentDescriptionEnabled,\n    classNamePrefixes = [\n      _type && _type.toLowerCase(),\n      _component && _component.toLowerCase()\n    ].filter(Boolean)\n  } = props;\n  const sizedInstruction = (mobileInstruction && device.screenSize !== 'large') ?\n    mobileInstruction :\n    instruction;\n  const _globals = Adapt.course.get('_globals');\n  const ariaRegion = _globals?._components?.[`_${_component}`]?.ariaRegion;\n  const isSet = (displayTitle || body || sizedInstruction);\n  if (!isSet && _isA11yComponentDescriptionEnabled && ariaRegion) {\n    // If no title, displaytitle, body or instruction is specified\n    // Output only the component description\n    return (\n      <div className=\"aria-label\" dangerouslySetInnerHTML={{ __html: compile(ariaRegion) }}>\n      </div>\n    );\n  }\n  if (!isSet) return null;\n  return (\n    <div id={`${_id}-header`} className={prefixClasses(classNamePrefixes, ['__header'])}>\n      <div className={prefixClasses(classNamePrefixes, ['__header-inner'])}>\n        {displayTitle &&\n        <div className={prefixClasses(classNamePrefixes, ['__title'])}>\n\n          {!_disableAccessibilityState &&\n          <div className=\"js-heading\" ref={jsxHeading}></div>\n          }\n\n          <div className={prefixClasses(classNamePrefixes, ['__title-inner'])} aria-hidden={!_disableAccessibilityState} dangerouslySetInnerHTML={{ __html: compile(displayTitle, props) }} >\n          </div>\n\n        </div>\n        }\n\n        {_isA11yComponentDescriptionEnabled && ariaRegion &&\n        <div className=\"aria-label\" dangerouslySetInnerHTML={{ __html: compile(ariaRegion, props) }}>\n        </div>\n        }\n\n        {body &&\n        <div className={prefixClasses(classNamePrefixes, ['__body'])}>\n          <div className={prefixClasses(classNamePrefixes, ['__body-inner'])} dangerouslySetInnerHTML={{ __html: compile(body, props) }}>\n          </div>\n        </div>\n        }\n\n        {sizedInstruction &&\n        <div className={prefixClasses(classNamePrefixes, ['__instruction'])}>\n          <div className={prefixClasses(classNamePrefixes, ['__instruction-inner'])} dangerouslySetInnerHTML={{ __html: compile(sizedInstruction, props) }}>\n          </div>\n        </div>\n        }\n\n      </div>\n    </div>\n  );\n}\n","import device from 'core/js/device';\nimport a11y from 'core/js/a11y';\nimport React from 'react';\nimport { html, classes, prefixClasses } from 'core/js/reactHelpers';\n\n/**\n * Size switching content image\n * @param {Object} props\n * @param {Array} props.classNamePrefixes\n * @param {Array} [props.attributionClassNamePrefixes]\n */\nexport default function Image(props) {\n  const hasMediumSetting = (Object.prototype.hasOwnProperty.call(props, '_medium') || Object.prototype.hasOwnProperty.call(props, 'medium'));\n  const screenSize = hasMediumSetting\n    ? device.screenSize\n    : (device.screenSize === 'large' ? 'large' : 'small');\n  const src = (\n    props[`_${screenSize}`] ||\n    props[`${screenSize}`] ||\n    props._src ||\n    props.src\n  );\n  const hasSource = Boolean(src);\n  if (!hasSource) return null;\n  const attributionClassNamePrefixes = (props.attributionClassNamePrefixes || props.classNamePrefixes);\n  return (\n    <span\n      id={props.id}\n      className={classes([\n        prefixClasses(props.classNamePrefixes, ['__image-container']),\n        props.classes,\n        props.attribution && 'has-attribution'\n      ])}\n    >\n\n      <img\n        className={prefixClasses(props.classNamePrefixes, ['__image'])}\n        src={src}\n        aria-label={a11y.normalize(props.alt)}\n        aria-hidden={!props.alt}\n        loading='eager'\n        aria-describedby={props.longdescription ? props.longDescriptionId : undefined}\n      />\n\n      {props.attribution &&\n      <span className={prefixClasses(attributionClassNamePrefixes, ['__attribution'])}>\n        <span className={prefixClasses(attributionClassNamePrefixes, ['__attribution-inner'])}>\n          {html(props.attribution)}\n        </span>\n      </span>\n      }\n\n    </span>\n  );\n}\n","import React from 'react';\nimport { templates } from 'core/js/reactHelpers';\n\nconst LinkWrapper = ({ href, children, target, className, role }) =>\n  href\n    ? <a href={href} target={target} className={className} role={role}>{children}</a>\n    : children;\n\nexport default function Graphic(props) {\n  const {\n    _id,\n    _isScrollable,\n    _scrollPercent,\n    _graphic,\n    _globals\n  } = props;\n\n  const scrollableProperties = _isScrollable\n    ? {\n      role: 'slider',\n      className: 'component__widget graphic__widget js-graphic-scrollbar',\n      'aria-controls': `graphic__scroll__container__${_id}`,\n      'aria-orientation': 'horizontal',\n      'aria-valuemax': '100',\n      'aria-valuemin': '0',\n      'aria-valuenow': _scrollPercent,\n      'aria-label': Handlebars.compile(_globals._components._graphic.scrollAriaLabel)(props),\n      'aria-describedby': _graphic.longdescription ? `graphic__longdescription__${_id}` : undefined,\n      tabIndex: '0'\n    }\n    : {};\n  return (\n    <div className='component__inner graphic__inner'>\n\n      <templates.header {...props} />\n\n      <div className='component__widget graphic__widget' {...scrollableProperties}>\n\n        <LinkWrapper\n          href = {_graphic._url}\n          target = {_graphic._target}\n          className = 'graphic__link js-graphic-link'\n          role = 'link'\n        >\n\n          <templates.image {..._graphic}\n            aria-hidden={_isScrollable}\n            id={`graphic__scroll__container__${_id}`}\n            longDescriptionId={`graphic__longdescription__${_id}`}\n            classes=\"js-graphic-scroll-container\"\n            classNamePrefixes={[\n              'component',\n              'graphic'\n            ]}\n          />\n\n          {_graphic.longdescription &&\n          <div\n            id={`graphic__longdescription__${_id}`}\n            className=\"graphic__longdescription\"\n          >\n            <div className=\"graphic__longdescription-inner\">\n              {_graphic.longdescription}\n            </div>\n          </div>\n          }\n\n        </LinkWrapper>\n\n      </div>\n\n    </div>\n  );\n}\n","import React from 'react';\nimport { templates, classes } from 'core/js/reactHelpers';\n\nexport default function Matching(props) {\n  const {\n    _isEnabled,\n    _isInteractionComplete,\n    _isCorrect,\n    _shouldShowMarking,\n    _isCorrectAnswerShown,\n    _items,\n    _options,\n    _globals\n  } = props;\n\n  const displayAsCorrect = (_isInteractionComplete && (_isCorrectAnswerShown || _isCorrect));\n\n  return (\n    <div className=\"component__inner matching__inner\">\n\n      <templates.header {...props} />\n\n      <div className={classes([\n        'component__widget matching__widget',\n        !_isEnabled && 'is-disabled',\n        _isInteractionComplete && 'is-complete is-submitted show-user-answer',\n        displayAsCorrect && 'is-correct'\n      ])}>\n\n        {_items.map(({\n          text,\n          _index\n        }, index) => {\n          const activeOption = _options.find(option => (option._itemIndex === _index) && option._isActive);\n          const displayItemAsCorrect = (!_isEnabled && _shouldShowMarking && (_isCorrectAnswerShown || activeOption?._shouldBeSelected));\n          return (\n            <div key={_index} className={classes([\n              'matching-item',\n              'item',\n              `item-${index}`,\n              'js-matching-item',\n              _shouldShowMarking && (displayItemAsCorrect ? 'is-correct' : 'is-incorrect')\n            ])}>\n\n              {text &&\n              <div className=\"matching-item__title\">\n                <div className=\"matching-item__title_inner\" dangerouslySetInnerHTML={{ __html: text }}>\n                </div>\n              </div>\n              }\n\n              <div className=\"matching-item__select-container js-matching-item-select-container\">\n\n                <templates.matchingDropDown {...props} _itemIndex={_index} />\n\n                <div className=\"matching-item__select-state\">\n                  <div className=\"matching-item__select-icon matching-item__select-correct-icon\" aria-label={_globals._accessibility._ariaLabels.correct}>\n                    <div className=\"icon\"></div>\n                  </div>\n                  <div className=\"matching-item__select-icon matching-item__select-incorrect-icon\" aria-label={_globals._accessibility._ariaLabels.incorrect}>\n                    <div className=\"icon\"></div>\n                  </div>\n                </div>\n\n              </div>\n\n            </div>\n          );\n        })}\n\n      </div>\n\n      <div className=\"btn__container\"></div>\n\n    </div>\n  );\n}\n","import React, { useRef, useState, useEffect } from 'react';\nimport { classes } from 'core/js/reactHelpers';\n\nexport default function MatchingDropDown(props) {\n  const button = useRef(null);\n  const list = useRef(null);\n\n  const [ wasOpen, setWasOpen ] = useState(false);\n  const [ isOpen, setIsOpen ] = useState(false);\n  const [ isShown, setIsShown ] = useState(false);\n  const [ blurTimeoutHandle, setBlurTimeoutHandle ] = useState(null);\n  const [ isListOffScreen, setIsListOffScreen ] = useState(false);\n  const [ listHeight, setListHeight ] = useState(null);\n  const [ buttonWidth, setButtonWidth ] = useState(null);\n  const [ buttonOffsetLeft, setButtonOffsetLeft ] = useState(null);\n\n  const onStartInteraction = () => setWasOpen(isOpen);\n\n  const onButtonClick = () => {\n    if (wasOpen || isOpen) {\n      // Click toggle list:\n      // If the list is open and the button is clicked\n      // the blur event will fire first closing the list.\n      // this code is to prevent the list from reopening\n      // in that situation\n      setIsOpen(false);\n      return;\n    }\n    if (blurTimeoutHandle) {\n      clearTimeout(blurTimeoutHandle);\n      setBlurTimeoutHandle(null);\n    }\n    setIsShown(false);\n    setIsOpen(true);\n    setTimeout(() => {\n      const offset = list?.current.getBoundingClientRect();\n      const height = $(list?.current).height();\n      const windowHeight = $(window).height();\n      setIsListOffScreen(offset.top + height > windowHeight);\n      setListHeight(height);\n      setButtonOffsetLeft(button?.current.offsetLeft);\n      setButtonWidth($(button?.current).outerWidth());\n      setIsShown(true);\n      list?.current.focus();\n      scrollToHighlightedListItem();\n    }, 100);\n  };\n\n  const scrollToHighlightedListItem = () => {\n    if (!list?.current) return;\n    const highlighted = $('li[aria-selected]', list.current)[0];\n    if (!highlighted) return;\n    const height = list.current.clientHeight;\n    const pos = highlighted.offsetTop - (height / 2);\n    list.current.scrollTop = pos;\n  };\n\n  const onOptionClicked = event => {\n    const li = $(event.target).closest('li');\n    const optionIndex = $(li).val();\n    const option = options.find(option => option._index === optionIndex);\n    chooseOption(option);\n  };\n\n  const chooseOption = option => {\n    setActiveOption(option._index);\n    button?.current.focus();\n  };\n\n  const onListBlur = () => {\n    if (!isOpen) return;\n    // IE11: Allow option click handler to execute before blur and close list\n    const handleBlur = () => {\n      setIsShown(false);\n      setIsOpen(false);\n    };\n    setBlurTimeoutHandle(setTimeout(handleBlur, 100));\n  };\n\n  /** Force blur if focus is lost from the list without triggering onListBlur */\n  const onDocumentClick = event => {\n    if (!isOpen) return;\n    const parents = [document.activeElement, ...$(document.activeElement).parents().toArray()];\n    if (parents.includes(list?.current)) return;\n    onListBlur(event);\n  };\n\n  /** Accessibility keyboard controls */\n  const KEYCODE = {\n    UP: 38,\n    DOWN: 40,\n    ENTER: 13,\n    SPACE: 32,\n    ESCAPE: 27\n  };\n  const validKeyCodes = Object.values(KEYCODE);\n  const onDocumentKeyDown = event => {\n    if (!isOpen || !validKeyCodes.includes(event.keyCode)) return;\n    switch (event.keyCode) {\n      case KEYCODE.UP: {\n        event.preventDefault();\n        const option = getPreviousOption() || getLastOption();\n        highlightOption(option);\n        break;\n      }\n      case KEYCODE.DOWN: {\n        event.preventDefault();\n        const option = getNextOption() || getFirstOption();\n        highlightOption(option);\n        break;\n      }\n      case KEYCODE.ENTER:\n      case KEYCODE.SPACE:\n        event.preventDefault();\n        chooseOption(highlightedOption);\n        break;\n      case KEYCODE.ESCAPE:\n        event.preventDefault();\n        button?.current.focus();\n    }\n  };\n\n  const getCurrentOptionIndex = () => options.findIndex(option => option === highlightedOption);\n  const getPreviousOption = () => options[getCurrentOptionIndex() - 1];\n  const getLastOption = () => options[options.length - 1];\n  const getNextOption = () => options[getCurrentOptionIndex() + 1];\n  const getFirstOption = () => options[0];\n\n  const highlightOption = option => {\n    setHighlightedOption(option._index);\n    scrollToHighlightedListItem();\n  };\n\n  /** Document event attachment for click and keydown */\n  useEffect(() => {\n    document.addEventListener('click', onDocumentClick, { capture: true });\n    document.addEventListener('keydown', onDocumentKeyDown);\n    return () => {\n      document.removeEventListener('click', onDocumentClick, { capture: true });\n      document.removeEventListener('keydown', onDocumentKeyDown);\n    };\n  }, [onDocumentKeyDown, onDocumentClick]);\n\n  const {\n    _id,\n    _isEnabled,\n    placeholder,\n    _itemIndex,\n    _options,\n    _isCorrectAnswerShown,\n    setActiveOption,\n    setHighlightedOption\n  } = props;\n\n  const options = _options.filter(({ _itemIndex: itemIndex }) => (itemIndex === _itemIndex) || (itemIndex === -1));\n  const activeOption = options.find(option => (option._itemIndex === _itemIndex) && option._isActive) || { text: placeholder };\n  const highlightedOption = options.find(option => (option._itemIndex === _itemIndex) && option._isHighlighted) || { text: placeholder };\n\n  const correctActiveOption = activeOption?._shouldBeSelected\n    ? activeOption\n    : options.find(option => option._shouldBeSelected);\n\n  const displayActiveOption = _isCorrectAnswerShown\n    ? correctActiveOption\n    : activeOption;\n\n  return (\n    <div className=\"dropdown\" disabled={!_isEnabled}>\n\n      <button\n        disabled={!_isEnabled}\n        className={classes([\n          'dropdown__btn js-dropdown-btn',\n          !_isEnabled && 'is-disabled'\n        ])}\n        aria-haspopup=\"listbox\"\n        aria-expanded={isOpen}\n        onMouseDown={onStartInteraction}\n        onTouchStart={onStartInteraction}\n        onClick={onButtonClick}\n        ref={button}>\n\n        <span className=\"dropdown__inner js-dropdown-inner\" dangerouslySetInnerHTML={{ __html: displayActiveOption?.text }}>\n        </span>\n\n        <span className=\"dropdown__icon\">\n          <span className=\"icon\"></span>\n        </span>\n\n      </button>\n\n      <ul\n        className={classes([\n          'dropdown__list js-dropdown-list',\n          !isOpen && 'u-display-none',\n          isOpen && !isShown && 'u-visibility-hidden'\n        ])}\n        style={{\n          top: (!isShown || !isListOffScreen) ? '' : -listHeight,\n          left: buttonOffsetLeft,\n          width: buttonWidth\n        }}\n        role=\"listbox\"\n        tabIndex=\"-1\"\n        onBlur={onListBlur}\n        ref={list}\n        disabled={!_isEnabled}\n        aria-activedescendant={highlightedOption && `dropdown__item__${_id}__${_itemIndex}__${highlightedOption._index}`}\n      >\n\n        {options.map(({\n          displayText,\n          text,\n          _index,\n          _isHighlighted\n        }) => {\n          return <li\n            key={_index}\n            id={`dropdown__item__${_id}__${_itemIndex}__${_index}`}\n            className=\"dropdown-item js-dropdown-list-item\"\n            role=\"option\"\n            text={text}\n            value={_index}\n            aria-selected={_isHighlighted || null}\n            selected={_isHighlighted || null}\n            onClick={onOptionClicked}\n          >\n            <div className=\"dropdown-item__inner js-dropdown-list-item-inner\" dangerouslySetInnerHTML={{ __html: displayText || text }}>\n            </div>\n          </li>;\n        })}\n\n      </ul>\n\n    </div>\n  );\n\n}\n","import Adapt from 'core/js/adapt';\nimport a11y from 'core/js/a11y';\nimport React from 'react';\nimport { templates, classes, compile } from 'core/js/reactHelpers';\n\nexport default function Mcq(props) {\n  const ariaLabels = Adapt.course.get('_globals')._accessibility._ariaLabels;\n\n  const {\n    _id,\n    _isEnabled,\n    _isInteractionComplete,\n    _isCorrect,\n    _isCorrectAnswerShown,\n    _shouldShowMarking,\n    _isRadio,\n    displayTitle,\n    body,\n    instruction,\n    ariaQuestion,\n    onKeyPress,\n    onItemSelect,\n    onItemFocus,\n    onItemBlur\n  } = props;\n\n  return (\n    <div className='component__inner mcq__inner'>\n\n      <templates.header {...props} />\n\n      <div\n        className={classes([\n          'component__widget',\n          'mcq__widget',\n          !_isEnabled && 'is-disabled',\n          _isInteractionComplete && 'is-complete is-submitted show-user-answer',\n          _isCorrect && 'is-correct'\n        ])}\n        role={_isRadio ? 'radiogroup' : 'group'}\n        aria-labelledby={ariaQuestion ? null : (displayTitle || body || instruction) && `${_id}-header`}\n        aria-label={ariaQuestion || null}\n      >\n\n        {props._items.map(({ text, _index, _isActive, _shouldBeSelected, _isHighlighted }, index) =>\n\n          <div\n            className={classes([\n              `mcq-item item-${index}`,\n              _shouldShowMarking && _shouldBeSelected && 'is-correct',\n              _shouldShowMarking && !_shouldBeSelected && 'is-incorrect'\n            ])}\n            key={_index}\n          >\n\n            <input\n              className='mcq-item__input'\n              id={`${_id}-${index}-input`}\n              name={_isRadio ? `${_id}-item` : null}\n              type={_isRadio ? 'radio' : 'checkbox'}\n              disabled={!_isEnabled}\n              defaultChecked={_isActive}\n              aria-label={!_shouldShowMarking ?\n                a11y.normalize(text) :\n                `${_shouldBeSelected ? ariaLabels.correct : ariaLabels.incorrect}, ${_isActive ? ariaLabels.selectedAnswer : ariaLabels.unselectedAnswer}. ${a11y.normalize(text)}`}\n              data-adapt-index={_index}\n              onKeyPress={onKeyPress}\n              onChange={onItemSelect}\n              onFocus={onItemFocus}\n              onBlur={onItemBlur}\n            />\n\n            <label\n              className={classes([\n                'mcq-item__label',\n                !_isEnabled && 'is-disabled',\n                _isHighlighted && 'is-highlighted',\n                (_isCorrectAnswerShown ? _shouldBeSelected : _isActive) && 'is-selected'\n              ])}\n              aria-hidden={true}\n              htmlFor={`${_id}-${index}-input`}\n              data-adapt-index={_index}\n            >\n\n              <span className='mcq-item__state'>\n                <span\n                  className={classes([\n                    'mcq-item__icon',\n                    'mcq-item__answer-icon',\n                    _isRadio ? 'is-radio' : 'is-checkbox'\n                  ])}\n                >\n\n                  <span className='icon'></span>\n\n                </span>\n\n                <span className='mcq-item__icon mcq-item__correct-icon'>\n                  <span className='icon'></span>\n                </span>\n\n                <span className='mcq-item__icon mcq-item__incorrect-icon'>\n                  <span className='icon'></span>\n                </span>\n              </span>\n\n              <span className='mcq-item__text'>\n                <span className='mcq-item__text-inner' dangerouslySetInnerHTML={{ __html: compile(text) }}>\n                </span>\n              </span>\n\n            </label>\n\n          </div>\n        )}\n\n      </div>\n\n      <div className='btn__container'></div>\n\n    </div>\n  );\n}\n","import React from 'react';\nimport { templates } from 'core/js/reactHelpers';\n\nexport default function Text(props) {\n  return (\n    <div className=\"component__inner text__inner\">\n      <templates.header {...props} />\n    </div>\n  );\n}\n","import Adapt from 'core/js/adapt';\nimport React from 'react';\nimport { templates, classes, html, compile } from 'core/js/reactHelpers';\n\nexport default function Gmcq(props) {\n  const ariaLabels = Adapt.course.get('_globals')._accessibility._ariaLabels;\n\n  const {\n    _id,\n    _isEnabled,\n    _isInteractionComplete,\n    _isCorrect,\n    _isCorrectAnswerShown,\n    _canShowMarking,\n    _isRadio,\n    _columns,\n    displayTitle,\n    body,\n    instruction,\n    onKeyPress,\n    onItemSelect,\n    onItemFocus,\n    onItemBlur,\n    isInteractive\n  } = props;\n\n  const screenSize = Adapt.device.screenSize;\n  const shouldShowMarking = !isInteractive() && _canShowMarking;\n\n  return (\n    <div className='component__inner gmcq__inner'>\n\n      <templates.header {...props} />\n\n      <div\n        className={classes([\n          'component__widget',\n          'gmcq__widget',\n          !_isEnabled && 'is-disabled',\n          _isInteractionComplete && 'is-complete is-submitted show-user-answer',\n          _isCorrect && 'is-correct',\n          _columns && screenSize === 'large' && 'has-column-layout'\n        ])}\n        role={_isRadio ? 'radiogroup' : 'group'}\n        aria-labelledby={(displayTitle || body || instruction) && `${_id}-header`}\n      >\n\n        {props._items.map(({ text, _index, _isActive, _shouldBeSelected, _graphic }, index) =>\n\n          <div\n            className={classes([\n              `gmcq__item item-${index}`,\n              (shouldShowMarking && _shouldBeSelected) ? 'is-correct' : null,\n              (shouldShowMarking && !_shouldBeSelected) ? 'is-incorrect' : null\n            ])}\n            style={(_columns && screenSize === 'large') ?\n              { width: `${100 / _columns}%` } :\n              null}\n            key={_index}\n          >\n\n            <input\n              className='gmcq__item-input'\n              id={`${_id}-${index}-input`}\n              name={_isRadio ? `${_id}-item` : null}\n              type={_isRadio ? 'radio' : 'checkbox'}\n              disabled={!_isEnabled}\n              aria-label={!shouldShowMarking ?\n                `${Adapt.a11y.normalize(text)} ${_graphic?.alt || ''}` :\n                `${_shouldBeSelected ? ariaLabels.correct : ariaLabels.incorrect}, ${_isActive ? ariaLabels.selectedAnswer : ariaLabels.unselectedAnswer}. ${Adapt.a11y.normalize(text)} ${_graphic?.alt || ''}`}\n              data-adapt-index={_index}\n              onKeyPress={onKeyPress}\n              onChange={onItemSelect}\n              onFocus={onItemFocus}\n              onBlur={onItemBlur}\n            />\n\n            <label\n              className={classes([\n                'gmcq__item-label',\n                'js-item-label',\n                !_isEnabled && 'is-disabled',\n                (_isCorrectAnswerShown ? _shouldBeSelected : _isActive) && 'is-selected'\n              ])}\n              aria-hidden={true}\n              htmlFor={`${_id}-${index}-input`}\n              data-adapt-index={_index}\n            >\n\n              <templates.image {..._graphic}\n                classNamePrefixes={['gmcq__item']}\n                attributionClassNamePrefixes={['component', 'gmcq']}\n              />\n\n              <div className='gmcq__item-option'>\n\n                <div className='gmcq__item-state'>\n                  <div\n                    className={classes([\n                      'gmcq__item-icon',\n                      'gmcq__item-answer-icon',\n                      _isRadio ? 'is-radio' : 'is-checkbox'\n                    ])}\n                  >\n\n                    <div className='icon'></div>\n\n                  </div>\n\n                  <div className='gmcq__item-icon gmcq__item-correct-icon'>\n                    <div className='icon'></div>\n                  </div>\n\n                  <div className='gmcq__item-icon gmcq__item-incorrect-icon'>\n                    <div className='icon'></div>\n                  </div>\n                </div>\n\n                {text &&\n                <div className='gmcq__item-text'>\n                  <div className='gmcq__item-text-inner'>\n                    {html(compile(text))}\n                  </div>\n                </div>\n                }\n\n              </div>\n\n            </label>\n\n          </div>\n        )}\n\n      </div>\n\n      <div className='btn__container'></div>\n\n    </div>\n  );\n}\n","import Adapt from 'core/js/adapt';\nimport 'core/js/wait';\nimport 'core/js/deprecated.js';\nimport 'core/js/components';\nimport 'core/js/location';\nimport 'core/js/templates';\nimport 'core/js/fixes';\nimport data from 'core/js/data';\nimport 'core/js/offlineStorage';\nimport logging from 'core/js/logging';\nimport 'core/js/tracking';\nimport 'core/js/device';\nimport 'core/js/drawer';\nimport 'core/js/notify';\nimport 'core/js/router';\nimport 'core/js/models/lockingModel';\nimport 'core/js/mpabc';\nimport 'core/js/helpers';\nimport 'core/js/scrolling';\nimport 'core/js/headings';\nimport 'core/js/navigation';\nimport 'core/js/startController';\nimport 'plugins';\n\n$('body').append(Handlebars.templates.loading());\n\ndata.on('ready', () => {\n  logging.debug('Calling Adapt.init');\n  Adapt.init();\n  Adapt.off('adaptCollection:dataLoaded courseModel:dataLoaded');\n}).init();\n"],"names":["Wait","Backbone","Controller","initialize","_waitCount","_callbackHandle","being","begin","bind","end","isWaiting","trigger","clearTimeout","setTimeout","queue","callback","Promise","resolve","once","for","_","defer","wait","LockingModel","Model","set","attrName","attrVal","options","stopProcessing","isLocking","arguments","isSettingValueForSpecificPlugin","pluginName","console","error","defaults","undefined","_lockedAttributes","lockingValue","isAttemptingToLock","setLockState","skipcheck","totalLockValue","getLockCount","setLocking","defaultLockValue","unsetLocking","_lockedAttributesValues","Object","keys","length","isCheckingGeneralLockingState","isUsingLockedAttributes","Boolean","lockedAttributes","result","isAttributeALockingAttribute","hasOwnProperty","isLocked","shouldSkipCheck","isGettingValueForSpecificPlugin","lockingAttributeValues","values","lockingAttributeValuesSum","reduce","sum","value","AdaptSingleton","loadScript","window","__loadScript","_canScroll","_outstandingCompletionChecks","_pluginWaitCount","_isStarted","_shouldDestroyContentObjects","init","addDirection","disableAnimation","deferUntilCompletionChecked","History","started","history","start","checkingCompletion","outstandingChecks","get","checkedCompletion","checkIfAnyChecksOutstanding","model","off","on","isWaitingForPlugins","log","deprecated","checkPluginsReady","parseRelativeString","relativeString","parts","replace","split","filter","parsed","map","part","splitIndex","search","symbol","slice","type","offset","inset","parseInt","trim","defaultDirection","config","$","addClass","attr","disableAnimationArray","i","l","is","toggleClass","remove","currentView","parentView","setOnChildren","_isReady","_isRendered","destroy","a11y","componentStore","data","device","drawer","location","notify","offlineStorage","router","scrolling","startController","store","tracking","navigateToElement","scrollTo","register","name","object","getViewName","getViewClass","getModelName","getModelClass","findById","findViewByModelId","findByTrackingPosition","Adapt","OfflineStorage","handler","ready","_handler","hasHandler","save","serialize","JSON","stringify","deserialize","parse","clear","setReadyStatus","Device","bindAll","bowser","Bowser","navigator","userAgent","$html","$window","touch","Modernizr","touchevents","screenWidth","getScreenWidth","screenHeight","getScreenHeight","setViewportHeight","browser","toLowerCase","version","OS","getOperatingSystem","osVersion","os","renderingEngine","getRenderingEngine","listenTo","onConfigDataLoaded","browserString","getAppleDeviceType","pixelDensity","orientation","aspectRatio","screenSize","checkScreenSize","onWindowResize","screenSizeConfig","screensizeEmThreshold","baseFontSize","mediumEmBreakpoint","medium","smallEmBreakpoint","small","fontSize","parseFloat","css","screenSizeEmWidth","innerWidth","isAppleDevice","getAppleScreenWidth","width","getAppleScreenHeight","innerHeight","height","document","documentElement","style","setProperty","platform","match","engine","hasWindowResized","requestAnimationFrame","calculateResize","previousWidth","previousHeight","newScreenSize","test","MSStream","maxTouchPoints","shouldReportInvertedAppleScreenSize","windowRatio","screenRatio","screen","isWindowPortrait","isScreenPortrait","isDeviceBadlyReportingScreenOrientation","platformType","browserName","isIPhone","isIPad","devicePixelRatio","Location","_previousId","_previousContentType","_previousModel","_previousClasses","_lastVisitedType","_lastVisitedMenu","_lastVisitedPage","_currentId","_currentModel","_currentLocation","_contentType","BrowserFocus","_onBlur","_onClick","$body","_attachEventListeners","addEventListener","event","_isEnabled","_options","_isFocusNextOnDisabled","$element","target","removeAttr","currentTarget","focusNext","isAriaDisabled","closest","preventDefault","stopImmediatePropagation","_isFocusOnClickEnabled","$stack","toArray","parents","$focusable","_tabbableElements","focus","FocusOptions","constructor","preventScroll","KeyboardFocusOutline","_onKeyDown","showOnKeys","_start","_isFocusOutlineDisabled","_isFocusOutlineKeyboardOnlyEnabled","keyCode","_focusOutlineKeyboardOnlyIgnore","removeClass","LOG_LEVEL","ENUM","Logging","_config","_level","INFO","asLowerCase","_console","_warnFirstOnly","_warned","listenToOnce","onLoadConfigData","loadConfig","debug","has","checkQueryStringOverride","matches","override","toUpperCase","args","_log","DEBUG","info","warn","WARN","ERROR","fatal","FATAL","removed","concat","warnOnce","_hasWarned","level","isEnabled","configLevel","isLogLevelAllowed","_logToConsole","shouldLogToConsole","asUpperCase","push","hash","String","join","logging","Log","_canWarn","_warn","Scroll","_onTouchStart","_onTouchEnd","_onScrollEvent","_scrollDisabledElements","_preventScrollOnKeys","_ignoreKeysOnElementsMatching","_isRunning","_touchStartEventObject","disable","$elements","add","_checkRunning","enable","not","_stop","passive","fix","_preventScroll","$target","isGesture","touches","scrollingParent","_getScrollingParent","scroll","isTouchEvent","hasTouchStartEvent","originalEvent","directionY","_getScrollDirection","$parent","_isScrollable","_isScrolling","scrollType","pointerEvents","scrollTop","Math","ceil","outerHeight","scrollHeight","hasScrollingSpace","deltaY","_getScrollDelta","startOriginalEvent","currentY","pageY","previousY","hasDeltaY","wheelDeltaY","wheelDelta","removeEventListener","WrapFocus","_focusguard","_onWrapAround","_isPopupWrapFocusEnabled","stopPropagation","focusFirst","Popup","_floorStack","_focusStack","_tabIndexes","_ariaHiddens","_elementUIDIndex","ignoreInternalTrigger","opened","closed","$popupElement","silent","activeElement","_addPopupLayer","_isPopupManagementEnabled","_tabbableElementsExcludes","$branch","$siblings","siblings","each","index","item","$item","a11y_uid","elementUID","tabindex","ariaHidden","_isPopupTabIndexManagementEnabled","_isPopupAriaHiddenManagementEnabled","$items","find","_ariaHiddenExcludes","$focusElement","$previousFocusElement","_removeLastPopupLayer","pop","previousTabIndex","previousAriaHidden","setCloseTo","$original","_menu","_menuGroup","_menuItem","_page","_article","_block","_component","_componentItem","_notify","assign","fn","isFixedPostion","a11y_aria_label","limitedScrollTo","a11y_text","a11y_selected","a11y_on","isOn","$tabbable","findTabbable","toggleAccessible","a11y_only","scrollDisable","_isScrollDisableEnabled","scrollEnable","a11y_popup","popupOpened","a11y_cntrl","withDisabled","toggleEnabled","a11y_cntrl_enabled","toggleAccessibleEnabled","isReadable","findForward","selector","_findFirstForward","findWalk","_findFindForwardDescendant","focusNoScroll","returnOnly","findFirstReadable","focusOrNext","a11y_focus","dontDefer","a11y_alert","a11y_update","text","toggleHidden","a11y_popdown","$focusTarget","popupClosed","a11y_normalize","html","normalize","a11y_remove_breaks","removeBreaks","Components","_register","Array","isArray","forEach","view","View","template","isModelSetAndInvalid","prototype","Function","Error","isViewSetAndInvalid","nameModelViewOrData","toJSON","foundName","entries","key","entry","names","_view","_type","isBackboneView","nameModelOrData","isViewOnlyQuestion","_isQuestionType","_model","isBackboneModel","components","AdaptCollection","Collection","models","loadedData","BuildModel","jsonext","attrs","url","fetch","success","isLoaded","isFrameworkVersion","semver","satisfies","includePrerelease","isPluginInstalled","plugin","whenReady","ConfigModel","large","_forceRouteLocking","_canLoadData","_disableAnimation","setValuesFromURLParams","paramMappings","dir","lang","params","URLSearchParams","passedVal","build","includes","loadData","Data","json","ModelClass","onAdded","onRemoved","reset","_byAdaptID","loadConfigData","onLoadCourseData","onLanguageChange","onDirectionChange","direction","loadCourseData","language","newLanguage","courseFolder","loadManifestFiles","triggerDataLoaded","triggerDataReady","triggerInit","getJSON","path","reject","__path__","fail","languagePath","manifestPath","manifest","err","allFileData","all","filePath","allModelData","fileData","datum","__index__","course","modelData","call","checkData","setupModel","e","isReady","hasId","id","idPathToView","currentLocationId","currentLocationModel","getAncestorModels","modelId","unshift","foundView","currentId","childViews","getChildViews","trackingPosition","trackingId","indexInTrackingIdDescendants","trackingIdModel","trackingIdDescendants","getAllDescendantModels","isTypeGroup","trackingIdAncestors","ancestorDistance","abs","logReadyError","notReadyDescendants","reverse","checkIds","checkTrackingIds","items","idIndex","indexBy","idGroups","groupBy","parentIdGroups","orphanedIds","emptyIds","duplicateIds","missingIds","o","isCourseType","isComponentType","_id","_parentId","hasErrored","number","trackingIdType","trackingIdCounts","missingTrackingIds","_trackingId","duplicateTrackingIds","group","A11y","_isFocusAssignmentEnabled","_isAriaHiddenManagementEnabled","_focusableElements","_readableElements","_focusForwardElementsExcludes","_wrapStyleElements","isFocusable","isTabbable","_htmlCharRegex","_browserFocus","_keyboardFocusOutline","_wrapFocus","_popup","_scroll","_removeLegacyElements","_onConfigDataLoaded","_setupNoSelect","_onNavigationStart","_onNavigationEnd","_isActive","_addFocuserDiv","_disableTextSelectOnClasses","classes","isMatch","some","className","append","$legacyElements","children","$navigationElements","isActive","ariaLevel","ariaLevels","_ariaLevels","defaultAriaLevels","calculateLevel","isNumber","isNaN","isTypeName","relativeDescriptor","nextLevel","hasModelId","nextModel","findAncestor","nextModelId","hasNextTitle","nextModelOverride","accumulatedOffset","resolvedLevel","isHidden","isAccessibleEnabled","toggleTabbableDescendants","element","isAdaptTabHidden","adaptPreviousTabIndex","findFirstTabbable","first","findFirstFocusable","findReadable","findFocusable","checkParents","isNotVisible","hasReadableContent","hasNativeFocusOrIsScreenReadable","childNodes","c","cl","childNode","isTextNode","nodeType","isOnlyWhiteSpace","nodeValue","iterator","$tag","$found","_findFirstForwardDescendant","nextAll","sibling","$sibling","parent","$notFound","stack","stackIndexPosition","childIndexPosition","stackEntry","$stackItem","splice","perform","y","htmls","isString","$div","stackIndex","outputs","nodes","usable","node","isStyleElement","apply","rtnText","outerHTML","textContent","setPopupCloseTo","DrawerItemView","attributes","role","render","events","Handlebars","templates","el","appendTo","onDrawerItemClicked","eventCallback","DrawerView","_isVisible","drawerDir","drawerDuration","_duration","setupEventListeners","toggleDrawer","openCustomView","onCloseDrawer","onRemove","onKeyUp","setupEscapeKey","which","_globals","prependTo","shadowTemplate","shadow","postRender","checkIfDrawerIsAvailable","hasBackButton","_hasBackButton","_isCustomViewVisible","showDrawer","isEmptyDrawer","collection","onBackButtonClicked","onCloseClicked","hideDrawer","$toElement","emptyDrawer","$el","renderItems","hideDrawerBackButton","complete","addShadowEvent","velocity","opacity","duration","easing","_showEasing","empty","isList","_hideEasing","removeShadowEvent","one","childContainer","childView","DrawerCollection","comparator","Drawer","addItem","drawerObject","triggerCustomView","AdaptSubsetCollection","loadSubset","ModelEvent","canBubble","deepPath","timeStamp","addPath","AdaptModel","_children","_parent","extend","_canShowFeedback","_classes","_canReset","_canRequestChild","_isComplete","_isInteractionComplete","_isA11yRegionEnabled","_isA11yCompletionDescriptionEnabled","_requireCompletionOf","_isResetOnRevisit","_isAvailable","_isOptional","_isVisited","_isLocked","_isHidden","firstDescendant","nearestTrackingIdModel","findIndex","descendant","ancestor","trackable","trackableType","bubblingEvents","hasManagedChildren","setupChildListeners","checkCompletionStatus","checkInteractionCompletionStatus","checkLocking","checkVisitedStatus","setupTrackables","originalTrackableStateFunction","triggerTrackableState","compose","isQueued","debounce","changed","trackablePropertyNames","changedPropertyNames","isTrackable","getChildren","onAll","bubble","checkReadyStatus","onIsComplete","getTrackableState","resultExtend","pick","setTrackableState","state","canReset","getAvailableChildModels","child","isVisited","setVisitedStatus","setCompletionStatus","checkCompletionStatusFor","completionAttribute","completed","requireCompletionOf","every","getTypeGroup","typeGroup","hasUpperCase","isPluralized","lowerCased","singular","singularLowerCased","pluralizedLowerCaseTypes","typeGroups","getTypeGroups","intersection","_typeGroups","parentClass","getPrototypeOf","uniq","s","ancestorType","getParent","findDescendantModels","descendants","allDescendantsModels","returnedDescendants","where","property","isParentFirst","subDescendants","findRelativeModel","relativeDescriptorObjects","isInset","isOffset","rootModel","limitParentId","increment","searchBackwards","moveBy","movementCount","hasDescendantsOfType","searchDescendants","searchFromIndex","searchDescendant","hasFilterFunction","loop","totalOfType","count","isSelf","nextDescriptor","output","foundModel","_childrenCollection","childrenCollection","sort","setChildren","_parentModel","parentId","setParent","shouldIncludeChild","context","getSiblings","passSiblingsAndIncludeSelf","_hasSiblingsAndSelf","siblingsCollection","setOptional","lockType","setSequentialLocking","setUnlockFirstLocking","setLockLastLocking","setCustomLocking","previousChild","isLockedByPreviousChild","firstChild","shift","isLockedByFirstChild","lastChild","isLockedByChildren","shouldLock","lockedBy","anotherModel","checkIfResetOnRevisit","isResetOnRevisit","deepClone","modifier","clonedModel","clonedId","shouldAssignUniqueId","cid","uniqueId","cidPrefix","clone","ContentObjectModel","isParentCourse","_siblings","ArticleModel","BlockModel","ComponentModel","_isA11yComponentDescriptionEnabled","_shouldStoreAttempts","_userAnswer","_attemptStates","onAdaptInitialize","restoreUserAnswers","storeUserAnswer","resetUserAnswer","wasReset","getAttemptState","trackables","types","n","booleans","v","numbers","Number","arrays","getAttemptObject","setAttemptObject","addAttemptObject","attemptStates","getAttemptObjects","states","MenuModel","CourseModel","PageModel","ChildEvent","isForced","isStoppedImmediate","isStoppedNext","hasRequestChild","force","stop","immediate","stopNext","close","TemplateRenderEvent","mode","component","preRenderEvent","postRenderEvent","original","React","createElement","__html","compile","flatten","prefixClasses","prefixes","prefixed","prefix","AdaptView","toggleVisibility","onIsCompleteChange","isJSX","_classSet","Set","_isRemoved","preRender","setupOnScreenHandler","addChildren","eventName","startsWith","props","Template","updateViewProperties","ReactDOM","classesToAdd","classesToRemove","delete","_setAttributes","onscreen","m","minVerticalInview","_percentInviewVertical","percentInviewVertical","nthChild","addedCount","addDescendants","_getAddChildEvent","subsequentModels","_nthChild","ChildView","addChildView","setChildViews","$parentContainer","addedDescendantCount","onReadyChange","stopListening","isRequestChild","canRequestChild","findDescendantViews","resetCompletionStatus","descendantComponents","preRemove","unmountComponentAtNode","setVisibility","setHidden","isComplete","_childViews","ContentObjectView","inview","lock","_loadingErrorTimeout","isReact","_isTriggeredReady","performIsReady","hide","unlock","styleOptions","renderTo","isRenderToSelf","ids","forceUntilId","addingId","PageView","$pageLabel","ArticleView","BlockView","MPABC","loading","waitForDataLoaded","loaded","onDataLoaded","setupSubsetCollections","contentObjects","articles","blocks","mpabc","NotifyPushView","updateIndexPosition","updatePushPosition","hasBeenRemoved","notifyPush","delay","closePush","triggerEvent","elementHeight","navigationHeight","currentIndex","flippedIndex","positionLowerPush","NotifyModel","_showIcon","_timeout","NotifyPushCollection","onPushAdded","onRemovePush","checkPushCanShow","canShowPush","showPush","availablePushNotifications","inactivePushNotifications","NotifyPopupView","isOpen","hasOpened","closeNotify","resetNotifySize","cancelNotify","notifyPopup","showNotify","onAlertButtonClicked","onPromptButtonClicked","onCloseButtonClicked","onShadowClicked","resizeNotify","windowHeight","notifyHeight","isFullWindow","top","addSubView","$previousActiveElement","imageready","onLoaded","onOpened","subView","check","stackItem","onCloseReady","removeSubView","views","NotifyView","_stack","notifyPushes","_deprecated","notifyObject","create","notifyTemplate","_shouldRenderId","_isCancellable","_showCloseButton","_closeOnShadowClick","popup","alert","prompt","RouterModel","_canNavigate","_shouldNavigateFocus","Router","routes","_isBackward","_navigationRoot","_isCircularNavigationInProgress","showLoading","$wrapper","setDocumentTitle","navigateToArguments","show","hideLoading","currentModel","hasSubTitle","title","escapedTitle","navigate","handleRoute","handleId","handlePluginRouter","action","pluginLocation","updateLocation","isContentObject","navigateToId","isRoot","_isMenuDisabled","navigateBack","isCourse","newLocation","handleNavigationFocus","ViewClass","isMenu","invoke","isScrolling","currentLocation","setGlobalClasses","htmlClasses","currentClasses","back","navigateToCurrentRoute","route","navigateToPreviousRoute","previousModel","navigateToParent","parentModel","navigateToHomeRoute","settings","currentModelId","isSelectorAnId","contentObject","contentObjectId","isNotInCurrentContentObject","shouldReplace","isElementUnavailable","disableScrollToAnimation","offsetTop","hasClass","left","axis","Scrolling","isLegacyScrolling","_loadConfig","limitTo","_limitToSelector","isIncluded","_windowScrollFix","_addStyling","_updateScrollbarWidth","$tester","scrollBarWidth","outerWidth","documentStyle","body","scrollY","scrollX","scrollLeft","scrollWidth","defineProperties","pageYOffset","pageXOffset","isObject","MouseEvent","pageX","clientX","clientY","StartController","setStartLocation","replaceState","getStartHash","returnToStartLocation","startIds","startId","_skipIfComplete","alwaysForce","getStartId","isRouteSpecified","href","indexOf","shouldForceStartId","shouldNavigateToStartId","_className","skipIfComplete","done","COMPLETION_STATE","Tracking","_requireContentCompleted","_requireAssessmentCompleted","_shouldSubmitScore","_assessmentState","onAssessmentComplete","onAssessmentRestored","checkCompletion","assessmentState","submitScore","isPercentageBased","scoreAsPercent","score","minScore","maxScore","completionData","getCompletionData","status","INCOMPLETE","canRetry","assessment","FAILED","isPass","PASSED","COMPLETED","newShouldSubmitScore","legacyShouldSubmitScore","_tracking","beginWait","endWait","isEventListening","_events","accessibility","onRender","cb","intercept","partials","_imgLazyLoad","applyImgLoadingFix","findImgTag","hasLoadingAttr","imgTagsFound","img","_jsxReactHelpersHTML","applyReactHelpersHTML","tagName","hasSomeUnsafeConversions","hasManyChildren","HTMLReactParser","dangerouslySetInnerHTML","helpers","lowercase","capitalise","charAt","inc","dec","odd","equals","block","compare","operator","inverse","math","lvalue","rvalue","any","specified","none","toString","root","compile_a11y_text","compile_a11y_normalize","compile_a11y_remove_breaks","import_globals","import_adapt","adapt","directImport","indexedImport","importArray","importIndex","i1","l1","component_description","isNotDefined","_components","hasOverride","description","ariaRegion","SafeString","a11y_aria_label_relative","a11y_aria_image","texts","a11y_wrap_focus","cfg","a11y_attrs_heading","from","lastItem","_ariaLevel","a11y_aria_level","a11y_attrs_tabbable","a11y_alt_text","visible","alternatives","if_value_equals","lowerCase","registerHelper","HeadingView","updateAria","customHeadingType","$rendered","Headings","onViewRender","$headingSeats","NavigationView","sortNavigationButtons","onNavigate","_accessibility","insertBefore","currentEvent","skipNavigation","hideNavigationButton","shouldHide","container","a","b","appendChild","showNavigationButton","NavigationController","addNavigationBar","adaptConfig","_isDefaultNavigationDisabled","navigation","ComponentView","renderState","setupInviewCompletion","inviewElementSelector","$inviewElement","inviewCallback","onInview","removeInviewListener","visiblePartX","visiblePartY","hasSeenTop","hasSeenBottom","ChartJSView","onDataChanged","setupChart","setupInview","getInviewElementSelector","dynamicInsert","dataURL","fetchJson","response","ctx","datasets","dataset","chart","Chart","update","ChartJSModel","updateDataset","datasetData","datasetIndex","RangeError","GraphicView","setupScrollable","onScroll","$scrollbar","$scrollContainer","onKeyDown","clientWidth","scrollableWidth","calculatedScrollPercent","step","definedScrollPercent","max","min","onClick","_url","_target","isNewWindow","open","isRouterNavigation","substr","GraphicModel","BUTTON_STATE","textPropertyName","SUBMIT","CORRECT","INCORRECT","SHOW_CORRECT_ANSWER","HIDE_CORRECT_ANSWER","SHOW_FEEDBACK","RESET","ButtonsView","onButtonStateChanged","onFeedbackMessageChanged","onAttemptsChanged","onCanSubmitChange","buttons","refresh","checkResetSubmittedState","isSubmitted","onActionClicked","buttonState","correctAnswer","getCorrectAnswerAsText","updateAnswerLiveRegion","userAnswer","getUserAnswerAsText","onFeedbackClicked","changedAttribute","updateAttemptsCount","$buttonsAction","propertyName","asString","ariaLabel","buttonText","checkFeedbackState","canShowFeedback","isInteractionComplete","attemptsLeft","shouldDisplayAttempts","attemptsString","remainingAttemptText","remainingAttemptsText","showMarking","answer","shouldShowMarking","isCorrect","ariaLabels","_ariaLabels","$marking","$ariaLabel","hasSpanAriaLabel","answeredCorrectly","answeredIncorrectly","QuestionModel","_shouldDisplayAttempts","_shouldShowMarking","_canShowModelAnswer","_canShowMarking","_canSubmit","_isSubmitted","_isCorrectAnswerShown","_questionWeight","_hasItemScoring","_items","setupDefaultSettings","updateRawScore","setupWeightSettings","setupButtonSettings","globalButtons","componentButtons","canSubmit","checkCanSubmit","updateAttempts","setQuestionAsSubmitted","markQuestion","setScore","questionWeight","_rawScore","_maxScore","_minScore","checkQuestionCompletion","updateButtons","canShowModelAnswer","setupFeedback","setupCorrectFeedback","isPartlyCorrect","setupPartlyCorrectFeedback","setupIncorrectFeedback","feedbackTitle","getFeedbackTitle","feedbackMessage","correct","feedback","_partlyCorrect","final","setAttemptSpecificFeedback","_incorrect","notFinal","altFeedbackTitle","getAltFeedbackTitle","altTitle","isInteractive","attempts","_attemptsLeft","_isCorrect","_buttonState","setQuestionAsReset","resetQuestion","getButtonState","getInteractionObject","getResponse","getResponseType","onSubmitted","QuestionView","onEnabledChanged","ensureLegacyLifecycleState","_runModelCompatibleFunction","setupQuestion","disableQuestion","enableQuestion","resetQuestionOnRevisit","onHideCorrectAnswerClicked","onResetClicked","addButtonsView","onQuestionRendered","buttonsView","onButtonStateUpdate","onSubmitClicked","onShowCorrectAnswerClicked","showFeedback","showInstructionError","onCannotSubmit","recordInteraction","resize","setQuestionAsShowCorrect","showCorrectAnswer","setQuestionAsHideCorrect","hideCorrectAnswer","getLatency","lookForViewOnlyFunction","ViewOnlyQuestionViewCompatibilityLayer","_isInViewOnlyCompatibleMode","checkForFunction","hasCompatibleVersion","usingCompatibleVersion","MatchingView","preinitialize","setActiveOption","setHighlightedOption","setupRandomisation","setupInitialHighlighted","ItemModel","_score","toggleActive","toggleVisited","MatchingItemModel","_isHighlighted","toggleHighlighted","isHighlighted","ItemsComponentModel","setUpItems","booleanArray","_index","getItem","findWhere","getVisitedItems","getActiveItems","getActiveItem","areAllItemsCompleted","resetActiveItems","setActiveItem","activeItem","BlendedItemsComponentQuestionModel","getOwnPropertyNames","defineProperty","ItemsQuestionModel","isSingleSelect","itemModels","shuffle","activeItems","itemModel","allChildren","activeChildren","isItemCorrect","isItemPartlyCorrect","isItemIncorrect","list","predicate","_numberOfRequiredAnswers","_numberOfCorrectAnswers","_numberOfPartlyCorrectAnswers","_numberOfIncorrectAnswers","_isAtLeastOneCorrectSelection","numberOfSelectableAnswers","hasSelectableCorrectAnswers","hasAllCorrectAnswers","hasCorrectAnswers","hasIncorrectAnswers","hasPartlyCorrectAnswers","scores","setupIndividualFeedback","selectedItem","isAtActiveLimit","selectedItems","getLastActiveItem","resetItems","interactions","correctResponsesPattern","choices","correctItems","activeIndexes","globals","ariaAnswer","ariaCorrectAnswer","ariaCorrectAnswers","correctOptions","_shouldBeSelected","correctOption","ariaUserAnswer","ariaUserAnswers","MatchingModel","itemIndex","itemOptions","option","optionIndex","_optionIndex","_itemIndex","_selectable","selectOption","getActiveItemOption","getFirstItemOption","resetHighlightedItems","activeCount","getItemOptions","getCorrectItemOption","activeOption","unsetDuplicateOptions","allowOnlyUniqueAnswers","activeItemOption","activeItemOptionText","otherActiveOptions","optionText","hasMatchingText","maxItemScores","optionScores","minItemScores","source","itemPosition","optionPosition","flat","Infinity","responses","correctAnswerTemplate","_matching","itemText","userAnswerTemplate","McqView","onKeyPress","onItemSelect","onItemFocus","onItemBlur","shouldSelect","McqModel","TextView","TextModel","MoralMachineGmcqView","MoralMachineGmcqModel","MoralMachineResultsResultsModel","onAssessmentReset","checkIfAssessmentComplete","assessmentModel","_queryURL","loadDataFromXAPI","getState","allowResetIfPassed","initScoring","scoreObj","counts","multiplier","j","updateScoring","arr","x","fetchDataFromXAPI","componentID","xapiQueryEndpoint","activityID","_activityID","componentURI","encodeURIComponent","_getAllQuestionComponents","ci","othersCounts","savedCount","allCharacterCount","finalArr","totalResponses","APIdata","completion","scoring","getCharacterCounts","saved","Character","killed","getSavedCounts","gender","results","setResults","_state","attemptsSpent","checkRetryEnabled","setFeedbackText","getFeedbackText","getResults","canResetInPage","isAttemptsLeft","showRetry","_isRetryEnabled","retryFeedback","getUserAnswersTemplate","userAnswers","nestedToUnestedChanges","key1","key2","removeZeroValues","finalObj","propertyKeys","hasNonZeroEntries","propertyKey","getBarPosition","total","firstValue","totalPercent","newCountOne","othersAnswers","savedTableDetail","percentages","character","replaceAll","barPositions","isAttemptInProgress","attemptInProgress","isVisibleBeforeCompletion","isVisible","resetType","MoralMachineResultsView","addClassesToArticle","onRetryClicked","_routeToAssessment","articleId","MoralMachineResultsModel","BlockSliderView","_disableAnimationOnce","AdaptArticleView","isBlockSliderEnabled","_blockSliderPreRender","resolveQueue","_blockSliderSetupEventListeners","_blockSliderResizeHeight","_onBlockSliderResize","_onBlockSliderDeviceChanged","_onBlockSliderPageScrollTo","_onBlockSliderPageScrolledTo","_onBlockSliderRemove","_onBlockSliderReady","_slideAnimationDuration","_blockSliderHideOthers","_blockSliderRender","_blockSliderConfigureVariables","delegateEvents","_blockSliderPostRender","totalBlocks","itemButtons","_includeNumber","_title","_currentBlock","_totalBlocks","_itemButtons","_blockSliderConfigureControls","animate","$left","$right","$indexes","eq","$blocks","_blockSliderSetButtonLayout","buttonsLength","itemwidth","startIndex","_startIndex","_blockSliderMoveIndex","_onBlockSliderClick","_blockSliderMoveLeft","_blockSliderMoveRight","_blockSliderSetVisible","_blockSliderScrollToCurrent","_blockSliderIsEnabledOnScreenSizes","$container","blockWidth","lastIndex","currentBlock","isRTL","totalLeft","_blockSliderShowAll","isEnabledOnScreenSizes","_isEnabledOnScreenSizes","sizes","cancel","makeVisible","_blockSliderResizeWidth","_blockSliderResizeTab","currentHeight","blockHeight","maxHeight","_heightAnimationDuration","_hasUniformHeight","minHeight","_minHeight","_hasTabs","parentHeight","toolbarHeight","additionalMargin","toolbarMargin","marginTop","$blockContainer","totalWidth","showToolbar","_blockSliderRemoveEventListeners","BlockSliderModel","_isDisabledWhenAccessibilityActive","ArticleViewInitialize","ArticleViewExtension","ArticleModelInitialize","ArticleModelExtension","returnValue","AssessmentView","isAssessmentEnabled","_setupEventListeners","getConfig","_questions","_onAssessmentComplete","_onAssessmentReset","_onRemove","_removeEventListeners","QuestionBank","quizBankId","_bankId","_articleId","_unusedQuestionBlocks","_count","calculateAvailableQuestionBlocks","articleModel","_availableQuestionBlocks","blockModel","_quizBankID","availableQuestionBlockIds","unusedQuestionBlockIds","haveBlocksChanged","difference","getRandomQuestionBlocks","questionBlocks","nextBlock","unusedQuestionBlocks","hasUnusedQuestion","givenIdCount","assessmentConfigDefaults","_resetType","_suppressMarking","_isPercentageBased","_scoreToPass","_correctToPass","_includeInTotalScore","_assessmentWeight","_reloadPageOnReset","_attempts","_allowResetIfPassed","AssessmentModel","_getCurrentQuestionComponents","questions","_postInitialize","assessmentConfig","_originalChildModels","_questionBanks","_forceResetOnRevisit","_assessmentCompleteInSession","_attemptInProgress","_isAssessmentComplete","_numberOfQuestionsAnswered","_lastAttemptScoreAsPercent","_attemptsSpent","_onDataReady","setupCurrentQuestionComponents","_setAssessmentOwnershipOnChildrenModels","_updateQuestionsState","assessmentQuestionsConfig","childConfig","_isPartOfAssessment","_assessmentId","_setupAssessmentData","hasAttemptsLeft","isFirstAttempt","shouldResetOnRevisit","shouldResetAssessment","shouldResetQuestions","quizModels","_banks","_split","_setupBankedAssessment","_randomisation","_setupRandomisedAssessment","_resetQuestions","_overrideQuestionComponentSettings","_setupQuestionListeners","_checkNumberOfQuestionsAnswered","saveState","_setupBanks","questionModels","flatMap","questionBank","bankSplits","hasBankSplitsChanged","bankId","randomisationModel","blockModels","_blockCount","newSettings","_getMarkingSettings","questionConfig","isEmpty","questionComponents","_removeQuestionListeners","_onCompletionEvent","numberOfQuestionsAnswered","_onBlockCompleted","_onQuestionCompleted","questionModel","_checkAssessmentComplete","question","allQuestionsAdded","POSITIVE_INFINITY","allQuestionsAnswered","wasAttemptInProgess","_spendAttempt","_scoreAsPercent","_getScoreAsPercent","_getScore","_getMaxScore","_getMinScore","_correctCount","_getCorrectCount","_correctAsPercent","_getCorrectAsPercent","_questionCount","_getQuestionCount","_checkIsPass","_isMarkingSuppressionEnabled","_isAttemptsLeft","_isPassed","_overrideMarkingSettings","_refreshQuestions","scoreToPass","correctToPass","correctAsPercent","correctCount","markingSettings","_shouldSuppressMarking","newMarkingSettings","range","round","questionCount","_getLastAttemptScoreAsPercent","_checkReloadPage","_reloadPage","_scrollToOnReset","_setCompletionStatus","_checkIfQuestionsWereRestored","wereQuestionsRestored","isPageReload","getSaveState","banksActive","randomisationActive","blockTrackingPositions","blockCompletion","blockData","dataPackage","setRestoreState","restoreState","nonBlockChildren","blockIndex","blockQuestions","questionIndex","pageId","includeInTotalScore","assessmentWeight","lastAttemptScoreAsPercent","assessmentsConfigDefaults","_isDefaultsLoaded","Assessment","_assessments","_byPageId","_byAssessmentId","_onAssessmentsComplete","_checkResetAssessmentsOnRevisit","_handleRoute","assessmentId","_getStateByAssessmentId","_setPageProgress","_checkAssessmentsComplete","_restoreModelState","_saveStateModel","toObject","pageAssessmentModels","_getAssessmentByPageId","resetAllAssessments","allAssessmentHaveReset","numberOfAssessments","numberOfResetAssessments","forceAssessmentReset","haveAllModelsReset","_restoredCount","allAssessmentsComplete","assessmentToPostBack","_getStatesByAssessmentId","assessmentStates","_setupSingleAssessmentConfiguration","assessmentsConfig","assessments","availableAssessments","assessmentsTotal","assessmentsPassed","pageModel","_subProgressTotal","_subProgressComplete","_addToAssessmentIdMap","_setupQuestionNumbering","getRelatedQuestions","currentAssessmentId","currentAssessment","getQuestionNumber","related","pluck","getTotalQuestions","assessmentsComplete","scoreRange","isFailed","AdaptAssessmentArticleView","AdaptAssessmentArticleModel","getMMCorrectness","getCorrectness","numberOfCorrect","numberOfPartlyCorrect","BranchingSet","setupModels","containerId","_containerId","isDirectChild","_isBranchChild","_isBranchClone","_wasInitialized","disableParentCompletion","wasRestored","restore","getNextModel","addNextModel","addFirstModel","enableParentCompletion","checkResetOnStartChange","isAtCorrectStart","isAtStart","branchedModels","isAtEnd","removeViews","branching","trackingPositions","isLast","isTheoretical","branchingModels","isBeforeStart","hasStartId","firstModel","lastChildModel","isLastIncomplete","lastChildConfig","correctness","nextId","_force","findNextModel","isRelativeId","originalLastChildModel","wasModelAlreadyUsed","nextBranchingSet","getSubsetByModelId","shouldSave","shouldRestore","_branchLastPreviousIndex","attemptIndex","isAnyPartRestored","cloned","unset","attemptObjects","hasAttemptRecord","areAllDescendantsComplete","saveNextModel","trackingIds","isEffectivelyComplete","childModel","hasStandardCompletionCriteria","areAllAvailableTrackableChildrenComplete","_isInReset","Branching","_rawSets","openPopupCount","shouldContinueOnPopupClose","onAppDataReady","onPopupOpened","onPopupClosed","onArticleReset","_isAwaitingDataReady","warnForSpoorMisconfiguration","setupBranchingModels","isMisconfigured","containerModels","_onChildren","containerModel","subsets","onRequestChild","onComplete","continue","continueAfterBranchChild","saveBranchQuestionAttemptHistory","checkIfIsEffectivelyComplete","isBranchChild","branchOriginModelId","originModel","Completion","subProgressCompleted","subProgressTotal","nonAssessmentCompleted","nonAssessmentTotal","assessmentCompleted","assessmentTotal","calculateCompletion","contentObjectModel","viewType","availableChildren","filterAvailableChildren","getPageLevelProgressEnabledModels","nonAssessmentComponents","getNonAssessmentComponents","getComponentsCompleted","assessmentComponents","getAssessmentComponents","getComponentsInteractionCompleted","_excludeAssessments","showPageCompletionCourse","_showPageCompletion","showPageCompletionPage","completionObject","unavailableInHierarchy","calculatePercentageComplete","percentageComplete","floor","PageLevelProgressIndicatorView","calculatePercentage","addClasses","setUpEventListeners","setPercentageComplete","checkAria","getRenderData","percentage","PageLevelProgressItemView","addIndicator","PageLevelProgressView","scrollToPageElement","currentComponentSelector","pageLevelProgress","$children","PageLevelProgressNavigationView","_extensions","_pageLevelProgress","_navOrder","click","deferredUpdate","updateProgressBar","refreshProgressBar","pageLevelProgressNavigation","indicatorView","_getPageCompletionPercentage","pageLevelProgressIndicatorBar","prepend","completionCalculations","repopulate","onProgressClicked","PageLevelProgressCollection","_pageModel","allDescendants","currentPageItems","availableItems","enabledProgressItems","PageLevelProgress","onDataReady","getCourseConfig","coursePLPConfig","headerIndicatorTypes","headerIndicatorEventNames","renderHeaderIndicatorView","renderMenuItemIndicatorView","renderNavigationView","onCompletionChange","completionState","hasChanged","_previousCompletionState","_isCompletionIndicatorEnabled","pageConfig","$headings","insertAfter","_getMenuItemCompletionPercentage","pageLevelProgressMenuBar","_isShownInNavigationBar","pagePLPConfig","after","_deepDefaults","defaultObjects","keyValuePairs","defaultValue","isRecursiveObject","isValueAlreadySet","configDefaults","_isInherited","_autoScroll","_scrollTo","_button","_isFullWidth","_autoHide","_hasIcon","_styleBeforeCompletion","_styleAfterClick","startText","startAriaLabel","finalText","finalAriaLabel","_stepLocking","_isCompletionRequired","_isLockedOnRevisit","isModelArticleWithOnChildren","trickleConfig","isModelBlockWithArticleNotChildren","parentTrickleConfig","getModelConfigDefaults","getModelInheritanceChain","configModel","parentConfig","blockConfig","isParentEnabledNotOnChildren","isNoChildConfig","getModelConfig","inheritance","inheritModel","getModelContainer","getCompletionAttribute","_completionAttribute","checkApplyLocks","hasCompletionChanged","hasAvailabilityChanged","debouncedApplyLocks","applyLocks","locks","modelsById","TrickleButtonModel","siteModel","isModelLocked","subsequentLockingModels","_getAncestorNextSiblings","isButtonModel","descendantId","wasLocked","logTrickleState","isStepLocked","isCompletionRequired","TrickleModel","trickleButton","isTrickleButtonComplete","fromModel","allSiblings","subsequentSiblings","allAncestors","inPageAncestors","subsequentInPageAncestors","grandParent","previousIndex","allGrandParentChildren","subsequentAncestorSiblings","subsequentContentObjectDescendantModels","addButtonComponents","uid","buttonModelSite","trickleButtonModel","_layout","_trickle","_renderPosition","_isTrackable","isTrickled","repeat","TrickleController","checkIsFinished","onAddChildView","kill","isMidRender","isStarted","isKilled","isManagedByTrickleAndLocked","isTrickling","isAutoScrollOff","hasTrickleButton","getScrollToId","firstCharacter","relativeModel","scrollToId","isDescendant","_scrollDuration","isFinished","TrickleButtonView","isAwaitingPopupClose","wasButtonClicked","calculateButtonText","calculateButtonState","isDisabledByPopups","tryButtonAutoHide","onParentComplete","updateButtonState","isStepUnlocked","onStepUnlocked","shouldUserInteractWithButton","finish","isButtonHidden","isButtonDisabled","$button","HTMLElement","isSameNode","$buttonText","onButtonClick","wasComplete","isStepLockingCompletionRequired","controller","measurements","isJustOffscreen","bottom","isButtonAutoHidden","isStepComplete","isStepLocking","isCompletionBlocked","isParentComplete","isStepLockedOnRevisit","isButtonComplete","isLastInContentObject","lastDescendant","isStart","isFinal","trickleParent","trickleSiblings","buttonAriaLabel","isButtonDisableForced","isButtonHiddenForced","_isButtonVisible","_isButtonDisabled","_showEndOfPage","isTrickleKilled","isButtonVisibleBeforeCompletion","isButtonVisibleAfterCompletion","isNoCompletionRequiredAndLockedVisible","isNoCompletionRequiredAndUnlockedVisible","isNoCompletionRequiredAndFinishedVisible","isStepLockedAndVisibleBeforeCompletion","isFinishedAndVisibleAfterCompletion","isStepUnlockedAndButtonIncomplete","isButtonVisible","isButtonEnabledBeforeCompletion","isButtonEnabledAfterCompletion","isNoCompletionRequiredAndLockedEnabled","isNoCompletionRequiredAndUnlockedEnabled","isNoCompletionRequiredAndFinishedEnabled","isStepUnlockedAndButtonIncompleteWithoutButtonDisabledForced","isFinishedAndEnabledAfterCompletion","isButtonEnabled","trickle","TUTOR_TYPE","TutorModel","NOTIFY","_hasNotifyBottomButton","_attributes","getOriginClasses","extension","TutorNotify","onNotifyClosed","triggerNotify","promptText","notifyOptions","_prompts","TutorView","onTutorClosed","onButtonsStateUpdate","tutor","toggleFeedback","shouldOpen","shouldManageFocus","animation","onAnimationEnd","onTutorOpened","onCloseClick","$showFeedbackButton","Tutor","onQuestionViewShowFeedback","tutorModel","INLINE","OVERLAY","NONE","xAPI","displayLang","generateIds","activityId","actor","shouldTrackState","shouldUseRegistration","componentBlacklist","isInitialised","startAttemptDuration","startTimeStamp","courseName","courseDescription","defaultLang","coreEvents","coreObjects","initializeWrapper","onInitialised","getLRSAttribute","getBaseUrl","cookieDomain","validateProps","Date","statements","getCourseStatement","ADL","verbs","launched","initialized","sendStatements","onVisibilityChange","sendUnloadStatements","sendStatement","attempted","resumed","getLearnerInfo","_learnerInfo","xapiWrapper","XAPIWrapper","checkWrapperConfig","registration","strictCallbacks","launch","launchData","configError","setWrapperConfig","uuidv4","crypto","getRandomValues","Uint8Array","getDomain","domain","URL","hostname","elems","iMax","isSecondLevel","tld","setCookie","cname","cvalue","exdays","d","setTime","getTime","expires","toUTCString","cookie","getCookie","decodedCookie","decodeURIComponent","ca","substring","lrs","courseUser","onLanguageChanged","deleteState","visibilityState","isTerminated","suspended","terminated","sendStatementsSync","endpoint","auth","activity_id","newConfig","val","changeConfig","testConfig","origin","pathname","getAttemptDuration","getSessionDuration","convertMillisecondsToISO8601Duration","inputMilliseconds","hours","minutes","seconds","i_inputMilliseconds","i_inputCentiseconds","inputIsNegative","rtnStr","setupListeners","sendState","onTrackingComplete","onItemExperience","onQuestionInteraction","onItemComplete","getCourseActivity","XAPIStatement","Activity","definition","activityTypes","verb","failed","passed","getStatement","getVerb","getNameObject","getActivityType","interaction","media","module","lesson","isComponentOnBlacklist","getUniqueIri","statement","stripHtml","interactionType","raw","processInteractionResponse","answered","addGroupingActivity","tempDiv","innerHTML","innerText","responseType","experienced","getLessonActivity","page","activity","addParentActivity","getAssessmentObject","getAssessmentResultObject","scaled","fakeModel","self","singleLanguageVerb","display","iri","completionVerb","require","stateObject","restoreModel","Agent","generateId","modelState","collectionName","findKey","stateCollection","newState","xhr","isFunction","Async","nextType","parseError","mbox","account","accountServiceHomePage","homePage","accountName","getLRSExtendedAttribute","extended","errorCount","attachments","isUndefined","processAttachments","onStatementReady","isCORS","credentials","withCredentials","headers","xapiVersion","cache","keepalive","method","then","catch","urlparts","protocol","urlPort","port","attachment","nextAttachment","XMLHttpRequest","onreadystatechange","readyState","reader","FileReader","onload","readAsBinaryString","send","nextStatement","getGlobals","_xapi","showError","lrsConnectionErrorTitle","lrsConnectionErrorMessage","confirmText","confirm","position","zIndex","getInstance","instance","xapi","load","isDataRestored","getAll","useTemporaryStore","learnerInfo","lastname","firstname","getLearnerId","openid","initialise","successEvent","_shouldTrackState","DevtoolsModel","getDefaultConfig","toggleHinting","toggleAutoCorrect","toggleAltText","toggleTraceFocus","Hinting","devtools","toggleHints","renderedQuestions","setHinting","onComponentRendered","hintingEnabled","setMcqHinting","setGmcqHinting","setMatchingHinting","setPpqHinting","setSliderHinting","setTextInputHinting","setQuestionStripHinting","$options","_bottom","_top","_answers","placeholder","$subItems","_subItems","subItem","subItemIndex","Events","isQuestionSupported","AutoAnswer","mousedownHandlers","componentRendered","onQuestionMouseDown","ctrlKey","shiftKey","isItemsQuestionModel","defined","incorrectly","answerMultipleChoiceIncorrectly","answerMatchingIncorrectly","answerPpqIncorrectly","answerSliderIncorrectly","answerTextInputIncorrectly","answerQuestionStripIncorrectly","answerUnsupportedIncorrectly","answerMultipleChoice","answerMatching","answerPpq","answerSlider","answerTextInput","answerQuestionStrip","answerUnsupported","isGraphical","noCorrectOptions","random","_isSelected","itemCount","selectionStates","times","nShould","nShouldNot","nSelect","nIncorrect","nCorrect","k","found","dropdowns","getFirstSelectedItem","selectValue","$select","setOptionSelected","prop","incorrect","answers","setStage","isDesktop","$pinboard","boardw","boardh","zone","pin","getNextUnusedPin","setPosition","maxSize","resetPins","ok","tuple","PassHalfFail","syncIterations","mouseTarget","_questionViews","_currentPageId","onPagePreRender","onKeypress","onMouseDown","onMouseUp","_completeNonQuestions","nonQuestions","pass","qs","len","half","notSubmitted","char","fromCharCode","tutorEnabled","partial","onPassHalfFailComplete","ToggleBanking","_assessmentBankDisabled","getBankedAssessmentsInCurrentPage","f","toggle","bankedAssessments","isBankingEnabled","_isPass","MapView","_renderIntervalId","setInterval","_checkRenderInterval","onModelCompletionChanged","devtoolsMap","clearInterval","_invalid","_getConfig","_disablePageIncompletePrompt","_pageIncompletePromptExists","_pageIncompletePromptEnabled","_restorePageIncompletePrompt","invalidate","onLinkClicked","defaultView","navigateAndDisableTrickle","navigateAndDisableTrickleUpTo","at","checkVisibility","handleCourse","targetModel","CourseMap","onMapLoaded","onCourseClosed","eachChild","ret","last","getId","getProp","isStringEmpty","str","getTitle","t","when","trickled","isBlock","mapWindow","onMapClosed","mapView","Utils","getModelForElement","getAdaptCoreVersion","getParents","horz","getHorzLine","onTrickleBegun","onTrickleChange","onTrickleEnded","onShowFeedback","hushTutor","reinstateTutor","onFeedbackToggled","onFeedbackButtonClicked","componentId","exec","AltText","MutationObserver","observer","onDomMutation","addTimer","fireNow","timerId","onTimer","removeTimer","connectObserver","observe","getElementById","childList","subtree","attributeFilter","disconnectObserver","disconnect","removeAllAnnotations","addAnnotation","$img","$annotation","updateAnnotation","removeAnnotation","removeData","mutations","mutated","breakCoreLocking","breakLocks","onUnlocked","onMenuPreRender","onMenuReady","_lock","_locked","buffer","isMouseDown","hitArea","coords","topLeftTapHold","topRightTapHold","listenType","timeoutId","focusableElements","processBuffer","blen","removeHooks","addHooks","kcheat","addTouchHook","removeTouchHook","onTouchStart","onTouchEnd","TraceFocus","openingTags","RegExp","consoleStyle","onFocusIn","openingTag","tokens","doCompletion","navigationView","DevtoolsView","_checkUnlockVisibility","_checkSpoorLogVisibility","_checkTrickleEndVisibility","_checkBankingVisibility","_checkFeedbackVisibility","_checkHintingVisibility","_checkAutoCorrectVisibility","_checkAltTextVisibility","_checkPassHalfFailVisibility","_checkCompletePageVisibility","_checkCompleteMenuVisibility","_checkTraceFocusVisibility","_checkForLocks","hasLock","onUnlock","onOpenMap","spoorInstalled","onOpenSpoorLog","spoor","scorm","showDebugWindow","onEndTrickle","onToggleBanking","onToggleFeedback","onToggleHinting","onToggleAutoCorrect","onToggleAltText","incomplete","onCompletePage","onCompleteMenu","unanswered","onPassHalfFail","onToggleTraceFocus","DevtoolsNavigationView","devtoolsNavigation","onDevtoolsClicked","onContentRendered","deferredRender","initNavigationView","MenuItemView","MenuView","BoxMenuItemView","onClickMenuItemButton","BoxMenuGroupView","BoxMenuView","setStyles","onDeviceResize","_renderAsGroup","addBackgroundLayer","setBackgroundImage","setBackgroundStyles","processHeader","$background","backgroundImages","_backgroundImage","backgroundImage","_small","styles","_backgroundStyles","_backgroundRepeat","_backgroundSize","_backgroundPosition","header","_menuHeader","$header","addHeaderBackgroundLayer","setHeaderBackgroundImage","setHeaderBackgroundStyles","setHeaderMinimumHeight","$headerBackground","minimumHeights","_minimumHeights","minimumHeight","ThemeView","setClasses","setMinimumHeight","setCustomStyles","_large","_medium","ThemePageView","ThemeArticleView","ThemeBlockView","onPostRender","theme","Header","jsxHeading","useRef","displayTitle","instruction","mobileInstruction","_disableAccessibilityState","classNamePrefixes","sizedInstruction","isSet","Image","hasMediumSetting","src","_src","hasSource","attributionClassNamePrefixes","attribution","alt","longdescription","longDescriptionId","LinkWrapper","Graphic","_scrollPercent","_graphic","scrollableProperties","scrollAriaLabel","tabIndex","Matching","displayAsCorrect","displayItemAsCorrect","MatchingDropDown","button","wasOpen","setWasOpen","useState","setIsOpen","isShown","setIsShown","blurTimeoutHandle","setBlurTimeoutHandle","isListOffScreen","setIsListOffScreen","listHeight","setListHeight","buttonWidth","setButtonWidth","buttonOffsetLeft","setButtonOffsetLeft","onStartInteraction","current","getBoundingClientRect","offsetLeft","scrollToHighlightedListItem","highlighted","clientHeight","pos","onOptionClicked","li","chooseOption","onListBlur","handleBlur","onDocumentClick","KEYCODE","UP","DOWN","ENTER","SPACE","ESCAPE","validKeyCodes","onDocumentKeyDown","getPreviousOption","getLastOption","highlightOption","getNextOption","getFirstOption","highlightedOption","getCurrentOptionIndex","useEffect","capture","correctActiveOption","displayActiveOption","displayText","Mcq","_isRadio","ariaQuestion","selectedAnswer","unselectedAnswer","Text","Gmcq","_columns"],"mappings":"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"}